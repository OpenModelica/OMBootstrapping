#include "omc_simulation_settings.h"
#include "NSimCode.h"
#define _OMC_LIT0_data "der"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,3,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT1,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT0}};
#define _OMC_LIT1 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT2,2,4) {&DAE_Type_T__REAL__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT2 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,1,7) {&DAE_InlineType_NO__INLINE__desc,}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,1,3) {&DAE_TailCall_NO__TAIL__desc,}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,8,3) {&DAE_CallAttributes_CALL__ATTR__desc,_OMC_LIT2,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT3,_OMC_LIT4}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "$DER"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,4,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data "$SEED_A"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,7,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,1,4) {&NFComponentRef_EMPTY__desc,}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT9,1,18) {&NFType_ANY__desc,}};
#define _OMC_LIT9 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,1,3) {&NFBinding_UNBOUND__desc,}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT11,1,4) {&NFPrefixes_Replaceable_NOT__REPLACEABLE__desc,}};
#define _OMC_LIT11 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT11)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT12,10,3) {&NFAttributes_ATTRIBUTES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT11,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT12 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT12)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT13,3,3) {&SCode_Comment_COMMENT__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT13 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,0,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT15,0.0);
#define _OMC_LIT15 MMC_REFREALLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT14,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT15}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,1,35) {&NFBackendExtension_VariableKind_FRONTEND__DUMMY__desc,}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT18,17,3) {&NFBackendExtension_VariableAttributes_VAR__ATTR__REAL__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT18 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT19,3,3) {&NFBackendExtension_Annotations_ANNOTATIONS__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT19 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,8,3) {&NFBackendExtension_BackendInfo_BACKEND__INFO__desc,_OMC_LIT17,_OMC_LIT18,_OMC_LIT19,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT21,11,3) {&NFVariable_VARIABLE__desc,_OMC_LIT8,_OMC_LIT9,_OMC_LIT10,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT12,MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT13,_OMC_LIT16,_OMC_LIT20}};
#define _OMC_LIT21 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,1,13) {&NFType_UNKNOWN__desc,}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "Searching for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,15,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,1,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "A"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,1,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "Internal error %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,17,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT28}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(63)),_OMC_LIT26,_OMC_LIT27,_OMC_LIT29}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
#define _OMC_LIT31_data "NSimCode.DaeModeData.createSparsityJacobian failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT31,51,_OMC_LIT31_data);
#define _OMC_LIT31 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,2,1) {_OMC_LIT31,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT33,1,3) {&SimCode_DaeModeConfig_ALL__EQUATIONS__desc,}};
#define _OMC_LIT33 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,1,4) {&SimCode_DaeModeConfig_DYNAMIC__EQUATIONS__desc,}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "  "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,2,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "DAE Partition "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,14,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
#define _OMC_LIT37_data "NSimCode.ModelInfo.setSeedVars failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT37,38,_OMC_LIT37_data);
#define _OMC_LIT37 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT37)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT38,2,1) {_OMC_LIT37,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT38 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT38)
#define _OMC_LIT39_data "NSimCode.SimCode.getDirectoryAndLibs failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT39,44,_OMC_LIT39_data);
#define _OMC_LIT39 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,2,1) {_OMC_LIT39,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT41,3,3) {&SimCode_DelayedExpression_DELAYED__EXPRESSIONS__desc,MMC_REFSTRUCTLIT(mmc_nil),MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT41 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT41)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT42,3,3) {&SimCode_SpatialDistributionInfo_SPATIAL__DISTRIBUTION__INFO__desc,MMC_REFSTRUCTLIT(mmc_nil),MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT42 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT42)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT43,3,3) {&HpcOmSimCode_HpcOmData_HPCOMDATA__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT43 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,1,5) {&AvlTreeCRToInt_Tree_EMPTY__desc,}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT45,5,3) {&SimCode_PartitionData_PARTITIONDATA__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(-1)),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT45 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT45)
#define _OMC_LIT46_data "B"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT46,1,_OMC_LIT46_data);
#define _OMC_LIT46 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT46)
#define _OMC_LIT47_data "C"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT47,1,_OMC_LIT47_data);
#define _OMC_LIT47 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT47)
#define _OMC_LIT48_data "D"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT48,1,_OMC_LIT48_data);
#define _OMC_LIT48 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT48)
#define _OMC_LIT49_data "F"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT49,1,_OMC_LIT49_data);
#define _OMC_LIT49 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT49)
#define _OMC_LIT50_data "H"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT50,1,_OMC_LIT50_data);
#define _OMC_LIT50 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT50)
#define _OMC_LIT51_data "NSimCode.SimCode.create failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT51,31,_OMC_LIT51_data);
#define _OMC_LIT51 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT51)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT52,2,1) {_OMC_LIT51,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT52 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT52)
#define _OMC_LIT53_data "SimCode "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT53,8,_OMC_LIT53_data);
#define _OMC_LIT53 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT53)
#define _OMC_LIT54_data "("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT54,1,_OMC_LIT54_data);
#define _OMC_LIT54 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT54)
#define _OMC_LIT55_data ")"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT55,1,_OMC_LIT55_data);
#define _OMC_LIT55 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT55)
#define _OMC_LIT56_data "Initial Partition (Lambda = 0)"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT56,30,_OMC_LIT56_data);
#define _OMC_LIT56 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT56)
#define _OMC_LIT57_data "Initial Partition"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT57,17,_OMC_LIT57_data);
#define _OMC_LIT57 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT57)
#define _OMC_LIT58_data "ODE Partition "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT58,14,_OMC_LIT58_data);
#define _OMC_LIT58 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT58)
#define _OMC_LIT59_data "Algebraic Partition "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT59,20,_OMC_LIT59_data);
#define _OMC_LIT59 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT59)
#define _OMC_LIT60_data "Event Partition"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT60,15,_OMC_LIT60_data);
#define _OMC_LIT60 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT60)
#define _OMC_LIT61_data "Clocked Partitions"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT61,18,_OMC_LIT61_data);
#define _OMC_LIT61 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT61)
#define _OMC_LIT62_data "Shared Literals"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT62,15,_OMC_LIT62_data);
#define _OMC_LIT62 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT62)
#define _OMC_LIT63_data "\n  "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT63,3,_OMC_LIT63_data);
#define _OMC_LIT63 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT63)
#define _OMC_LIT64_data "\n\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT64,2,_OMC_LIT64_data);
#define _OMC_LIT64 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT64)
#define _OMC_LIT65_data "Generic Calls"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT65,13,_OMC_LIT65_data);
#define _OMC_LIT65 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT65)
#define _OMC_LIT66_data "cref: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT66,6,_OMC_LIT66_data);
#define _OMC_LIT66 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT66)
#define _OMC_LIT67_data "\neqn: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT67,6,_OMC_LIT67_data);
#define _OMC_LIT67 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT67)
#define _OMC_LIT68_data "\n(resizable="
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT68,12,_OMC_LIT68_data);
#define _OMC_LIT68 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT68)
#define _OMC_LIT69_data "true"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT69,4,_OMC_LIT69_data);
#define _OMC_LIT69 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT69)
#define _OMC_LIT70_data "false"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT70,5,_OMC_LIT70_data);
#define _OMC_LIT70 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT70)
#include "util/modelica.h"

#include "NSimCode_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_replaceDerCref(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_integer __omcQ_24in_5Fi, modelica_boolean *out_b, modelica_integer *out_i);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NSimCode_DaeModeData_replaceDerCref(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype __omcQ_24in_5Fi, modelica_metatype *out_b, modelica_metatype *out_i);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_replaceDerCref,2,0) {(void*) boxptr_NSimCode_DaeModeData_replaceDerCref,0}};
#define boxvar_NSimCode_DaeModeData_replaceDerCref MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_replaceDerCref)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_replaceDerCrefSES(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fsys);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_replaceDerCrefSES,2,0) {(void*) boxptr_NSimCode_DaeModeData_replaceDerCrefSES,0}};
#define boxvar_NSimCode_DaeModeData_replaceDerCrefSES MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_replaceDerCrefSES)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx(threadData_t *threadData, modelica_metatype _simulationAlgVars, modelica_metatype _simcode_map);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx,2,0) {(void*) boxptr_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx,0}};
#define boxvar_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_createSparsityJacobian(threadData_t *threadData, modelica_metatype __omcQ_24in_5FdaeModeDataOpt, modelica_metatype __omcQ_24in_5FmodelInfo, modelica_metatype _systems, modelica_metatype __omcQ_24in_5Fsimcode_5Fmap, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype *out_modelInfo, modelica_metatype *out_jacobian, modelica_metatype *out_simcode_map, modelica_metatype *out_simCodeIndices);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_createSparsityJacobian,2,0) {(void*) boxptr_NSimCode_DaeModeData_createSparsityJacobian,0}};
#define boxvar_NSimCode_DaeModeData_createSparsityJacobian MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_createSparsityJacobian)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_convertMode(threadData_t *threadData, modelica_integer _mode);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NSimCode_DaeModeData_convertMode(threadData_t *threadData, modelica_metatype _mode);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_convertMode,2,0) {(void*) boxptr_NSimCode_DaeModeData_convertMode,0}};
#define boxvar_NSimCode_DaeModeData_convertMode MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_DaeModeData_convertMode)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_SimCode_collectAlgebraicLoops(threadData_t *threadData, modelica_metatype _init, modelica_metatype _init_0, modelica_metatype _ode, modelica_metatype _algebraic, modelica_metatype _daeModeData, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype _simcode_map, modelica_metatype *out_nonlinearLoops, modelica_metatype *out_jacobians, modelica_metatype *out_simCodeIndices);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NSimCode_SimCode_collectAlgebraicLoops,2,0) {(void*) boxptr_NSimCode_SimCode_collectAlgebraicLoops,0}};
#define boxvar_NSimCode_SimCode_collectAlgebraicLoops MMC_REFSTRUCTLIT(boxvar_lit_NSimCode_SimCode_collectAlgebraicLoops)

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_replaceDerCref(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_integer __omcQ_24in_5Fi, modelica_boolean *out_b, modelica_integer *out_i)
{
  modelica_metatype _exp = NULL;
  modelica_boolean _b;
  modelica_integer _i;
  modelica_boolean tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _exp = __omcQ_24in_5Fexp;
  // _b has no default value.
  _i = __omcQ_24in_5Fi;
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _exp;
    {
      modelica_metatype _cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,4) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          if (4 != MMC_STRLEN(tmpMeta7) || strcmp(MMC_STRINGDATA(_OMC_LIT6), MMC_STRINGDATA(tmpMeta7)) != 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 5));
          
          _cref = tmpMeta8;
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_box3(9, &DAE_Exp_CREF__desc, _cref, omc_ComponentReference_crefTypeFull(threadData, _cref));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta11 = mmc_mk_box4(16, &DAE_Exp_CALL__desc, _OMC_LIT1, tmpMeta9, _OMC_LIT5);
          tmpMeta[0+0] = tmpMeta11;
          tmp1_c1 = 0 /* false */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _exp;
          tmp1_c1 = 1 /* true */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta[0+0];
  _b = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_b) { *out_b = _b; }
  if (out_i) { *out_i = _i; }
  return _exp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NSimCode_DaeModeData_replaceDerCref(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype __omcQ_24in_5Fi, modelica_metatype *out_b, modelica_metatype *out_i)
{
  modelica_integer tmp1;
  modelica_boolean _b;
  modelica_integer _i;
  modelica_metatype _exp = NULL;
  tmp1 = mmc_unbox_integer(__omcQ_24in_5Fi);
  _exp = omc_NSimCode_DaeModeData_replaceDerCref(threadData, __omcQ_24in_5Fexp, tmp1, &_b, &_i);
  /* skip box _exp; DAE.Exp */
  if (out_b) { *out_b = mmc_mk_icon(_b); }
  if (out_i) { *out_i = mmc_mk_icon(_i); }
  return _exp;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_replaceDerCrefSES(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fsys)
{
  modelica_metatype _sys = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _sys = __omcQ_24in_5Fsys;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sys;
    {
      modelica_metatype _qual = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _qual has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          _qual = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_qual), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = omc_Expression_traverseExpTopDown(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_qual), 4))), boxvar_NSimCode_DaeModeData_replaceDerCref, mmc_mk_integer(((modelica_integer) 0)), NULL);
          _qual = tmpMeta6;
          tmpMeta1 = _qual;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          _qual = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_qual), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[4] = omc_Expression_traverseExpTopDown(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_qual), 4))), boxvar_NSimCode_DaeModeData_replaceDerCref, mmc_mk_integer(((modelica_integer) 0)), NULL);
          _qual = tmpMeta7;
          tmpMeta1 = _qual;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sys = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sys;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_rewriteAlgebraicVarsIdx(threadData_t *threadData, modelica_metatype _simulationAlgVars, modelica_metatype _simcode_map)
{
  modelica_metatype _daeModeAlgVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _seedCref = NULL;
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _daeModeAlgVars = tmpMeta1;
  // _seedCref has no default value.
  // _cref has no default value.
  tmpMeta2 = mmc_mk_box3(10, &NFInstNode_InstNode_VAR__NODE__desc, _OMC_LIT7, omc_Pointer_create(threadData, _OMC_LIT21));
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _seedCref = omc_NFComponentRef_fromNode(threadData, tmpMeta2, _OMC_LIT22, tmpMeta3, 1);

  {
    modelica_metatype _var;
    for (tmpMeta4 = listReverse(_simulationAlgVars); !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
    {
      _var = MMC_CAR(tmpMeta4);
      _cref = omc_NFComponentRef_append(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 2))), _seedCref);

      tmpMeta5 = stringAppend(_OMC_LIT23,omc_NFComponentRef_toString(threadData, _cref));
      tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT24);
      fputs(MMC_STRINGDATA(tmpMeta6),stdout);

      tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(31));
      memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_var), 31*sizeof(modelica_metatype));
      ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[7] = mmc_mk_integer(omc_NSimVar_SimVar_getIndex(threadData, _cref, _simcode_map));
      _var = tmpMeta7;

      tmpMeta8 = mmc_mk_cons(_var, _daeModeAlgVars);
      _daeModeAlgVars = tmpMeta8;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _daeModeAlgVars;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_createSparsityJacobian(threadData_t *threadData, modelica_metatype __omcQ_24in_5FdaeModeDataOpt, modelica_metatype __omcQ_24in_5FmodelInfo, modelica_metatype _systems, modelica_metatype __omcQ_24in_5Fsimcode_5Fmap, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype *out_modelInfo, modelica_metatype *out_jacobian, modelica_metatype *out_simcode_map, modelica_metatype *out_simCodeIndices)
{
  modelica_metatype _daeModeDataOpt = NULL;
  modelica_metatype _modelInfo = NULL;
  modelica_metatype _jacobian = NULL;
  modelica_metatype _simcode_map = NULL;
  modelica_metatype _simCodeIndices = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _daeModeDataOpt = __omcQ_24in_5FdaeModeDataOpt;
  _modelInfo = __omcQ_24in_5FmodelInfo;
  // _jacobian has no default value.
  _simcode_map = __omcQ_24in_5Fsimcode_5Fmap;
  _simCodeIndices = __omcQ_24in_5FsimCodeIndices;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _daeModeDataOpt;
    {
      modelica_metatype _daeModeData = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _daeModeData has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          _daeModeData = tmpMeta6;
          /* Pattern matching succeeded */
          _jacobian = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT25, _simCodeIndices ,&_simCodeIndices);
          tmpMeta1 = mmc_mk_some(_daeModeData);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT30, _OMC_LIT32);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _daeModeDataOpt = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_modelInfo) { *out_modelInfo = _modelInfo; }
  if (out_jacobian) { *out_jacobian = _jacobian; }
  if (out_simcode_map) { *out_simcode_map = _simcode_map; }
  if (out_simCodeIndices) { *out_simCodeIndices = _simCodeIndices; }
  return _daeModeDataOpt;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_DaeModeData_convertMode(threadData_t *threadData, modelica_integer _mode)
{
  modelica_metatype _oldMode = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldMode has no default value.
  { /* match expression */
    modelica_integer tmp4_1;
    tmp4_1 = (modelica_integer)_mode;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (1 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT33;
          goto tmp3_done;
        }
        case 1: {
          if (2 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT34;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _oldMode = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oldMode;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NSimCode_DaeModeData_convertMode(threadData_t *threadData, modelica_metatype _mode)
{
  modelica_integer tmp1;
  modelica_metatype _oldMode = NULL;
  tmp1 = mmc_unbox_integer(_mode);
  _oldMode = omc_NSimCode_DaeModeData_convertMode(threadData, tmp1);
  /* skip box _oldMode; SimCode.DaeModeConfig */
  return _oldMode;
}

DLLDirection
modelica_metatype omc_NSimCode_DaeModeData_convert(threadData_t *threadData, modelica_metatype _data)
{
  modelica_metatype _oldData = NULL;
  modelica_metatype _simEqSystems = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldData has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _simEqSystems = tmpMeta1;
  _simEqSystems = omc_NSimStrongComponent_Block_convertListList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 2))));

  tmpMeta2 = mmc_mk_box7(3, &SimCode_DaeModeData_DAEMODEDATA__desc, _simEqSystems, omc_Util_applyOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 3))), boxvar_NSimJacobian_SimJacobian_convert), omc_NSimVar_SimVar_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 4)))), omc_NSimVar_SimVar_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 5)))), omc_NSimVar_SimVar_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 6)))), omc_NSimCode_DaeModeData_convertMode(threadData, mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 7))))));
  _oldData = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _oldData;
}

DLLDirection
modelica_metatype omc_NSimCode_DaeModeData_addJacobian(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fdata, modelica_metatype _daeModeJac)
{
  modelica_metatype _data = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _data = __omcQ_24in_5Fdata;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _data;
    {
      modelica_metatype _dmd = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _dmd has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          _dmd = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_dmd), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[3] = mmc_mk_some(_daeModeJac);
          _dmd = tmpMeta7;
          tmpMeta1 = mmc_mk_some(_dmd);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = mmc_mk_none();
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _data = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _data;
}

DLLDirection
modelica_metatype omc_NSimCode_DaeModeData_create(threadData_t *threadData, modelica_metatype _systems, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype _simcode_map, modelica_metatype _equation_map, modelica_metatype *out_simCodeIndices)
{
  modelica_metatype _data = NULL;
  modelica_metatype _simCodeIndices = NULL;
  modelica_metatype _blcks = NULL;
  modelica_metatype _residualVars = NULL;
  modelica_metatype _algebraicVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _data has no default value.
  _simCodeIndices = __omcQ_24in_5FsimCodeIndices;
  // _blcks has no default value.
  // _residualVars has no default value.
  // _algebraicVars has no default value.
  _blcks = omc_NSimStrongComponent_Block_createDAEModeBlocks(threadData, _systems, _simCodeIndices, _simcode_map, _equation_map ,&_residualVars ,&_simCodeIndices);

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta3 = mmc_mk_box7(3, &NSimCode_DaeModeData_DAE__MODE__DATA__desc, _blcks, mmc_mk_none(), _residualVars, tmpMeta1, tmpMeta2, mmc_mk_integer(1));
  _data = mmc_mk_some(tmpMeta3);
  _return: OMC_LABEL_UNUSED
  if (out_simCodeIndices) { *out_simCodeIndices = _simCodeIndices; }
  return _data;
}

DLLDirection
modelica_string omc_NSimCode_DaeModeData_toString(threadData_t *threadData, modelica_metatype _data)
{
  modelica_string _str = NULL;
  modelica_integer _idx;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = _OMC_LIT14;
  _idx = ((modelica_integer) 1);
  {
    modelica_metatype _blck_lst;
    for (tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 2))); !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _blck_lst = MMC_CAR(tmpMeta1);
      tmpMeta2 = stringAppend(_OMC_LIT36,intString(_idx));
      tmpMeta3 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, _blck_lst, _OMC_LIT35, tmpMeta2));
      _str = tmpMeta3;

      _idx = ((modelica_integer) 1) + _idx;
    }
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 3)))))
  {
    tmpMeta5 = stringAppend(_str,_OMC_LIT24);
    tmpMeta6 = stringAppend(tmpMeta5,omc_NSimJacobian_SimJacobian_toString(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_data), 3))))));
    _str = tmpMeta6;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NSimCode_ModelInfo_convert(threadData_t *threadData, modelica_metatype _modelInfo)
{
  modelica_metatype _oldModelInfo = NULL;
  modelica_metatype _varInfo = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldModelInfo has no default value.
  // _varInfo has no default value.
  _varInfo = omc_NSimVar_VarInfo_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 11))));

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = mmc_mk_box(22, 3, &SimCode_ModelInfo_MODELINFO__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 6))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 7))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 8))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 9))), omc_NSimVar_VarInfo_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 11)))), omc_NSimVar_SimVars_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 10)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 12))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 13))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 14))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 15))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 16))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 17))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 18))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 19))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 20)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 21)))), tmpMeta1);
  _oldModelInfo = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _oldModelInfo;
}

DLLDirection
modelica_metatype omc_NSimCode_ModelInfo_setSeedVars(threadData_t *threadData, modelica_metatype __omcQ_24in_5FmodelInfo, modelica_metatype _seedVars)
{
  modelica_metatype _modelInfo = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _modelInfo = __omcQ_24in_5FmodelInfo;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _modelInfo;
    {
      modelica_metatype _vars = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _vars has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,20) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 10));
          
          _vars = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(37));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_vars), 37*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[30] = _seedVars;
          _vars = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(22));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_modelInfo), 22*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[10] = _vars;
          _modelInfo = tmpMeta8;
          tmpMeta1 = _modelInfo;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT30, _OMC_LIT38);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _modelInfo = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _modelInfo;
}

DLLDirection
modelica_metatype omc_NSimCode_ModelInfo_create(threadData_t *threadData, modelica_metatype _vars, modelica_metatype _name, modelica_string _directory, modelica_metatype _functions, modelica_metatype _linearLoops, modelica_metatype _nonlinearLoops, modelica_metatype _eventInfo, modelica_metatype _clockedInfo, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype *out_simCodeIndices)
{
  modelica_metatype _modelInfo = NULL;
  modelica_metatype _simCodeIndices = NULL;
  modelica_metatype _info = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _modelInfo has no default value.
  _simCodeIndices = __omcQ_24in_5FsimCodeIndices;
  // _info has no default value.
  _info = omc_NSimVar_VarInfo_create(threadData, _vars, _eventInfo, _simCodeIndices);

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta4 = mmc_mk_box(21, 3, &NSimCode_ModelInfo_MODEL__INFO__desc, _name, _OMC_LIT14, _OMC_LIT14, _OMC_LIT14, _OMC_LIT14, _OMC_LIT14, _directory, _OMC_LIT14, _vars, _info, _functions, tmpMeta1, tmpMeta2, tmpMeta3, mmc_mk_integer(omc_UnorderedMap_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_clockedInfo), 2))))), mmc_mk_integer(omc_UnorderedMap_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_clockedInfo), 3))))), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_boolean(1 /* true */), _linearLoops, _nonlinearLoops);
  _modelInfo = tmpMeta4;
  _return: OMC_LABEL_UNUSED
  if (out_simCodeIndices) { *out_simCodeIndices = _simCodeIndices; }
  return _modelInfo;
}

DLLDirection
modelica_string omc_NSimCode_ModelInfo_toString(threadData_t *threadData, modelica_metatype _modelInfo)
{
  modelica_string _str = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  _str = omc_NSimVar_SimVars_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_modelInfo), 10))), _OMC_LIT14);
  _return: OMC_LABEL_UNUSED
  return _str;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NSimCode_SimCode_collectAlgebraicLoops(threadData_t *threadData, modelica_metatype _init, modelica_metatype _init_0, modelica_metatype _ode, modelica_metatype _algebraic, modelica_metatype _daeModeData, modelica_metatype __omcQ_24in_5FsimCodeIndices, modelica_metatype _simcode_map, modelica_metatype *out_nonlinearLoops, modelica_metatype *out_jacobians, modelica_metatype *out_simCodeIndices)
{
  modelica_metatype _linearLoops = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _nonlinearLoops = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _jacobians = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype _simCodeIndices = NULL;
  modelica_metatype _dae_mode_blcks = NULL;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _linearLoops = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _nonlinearLoops = tmpMeta2;
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _jacobians = tmpMeta3;
  _simCodeIndices = __omcQ_24in_5FsimCodeIndices;
  // _dae_mode_blcks has no default value.
  tmpMeta4 = mmc_mk_cons(_init, mmc_mk_cons(_init_0, MMC_REFSTRUCTLIT(mmc_nil)));
  _linearLoops = omc_NSimStrongComponent_Block_collectAlgebraicLoops(threadData, tmpMeta4, _linearLoops, _nonlinearLoops, _jacobians, _simCodeIndices, _simcode_map ,&_nonlinearLoops ,&_jacobians ,&_simCodeIndices);

  _linearLoops = omc_NSimStrongComponent_Block_collectAlgebraicLoops(threadData, _ode, _linearLoops, _nonlinearLoops, _jacobians, _simCodeIndices, _simcode_map ,&_nonlinearLoops ,&_jacobians ,&_simCodeIndices);

  _linearLoops = omc_NSimStrongComponent_Block_collectAlgebraicLoops(threadData, _algebraic, _linearLoops, _nonlinearLoops, _jacobians, _simCodeIndices, _simcode_map ,&_nonlinearLoops ,&_jacobians ,&_simCodeIndices);

  if(isSome(_daeModeData))
  {
    /* Pattern-matching assignment */
    tmpMeta5 = _daeModeData;
    if (optionNone(tmpMeta5)) MMC_THROW_INTERNAL();
    tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 1));
    if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,6) == 0) MMC_THROW_INTERNAL();
    tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
    _dae_mode_blcks = tmpMeta7;

    _linearLoops = omc_NSimStrongComponent_Block_collectAlgebraicLoops(threadData, _dae_mode_blcks, _linearLoops, _nonlinearLoops, _jacobians, _simCodeIndices, _simcode_map ,&_nonlinearLoops ,&_jacobians ,&_simCodeIndices);
  }
  _return: OMC_LABEL_UNUSED
  if (out_nonlinearLoops) { *out_nonlinearLoops = _nonlinearLoops; }
  if (out_jacobians) { *out_jacobians = _jacobians; }
  if (out_simCodeIndices) { *out_simCodeIndices = _simCodeIndices; }
  return _linearLoops;
}

DLLDirection
modelica_string omc_NSimCode_SimCode_getDirectoryAndLibs(threadData_t *threadData, modelica_metatype _simCode, modelica_metatype *out_libs)
{
  modelica_string _directory = NULL;
  modelica_metatype _libs = NULL;
  modelica_string tmp1_c0 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _directory has no default value.
  // _libs has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _simCode;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,33) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,20) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 8));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 26));
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 12));
          
          _directory = tmpMeta7;
          _libs = tmpMeta9;
          /* Pattern matching succeeded */
          tmp1_c0 = _directory;
          tmpMeta[0+1] = _libs;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT30, _OMC_LIT40);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _directory = tmp1_c0;
  _libs = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_libs) { *out_libs = _libs; }
  return _directory;
}

DLLDirection
modelica_metatype omc_NSimCode_SimCode_convert(threadData_t *threadData, modelica_metatype _simCode)
{
  modelica_metatype _oldSimCode = NULL;
  modelica_metatype _modelInfo = NULL;
  modelica_metatype _discreteModelVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _zeroCrossings = NULL;
  modelica_metatype _relations = NULL;
  modelica_metatype _timeEvents = NULL;
  modelica_metatype _varToArrayIndexMapping = NULL;
  modelica_metatype _varToIndexMapping = NULL;
  modelica_metatype _crefToSimVarHT = NULL;
  modelica_metatype _crefToClockIndexHT = NULL;
  modelica_metatype _residualVars = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldSimCode has no default value.
  // _modelInfo has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _discreteModelVars = tmpMeta1;
  // _zeroCrossings has no default value.
  // _relations has no default value.
  // _timeEvents has no default value.
  // _varToArrayIndexMapping has no default value.
  // _varToIndexMapping has no default value.
  // _crefToSimVarHT has no default value.
  // _crefToClockIndexHT has no default value.
  // _residualVars has no default value.
  _modelInfo = omc_NSimCode_ModelInfo_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 2))));

  _zeroCrossings = omc_NBEvents_EventInfo_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 32))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 31))) ,&_relations ,&_timeEvents);

  _varToArrayIndexMapping = omc_SimCodeUtil_createVarToArrayIndexMapping(threadData, _modelInfo ,&_varToIndexMapping);

  _crefToSimVarHT = omc_NSimCodeUtil_convertSimCodeMap(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 30))));

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33)))))
  {
    /* Pattern-matching assignment */
    tmpMeta2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33)));
    if (optionNone(tmpMeta2)) MMC_THROW_INTERNAL();
    tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 1));
    if (mmc__uniontype__metarecord__typedef__equal(tmpMeta3,0,6) == 0) MMC_THROW_INTERNAL();
    tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 4));
    _residualVars = tmpMeta4;

    _crefToSimVarHT = omc_List_fold(threadData, omc_NSimVar_SimVar_convertList(threadData, _residualVars), boxvar_HashTableCrefSimVar_addSimVarToHashTable, _crefToSimVarHT);
  }

  _crefToClockIndexHT = omc_HashTable_emptyHashTable(threadData);

  {
    modelica_metatype _cref;
    for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 24))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
    {
      _cref = MMC_CAR(tmpMeta5);
      tmpMeta6 = mmc_mk_cons(omc_NFComponentRef_toDAE(threadData, _cref), _discreteModelVars);
      _discreteModelVars = tmpMeta6;
    }
  }

  {
    modelica_metatype __omcQ_24tmpVar1;
    modelica_metatype* tmp9;
    modelica_metatype tmpMeta10;
    modelica_metatype __omcQ_24tmpVar0;
    modelica_integer tmp11;
    modelica_metatype _lit_loopVar = 0;
    modelica_metatype _lit;
    _lit_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 3)));
    tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar1 = tmpMeta10; /* defaultValue */
    tmp9 = &__omcQ_24tmpVar1;
    while(1) {
      tmp11 = 1;
      if (!listEmpty(_lit_loopVar)) {
        _lit = MMC_CAR(_lit_loopVar);
        _lit_loopVar = MMC_CDR(_lit_loopVar);
        tmp11--;
      }
      if (tmp11 == 0) {
        __omcQ_24tmpVar0 = omc_NFExpression_toDAE(threadData, _lit);
        *tmp9 = mmc_mk_cons(__omcQ_24tmpVar0,0);
        tmp9 = &MMC_CDR(*tmp9);
      } else if (tmp11 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp9 = mmc_mk_nil();
    tmpMeta8 = __omcQ_24tmpVar1;
  }
  {
    modelica_metatype __omcQ_24tmpVar3;
    modelica_metatype* tmp13;
    modelica_metatype tmpMeta14;
    modelica_metatype __omcQ_24tmpVar2;
    modelica_integer tmp15;
    modelica_metatype _gc_loopVar = 0;
    modelica_metatype _gc;
    _gc_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 6)));
    tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar3 = tmpMeta14; /* defaultValue */
    tmp13 = &__omcQ_24tmpVar3;
    while(1) {
      tmp15 = 1;
      if (!listEmpty(_gc_loopVar)) {
        _gc = MMC_CAR(_gc_loopVar);
        _gc_loopVar = MMC_CDR(_gc_loopVar);
        tmp15--;
      }
      if (tmp15 == 0) {
        __omcQ_24tmpVar2 = omc_NSimGenericCall_convert(threadData, _gc);
        *tmp13 = mmc_mk_cons(__omcQ_24tmpVar2,0);
        tmp13 = &MMC_CDR(*tmp13);
      } else if (tmp15 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp13 = mmc_mk_nil();
    tmpMeta12 = __omcQ_24tmpVar3;
  }
  {
    modelica_metatype __omcQ_24tmpVar5;
    modelica_metatype* tmp17;
    modelica_metatype tmpMeta18;
    modelica_metatype __omcQ_24tmpVar4;
    modelica_integer tmp19;
    modelica_metatype _part_loopVar = 0;
    modelica_metatype _part;
    _part_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 11)));
    tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar5 = tmpMeta18; /* defaultValue */
    tmp17 = &__omcQ_24tmpVar5;
    while(1) {
      tmp19 = 1;
      if (!listEmpty(_part_loopVar)) {
        _part = MMC_CAR(_part_loopVar);
        _part_loopVar = MMC_CDR(_part_loopVar);
        tmp19--;
      }
      if (tmp19 == 0) {
        __omcQ_24tmpVar4 = omc_NSimPartition_convertBase(threadData, _part);
        *tmp17 = mmc_mk_cons(__omcQ_24tmpVar4,0);
        tmp17 = &MMC_CDR(*tmp17);
      } else if (tmp19 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp17 = mmc_mk_nil();
    tmpMeta16 = __omcQ_24tmpVar5;
  }
  tmpMeta20 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta21 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
  {
    modelica_metatype __omcQ_24tmpVar7;
    modelica_metatype* tmp24;
    modelica_metatype tmpMeta25;
    modelica_metatype __omcQ_24tmpVar6;
    modelica_integer tmp26;
    modelica_metatype _jac_loopVar = 0;
    modelica_metatype _jac;
    _jac_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 27)));
    tmpMeta25 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar7 = tmpMeta25; /* defaultValue */
    tmp24 = &__omcQ_24tmpVar7;
    while(1) {
      tmp26 = 1;
      if (!listEmpty(_jac_loopVar)) {
        _jac = MMC_CAR(_jac_loopVar);
        _jac_loopVar = MMC_CDR(_jac_loopVar);
        tmp26--;
      }
      if (tmp26 == 0) {
        __omcQ_24tmpVar6 = omc_NSimJacobian_SimJacobian_convert(threadData, _jac);
        *tmp24 = mmc_mk_cons(__omcQ_24tmpVar6,0);
        tmp24 = &MMC_CDR(*tmp24);
      } else if (tmp26 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp24 = mmc_mk_nil();
    tmpMeta23 = __omcQ_24tmpVar7;
  }
  tmpMeta27 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta28 = mmc_mk_box(52, 3, &SimCode_SimCode_SIMCODE__desc, _modelInfo, tmpMeta8, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 5))), tmpMeta12, omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 7)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 8)))), omc_NSimStrongComponent_Block_convertListList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 9)))), omc_NSimStrongComponent_Block_convertListList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 10)))), tmpMeta16, omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 21)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 22)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 23)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 20)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 12)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 13)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 14)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 15)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 16)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 17)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 18)))), omc_NSimStrongComponent_Block_convertList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 19)))), tmpMeta20, tmpMeta21, tmpMeta22, _zeroCrossings, _relations, _timeEvents, _discreteModelVars, omc_NSimVar_ExtObjInfo_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 25)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 26))), _OMC_LIT41, _OMC_LIT42, tmpMeta23, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 28))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 29))), _OMC_LIT14, _OMC_LIT14, _OMC_LIT43, _OMC_LIT44, _varToArrayIndexMapping, _varToIndexMapping, _crefToSimVarHT, _crefToClockIndexHT, mmc_mk_none(), mmc_mk_none(), mmc_mk_none(), _OMC_LIT45, (isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33))))?mmc_mk_some(omc_NSimCode_DaeModeData_convert(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33)))))):mmc_mk_none()), tmpMeta27, mmc_mk_none());
  _oldSimCode = tmpMeta28;
  _return: OMC_LABEL_UNUSED
  return _oldSimCode;
}

static modelica_metatype closure1_NFExpression_replaceLiteral(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype map = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype idx_ptr = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  return boxptr_NFExpression_replaceLiteral(thData, $in_exp, map, idx_ptr);
}static modelica_metatype closure0_NFExpression_fakeMap(threadData_t *thData, modelica_metatype closure, modelica_metatype exp)
{
  modelica_fnptr func = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NFExpression_fakeMap(thData, exp, func);
}
DLLDirection
modelica_metatype omc_NSimCode_SimCode_create(threadData_t *threadData, modelica_metatype _bdae, modelica_metatype _name, modelica_string _fileNamePrefix, modelica_metatype _simSettingsOpt)
{
  modelica_metatype _simCode = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _simCode has no default value.
  { /* match expression */
    modelica_metatype tmp6_1;
    tmp6_1 = _bdae;
    {
      modelica_metatype _varData = NULL;
      modelica_metatype _eqData = NULL;
      modelica_metatype _funcTree = NULL;
      modelica_metatype _residual_vars = NULL;
      modelica_metatype _vars = NULL;
      modelica_metatype _program = NULL;
      modelica_metatype _libs = NULL;
      modelica_metatype _includeDirs = NULL;
      modelica_metatype _libPaths = NULL;
      modelica_string _directory = NULL;
      modelica_metatype _makefileParams = NULL;
      modelica_metatype _functions = NULL;
      modelica_metatype _recordDecls = NULL;
      modelica_metatype _modelInfo = NULL;
      modelica_metatype _simCodeIndices = NULL;
      modelica_metatype _literals_map = NULL;
      modelica_metatype _clockedPartitions = NULL;
      modelica_metatype _literals_idx = NULL;
      modelica_metatype _literals = NULL;
      modelica_metatype _externalFunctionIncludes = NULL;
      modelica_metatype _generic_loop_calls = NULL;
      modelica_metatype _independent = NULL;
      modelica_metatype _allSim = NULL;
      modelica_metatype tmpMeta3;
      modelica_metatype _nominal = NULL;
      modelica_metatype _min = NULL;
      modelica_metatype _max = NULL;
      modelica_metatype _param = NULL;
      modelica_metatype _no_ret = NULL;
      modelica_metatype _event_clocks = NULL;
      modelica_metatype _algorithms = NULL;
      modelica_metatype _event_blocks = NULL;
      modelica_metatype tmpMeta4;
      modelica_metatype _jac_blocks = NULL;
      modelica_metatype _init = NULL;
      modelica_metatype _init_0 = NULL;
      modelica_metatype _init_no_ret = NULL;
      modelica_metatype _start = NULL;
      modelica_metatype _ode = NULL;
      modelica_metatype _algebraic = NULL;
      modelica_metatype _linearLoops = NULL;
      modelica_metatype _nonlinearLoops = NULL;
      modelica_metatype _discreteVars = NULL;
      modelica_metatype _extObjInfo = NULL;
      modelica_metatype _jacobians = NULL;
      modelica_metatype _simcode_map = NULL;
      modelica_metatype _equation_map = NULL;
      modelica_metatype _daeModeData = NULL;
      modelica_metatype _jacA = NULL;
      modelica_metatype _jacB = NULL;
      modelica_metatype _jacC = NULL;
      modelica_metatype _jacD = NULL;
      modelica_metatype _jacF = NULL;
      modelica_metatype _jacH = NULL;
      modelica_metatype _inlineEquations = NULL;
      modelica_fnptr _collect_literals;
      volatile mmc_switch_type tmp6;
      int tmp7;
      // _varData has no default value.
      // _eqData has no default value.
      // _funcTree has no default value.
      // _residual_vars has no default value.
      // _vars has no default value.
      // _program has no default value.
      // _libs has no default value.
      // _includeDirs has no default value.
      // _libPaths has no default value.
      // _directory has no default value.
      // _makefileParams has no default value.
      // _functions has no default value.
      // _recordDecls has no default value.
      // _modelInfo has no default value.
      // _simCodeIndices has no default value.
      _literals_map = omc_UnorderedMap_new(threadData, boxvar_NFExpression_hash, boxvar_NFExpression_isEqual, ((modelica_integer) 1));
      // _clockedPartitions has no default value.
      _literals_idx = omc_Pointer_create(threadData, mmc_mk_integer(((modelica_integer) 0)));
      // _literals has no default value.
      // _externalFunctionIncludes has no default value.
      // _generic_loop_calls has no default value.
      // _independent has no default value.
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      _allSim = tmpMeta3;
      // _nominal has no default value.
      // _min has no default value.
      // _max has no default value.
      // _param has no default value.
      // _no_ret has no default value.
      // _event_clocks has no default value.
      // _algorithms has no default value.
      tmpMeta4 = MMC_REFSTRUCTLIT(mmc_nil);
      _event_blocks = tmpMeta4;
      // _jac_blocks has no default value.
      // _init has no default value.
      // _init_0 has no default value.
      // _init_no_ret has no default value.
      // _start has no default value.
      // _ode has no default value.
      // _algebraic has no default value.
      // _linearLoops has no default value.
      // _nonlinearLoops has no default value.
      // _discreteVars has no default value.
      // _extObjInfo has no default value.
      // _jacobians has no default value.
      // _simcode_map has no default value.
      // _equation_map has no default value.
      // _daeModeData has no default value.
      // _jacA has no default value.
      // _jacB has no default value.
      // _jacC has no default value.
      // _jacD has no default value.
      // _jacF has no default value.
      // _jacH has no default value.
      // _inlineEquations has no default value.
      tmp6 = 0;
      for (; tmp6 < 2; tmp6++) {
        switch (MMC_SWITCH_CAST(tmp6)) {
        case 0: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_boolean tmp27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          modelica_metatype tmpMeta45;
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta53;
          if (mmc__uniontype__metarecord__typedef__equal(tmp6_1,0,13) == 0) goto tmp5_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp6_1), 10));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,0,23) == 0) goto tmp5_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp6_1), 11));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,0,9) == 0) goto tmp5_end;
          
          _varData = tmpMeta8;
          _eqData = tmpMeta9;
          /* Pattern matching succeeded */
          _simCodeIndices = omc_NSimCode_EMPTY__SIM__CODE__INDICES(threadData);

          _funcTree = omc_NBackendDAE_getFunctionTree(threadData, _bdae);

          tmpMeta11 = mmc_mk_box2(0, _literals_map, _literals_idx);
          tmpMeta10 = mmc_mk_box1(0, (modelica_fnptr) mmc_mk_box2(0,closure1_NFExpression_replaceLiteral,tmpMeta11));
          _collect_literals = (modelica_fnptr) (modelica_fnptr) mmc_mk_box2(0,closure0_NFExpression_fakeMap,tmpMeta10);

          _funcTree = omc_NFFlatten_FunctionTreeImpl_mapExp(threadData, _funcTree, ((modelica_fnptr) _collect_literals));

          _residual_vars = omc_NBackendDAE_getLoopResiduals(threadData, _bdae);

          _vars = omc_NSimVar_SimVars_create(threadData, _varData, _residual_vars, _simCodeIndices ,&_simCodeIndices);

          _extObjInfo = omc_NSimVar_ExtObjInfo_create(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_varData), 22))), _vars, _simCodeIndices ,&_vars ,&_simCodeIndices);

          _simcode_map = omc_NSimCodeUtil_createSimCodeMap(threadData, _vars, _extObjInfo);

          _equation_map = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));

          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          _externalFunctionIncludes = tmpMeta12;

          tmpMeta13 = MMC_REFSTRUCTLIT(mmc_nil);
          _independent = tmpMeta13;

          tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
          _nominal = tmpMeta14;

          tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
          _min = tmpMeta15;

          tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
          _max = tmpMeta16;

          tmpMeta17 = MMC_REFSTRUCTLIT(mmc_nil);
          _param = tmpMeta17;

          tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
          _algorithms = tmpMeta18;

          _init = omc_NSimStrongComponent_Block_createInitialBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 7))), _simCodeIndices, _simcode_map, _equation_map ,&_simCodeIndices);

          if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 8)))))
          {
            _init_0 = omc_NSimStrongComponent_Block_createInitialBlocks(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 8)))), _simCodeIndices, _simcode_map, _equation_map ,&_simCodeIndices);
          }
          else
          {
            tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
            _init_0 = tmpMeta19;
          }

          _clockedPartitions = omc_NSimStrongComponent_Block_createClockedBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 6))), _simCodeIndices, _simcode_map, _equation_map, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 13))) ,&_event_clocks ,&_simCodeIndices);

          _no_ret = omc_NSimStrongComponent_Block_createNoReturnBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))), _simCodeIndices, 1, _simcode_map, _equation_map ,&_simCodeIndices);

          tmpMeta20 = MMC_REFSTRUCTLIT(mmc_nil);
          _init_no_ret = tmpMeta20;

          tmpMeta21 = MMC_REFSTRUCTLIT(mmc_nil);
          _start = tmpMeta21;

          tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
          _discreteVars = tmpMeta22;

          tmpMeta23 = MMC_REFSTRUCTLIT(mmc_nil);
          _jacobians = tmpMeta23;

          if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 9)))))
          {
            tmpMeta24 = MMC_REFSTRUCTLIT(mmc_nil);
            _ode = tmpMeta24;

            tmp27 = (modelica_boolean)listEmpty(_no_ret);
            if(tmp27)
            {
              tmpMeta25 = MMC_REFSTRUCTLIT(mmc_nil);
              tmpMeta28 = tmpMeta25;
            }
            else
            {
              tmpMeta26 = mmc_mk_cons(_no_ret, MMC_REFSTRUCTLIT(mmc_nil));
              tmpMeta28 = tmpMeta26;
            }
            _algebraic = tmpMeta28;

            _no_ret = listAppend(_event_clocks, _no_ret);

            if((!listEmpty(_no_ret)))
            {
              _allSim = listReverse(listAppend(_no_ret, listReverse(_allSim)));
            }

            _daeModeData = omc_NSimCode_DaeModeData_create(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 9)))), _simCodeIndices, _simcode_map, _equation_map ,&_simCodeIndices);
          }
          else
          {
            _daeModeData = mmc_mk_none();

            _ode = omc_NSimStrongComponent_Block_createBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 2))), _allSim, _simCodeIndices, _simcode_map, _equation_map ,&_allSim ,&_simCodeIndices);

            _algebraic = omc_NSimStrongComponent_Block_createBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 3))), _allSim, _simCodeIndices, _simcode_map, _equation_map ,&_allSim ,&_simCodeIndices);

            _ode = omc_NSimStrongComponent_Block_createDiscreteBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 4))), _ode, _allSim, _event_blocks, _simCodeIndices, _simcode_map, _equation_map ,&_allSim ,&_event_blocks ,&_simCodeIndices);

            _algebraic = omc_NSimStrongComponent_Block_createDiscreteBlocks(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 5))), _algebraic, _allSim, _event_blocks, _simCodeIndices, _simcode_map, _equation_map ,&_allSim ,&_event_blocks ,&_simCodeIndices);

            if((!listEmpty(_no_ret)))
            {
              tmpMeta29 = mmc_mk_cons(_no_ret, listReverse(_algebraic));
              _algebraic = listReverse(tmpMeta29);
            }

            _no_ret = listAppend(_event_clocks, _no_ret);

            if((!listEmpty(_no_ret)))
            {
              _allSim = listReverse(listAppend(_no_ret, listReverse(_allSim)));
            }
          }

          {
            modelica_metatype __omcQ_24tmpVar9;
            modelica_metatype* tmp31;
            modelica_metatype tmpMeta32;
            modelica_metatype __omcQ_24tmpVar8;
            modelica_integer tmp33;
            modelica_metatype _blck_loopVar = 0;
            modelica_metatype _blck;
            _blck_loopVar = _allSim;
            tmpMeta32 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar9 = tmpMeta32; /* defaultValue */
            tmp31 = &__omcQ_24tmpVar9;
            while(1) {
              tmp33 = 1;
              if (!listEmpty(_blck_loopVar)) {
                _blck = MMC_CAR(_blck_loopVar);
                _blck_loopVar = MMC_CDR(_blck_loopVar);
                tmp33--;
              }
              if (tmp33 == 0) {
                __omcQ_24tmpVar8 = omc_NSimStrongComponent_Block_collectEntwinedEquations(threadData, _blck);
                *tmp31 = mmc_mk_cons(__omcQ_24tmpVar8,0);
                tmp31 = &MMC_CDR(*tmp31);
              } else if (tmp33 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp31 = mmc_mk_nil();
            tmpMeta30 = __omcQ_24tmpVar9;
          }
          _allSim = listAppend(omc_List_flatten(threadData, tmpMeta30), _allSim);

          tmpMeta34 = MMC_REFSTRUCTLIT(mmc_nil);
          _inlineEquations = tmpMeta34;

          _program = omc_SymbolTable_getAbsyn(threadData);

          _directory = omc_CevalScriptBackend_getFileDir(threadData, omc_AbsynUtil_pathToCref(threadData, _name), _program);

          _libs = omc_SimCodeUtil_createFunctions(threadData, _program, omc_NFConvertDAE_convertFunctionTree(threadData, _funcTree) ,&_libPaths ,NULL ,&_includeDirs ,&_recordDecls ,&_functions ,NULL);

          _makefileParams = omc_SimCodeFunctionUtil_createMakefileParams(threadData, _includeDirs, _libs, _libPaths, 0 /* false */, 0 /* false */);

          _linearLoops = omc_NSimCode_SimCode_collectAlgebraicLoops(threadData, _init, _init_0, _ode, _algebraic, _daeModeData, _simCodeIndices, _simcode_map ,&_nonlinearLoops ,&_jacobians ,&_simCodeIndices);

          if(isSome(_daeModeData))
          {
            _jacA = omc_NSimJacobian_SimJacobian_createSimulationJacobian(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 9)))), _simCodeIndices, _simcode_map ,&_simCodeIndices);

            _daeModeData = omc_NSimCode_DaeModeData_addJacobian(threadData, _daeModeData, _jacA);
          }
          else
          {
            _jacA = omc_NSimJacobian_SimJacobian_createSimulationJacobian(threadData, listAppend((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 4)))), _simCodeIndices, _simcode_map ,&_simCodeIndices);
          }

          _jacB = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT46, _simCodeIndices ,&_simCodeIndices);

          _jacC = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT47, _simCodeIndices ,&_simCodeIndices);

          _jacD = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT48, _simCodeIndices ,&_simCodeIndices);

          _jacF = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT49, _simCodeIndices ,&_simCodeIndices);

          _jacH = omc_NSimJacobian_SimJacobian_empty(threadData, _OMC_LIT50, _simCodeIndices ,&_simCodeIndices);

          tmpMeta40 = mmc_mk_cons(_jacA, _jacobians);
          tmpMeta39 = mmc_mk_cons(_jacB, tmpMeta40);
          tmpMeta38 = mmc_mk_cons(_jacC, tmpMeta39);
          tmpMeta37 = mmc_mk_cons(_jacD, tmpMeta38);
          tmpMeta36 = mmc_mk_cons(_jacF, tmpMeta37);
          tmpMeta35 = mmc_mk_cons(_jacH, tmpMeta36);
          _jacobians = listReverse(tmpMeta35);

          {
            modelica_metatype _jac;
            for (tmpMeta41 = _jacobians; !listEmpty(tmpMeta41); tmpMeta41=MMC_CDR(tmpMeta41))
            {
              _jac = MMC_CAR(tmpMeta41);
              if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_jac), 15)))))
              {
                _vars = omc_NSimVar_SimVars_addSeedAndJacobianVars(threadData, _vars, omc_UnorderedMap_toList(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_jac), 15))))));
              }
            }
          }

          tmpMeta43 = mmc_mk_cons(_jacA, mmc_mk_cons(_jacB, mmc_mk_cons(_jacC, mmc_mk_cons(_jacD, mmc_mk_cons(_jacF, mmc_mk_cons(_jacH, MMC_REFSTRUCTLIT(mmc_nil)))))));
          _jac_blocks = omc_NSimJacobian_SimJacobian_getJacobiansBlocks(threadData, tmpMeta43);

          tmpMeta44 = MMC_REFSTRUCTLIT(mmc_nil);
          _jac_blocks = omc_NSimStrongComponent_Block_fixIndices(threadData, _jac_blocks, tmpMeta44, _simCodeIndices ,&_simCodeIndices);

          {
            modelica_metatype __omcQ_24tmpVar11;
            modelica_metatype* tmp46;
            modelica_metatype tmpMeta47;
            modelica_metatype __omcQ_24tmpVar10;
            modelica_integer tmp48;
            modelica_metatype _tpl_loopVar = 0;
            modelica_metatype _tpl;
            _tpl_loopVar = omc_UnorderedMap_toList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCodeIndices), 26))));
            tmpMeta47 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar11 = tmpMeta47; /* defaultValue */
            tmp46 = &__omcQ_24tmpVar11;
            while(1) {
              tmp48 = 1;
              if (!listEmpty(_tpl_loopVar)) {
                _tpl = MMC_CAR(_tpl_loopVar);
                _tpl_loopVar = MMC_CDR(_tpl_loopVar);
                tmp48--;
              }
              if (tmp48 == 0) {
                __omcQ_24tmpVar10 = omc_NSimGenericCall_fromIdentifier(threadData, _tpl);
                *tmp46 = mmc_mk_cons(__omcQ_24tmpVar10,0);
                tmp46 = &MMC_CDR(*tmp46);
              } else if (tmp48 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp46 = mmc_mk_nil();
            tmpMeta45 = __omcQ_24tmpVar11;
          }
          _generic_loop_calls = tmpMeta45;

          {
            modelica_metatype __omcQ_24tmpVar13;
            modelica_metatype* tmp50;
            modelica_metatype tmpMeta51;
            modelica_metatype __omcQ_24tmpVar12;
            modelica_integer tmp52;
            modelica_metatype _call_loopVar = 0;
            modelica_metatype _call;
            _call_loopVar = _generic_loop_calls;
            tmpMeta51 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar13 = tmpMeta51; /* defaultValue */
            tmp50 = &__omcQ_24tmpVar13;
            while(1) {
              tmp52 = 1;
              if (!listEmpty(_call_loopVar)) {
                _call = MMC_CAR(_call_loopVar);
                _call_loopVar = MMC_CDR(_call_loopVar);
                tmp52--;
              }
              if (tmp52 == 0) {
                __omcQ_24tmpVar12 = omc_NSimGenericCall_mapShallow(threadData, _call, ((modelica_fnptr) _collect_literals));
                *tmp50 = mmc_mk_cons(__omcQ_24tmpVar12,0);
                tmp50 = &MMC_CDR(*tmp50);
              } else if (tmp52 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp50 = mmc_mk_nil();
            tmpMeta49 = __omcQ_24tmpVar13;
          }
          _generic_loop_calls = tmpMeta49;

          _literals = omc_UnorderedMap_keyList(threadData, _literals_map);

          _modelInfo = omc_NSimCode_ModelInfo_create(threadData, _vars, _name, _directory, _functions, _linearLoops, _nonlinearLoops, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 12))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 13))), _simCodeIndices ,&_simCodeIndices);
          tmpMeta53 = mmc_mk_box(34, 3, &NSimCode_SimCode_SIM__CODE__desc, _modelInfo, _literals, _recordDecls, _externalFunctionIncludes, _generic_loop_calls, _independent, _allSim, _ode, _algebraic, _clockedPartitions, _nominal, _min, _max, _param, _no_ret, _algorithms, _event_blocks, _jac_blocks, _start, _init, _init_0, _init_no_ret, _discreteVars, _extObjInfo, _makefileParams, _jacobians, _simSettingsOpt, _fileNamePrefix, _simcode_map, _equation_map, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_bdae), 12))), _daeModeData, _inlineEquations);
          tmpMeta1 = tmpMeta53;
          goto tmp5_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT30, _OMC_LIT52);
          goto goto_2;
          goto tmp5_done;
        }
        }
        goto tmp5_end;
        tmp5_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp5_done;
      tmp5_done:;
    }
  }
  _simCode = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _simCode;
}

DLLDirection
modelica_string omc_NSimCode_SimCode_toString(threadData_t *threadData, modelica_metatype _simCode, modelica_string __omcQ_24in_5Fstr)
{
  modelica_string _str = NULL;
  modelica_integer _idx;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  modelica_metatype tmpMeta33;
  modelica_metatype tmpMeta34;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  _idx = ((modelica_integer) 1);
  tmpMeta1 = stringAppend(_OMC_LIT53,_str);
  tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT54);
  tmpMeta3 = stringAppend(tmpMeta2,(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 29))));
  tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT55);
  _str = omc_StringUtil_headline__1(threadData, tmpMeta4);

  tmpMeta5 = stringAppend(_str,omc_NSimCode_ModelInfo_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 2)))));
  _str = tmpMeta5;

  tmpMeta6 = stringAppend(_str,omc_NSimVar_ExtObjInfo_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 25)))));
  _str = tmpMeta6;

  if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 22))))))
  {
    tmpMeta7 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 22))), _OMC_LIT35, _OMC_LIT56));
    tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT24);
    _str = tmpMeta8;
  }

  tmpMeta9 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 21))), _OMC_LIT35, _OMC_LIT57));
  tmpMeta10 = stringAppend(tmpMeta9,_OMC_LIT24);
  _str = tmpMeta10;

  {
    modelica_metatype _blck_lst;
    for (tmpMeta11 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 9))); !listEmpty(tmpMeta11); tmpMeta11=MMC_CDR(tmpMeta11))
    {
      _blck_lst = MMC_CAR(tmpMeta11);
      tmpMeta12 = stringAppend(_OMC_LIT58,intString(_idx));
      tmpMeta13 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, _blck_lst, _OMC_LIT35, tmpMeta12));
      tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT24);
      _str = tmpMeta14;

      _idx = ((modelica_integer) 1) + _idx;
    }
  }

  _idx = ((modelica_integer) 1);

  {
    modelica_metatype _blck_lst;
    for (tmpMeta16 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 10))); !listEmpty(tmpMeta16); tmpMeta16=MMC_CDR(tmpMeta16))
    {
      _blck_lst = MMC_CAR(tmpMeta16);
      tmpMeta17 = stringAppend(_OMC_LIT59,intString(_idx));
      tmpMeta18 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, _blck_lst, _OMC_LIT35, tmpMeta17));
      tmpMeta19 = stringAppend(tmpMeta18,_OMC_LIT24);
      _str = tmpMeta19;

      _idx = ((modelica_integer) 1) + _idx;
    }
  }

  tmpMeta21 = stringAppend(_str,omc_NSimStrongComponent_Block_listToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 8))), _OMC_LIT35, _OMC_LIT60));
  tmpMeta22 = stringAppend(tmpMeta21,_OMC_LIT24);
  _str = tmpMeta22;

  if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 11))))))
  {
    tmpMeta23 = stringAppend(_str,omc_NSimPartition_listToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 11))), _OMC_LIT35, _OMC_LIT61));
    tmpMeta24 = stringAppend(tmpMeta23,_OMC_LIT24);
    _str = tmpMeta24;
  }

  if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 3))))))
  {
    tmpMeta25 = stringAppend(_str,omc_StringUtil_headline__3(threadData, _OMC_LIT62));
    _str = tmpMeta25;

    tmpMeta26 = stringAppend(_str,omc_List_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 3))), boxvar_NFExpression_toString, _OMC_LIT14, _OMC_LIT35, _OMC_LIT63, _OMC_LIT64, 1 /* true */, ((modelica_integer) 0)));
    _str = tmpMeta26;
  }

  if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 6))))))
  {
    tmpMeta27 = stringAppend(_str,omc_StringUtil_headline__3(threadData, _OMC_LIT65));
    _str = tmpMeta27;

    tmpMeta28 = stringAppend(_str,omc_List_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 6))), boxvar_NSimGenericCall_toString, _OMC_LIT14, _OMC_LIT35, _OMC_LIT63, _OMC_LIT64, 1 /* true */, ((modelica_integer) 0)));
    _str = tmpMeta28;
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33)))))
  {
    tmpMeta29 = stringAppend(_str,omc_NSimCode_DaeModeData_toString(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 33))))));
    tmpMeta30 = stringAppend(tmpMeta29,_OMC_LIT24);
    _str = tmpMeta30;
  }

  {
    modelica_metatype _jac;
    for (tmpMeta31 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 27))); !listEmpty(tmpMeta31); tmpMeta31=MMC_CDR(tmpMeta31))
    {
      _jac = MMC_CAR(tmpMeta31);
      tmpMeta32 = stringAppend(_str,omc_NSimJacobian_SimJacobian_toString(threadData, _jac));
      _str = tmpMeta32;
    }
  }

  tmpMeta34 = stringAppend(_str,omc_NBEvents_EventInfo_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_simCode), 32)))));
  _str = tmpMeta34;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NSimCode_EMPTY__SIM__CODE__INDICES(threadData_t *threadData)
{
  modelica_metatype _indices = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = mmc_mk_box(26, 3, &NSimCode_SimCodeIndices_SIM__CODE__INDICES__desc, mmc_mk_integer(((modelica_integer) 1)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 1)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), mmc_mk_integer(((modelica_integer) 0)), omc_UnorderedMap_new(threadData, boxvar_NBStrongComponent_AliasInfo_hash, boxvar_NBStrongComponent_AliasInfo_isEqual, ((modelica_integer) 1)), omc_UnorderedMap_new(threadData, boxvar_NSimCode_Identifier_hash, boxvar_NSimCode_Identifier_isEqual, ((modelica_integer) 1)));
  _indices = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _indices;
}

DLLDirection
modelica_boolean omc_NSimCode_Identifier_isEqual(threadData_t *threadData, modelica_metatype _ident1, modelica_metatype _ident2)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = (omc_NBEquation_Equation_equalName(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident2), 2)))) && omc_NFComponentRef_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident2), 3)))));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NSimCode_Identifier_isEqual(threadData_t *threadData, modelica_metatype _ident1, modelica_metatype _ident2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NSimCode_Identifier_isEqual(threadData, _ident1, _ident2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NSimCode_Identifier_hash(threadData_t *threadData, modelica_metatype _ident)
{
  modelica_integer _i;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _i = stringHashDjb2(omc_NSimCode_Identifier_toString(threadData, _ident));
  _return: OMC_LABEL_UNUSED
  return _i;
}
modelica_metatype boxptr_NSimCode_Identifier_hash(threadData_t *threadData, modelica_metatype _ident)
{
  modelica_integer _i;
  modelica_metatype out_i;
  _i = omc_NSimCode_Identifier_hash(threadData, _ident);
  out_i = mmc_mk_icon(_i);
  return out_i;
}

DLLDirection
modelica_string omc_NSimCode_Identifier_toString(threadData_t *threadData, modelica_metatype _ident)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = stringAppend(_OMC_LIT66,omc_NFComponentRef_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident), 3)))));
  tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT67);
  tmpMeta3 = stringAppend(tmpMeta2,omc_NBEquation_Equation_pointerToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident), 2))), _OMC_LIT14));
  tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT68);
  tmpMeta5 = stringAppend(tmpMeta4,(mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ident), 4))))?_OMC_LIT69:_OMC_LIT70));
  tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT55);
  _str = tmpMeta6;
  _return: OMC_LABEL_UNUSED
  return _str;
}

