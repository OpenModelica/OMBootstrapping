#include "omc_simulation_settings.h"
#include "NFRecord.h"
#define _OMC_LIT0_data "NFRecord.collectRecordParams got non-instantiated function"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,58,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "/home/adrpo33/OpenModelica/OMCompiler/Compiler/NFFrontEnd/NFRecord.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,69,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT2_6,1.758197185e9);
#define _OMC_LIT2_6 MMC_REFREALLIT(_OMC_LIT_STRUCT2_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT2,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT1,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(250)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(250)),MMC_IMMEDIATE(MMC_TAGFIXNUM(99)),_OMC_LIT2_6}};
#define _OMC_LIT2 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data "The record constructor for '%s' requires reordering of local fields to initialize them in the correct order, which is not yet supported."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,136,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT6,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT5}};
#define _OMC_LIT6 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT7,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(389)),_OMC_LIT3,_OMC_LIT4,_OMC_LIT6}};
#define _OMC_LIT7 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,1,3) {&NFBinding_UNBOUND__desc,}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT9,1,4) {&NFPrefixes_Replaceable_NOT__REPLACEABLE__desc,}};
#define _OMC_LIT9 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,10,3) {&NFAttributes_ATTRIBUTES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT9,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT11,3,3) {&SCode_Comment_COMMENT__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT11 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,0,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT13,0.0);
#define _OMC_LIT13 MMC_REFREALLIT(_OMC_LIT_STRUCT13)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT14,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT12,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT13}};
#define _OMC_LIT14 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data "$out"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,4,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,1,3) {&NFComplexType_CLASS__desc,}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,1,6) {&DAE_InlineType_DEFAULT__INLINE__desc,}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT18,1,3) {&DAE_FunctionBuiltin_FUNCTION__NOT__BUILTIN__desc,}};
#define _OMC_LIT18 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT19,1,3) {&DAE_FunctionParallelism_FP__NON__PARALLEL__desc,}};
#define _OMC_LIT19 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,7,3) {&DAE_FunctionAttributes_FUNCTION__ATTRIBUTES__desc,_OMC_LIT17,MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT18,_OMC_LIT19}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT21,1,13) {&NFType_UNKNOWN__desc,}};
#define _OMC_LIT21 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,1,3) {&NFClass_NOT__INSTANTIATED__desc,}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,1,5) {&NFModifier_Modifier_NOMOD__desc,}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT24,1,11) {&NFInstNode_InstNode_EMPTY__NODE__desc,}};
#define _OMC_LIT24 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT24)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT25,1,5) {&NFSections_EMPTY__desc,}};
#define _OMC_LIT25 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT25)
#include "util/modelica.h"

#include "NFRecord_includes.h"



DLLDirection
modelica_metatype omc_NFRecord_toFlatDeclarationStream(threadData_t *threadData, modelica_metatype _recordNode, modelica_metatype _format, modelica_string _indent, modelica_metatype __omcQ_24in_5Fs)
{
  modelica_metatype _s = NULL;
  modelica_metatype _node = NULL;
  modelica_metatype _node_ty = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _s = __omcQ_24in_5Fs;
  // _node has no default value.
  // _node_ty has no default value.
  _node_ty = omc_NFInstNode_InstNode_nodeType(threadData, _recordNode);

  _node = omc_NFRecord_instRecord(threadData, _recordNode, ((modelica_integer) 0));

  omc_NFTyping_typeClass(threadData, _node, ((modelica_integer) 1));

  _node = omc_NFInstNode_InstNode_setNodeType(threadData, _node_ty, _node);

  omc_NFEvalConstants_evaluateRecordDeclaration(threadData, _node);

  _s = omc_IOStream_append(threadData, _s, omc_NFInstNode_InstNode_toFlatString(threadData, _node, _format, _indent));
  _return: OMC_LABEL_UNUSED
  return _s;
}

DLLDirection
modelica_metatype omc_NFRecord_foldInputFields(threadData_t *threadData, modelica_metatype _fields, modelica_metatype _args, modelica_fnptr _func, modelica_metatype __omcQ_24in_5FfoldArg)
{
  modelica_metatype _foldArg = NULL;
  modelica_metatype _arg = NULL;
  modelica_metatype _rest_args = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _foldArg = __omcQ_24in_5FfoldArg;
  // _arg has no default value.
  _rest_args = _args;
  {
    modelica_metatype _field;
    for (tmpMeta1 = _fields; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _field = MMC_CAR(tmpMeta1);
      /* Pattern-matching assignment */
      tmpMeta2 = _rest_args;
      if (listEmpty(tmpMeta2)) MMC_THROW_INTERNAL();
      tmpMeta3 = MMC_CAR(tmpMeta2);
      tmpMeta4 = MMC_CDR(tmpMeta2);
      _arg = tmpMeta3;
      _rest_args = tmpMeta4;

      if(omc_NFRecord_Field_isInput(threadData, _field))
      {
        _foldArg = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _arg, _foldArg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _arg, _foldArg);
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _foldArg;
}

DLLDirection
modelica_metatype omc_NFRecord_fieldsToDAE(threadData_t *threadData, modelica_metatype _fields)
{
  modelica_metatype _fieldNames = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _fieldNames = tmpMeta1;
  {
    modelica_metatype _field;
    for (tmpMeta2 = _fields; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _field = MMC_CAR(tmpMeta2);
      { /* match expression */
        modelica_metatype tmp5_1;
        tmp5_1 = _field;
        {
          volatile mmc_switch_type tmp5;
          int tmp6;
          tmp5 = 0;
          for (; tmp5 < 2; tmp5++) {
            switch (MMC_SWITCH_CAST(tmp5)) {
            case 0: {
              modelica_metatype tmpMeta7;
              if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,0,1) == 0) goto tmp4_end;
              
              /* Pattern matching succeeded */
              tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_field), 2))), _fieldNames);
              _fieldNames = tmpMeta7;
              goto tmp4_done;
            }
            case 1: {
              
              /* Pattern matching succeeded */
              goto tmp4_done;
            }
            }
            goto tmp4_end;
            tmp4_end: ;
          }
          goto goto_3;
          goto_3:;
          MMC_THROW_INTERNAL();
          goto tmp4_done;
          tmp4_done:;
        }
      }
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _fieldNames;
}

DLLDirection
modelica_metatype omc_NFRecord_collectRecordField(threadData_t *threadData, modelica_metatype _component, modelica_metatype __omcQ_24in_5Ffields)
{
  modelica_metatype _fields = NULL;
  modelica_metatype _comp_node = NULL;
  modelica_metatype _comp = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _fields = __omcQ_24in_5Ffields;
  _comp_node = omc_NFInstNode_InstNode_resolveInner(threadData, _component);
  // _comp has no default value.
  if(omc_NFInstNode_InstNode_isProtected(threadData, _comp_node))
  {
    tmpMeta2 = mmc_mk_box2(4, &NFRecord_Field_LOCAL__desc, omc_NFInstNode_InstNode_name(threadData, _comp_node));
    tmpMeta1 = mmc_mk_cons(tmpMeta2, _fields);
    _fields = tmpMeta1;
  }
  else
  {
    _comp = omc_NFInstNode_InstNode_component(threadData, _comp_node);

    if(omc_NFComponent_isFinal(threadData, _comp))
    {
      tmpMeta4 = mmc_mk_box2(4, &NFRecord_Field_LOCAL__desc, omc_NFInstNode_InstNode_name(threadData, _comp_node));
      tmpMeta3 = mmc_mk_cons(tmpMeta4, _fields);
      _fields = tmpMeta3;
    }
    else
    {
      if((!omc_NFComponent_isOutput(threadData, _comp)))
      {
        tmpMeta6 = mmc_mk_box2(3, &NFRecord_Field_INPUT__desc, omc_NFInstNode_InstNode_name(threadData, _comp_node));
        tmpMeta5 = mmc_mk_cons(tmpMeta6, _fields);
        _fields = tmpMeta5;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _fields;
}

DLLDirection
modelica_metatype omc_NFRecord_collectRecordFields(threadData_t *threadData, modelica_metatype _recNode, modelica_metatype *out_indexMap)
{
  modelica_metatype _fields = NULL;
  modelica_metatype _indexMap = NULL;
  modelica_metatype _field_lst = NULL;
  modelica_metatype _tree = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _fields has no default value.
  // _indexMap has no default value.
  // _field_lst has no default value.
  // _tree has no default value.
  _tree = omc_NFClass_classTree(threadData, omc_NFInstNode_InstNode_getClass(threadData, _recNode));

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _field_lst = omc_NFClassTree_ClassTree_foldComponents(threadData, _tree, boxvar_NFRecord_collectRecordField, tmpMeta1);

  _fields = listArray(listReverseInPlace(_field_lst));

  _indexMap = omc_UnorderedMap_new(threadData, boxvar_stringHashDjb2, boxvar_stringEq, arrayLength(_fields));

  omc_NFType_updateRecordFieldsIndexMap(threadData, _fields, _indexMap);
  _return: OMC_LABEL_UNUSED
  if (out_indexMap) { *out_indexMap = _indexMap; }
  return _fields;
}

DLLDirection
void omc_NFRecord_setFieldDirection(threadData_t *threadData, modelica_metatype _field, modelica_integer _direction)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  omc_NFInstNode_InstNode_componentApply(threadData, _field, boxvar_NFComponent_setDirection, mmc_mk_integer((modelica_integer)_direction));
  _return: OMC_LABEL_UNUSED
  return;
}
void boxptr_NFRecord_setFieldDirection(threadData_t *threadData, modelica_metatype _field, modelica_metatype _direction)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_direction);
  omc_NFRecord_setFieldDirection(threadData, _field, tmp1);
  return;
}

DLLDirection
modelica_metatype omc_NFRecord_collectRecordParam(threadData_t *threadData, modelica_metatype _component, modelica_metatype __omcQ_24in_5Finputs, modelica_metatype __omcQ_24in_5Flocals, modelica_metatype *out_locals)
{
  modelica_metatype _inputs = NULL;
  modelica_metatype _locals = NULL;
  modelica_metatype _comp = NULL;
  modelica_metatype _comp_node = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _inputs = __omcQ_24in_5Finputs;
  _locals = __omcQ_24in_5Flocals;
  // _comp has no default value.
  _comp_node = omc_NFInstNode_InstNode_resolveInner(threadData, _component);
  if(omc_NFInstNode_InstNode_isProtected(threadData, _comp_node))
  {
    tmpMeta1 = mmc_mk_cons(_comp_node, _locals);
    _locals = tmpMeta1;

    goto _return;
  }

  _comp = omc_NFInstNode_InstNode_component(threadData, _comp_node);

  if(omc_NFComponent_isFinal(threadData, _comp))
  {
    omc_NFRecord_setFieldDirection(threadData, _comp_node, 1);

    tmpMeta2 = mmc_mk_cons(_comp_node, _locals);
    _locals = tmpMeta2;
  }
  else
  {
    omc_NFRecord_setFieldDirection(threadData, _comp_node, 2);

    omc_NFInstNode_InstNode_componentApply(threadData, _comp_node, boxvar_NFComponent_setVariability, mmc_mk_integer(7));

    tmpMeta3 = mmc_mk_cons(_comp_node, _inputs);
    _inputs = tmpMeta3;
  }
  _return: OMC_LABEL_UNUSED
  if (out_locals) { *out_locals = _locals; }
  return _inputs;
}

DLLDirection
modelica_metatype omc_NFRecord_collectRecordParams(threadData_t *threadData, modelica_metatype _recNode, modelica_metatype *out_locals, modelica_metatype *out_allParams)
{
  modelica_metatype _inputs = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _locals = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _allParams = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype _comp = NULL;
  modelica_metatype _comps = NULL;
  modelica_metatype _pcomps = NULL;
  modelica_metatype _tree = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _inputs = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _locals = tmpMeta2;
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _allParams = tmpMeta3;
  // _comp has no default value.
  // _comps has no default value.
  // _pcomps has no default value.
  // _tree has no default value.
  _tree = omc_NFClass_classTree(threadData, omc_NFInstNode_InstNode_getClass(threadData, _recNode));

  { /* match expression */
    modelica_metatype tmp6_1;
    tmp6_1 = _tree;
    {
      int tmp6;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp6_1))) {
        case 6: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_integer tmp10;
          modelica_integer tmp11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp6_1,3,5) == 0) goto tmp5_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp6_1), 4));
          
          _comps = tmpMeta7;
          /* Pattern matching succeeded */
          tmp9 = arrayLength(_comps); tmp10 = ((modelica_integer) -1); tmp11 = ((modelica_integer) 1);
          if(!(((tmp10 > 0) && (tmp9 > tmp11)) || ((tmp10 < 0) && (tmp9 < tmp11))))
          {
            modelica_integer _i;
            for(_i = arrayLength(_comps); in_range_integer(_i, tmp9, tmp11); _i += tmp10)
            {
              _comp = arrayGet(_comps,_i) /* DAE.ASUB */;

              _inputs = omc_NFRecord_collectRecordParam(threadData, _comp, _inputs, _locals ,&_locals);

              tmpMeta8 = mmc_mk_cons(_comp, _allParams);
              _allParams = tmpMeta8;
            }
          }
          goto tmp5_done;
        }
        case 5: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_integer tmp14;
          modelica_integer tmp15;
          modelica_integer tmp16;
          if (mmc__uniontype__metarecord__typedef__equal(tmp6_1,2,7) == 0) goto tmp5_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp6_1), 4));
          
          _pcomps = tmpMeta12;
          /* Pattern matching succeeded */
          tmp14 = arrayLength(_pcomps); tmp15 = ((modelica_integer) -1); tmp16 = ((modelica_integer) 1);
          if(!(((tmp15 > 0) && (tmp14 > tmp16)) || ((tmp15 < 0) && (tmp14 < tmp16))))
          {
            modelica_integer _i;
            for(_i = arrayLength(_pcomps); in_range_integer(_i, tmp14, tmp16); _i += tmp15)
            {
              _comp = omc_Mutable_access(threadData, arrayGet(_pcomps,_i) /* DAE.ASUB */);

              _inputs = omc_NFRecord_collectRecordParam(threadData, _comp, _inputs, _locals ,&_locals);

              tmpMeta13 = mmc_mk_cons(_comp, _allParams);
              _allParams = tmpMeta13;
            }
          }
          goto tmp5_done;
        }
        default:
        tmp5_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_assertion(threadData, 0 /* false */, _OMC_LIT0, _OMC_LIT2);
          goto goto_4;
          goto tmp5_done;
        }
        }
        goto tmp5_end;
        tmp5_end: ;
      }
      goto goto_4;
      goto_4:;
      MMC_THROW_INTERNAL();
      goto tmp5_done;
      tmp5_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  if (out_locals) { *out_locals = _locals; }
  if (out_allParams) { *out_allParams = _allParams; }
  return _inputs;
}

DLLDirection
void omc_NFRecord_checkLocalFieldOrder(threadData_t *threadData, modelica_metatype _locals, modelica_metatype _recNode, modelica_metatype _info)
{
  modelica_metatype _locals_set = NULL;
  modelica_metatype _locs = NULL;
  modelica_metatype _deps = NULL;
  modelica_metatype _loc = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _locals_set has no default value.
  // _locs has no default value.
  // _deps has no default value.
  // _loc has no default value.
  if((listLength(_locals) <= ((modelica_integer) 1)))
  {
    goto _return;
  }

  /* Pattern-matching assignment */
  tmpMeta1 = listReverse(_locals);
  if (listEmpty(tmpMeta1)) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_CAR(tmpMeta1);
  tmpMeta3 = MMC_CDR(tmpMeta1);
  _loc = tmpMeta2;
  _locs = tmpMeta3;

  tmpMeta4 = mmc_mk_cons(_loc, MMC_REFSTRUCTLIT(mmc_nil));
  _locals_set = omc_UnorderedSet_fromList(threadData, tmpMeta4, boxvar_NFInstNode_InstNode_hash, boxvar_NFInstNode_InstNode_refEqual);

  {
    modelica_metatype _l;
    for (tmpMeta5 = _locs; !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
    {
      _l = MMC_CAR(tmpMeta5);
      _deps = omc_NFFunction_Function_getLocalDependencies(threadData, _l, _locals_set);

      if((!listEmpty(_deps)))
      {
        tmpMeta6 = mmc_mk_cons(omc_NFInstNode_InstNode_name(threadData, _recNode), MMC_REFSTRUCTLIT(mmc_nil));
        omc_Error_addSourceMessage(threadData, _OMC_LIT7, tmpMeta6, _info);

        MMC_THROW_INTERNAL();
      }

      omc_UnorderedSet_add(threadData, _l, _locals_set);
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_NFRecord_instDefaultConstructor(threadData_t *threadData, modelica_metatype _path, modelica_metatype __omcQ_24in_5Fnode, modelica_integer _context, modelica_metatype _info)
{
  modelica_metatype _node = NULL;
  modelica_metatype _inputs = NULL;
  modelica_metatype _locals = NULL;
  modelica_metatype _all_params = NULL;
  modelica_metatype _sorted_locals = NULL;
  modelica_metatype _attr = NULL;
  modelica_metatype _status = NULL;
  modelica_metatype _ctor_node = NULL;
  modelica_metatype _out_rec = NULL;
  modelica_metatype _out_comp = NULL;
  modelica_metatype _ctor_cls = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _node = __omcQ_24in_5Fnode;
  // _inputs has no default value.
  // _locals has no default value.
  // _all_params has no default value.
  // _sorted_locals has no default value.
  // _attr has no default value.
  // _status has no default value.
  // _ctor_node has no default value.
  // _out_rec has no default value.
  // _out_comp has no default value.
  // _ctor_cls has no default value.
  _ctor_node = omc_NFRecord_instRecord(threadData, _node, _context);

  _inputs = omc_NFRecord_collectRecordParams(threadData, _ctor_node ,&_locals ,&_all_params);

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = mmc_mk_box3(20, &NFType_UNTYPED__desc, _node, listArray(tmpMeta1));
  tmpMeta3 = mmc_mk_box9(4, &NFComponent_COMPONENT__desc, _ctor_node, tmpMeta2, _OMC_LIT8, _OMC_LIT8, _OMC_LIT10, _OMC_LIT11, mmc_mk_integer(2), _OMC_LIT14);
  _out_comp = tmpMeta3;

  tmpMeta4 = stringAppend(_OMC_LIT15,omc_NFInstNode_InstNode_name(threadData, _ctor_node));
  _out_rec = omc_NFInstNode_InstNode_fromComponent(threadData, tmpMeta4, _out_comp, _ctor_node);

  _ctor_cls = omc_NFClass_makeRecordConstructor(threadData, _all_params, _out_rec);

  _ctor_node = omc_NFInstNode_InstNode_replaceClass(threadData, _ctor_cls, _ctor_node);

  tmpMeta5 = mmc_mk_box3(14, &NFType_COMPLEX__desc, _ctor_node, _OMC_LIT16);
  omc_NFInstNode_InstNode_classApply(threadData, _ctor_node, boxvar_NFClass_setType, tmpMeta5);

  _attr = _OMC_LIT20;

  _status = omc_Pointer_create(threadData, mmc_mk_integer(2));

  tmpMeta6 = mmc_mk_cons(_out_rec, MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta11 = mmc_mk_box14(3, &NFFunction_Function_FUNCTION__desc, _path, _ctor_node, _inputs, tmpMeta6, _locals, tmpMeta7, _OMC_LIT21, _attr, tmpMeta8, tmpMeta9, listArray(tmpMeta10), _status, omc_Pointer_create(threadData, mmc_mk_integer(((modelica_integer) 0))));
  omc_NFInstNode_InstNode_cacheAddFunc(threadData, _node, tmpMeta11, 0 /* false */);
  _return: OMC_LABEL_UNUSED
  return _node;
}
modelica_metatype boxptr_NFRecord_instDefaultConstructor(threadData_t *threadData, modelica_metatype _path, modelica_metatype __omcQ_24in_5Fnode, modelica_metatype _context, modelica_metatype _info)
{
  modelica_integer tmp1;
  modelica_metatype _node = NULL;
  tmp1 = mmc_unbox_integer(_context);
  _node = omc_NFRecord_instDefaultConstructor(threadData, _path, __omcQ_24in_5Fnode, tmp1, _info);
  /* skip box _node; NFInstNode.InstNode */
  return _node;
}

DLLDirection
modelica_metatype omc_NFRecord_instRecord(threadData_t *threadData, modelica_metatype _node, modelica_integer _context)
{
  modelica_metatype _recordNode = NULL;
  modelica_integer _next_context;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _recordNode has no default value.
  // _next_context has no default value.
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_boolean tmp5;
          /* Pattern matching succeeded */
          _recordNode = omc_NFLookup_lookupLocalSimpleName(threadData, omc_NFInstNode_InstNode_name(threadData, _node), omc_NFInstNode_InstNode_classScope(threadData, omc_NFInstNode_InstNode_parent(threadData, _node)), NULL);

          /* Pattern-matching assignment */
          tmp5 = referenceEq(omc_NFInstNode_InstNode_definition(threadData, _node), omc_NFInstNode_InstNode_definition(threadData, _recordNode));
          if (1 /* true */ != tmp5) goto goto_1;
          goto tmp2_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          _recordNode = omc_NFInstNode_InstNode_replaceClass(threadData, _OMC_LIT22, _node);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;

  _next_context = omc_NFInstContext_set(threadData, _context, ((modelica_integer) 1));

  _next_context = omc_NFInstContext_set(threadData, _next_context, ((modelica_integer) 16));

  tmpMeta6 = mmc_mk_box2(8, &NFInstNode_InstNodeType_ROOT__CLASS__desc, omc_NFInstNode_InstNode_parent(threadData, _node));
  _recordNode = omc_NFInstNode_InstNode_setNodeType(threadData, tmpMeta6, _recordNode);

  _recordNode = omc_NFInst_instantiate(threadData, _recordNode, _OMC_LIT23, _OMC_LIT24, _next_context, 0 /* false */);

  omc_NFInst_instExpressions(threadData, _recordNode, _recordNode, _OMC_LIT25, _next_context, omc_NFInst_InstSettings_create(threadData));
  _return: OMC_LABEL_UNUSED
  return _recordNode;
}
modelica_metatype boxptr_NFRecord_instRecord(threadData_t *threadData, modelica_metatype _node, modelica_metatype _context)
{
  modelica_integer tmp1;
  modelica_metatype _recordNode = NULL;
  tmp1 = mmc_unbox_integer(_context);
  _recordNode = omc_NFRecord_instRecord(threadData, _node, tmp1);
  /* skip box _recordNode; NFInstNode.InstNode */
  return _recordNode;
}

DLLDirection
modelica_string omc_NFRecord_Field_name(threadData_t *threadData, modelica_metatype _field)
{
  modelica_string _name = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _name has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _field;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_field), 2)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_field), 2)));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _name = tmp1;
  _return: OMC_LABEL_UNUSED
  return _name;
}

DLLDirection
modelica_boolean omc_NFRecord_Field_isInput(threadData_t *threadData, modelica_metatype _field)
{
  modelica_boolean _isInput;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isInput has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _field;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isInput = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isInput;
}
modelica_metatype boxptr_NFRecord_Field_isInput(threadData_t *threadData, modelica_metatype _field)
{
  modelica_boolean _isInput;
  modelica_metatype out_isInput;
  _isInput = omc_NFRecord_Field_isInput(threadData, _field);
  out_isInput = mmc_mk_icon(_isInput);
  return out_isInput;
}

