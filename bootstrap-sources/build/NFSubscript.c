#include "omc_simulation_settings.h"
#include "NFSubscript.h"
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT0,1,8) {&NFSubscript_WHOLE__desc,}};
#define _OMC_LIT0 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT0)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT1,2,3) {&NFExpression_INTEGER__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT1 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT2,2,5) {&NFSubscript_INDEX__desc,_OMC_LIT1}};
#define _OMC_LIT2 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,2,6) {&NFExpression_BOOLEAN__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,2,5) {&NFSubscript_INDEX__desc,_OMC_LIT3}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,2,6) {&NFExpression_BOOLEAN__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */))}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT6,1,10) {&NFDimension_UNKNOWN__desc,}};
#define _OMC_LIT6 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,0,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT8,0.0);
#define _OMC_LIT8 MMC_REFREALLIT(_OMC_LIT_STRUCT8)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT9,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT7,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT8}};
#define _OMC_LIT9 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,4,3) {&NFCeval_EvalTarget_EVAL__TARGET__desc,_OMC_LIT9,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "["
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,1,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data ","
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,1,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,1,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "{"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,1,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,2,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
#define _OMC_LIT16_data "}"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT16,1,_OMC_LIT16_data);
#define _OMC_LIT16 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT16)
#define _OMC_LIT17_data ":"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT17,1,_OMC_LIT17_data);
#define _OMC_LIT17 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data "<"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,1,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data ">"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,1,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data "NFSubscript.toDAEExp failed on unknown subscript '"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,50,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,1,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
#define _OMC_LIT22_data "/home/adrpo33/OpenModelica/OMCompiler/Compiler/NFFrontEnd/NFSubscript.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT22,72,_OMC_LIT22_data);
#define _OMC_LIT22 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT23_6,1.758197185e9);
#define _OMC_LIT23_6 MMC_REFREALLIT(_OMC_LIT_STRUCT23_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(789)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(790)),MMC_IMMEDIATE(MMC_TAGFIXNUM(53)),_OMC_LIT23_6}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT24,1,3) {&DAE_Subscript_WHOLEDIM__desc,}};
#define _OMC_LIT24 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "NFSubscript.toDAE failed on unknown subscript "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,46,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT26_6,1.758197185e9);
#define _OMC_LIT26_6 MMC_REFREALLIT(_OMC_LIT_STRUCT26_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(774)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(774)),MMC_IMMEDIATE(MMC_TAGFIXNUM(122)),_OMC_LIT26_6}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,1,3) {&Absyn_Subscript_NOSUB__desc,}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "NFSubscript.toAbsyn failed on unknown subscript"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,47,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT29_6,1.758197185e9);
#define _OMC_LIT29_6 MMC_REFREALLIT(_OMC_LIT_STRUCT29_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(758)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(758)),MMC_IMMEDIATE(MMC_TAGFIXNUM(99)),_OMC_LIT29_6}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,1,11) {&NFInstNode_InstNode_EMPTY__NODE__desc,}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
#define _OMC_LIT31_data "NFSubscript.makeSplitIndex got invalid index "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT31,45,_OMC_LIT31_data);
#define _OMC_LIT31 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT32_6,1.758197185e9);
#define _OMC_LIT32_6 MMC_REFREALLIT(_OMC_LIT_STRUCT32_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(210)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(210)),MMC_IMMEDIATE(MMC_TAGFIXNUM(105)),_OMC_LIT32_6}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data "NFSubscript.makeIndex got a non integer type exp to make an index sub"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,69,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT34_6,1.758197185e9);
#define _OMC_LIT34_6 MMC_REFREALLIT(_OMC_LIT_STRUCT34_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(199)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(199)),MMC_IMMEDIATE(MMC_TAGFIXNUM(115)),_OMC_LIT34_6}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "NFSubscript.toIndexList got an incorrect subscript type "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,56,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,1,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT37_6,1.758197185e9);
#define _OMC_LIT37_6 MMC_REFREALLIT(_OMC_LIT_STRUCT37_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT37,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT22,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(178)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(178)),MMC_IMMEDIATE(MMC_TAGFIXNUM(130)),_OMC_LIT37_6}};
#define _OMC_LIT37 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT37)
#include "util/modelica.h"

#include "NFSubscript_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFSubscript_isValidIndexType(threadData_t *threadData, modelica_metatype _ty);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFSubscript_isValidIndexType(threadData_t *threadData, modelica_metatype _ty);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSubscript_isValidIndexType,2,0) {(void*) boxptr_NFSubscript_isValidIndexType,0}};
#define boxvar_NFSubscript_isValidIndexType MMC_REFSTRUCTLIT(boxvar_lit_NFSubscript_isValidIndexType)

DLLDirection
modelica_boolean omc_NFSubscript_isLiteral(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _literal;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _literal has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _literal = tmp1;
  _return: OMC_LABEL_UNUSED
  return _literal;
}
modelica_metatype boxptr_NFSubscript_isLiteral(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _literal;
  modelica_metatype out_literal;
  _literal = omc_NFSubscript_isLiteral(threadData, _sub);
  out_literal = mmc_mk_icon(_literal);
  return out_literal;
}

DLLDirection
modelica_metatype omc_NFSubscript_splitIndexDimExp(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_metatype _exp = NULL;
  modelica_metatype _node = NULL;
  modelica_integer _index;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _exp has no default value.
  // _node has no default value.
  // _index has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _sub;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,7,2) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmp4 = mmc_unbox_integer(tmpMeta3);
  _node = tmpMeta2;
  _index = tmp4  /* pattern as ty=Integer */;

  _exp = omc_NFDimension_sizeExp(threadData, omc_NFType_nthDimension(threadData, omc_NFInstNode_InstNode_getType(threadData, _node), _index));
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_integer omc_NFSubscript_hash(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_integer _hash;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _hash has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 9: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_hash(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2)))) + omc_NFInstNode_InstNode_hash(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 3))));
          goto tmp3_done;
        }
        case 10: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_hash(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2)))) + mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 3))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = stringHashDjb2(omc_NFSubscript_toString(threadData, _sub));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hash = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hash;
}
modelica_metatype boxptr_NFSubscript_hash(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_integer _hash;
  modelica_metatype out_hash;
  _hash = omc_NFSubscript_hash(threadData, _sub);
  out_hash = mmc_mk_icon(_hash);
  return out_hash;
}

DLLDirection
modelica_metatype omc_NFSubscript_expandSplitIndices(threadData_t *threadData, modelica_metatype _subs, modelica_metatype _indicesToKeep)
{
  modelica_metatype _outSubs = NULL;
  modelica_metatype tmpMeta1;
  modelica_boolean _changed;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _outSubs = tmpMeta1;
  _changed = 0 /* false */;
  {
    modelica_metatype _s;
    for (tmpMeta2 = _subs; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _s = MMC_CAR(tmpMeta2);
      { /* match expression */
        modelica_metatype tmp5_1;
        tmp5_1 = _s;
        {
          volatile mmc_switch_type tmp5;
          int tmp6;
          tmp5 = 0;
          for (; tmp5 < 2; tmp5++) {
            switch (MMC_SWITCH_CAST(tmp5)) {
            case 0: {
              modelica_metatype tmpMeta7;
              modelica_metatype tmpMeta8;
              if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,7,2) == 0) goto tmp4_end;
              
              /* Pattern matching succeeded */
              if(omc_List_isMemberOnTrue(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_s), 2))), _indicesToKeep, boxvar_NFInstNode_InstNode_refEqual))
              {
                tmpMeta7 = mmc_mk_cons(_s, _outSubs);
                _outSubs = tmpMeta7;
              }
              else
              {
                tmpMeta8 = mmc_mk_cons(_OMC_LIT0, _outSubs);
                _outSubs = tmpMeta8;

                _changed = 1 /* true */;
              }
              goto tmp4_done;
            }
            case 1: {
              modelica_metatype tmpMeta9;
              
              /* Pattern matching succeeded */
              tmpMeta9 = mmc_mk_cons(_s, _outSubs);
              _outSubs = tmpMeta9;
              goto tmp4_done;
            }
            }
            goto tmp4_end;
            tmp4_end: ;
          }
          goto goto_3;
          goto_3:;
          MMC_THROW_INTERNAL();
          goto tmp4_done;
          tmp4_done:;
        }
      }
      ;
    }
  }

  if(_changed)
  {
    _outSubs = omc_List_trim(threadData, _outSubs, boxvar_NFSubscript_isWhole);

    _outSubs = listReverseInPlace(_outSubs);
  }
  else
  {
    _outSubs = _subs;
  }
  _return: OMC_LABEL_UNUSED
  return _outSubs;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSplitFromOrigin(threadData_t *threadData, modelica_metatype _sub, modelica_metatype _origin)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_refEqual(threadData, _origin, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isSplitFromOrigin(threadData_t *threadData, modelica_metatype _sub, modelica_metatype _origin)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isSplitFromOrigin(threadData, _sub, _origin);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSplitClassProxy(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_isClass(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isSplitClassProxy(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isSplitClassProxy(threadData, _sub);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSplitIndex(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isSplitIndex(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isSplitIndex(threadData, _sub);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSplit(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 9: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 10: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isSplit(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isSplit(threadData, _sub);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_metatype omc_NFSubscript_first(threadData_t *threadData, modelica_metatype _dim)
{
  modelica_metatype _sub = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sub has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _dim;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT2;
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT4;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, omc_NFExpression_nthEnumLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dim), 2))), ((modelica_integer) 1)));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sub = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sub;
}

DLLDirection
modelica_metatype omc_NFSubscript_mergeList(threadData_t *threadData, modelica_metatype _newSubs, modelica_metatype _oldSubs, modelica_integer _dimensions, modelica_boolean _backend, modelica_metatype *out_remainingSubs)
{
  modelica_metatype _outSubs = NULL;
  modelica_metatype _remainingSubs = NULL;
  modelica_integer _subs_count;
  modelica_metatype _new_sub = NULL;
  modelica_metatype _old_sub = NULL;
  modelica_metatype _rest_old_subs = NULL;
  modelica_boolean _merged;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_boolean tmp10_c0 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubs has no default value.
  // _remainingSubs has no default value.
  // _subs_count has no default value.
  // _new_sub has no default value.
  // _old_sub has no default value.
  // _rest_old_subs has no default value.
  _merged = 1 /* true */;
  if(((_backend && (listLength(_oldSubs) >= _dimensions)) && omc_List_all(threadData, omc_List_firstN(threadData, _oldSubs, _dimensions), boxvar_NFSubscript_isBackendIterator)))
  {
    omc_List_split(threadData, _newSubs, _dimensions ,&_remainingSubs);

    _outSubs = omc_List_split(threadData, _oldSubs, _dimensions, NULL);

    goto _return;
  }

  if(listEmpty(_oldSubs))
  {
    if((listLength(_newSubs) <= _dimensions))
    {
      _outSubs = _newSubs;

      tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
      _remainingSubs = tmpMeta1;
    }
    else
    {
      _outSubs = omc_List_split(threadData, _newSubs, _dimensions ,&_remainingSubs);
    }

    goto _return;
  }

  _subs_count = listLength(_oldSubs);

  _remainingSubs = _newSubs;

  _rest_old_subs = _oldSubs;

  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _outSubs = tmpMeta2;

  while(1)
  {
    if(!(_merged && (!listEmpty(_remainingSubs)))) break;
    /* Pattern-matching assignment */
    tmpMeta3 = _remainingSubs;
    if (listEmpty(tmpMeta3)) MMC_THROW_INTERNAL();
    tmpMeta4 = MMC_CAR(tmpMeta3);
    tmpMeta5 = MMC_CDR(tmpMeta3);
    _new_sub = tmpMeta4;
    _remainingSubs = tmpMeta5;

    _merged = 0 /* false */;

    while(1)
    {
      if(!(!_merged)) break;
      if(listEmpty(_rest_old_subs))
      {
        tmpMeta6 = mmc_mk_cons(_new_sub, _remainingSubs);
        _remainingSubs = tmpMeta6;

        break;
      }
      else
      {
        /* Pattern-matching assignment */
        tmpMeta7 = _rest_old_subs;
        if (listEmpty(tmpMeta7)) MMC_THROW_INTERNAL();
        tmpMeta8 = MMC_CAR(tmpMeta7);
        tmpMeta9 = MMC_CDR(tmpMeta7);
        _old_sub = tmpMeta8;
        _rest_old_subs = tmpMeta9;

        
        
        { /* match expression */
          modelica_metatype tmp13_1;
          tmp13_1 = _old_sub;
          {
            int tmp13;
            {
              switch (MMC_SWITCH_CAST(valueConstructor(tmp13_1))) {
              case 6: {
                modelica_metatype tmpMeta14;
                modelica_metatype tmpMeta15;
                modelica_metatype tmpMeta16;
                modelica_metatype tmpMeta17;
                
                /* Pattern matching succeeded */
                if((!omc_NFSubscript_isWhole(threadData, _new_sub)))
                {
                  tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
                  tmpMeta16 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, omc_NFExpression_applySubscript(threadData, _new_sub, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_old_sub), 2))), tmpMeta15, 0 /* false */));
                  tmpMeta14 = mmc_mk_cons(tmpMeta16, _outSubs);
                  _outSubs = tmpMeta14;
                }
                else
                {
                  tmpMeta17 = mmc_mk_cons(_old_sub, _outSubs);
                  _outSubs = tmpMeta17;
                }
                tmp10_c0 = 1 /* true */;
                tmpMeta[0+1] = _outSubs;
                goto tmp12_done;
              }
              case 8: {
                modelica_metatype tmpMeta18;
                
                /* Pattern matching succeeded */
                tmpMeta18 = mmc_mk_cons(_new_sub, _outSubs);
                tmp10_c0 = 1 /* true */;
                tmpMeta[0+1] = tmpMeta18;
                goto tmp12_done;
              }
              default:
              tmp12_default: OMC_LABEL_UNUSED; {
                modelica_metatype tmpMeta19;
                
                /* Pattern matching succeeded */
                tmpMeta19 = mmc_mk_cons(_old_sub, _outSubs);
                tmp10_c0 = 0 /* false */;
                tmpMeta[0+1] = tmpMeta19;
                goto tmp12_done;
              }
              }
              goto tmp12_end;
              tmp12_end: ;
            }
            goto goto_11;
            goto_11:;
            MMC_THROW_INTERNAL();
            goto tmp12_done;
            tmp12_done:;
          }
        }
        _merged = tmp10_c0;
        _outSubs = tmpMeta[0+1];
      }
    }
  }

  {
    modelica_metatype _s;
    for (tmpMeta20 = _rest_old_subs; !listEmpty(tmpMeta20); tmpMeta20=MMC_CDR(tmpMeta20))
    {
      _s = MMC_CAR(tmpMeta20);
      tmpMeta21 = mmc_mk_cons(_s, _outSubs);
      _outSubs = tmpMeta21;
    }
  }

  while(1)
  {
    if(!((!listEmpty(_remainingSubs)) && (_subs_count < _dimensions))) break;
    /* Pattern-matching assignment */
    tmpMeta23 = _remainingSubs;
    if (listEmpty(tmpMeta23)) MMC_THROW_INTERNAL();
    tmpMeta24 = MMC_CAR(tmpMeta23);
    tmpMeta25 = MMC_CDR(tmpMeta23);
    _new_sub = tmpMeta24;
    _remainingSubs = tmpMeta25;

    tmpMeta26 = mmc_mk_cons(_new_sub, _outSubs);
    _outSubs = tmpMeta26;

    _subs_count = ((modelica_integer) 1) + _subs_count;
  }

  _outSubs = listReverseInPlace(_outSubs);
  _return: OMC_LABEL_UNUSED
  if (out_remainingSubs) { *out_remainingSubs = _remainingSubs; }
  return _outSubs;
}
modelica_metatype boxptr_NFSubscript_mergeList(threadData_t *threadData, modelica_metatype _newSubs, modelica_metatype _oldSubs, modelica_metatype _dimensions, modelica_metatype _backend, modelica_metatype *out_remainingSubs)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outSubs = NULL;
  tmp1 = mmc_unbox_integer(_dimensions);
  tmp2 = mmc_unbox_integer(_backend);
  _outSubs = omc_NFSubscript_mergeList(threadData, _newSubs, _oldSubs, tmp1, tmp2, out_remainingSubs);
  /* skip box _outSubs; list<NFSubscript> */
  /* skip box _remainingSubs; list<NFSubscript> */
  return _outSubs;
}

DLLDirection
modelica_integer omc_NFSubscript_purityList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_integer _pur;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _pur = 1;
  {
    modelica_metatype _s;
    for (tmpMeta1 = _subscripts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s = MMC_CAR(tmpMeta1);
      _pur = omc_NFPrefixes_purityMin(threadData, (modelica_integer)_pur, omc_NFSubscript_purity(threadData, _s));
    }
  }
  _return: OMC_LABEL_UNUSED
  return _pur;
}
modelica_metatype boxptr_NFSubscript_purityList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_integer _pur;
  modelica_metatype out_pur;
  _pur = omc_NFSubscript_purityList(threadData, _subscripts);
  out_pur = mmc_mk_icon(_pur);
  return out_pur;
}

DLLDirection
modelica_integer omc_NFSubscript_purity(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _purity;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _purity has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_purity(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_purity(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_purity(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _purity = tmp1;
  _return: OMC_LABEL_UNUSED
  return _purity;
}
modelica_metatype boxptr_NFSubscript_purity(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _purity;
  modelica_metatype out_purity;
  _purity = omc_NFSubscript_purity(threadData, _subscript);
  out_purity = mmc_mk_icon(_purity);
  return out_purity;
}

DLLDirection
modelica_integer omc_NFSubscript_variabilityList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_integer _var;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _var = 1;
  {
    modelica_metatype _s;
    for (tmpMeta1 = _subscripts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s = MMC_CAR(tmpMeta1);
      _var = omc_NFPrefixes_variabilityMax(threadData, (modelica_integer)_var, omc_NFSubscript_variability(threadData, _s));
    }
  }
  _return: OMC_LABEL_UNUSED
  return _var;
}
modelica_metatype boxptr_NFSubscript_variabilityList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_integer _var;
  modelica_metatype out_var;
  _var = omc_NFSubscript_variabilityList(threadData, _subscripts);
  out_var = mmc_mk_icon(_var);
  return out_var;
}

DLLDirection
modelica_integer omc_NFSubscript_variability(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _var;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _var has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_variability(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_variability(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_variability(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 1;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _var = tmp1;
  _return: OMC_LABEL_UNUSED
  return _var;
}
modelica_metatype boxptr_NFSubscript_variability(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _var;
  modelica_metatype out_var;
  _var = omc_NFSubscript_variability(threadData, _subscript);
  out_var = mmc_mk_icon(_var);
  return out_var;
}

DLLDirection
modelica_metatype omc_NFSubscript_expandList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_boolean _resize)
{
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _dim = NULL;
  modelica_metatype _rest_dims = NULL;
  modelica_metatype _sub = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _outSubscripts = tmpMeta1;
  // _dim has no default value.
  _rest_dims = _dimensions;
  // _sub has no default value.
  {
    modelica_metatype _s;
    for (tmpMeta2 = _subscripts; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _s = MMC_CAR(tmpMeta2);
      /* Pattern-matching assignment */
      tmpMeta3 = _rest_dims;
      if (listEmpty(tmpMeta3)) MMC_THROW_INTERNAL();
      tmpMeta4 = MMC_CAR(tmpMeta3);
      tmpMeta5 = MMC_CDR(tmpMeta3);
      _dim = tmpMeta4;
      _rest_dims = tmpMeta5;

      _sub = omc_NFSubscript_expand(threadData, _s, _dim, _resize, NULL);

      tmpMeta6 = mmc_mk_cons(_sub, _outSubscripts);
      _outSubscripts = tmpMeta6;
    }
  }

  {
    modelica_metatype _d;
    for (tmpMeta8 = _rest_dims; !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
    {
      _d = MMC_CAR(tmpMeta8);
      tmpMeta9 = mmc_mk_box2(7, &NFSubscript_EXPANDED__SLICE__desc, omc_NFRangeIterator_map(threadData, omc_NFRangeIterator_fromDim(threadData, _d, _resize), boxvar_NFSubscript_makeIndex));
      _sub = tmpMeta9;

      tmpMeta10 = mmc_mk_cons(_sub, _outSubscripts);
      _outSubscripts = tmpMeta10;
    }
  }

  _outSubscripts = listReverse(_outSubscripts);
  _return: OMC_LABEL_UNUSED
  return _outSubscripts;
}
modelica_metatype boxptr_NFSubscript_expandList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_resize);
  _outSubscripts = omc_NFSubscript_expandList(threadData, _subscripts, _dimensions, tmp1);
  /* skip box _outSubscripts; list<NFSubscript> */
  return _outSubscripts;
}

DLLDirection
modelica_metatype omc_NFSubscript_expandSlice(threadData_t *threadData, modelica_metatype _subscript, modelica_boolean _resize, modelica_boolean *out_expanded)
{
  modelica_metatype _outSubscript = NULL;
  modelica_boolean _expanded;
  modelica_boolean tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  // _expanded has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _exp = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _exp has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _exp = omc_NFExpandExp_expand(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _resize, NULL);

          if(omc_NFExpression_isArray(threadData, _exp))
          {
            {
              modelica_metatype __omcQ_24tmpVar1;
              modelica_metatype* tmp7;
              modelica_metatype tmpMeta8;
              modelica_metatype tmpMeta9;
              modelica_metatype __omcQ_24tmpVar0;
              modelica_integer tmp10;
              modelica_metatype _e_loopVar = 0;
              modelica_integer tmp11;
              modelica_metatype _e;
              _e_loopVar = omc_NFExpression_arrayElements(threadData, _exp);
              tmp11 = 1;
              tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar1 = tmpMeta8; /* defaultValue */
              tmp7 = &__omcQ_24tmpVar1;
              while(1) {
                tmp10 = 1;
                if (tmp11 <= arrayLength(_e_loopVar)) {
                  _e = arrayGet(_e_loopVar, tmp11++);
                  tmp10--;
                }
                if (tmp10 == 0) {
                  tmpMeta9 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _e);
                  __omcQ_24tmpVar0 = tmpMeta9;
                  *tmp7 = mmc_mk_cons(__omcQ_24tmpVar0,0);
                  tmp7 = &MMC_CDR(*tmp7);
                } else if (tmp10 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp7 = mmc_mk_nil();
              tmpMeta6 = __omcQ_24tmpVar1;
            }
            tmpMeta12 = mmc_mk_box2(7, &NFSubscript_EXPANDED__SLICE__desc, tmpMeta6);
            _outSubscript = tmpMeta12;

            _expanded = 1 /* true */;
          }
          else
          {
            _outSubscript = _subscript;

            _expanded = 0 /* false */;
          }
          tmpMeta[0+0] = _outSubscript;
          tmp1_c1 = _expanded;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _subscript;
          tmp1_c1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta[0+0];
  _expanded = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_expanded) { *out_expanded = _expanded; }
  return _outSubscript;
}
modelica_metatype boxptr_NFSubscript_expandSlice(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _resize, modelica_metatype *out_expanded)
{
  modelica_integer tmp1;
  modelica_boolean _expanded;
  modelica_metatype _outSubscript = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _outSubscript = omc_NFSubscript_expandSlice(threadData, _subscript, tmp1, &_expanded);
  /* skip box _outSubscript; NFSubscript */
  if (out_expanded) { *out_expanded = mmc_mk_icon(_expanded); }
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_expand(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _dimension, modelica_boolean _resize, modelica_boolean *out_expanded)
{
  modelica_metatype _outSubscript = NULL;
  modelica_boolean _expanded;
  modelica_boolean tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  // _expanded has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _iter = NULL;
      int tmp4;
      // _iter has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = omc_NFSubscript_expandSlice(threadData, _subscript, _resize, &tmp1_c1);
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          _iter = omc_NFRangeIterator_fromDim(threadData, _dimension, _resize);

          if(omc_NFRangeIterator_isValid(threadData, _iter))
          {
            tmpMeta5 = mmc_mk_box2(7, &NFSubscript_EXPANDED__SLICE__desc, omc_NFRangeIterator_map(threadData, _iter, boxvar_NFSubscript_makeIndex));
            _outSubscript = tmpMeta5;

            _expanded = 1 /* true */;
          }
          else
          {
            _outSubscript = _subscript;

            _expanded = 0 /* false */;
          }
          tmpMeta[0+0] = _outSubscript;
          tmp1_c1 = _expanded;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _subscript;
          tmp1_c1 = 1 /* true */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta[0+0];
  _expanded = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_expanded) { *out_expanded = _expanded; }
  return _outSubscript;
}
modelica_metatype boxptr_NFSubscript_expand(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _dimension, modelica_metatype _resize, modelica_metatype *out_expanded)
{
  modelica_integer tmp1;
  modelica_boolean _expanded;
  modelica_metatype _outSubscript = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _outSubscript = omc_NFSubscript_expand(threadData, _subscript, _dimension, tmp1, &_expanded);
  /* skip box _outSubscript; NFSubscript */
  if (out_expanded) { *out_expanded = mmc_mk_icon(_expanded); }
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_scalarizeList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_boolean _resize)
{
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _dim = NULL;
  modelica_metatype _rest_dims = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _outSubscripts = tmpMeta1;
  // _dim has no default value.
  _rest_dims = _dimensions;
  // _subs has no default value.
  {
    modelica_metatype _s;
    for (tmpMeta2 = _subscripts; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _s = MMC_CAR(tmpMeta2);
      /* Pattern-matching assignment */
      tmpMeta3 = _rest_dims;
      if (listEmpty(tmpMeta3)) MMC_THROW_INTERNAL();
      tmpMeta4 = MMC_CAR(tmpMeta3);
      tmpMeta5 = MMC_CDR(tmpMeta3);
      _dim = tmpMeta4;
      _rest_dims = tmpMeta5;

      _subs = omc_NFSubscript_scalarize(threadData, _s, _dim, _resize);

      if(listEmpty(_subs))
      {
        tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
        _outSubscripts = tmpMeta6;

        goto _return;
      }
      else
      {
        tmpMeta7 = mmc_mk_cons(_subs, _outSubscripts);
        _outSubscripts = tmpMeta7;
      }
    }
  }

  {
    modelica_metatype _d;
    for (tmpMeta9 = _rest_dims; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
    {
      _d = MMC_CAR(tmpMeta9);
      _subs = omc_NFRangeIterator_map(threadData, omc_NFRangeIterator_fromDim(threadData, _d, _resize), boxvar_NFSubscript_makeIndex);

      if(listEmpty(_subs))
      {
        tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
        _outSubscripts = tmpMeta10;

        goto _return;
      }
      else
      {
        tmpMeta11 = mmc_mk_cons(_subs, _outSubscripts);
        _outSubscripts = tmpMeta11;
      }
    }
  }

  _outSubscripts = listReverse(_outSubscripts);
  _return: OMC_LABEL_UNUSED
  return _outSubscripts;
}
modelica_metatype boxptr_NFSubscript_scalarizeList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_resize);
  _outSubscripts = omc_NFSubscript_scalarizeList(threadData, _subscripts, _dimensions, tmp1);
  /* skip box _outSubscripts; list<list<NFSubscript>> */
  return _outSubscripts;
}

DLLDirection
modelica_metatype omc_NFSubscript_scalarize(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _dimension, modelica_boolean _resize)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_cons(_subscript, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar3;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype tmpMeta9;
            modelica_metatype __omcQ_24tmpVar2;
            modelica_integer tmp10;
            modelica_metatype _e_loopVar = 0;
            modelica_integer tmp11;
            modelica_metatype _e;
            _e_loopVar = omc_NFExpression_arrayElements(threadData, omc_NFExpandExp_expand(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _resize, NULL));
            tmp11 = 1;
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar3 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar3;
            while(1) {
              tmp10 = 1;
              if (tmp11 <= arrayLength(_e_loopVar)) {
                _e = arrayGet(_e_loopVar, tmp11++);
                tmp10--;
              }
              if (tmp10 == 0) {
                tmpMeta9 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _e);
                __omcQ_24tmpVar2 = tmpMeta9;
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar2,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp10 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar3;
          }
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFRangeIterator_map(threadData, omc_NFRangeIterator_fromDim(threadData, _dimension, _resize), boxvar_NFSubscript_makeIndex);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = mmc_mk_cons(_subscript, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta12;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}
modelica_metatype boxptr_NFSubscript_scalarize(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _dimension, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _subscripts = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _subscripts = omc_NFSubscript_scalarize(threadData, _subscript, _dimension, tmp1);
  /* skip box _subscripts; list<NFSubscript> */
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFSubscript_fromDimension(threadData_t *threadData, modelica_metatype _dimension)
{
  modelica_metatype _subscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _dimension;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, omc_NFExpression_makeIntegerRange(threadData, ((modelica_integer) 1), ((modelica_integer) 1), mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dimension), 2))))));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, omc_NFExpression_makeRange(threadData, _OMC_LIT3, mmc_mk_none(), _OMC_LIT5));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, omc_NFExpression_makeRange(threadData, omc_NFExpression_makeEnumLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dimension), 2))), ((modelica_integer) 1)), mmc_mk_none(), omc_NFExpression_makeEnumLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dimension), 2))), omc_NFType_enumSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dimension), 2)))))));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, omc_NFExpression_makeRange(threadData, _OMC_LIT1, mmc_mk_none(), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dimension), 2)))));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_toDimension(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _dimension = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _dimension has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFDimension_fromInteger(threadData, ((modelica_integer) 1), 1);
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = listHead(omc_NFType_arrayDims(threadData, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))))));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT6;
          goto tmp3_done;
        }
        case 10: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFDimension_fromInteger(threadData, ((modelica_integer) 1), 1);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _dimension = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _dimension;
}

DLLDirection
modelica_metatype omc_NFSubscript_simplifyList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_boolean _trim)
{
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _d = NULL;
  modelica_metatype _rest_d = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _outSubscripts = tmpMeta1;
  // _d has no default value.
  _rest_d = _dimensions;
  if(listEmpty(_dimensions))
  {
    {
      modelica_metatype __omcQ_24tmpVar5;
      modelica_metatype* tmp3;
      modelica_metatype tmpMeta4;
      modelica_metatype __omcQ_24tmpVar4;
      modelica_integer tmp5;
      modelica_metatype _s_loopVar = 0;
      modelica_metatype _s;
      _s_loopVar = _subscripts;
      tmpMeta4 = MMC_REFSTRUCTLIT(mmc_nil);
      __omcQ_24tmpVar5 = tmpMeta4; /* defaultValue */
      tmp3 = &__omcQ_24tmpVar5;
      while(1) {
        tmp5 = 1;
        if (!listEmpty(_s_loopVar)) {
          _s = MMC_CAR(_s_loopVar);
          _s_loopVar = MMC_CDR(_s_loopVar);
          tmp5--;
        }
        if (tmp5 == 0) {
          __omcQ_24tmpVar4 = omc_NFSubscript_simplify(threadData, _s, _OMC_LIT6);
          *tmp3 = mmc_mk_cons(__omcQ_24tmpVar4,0);
          tmp3 = &MMC_CDR(*tmp3);
        } else if (tmp5 == 1) {
          break;
        } else {
          MMC_THROW_INTERNAL();
        }
      }
      *tmp3 = mmc_mk_nil();
      tmpMeta2 = __omcQ_24tmpVar5;
    }
    _outSubscripts = tmpMeta2;
  }
  else
  {
    _rest_d = omc_List_lastN(threadData, _dimensions, listLength(_subscripts));

    {
      modelica_metatype _s;
      for (tmpMeta6 = _subscripts; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
      {
        _s = MMC_CAR(tmpMeta6);
        /* Pattern-matching assignment */
        tmpMeta7 = _rest_d;
        if (listEmpty(tmpMeta7)) MMC_THROW_INTERNAL();
        tmpMeta8 = MMC_CAR(tmpMeta7);
        tmpMeta9 = MMC_CDR(tmpMeta7);
        _d = tmpMeta8;
        _rest_d = tmpMeta9;

        tmpMeta10 = mmc_mk_cons(omc_NFSubscript_simplify(threadData, _s, _d), _outSubscripts);
        _outSubscripts = tmpMeta10;
      }
    }

    if(_trim)
    {
      _outSubscripts = listReverseInPlace(omc_List_trim(threadData, _outSubscripts, boxvar_NFSubscript_isWhole));
    }
    else
    {
      _outSubscripts = listReverseInPlace(_outSubscripts);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outSubscripts;
}
modelica_metatype boxptr_NFSubscript_simplifyList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _dimensions, modelica_metatype _trim)
{
  modelica_integer tmp1;
  modelica_metatype _outSubscripts = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_trim);
  _outSubscripts = omc_NFSubscript_simplifyList(threadData, _subscripts, _dimensions, tmp1);
  /* skip box _outSubscripts; list<NFSubscript> */
  return _outSubscripts;
}

DLLDirection
modelica_metatype omc_NFSubscript_simplifySlice(threadData_t *threadData, modelica_metatype _slice, modelica_metatype _dimension)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  // _exp has no default value.
  _exp = omc_NFSimplifyExp_simplify(threadData, _slice, 0 /* false */);

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _exp;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,10,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(((isNone((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 4)))) || omc_NFExpression_isOne(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 4)))))) && omc_NFDimension_expIsLowerBound(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))))) && omc_NFDimension_expIsUpperBound(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 5))), _dimension))) goto tmp3_end;
          tmpMeta1 = _OMC_LIT0;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, _exp);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_simplify(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _dimension)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, omc_NFSimplifyExp_simplify(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), 0 /* false */));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFSubscript_simplifySlice(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _dimension);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_eval(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _target)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, omc_NFCeval_evalExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _target));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, omc_NFCeval_evalExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _target));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_toJSONList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_metatype _json = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _json = omc_JSON_makeNull(threadData);
  {
    modelica_metatype _s;
    for (tmpMeta1 = _subscripts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s = MMC_CAR(tmpMeta1);
      _json = omc_JSON_addElement(threadData, omc_NFSubscript_toJSON(threadData, _s), _json);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _json;
}

DLLDirection
modelica_metatype omc_NFSubscript_toJSON(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _json = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _json has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_toJSON(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_toJSON(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_toJSON(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_JSON_makeString(threadData, omc_NFSubscript_toString(threadData, _subscript));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _json = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _json;
}

static modelica_metatype closure0_NFSubscript_toFlatString(threadData_t *thData, modelica_metatype closure, modelica_metatype subscript)
{
  modelica_metatype format = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NFSubscript_toFlatString(thData, subscript, format);
}
DLLDirection
modelica_string omc_NFSubscript_toFlatStringList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype _format)
{
  modelica_string _string = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _string has no default value.
  tmpMeta1 = mmc_mk_box1(0, _format);
  _string = omc_List_toString(threadData, _subscripts, (modelica_fnptr) mmc_mk_box2(0,closure0_NFSubscript_toFlatString,tmpMeta1), _OMC_LIT7, _OMC_LIT11, _OMC_LIT12, _OMC_LIT13, 0 /* false */, ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _string;
}

DLLDirection
modelica_string omc_NFSubscript_toFlatString(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _format)
{
  modelica_string _string = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _string has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_Dump_printSubscriptStr(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toFlatString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _format);
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toFlatString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _format);
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toFlatString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _format);
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_List_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), boxvar_NFSubscript_toString, _OMC_LIT7, _OMC_LIT14, _OMC_LIT15, _OMC_LIT16, 0 /* false */, ((modelica_integer) 0));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT17;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_string tmp7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT18,omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT15);
          tmp7 = modelica_integer_to_modelica_string(mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 3)))), ((modelica_integer) 0), 1 /* true */);
          tmpMeta8 = stringAppend(tmpMeta6,tmp7);
          tmpMeta9 = stringAppend(tmpMeta8,_OMC_LIT19);
          tmp1 = tmpMeta9;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _string = tmp1;
  _return: OMC_LABEL_UNUSED
  return _string;
}

DLLDirection
modelica_string omc_NFSubscript_toStringList(threadData_t *threadData, modelica_metatype _subscripts)
{
  modelica_string _string = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _string has no default value.
  _string = omc_List_toString(threadData, _subscripts, boxvar_NFSubscript_toString, _OMC_LIT7, _OMC_LIT11, _OMC_LIT15, _OMC_LIT13, 0 /* false */, ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _string;
}

DLLDirection
modelica_string omc_NFSubscript_toString(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_string _string = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _string has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_Dump_printSubscriptStr(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_List_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), boxvar_NFSubscript_toString, _OMC_LIT7, _OMC_LIT14, _OMC_LIT15, _OMC_LIT16, 0 /* false */, ((modelica_integer) 0));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT17;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT18,omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT15);
          tmpMeta7 = stringAppend(tmpMeta6,omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 3)))));
          tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT19);
          tmp1 = tmpMeta8;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_string tmp11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta9 = stringAppend(_OMC_LIT18,omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta10 = stringAppend(tmpMeta9,_OMC_LIT15);
          tmp11 = modelica_integer_to_modelica_string(mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 3)))), ((modelica_integer) 0), 1 /* true */);
          tmpMeta12 = stringAppend(tmpMeta10,tmp11);
          tmpMeta13 = stringAppend(tmpMeta12,_OMC_LIT19);
          tmp1 = tmpMeta13;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _string = tmp1;
  _return: OMC_LABEL_UNUSED
  return _string;
}

DLLDirection
modelica_metatype omc_NFSubscript_toDAEExp(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _daeExp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _daeExp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT20,omc_NFSubscript_toString(threadData, _subscript));
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT21);
          omc_Error_assertion(threadData, 0 /* false */, tmpMeta6, _OMC_LIT23);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _daeExp = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _daeExp;
}

DLLDirection
modelica_metatype omc_NFSubscript_toDAE(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _daeSubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _daeSubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(5, &DAE_Subscript_INDEX__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(4, &DAE_Subscript_SLICE__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT24;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = stringAppend(_OMC_LIT25,omc_NFSubscript_toString(threadData, _subscript));
          omc_Error_assertion(threadData, 0 /* false */, tmpMeta7, _OMC_LIT26);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _daeSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _daeSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_toAbsyn(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _asubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _asubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)));
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, omc_NFExpression_toAbsyn(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, omc_NFExpression_toAbsyn(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box2(4, &Absyn_Subscript_SUBSCRIPT__desc, omc_NFExpression_toAbsyn(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT27;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_assertion(threadData, 0 /* false */, _OMC_LIT28, _OMC_LIT29);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _asubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _asubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_mapFoldExpShallow(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_metatype *out_arg)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype _arg = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _exp = NULL;
      int tmp4;
      // _exp has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_boolean tmp6;
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          _exp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg);
          tmp6 = (modelica_boolean)referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp);
          if(tmp6)
          {
            tmpMeta7 = _subscript;
          }
          else
          {
            tmpMeta5 = mmc_mk_box2(4, &NFSubscript_UNTYPED__desc, _exp);
            tmpMeta7 = tmpMeta5;
          }
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          _exp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg);
          tmpMeta1 = (referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _exp));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          _exp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _arg ,&_arg);
          tmpMeta1 = (referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _exp));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_arg) { *out_arg = _arg; }
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_mapFoldExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_metatype *out_arg)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype _arg = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _exp = NULL;
      int tmp4;
      // _exp has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_boolean tmp6;
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          _exp = omc_NFExpression_mapFold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg ,&_arg);
          tmp6 = (modelica_boolean)referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp);
          if(tmp6)
          {
            tmpMeta7 = _subscript;
          }
          else
          {
            tmpMeta5 = mmc_mk_box2(4, &NFSubscript_UNTYPED__desc, _exp);
            tmpMeta7 = tmpMeta5;
          }
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          _exp = omc_NFExpression_mapFold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg ,&_arg);
          tmpMeta1 = (referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _exp));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          _exp = omc_NFExpression_mapFold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg ,&_arg);
          tmpMeta1 = (referenceEq((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), _exp)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _exp));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_arg) { *out_arg = _arg; }
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_foldExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func, modelica_metatype _arg)
{
  modelica_metatype _result = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _result has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg);
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg);
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func), _arg);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _arg;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _result = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _result;
}

DLLDirection
modelica_metatype omc_NFSubscript_mapShallowExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _e1 = NULL;
      modelica_metatype _e2 = NULL;
      int tmp4;
      // _e1 has no default value.
      // _e2 has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_boolean tmp7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta5;
          /* Pattern matching succeeded */
          _e2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _e1) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _e1);
          tmp7 = (modelica_boolean)referenceEq(_e1, _e2);
          if(tmp7)
          {
            tmpMeta8 = _subscript;
          }
          else
          {
            tmpMeta6 = mmc_mk_box2(4, &NFSubscript_UNTYPED__desc, _e2);
            tmpMeta8 = tmpMeta6;
          }
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta9;
          /* Pattern matching succeeded */
          _e2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _e1) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _e1);
          tmpMeta1 = (referenceEq(_e1, _e2)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _e2));
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta10;
          /* Pattern matching succeeded */
          _e2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _e1) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _e1);
          tmpMeta1 = (referenceEq(_e1, _e2)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _e2));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outSubscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_mapExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_metatype _outSubscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outSubscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _e1 = NULL;
      modelica_metatype _e2 = NULL;
      int tmp4;
      // _e1 has no default value.
      // _e2 has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_boolean tmp7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta5;
          /* Pattern matching succeeded */
          _e2 = omc_NFExpression_map(threadData, _e1, ((modelica_fnptr) _func));
          tmp7 = (modelica_boolean)referenceEq(_e1, _e2);
          if(tmp7)
          {
            tmpMeta8 = _subscript;
          }
          else
          {
            tmpMeta6 = mmc_mk_box2(4, &NFSubscript_UNTYPED__desc, _e2);
            tmpMeta8 = tmpMeta6;
          }
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta9;
          /* Pattern matching succeeded */
          _e2 = omc_NFExpression_map(threadData, _e1, ((modelica_fnptr) _func));
          tmpMeta1 = (referenceEq(_e1, _e2)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _e2));
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _e1 = tmpMeta10;
          /* Pattern matching succeeded */
          _e2 = omc_NFExpression_map(threadData, _e1, ((modelica_fnptr) _func));
          tmpMeta1 = (referenceEq(_e1, _e2)?_subscript:omc_NFSubscript_fromTypedExp(threadData, _e2));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _subscript;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outSubscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outSubscript;
}

DLLDirection
void omc_NFSubscript_applyExpShallow(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _subscript;
    {
      int tmp3;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((void(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((void(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp2_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((void(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((void(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp2_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((void(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((void(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp2_done;
        }
        default:
        tmp2_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
void omc_NFSubscript_applyExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _subscript;
    {
      int tmp3;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          omc_NFExpression_apply(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp2_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          omc_NFExpression_apply(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp2_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          omc_NFExpression_apply(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp2_done;
        }
        default:
        tmp2_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_boolean omc_NFSubscript_listContainsExpShallow(threadData_t *threadData, modelica_metatype _subscripts, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  {
    modelica_metatype _s;
    for (tmpMeta1 = _subscripts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s = MMC_CAR(tmpMeta1);
      if(omc_NFSubscript_containsExpShallow(threadData, _s, ((modelica_fnptr) _func)))
      {
        _res = 1 /* true */;

        goto _return;
      }
    }
  }

  _res = 0 /* false */;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_listContainsExpShallow(threadData_t *threadData, modelica_metatype _subscripts, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_listContainsExpShallow(threadData, _subscripts, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_containsExpShallow(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_containsExpShallow(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_containsExpShallow(threadData, _subscript, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_listContainsExp(threadData_t *threadData, modelica_metatype _subscripts, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  {
    modelica_metatype _s;
    for (tmpMeta1 = _subscripts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s = MMC_CAR(tmpMeta1);
      if(omc_NFSubscript_containsExp(threadData, _s, ((modelica_fnptr) _func)))
      {
        _res = 1 /* true */;

        goto _return;
      }
    }
  }

  _res = 0 /* false */;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_listContainsExp(threadData_t *threadData, modelica_metatype _subscripts, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_listContainsExp(threadData, _subscripts, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_containsExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_contains(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_contains(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_contains(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))), ((modelica_fnptr) _func));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_containsExp(threadData_t *threadData, modelica_metatype _subscript, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_containsExp(threadData, _subscript, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_integer omc_NFSubscript_compareList(threadData_t *threadData, modelica_metatype _subscripts1, modelica_metatype _subscripts2)
{
  modelica_integer _comp;
  modelica_metatype _s2 = NULL;
  modelica_metatype _rest_s2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _comp has no default value.
  // _s2 has no default value.
  _rest_s2 = _subscripts2;
  _comp = omc_Util_intCompare(threadData, listLength(_subscripts1), listLength(_subscripts2));

  if((_comp != ((modelica_integer) 0)))
  {
    goto _return;
  }

  {
    modelica_metatype _s1;
    for (tmpMeta1 = _subscripts1; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s1 = MMC_CAR(tmpMeta1);
      /* Pattern-matching assignment */
      tmpMeta2 = _rest_s2;
      if (listEmpty(tmpMeta2)) MMC_THROW_INTERNAL();
      tmpMeta3 = MMC_CAR(tmpMeta2);
      tmpMeta4 = MMC_CDR(tmpMeta2);
      _s2 = tmpMeta3;
      _rest_s2 = tmpMeta4;

      _comp = omc_NFSubscript_compare(threadData, _s1, _s2);

      if((_comp != ((modelica_integer) 0)))
      {
        goto _return;
      }
    }
  }

  _comp = ((modelica_integer) 0);
  _return: OMC_LABEL_UNUSED
  return _comp;
}
modelica_metatype boxptr_NFSubscript_compareList(threadData_t *threadData, modelica_metatype _subscripts1, modelica_metatype _subscripts2)
{
  modelica_integer _comp;
  modelica_metatype out_comp;
  _comp = omc_NFSubscript_compareList(threadData, _subscripts1, _subscripts2);
  out_comp = mmc_mk_icon(_comp);
  return out_comp;
}

DLLDirection
modelica_integer omc_NFSubscript_compare(threadData_t *threadData, modelica_metatype _subscript1, modelica_metatype _subscript2)
{
  modelica_integer _comp;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _comp has no default value.
  if(referenceEq(_subscript1, _subscript2))
  {
    _comp = ((modelica_integer) 0);

    goto _return;
  }

  _comp = omc_Util_intCompare(threadData, valueConstructor(_subscript1), valueConstructor(_subscript2));

  if((_comp != ((modelica_integer) 0)))
  {
    goto _return;
  }

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript1;
    {
      modelica_metatype _e = NULL;
      modelica_metatype _node = NULL;
      modelica_integer _index;
      int tmp4;
      // _e has no default value.
      // _node has no default value.
      // _index has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta5 = _subscript2;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta5,1,1) == 0) goto goto_2;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 2));
          _e = tmpMeta6;
          tmp1 = omc_NFExpression_compare(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), _e);
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta7 = _subscript2;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,2,1) == 0) goto goto_2;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
          _e = tmpMeta8;
          tmp1 = omc_NFExpression_compare(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), _e);
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta9 = _subscript2;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,3,1) == 0) goto goto_2;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 2));
          _e = tmpMeta10;
          tmp1 = omc_NFExpression_compare(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), _e);
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_integer tmp14;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta11 = _subscript2;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,7,2) == 0) goto goto_2;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 2));
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 3));
          tmp14 = mmc_unbox_integer(tmpMeta13);
          _node = tmpMeta12;
          _index = tmp14  /* pattern as ty=Integer */;

          _comp = omc_NFInstNode_InstNode_refCompare(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), _node);
          tmp1 = ((_comp == ((modelica_integer) 0))?omc_Util_intCompare(threadData, mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 3)))), _index):_comp);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _comp = tmp1;
  _return: OMC_LABEL_UNUSED
  return _comp;
}
modelica_metatype boxptr_NFSubscript_compare(threadData_t *threadData, modelica_metatype _subscript1, modelica_metatype _subscript2)
{
  modelica_integer _comp;
  modelica_metatype out_comp;
  _comp = omc_NFSubscript_compare(threadData, _subscript1, _subscript2);
  out_comp = mmc_mk_icon(_comp);
  return out_comp;
}

DLLDirection
modelica_boolean omc_NFSubscript_isEqualList(threadData_t *threadData, modelica_metatype _subscripts1, modelica_metatype _subscripts2)
{
  modelica_boolean _isEqual;
  modelica_metatype _s2 = NULL;
  modelica_metatype _rest = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEqual has no default value.
  // _s2 has no default value.
  _rest = _subscripts2;
  {
    modelica_metatype _s1;
    for (tmpMeta1 = _subscripts1; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _s1 = MMC_CAR(tmpMeta1);
      if(listEmpty(_rest))
      {
        _isEqual = 0 /* false */;

        goto _return;
      }

      /* Pattern-matching assignment */
      tmpMeta2 = _rest;
      if (listEmpty(tmpMeta2)) MMC_THROW_INTERNAL();
      tmpMeta3 = MMC_CAR(tmpMeta2);
      tmpMeta4 = MMC_CDR(tmpMeta2);
      _s2 = tmpMeta3;
      _rest = tmpMeta4;

      if((!omc_NFSubscript_isEqual(threadData, _s1, _s2)))
      {
        _isEqual = 0 /* false */;

        goto _return;
      }
    }
  }

  _isEqual = listEmpty(_rest);
  _return: OMC_LABEL_UNUSED
  return _isEqual;
}
modelica_metatype boxptr_NFSubscript_isEqualList(threadData_t *threadData, modelica_metatype _subscripts1, modelica_metatype _subscripts2)
{
  modelica_boolean _isEqual;
  modelica_metatype out_isEqual;
  _isEqual = omc_NFSubscript_isEqualList(threadData, _subscripts1, _subscripts2);
  out_isEqual = mmc_mk_icon(_isEqual);
  return out_isEqual;
}

DLLDirection
modelica_boolean omc_NFSubscript_isEqual(threadData_t *threadData, modelica_metatype _subscript1, modelica_metatype _subscript2)
{
  modelica_boolean _isEqual;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEqual has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _subscript1;
    tmp4_2 = _subscript2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 7; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_AbsynUtil_subscriptEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 2))));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 2))));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 2))));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,3,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 2))));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,5,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 5: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 3)))) == mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 3))))) && omc_NFInstNode_InstNode_refEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript2), 2)))));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isEqual = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isEqual;
}
modelica_metatype boxptr_NFSubscript_isEqual(threadData_t *threadData, modelica_metatype _subscript1, modelica_metatype _subscript2)
{
  modelica_boolean _isEqual;
  modelica_metatype out_isEqual;
  _isEqual = omc_NFSubscript_isEqual(threadData, _subscript1, _subscript2);
  out_isEqual = mmc_mk_icon(_isEqual);
  return out_isEqual;
}

DLLDirection
modelica_boolean omc_NFSubscript_isBackendIterator(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype _cref = NULL;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  // _cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,6,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          _cref = tmpMeta7;
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponentRef_isIterator(threadData, _cref);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isBackendIterator(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isBackendIterator(threadData, _sub);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_metatype omc_NFSubscript_toIterator(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_metatype _iterator = NULL;
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _iterator has no default value.
  // _cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,6,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          _cref = tmpMeta7;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFComponentRef_isIterator(threadData, _cref)) goto tmp3_end;
          tmpMeta1 = omc_NFComponentRef_node(threadData, _cref);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,6,2) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          _cref = tmpMeta9;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFComponentRef_isIterator(threadData, _cref)) goto tmp3_end;
          tmpMeta1 = omc_NFComponentRef_node(threadData, _cref);
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT30;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iterator = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iterator;
}

DLLDirection
modelica_boolean omc_NFSubscript_isIterator(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype _cref = NULL;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  // _cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isIterator(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isIterator(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_isIterator(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_isIterator(threadData, _sub);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_equalsIterator(threadData_t *threadData, modelica_metatype _sub, modelica_metatype _iterator)
{
  modelica_boolean _res;
  modelica_metatype _cref = NULL;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  // _cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,6,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          _cref = tmpMeta7;
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_refEqual(threadData, _iterator, omc_NFComponentRef_node(threadData, _cref));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,6,2) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          _cref = tmpMeta9;
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_refEqual(threadData, _iterator, omc_NFComponentRef_node(threadData, _cref));
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFSubscript_equalsIterator(threadData_t *threadData, modelica_metatype _sub, modelica_metatype _iterator)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFSubscript_equalsIterator(threadData, _sub, _iterator);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFSubscript_isScalarLiteral(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isScalarLiteral;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isScalarLiteral has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isScalarLiteral(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isScalarLiteral = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isScalarLiteral;
}
modelica_metatype boxptr_NFSubscript_isScalarLiteral(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isScalarLiteral;
  modelica_metatype out_isScalarLiteral;
  _isScalarLiteral = omc_NFSubscript_isScalarLiteral(threadData, _sub);
  out_isScalarLiteral = mmc_mk_icon(_isScalarLiteral);
  return out_isScalarLiteral;
}

DLLDirection
modelica_boolean omc_NFSubscript_isScalar(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isScalar;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isScalar has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      modelica_metatype _ty = NULL;
      int tmp4;
      // _ty has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          
          /* Pattern matching succeeded */
          _ty = omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_sub), 2))));
          tmp1 = omc_NFSubscript_isValidIndexType(threadData, _ty);
          goto tmp3_done;
        }
        case 10: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isScalar = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isScalar;
}
modelica_metatype boxptr_NFSubscript_isScalar(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isScalar;
  modelica_metatype out_isScalar;
  _isScalar = omc_NFSubscript_isScalar(threadData, _sub);
  out_isScalar = mmc_mk_icon(_isScalar);
  return out_isScalar;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSliced(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _sliced;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sliced has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sliced = tmp1;
  _return: OMC_LABEL_UNUSED
  return _sliced;
}
modelica_metatype boxptr_NFSubscript_isSliced(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _sliced;
  modelica_metatype out_sliced;
  _sliced = omc_NFSubscript_isSliced(threadData, _sub);
  out_sliced = mmc_mk_icon(_sliced);
  return out_sliced;
}

DLLDirection
modelica_boolean omc_NFSubscript_isSimple(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isSimple;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _isSimple = (omc_NFSubscript_isIndex(threadData, _sub) || omc_NFSubscript_isWhole(threadData, _sub));
  _return: OMC_LABEL_UNUSED
  return _isSimple;
}
modelica_metatype boxptr_NFSubscript_isSimple(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isSimple;
  modelica_metatype out_isSimple;
  _isSimple = omc_NFSubscript_isSimple(threadData, _sub);
  out_isSimple = mmc_mk_icon(_isSimple);
  return out_isSimple;
}

DLLDirection
modelica_boolean omc_NFSubscript_isWhole(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isWhole;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isWhole has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isWhole = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isWhole;
}
modelica_metatype boxptr_NFSubscript_isWhole(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isWhole;
  modelica_metatype out_isWhole;
  _isWhole = omc_NFSubscript_isWhole(threadData, _sub);
  out_isWhole = mmc_mk_icon(_isWhole);
  return out_isWhole;
}

DLLDirection
modelica_boolean omc_NFSubscript_isIndex(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isIndex;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isIndex has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _sub;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isIndex = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isIndex;
}
modelica_metatype boxptr_NFSubscript_isIndex(threadData_t *threadData, modelica_metatype _sub)
{
  modelica_boolean _isIndex;
  modelica_metatype out_isIndex;
  _isIndex = omc_NFSubscript_isIndex(threadData, _sub);
  out_isIndex = mmc_mk_icon(_isIndex);
  return out_isIndex;
}

DLLDirection
modelica_metatype omc_NFSubscript_makeSplitIndex(threadData_t *threadData, modelica_metatype _node, modelica_integer _dimIndex)
{
  modelica_metatype _subscript = NULL;
  modelica_metatype tmpMeta1;
  modelica_string tmp2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = mmc_mk_box3(10, &NFSubscript_SPLIT__INDEX__desc, _node, mmc_mk_integer(_dimIndex));
  _subscript = tmpMeta1;
  if((_dimIndex < ((modelica_integer) 1)))
  {
    tmp2 = modelica_integer_to_modelica_string(_dimIndex, ((modelica_integer) 0), 1 /* true */);
    tmpMeta3 = stringAppend(_OMC_LIT31,tmp2);
    omc_Error_assertion(threadData, 0 /* false */, tmpMeta3, _OMC_LIT32);
  }
  _return: OMC_LABEL_UNUSED
  return _subscript;
}
modelica_metatype boxptr_NFSubscript_makeSplitIndex(threadData_t *threadData, modelica_metatype _node, modelica_metatype _dimIndex)
{
  modelica_integer tmp1;
  modelica_metatype _subscript = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_dimIndex);
  _subscript = omc_NFSubscript_makeSplitIndex(threadData, _node, tmp1);
  /* skip box _subscript; NFSubscript */
  return _subscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_makeIndex(threadData_t *threadData, modelica_metatype _exp)
{
  modelica_metatype _subscript = NULL;
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscript has no default value.
  // _ty has no default value.
  _ty = omc_NFExpression_typeOf(threadData, _exp);

  if(omc_NFSubscript_isValidIndexType(threadData, _ty))
  {
    tmpMeta1 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _exp);
    _subscript = tmpMeta1;
  }
  else
  {
    omc_Error_assertion(threadData, 0 /* false */, _OMC_LIT33, _OMC_LIT34);

    MMC_THROW_INTERNAL();
  }
  _return: OMC_LABEL_UNUSED
  return _subscript;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFSubscript_isValidIndexType(threadData_t *threadData, modelica_metatype _ty)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = ((omc_NFType_isInteger(threadData, _ty) || omc_NFType_isBoolean(threadData, _ty)) || omc_NFType_isEnumeration(threadData, _ty));
  _return: OMC_LABEL_UNUSED
  return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFSubscript_isValidIndexType(threadData_t *threadData, modelica_metatype _ty)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFSubscript_isValidIndexType(threadData, _ty);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NFSubscript_toIndexList(threadData_t *threadData, modelica_metatype _subscript, modelica_integer _length, modelica_boolean _baseZero)
{
  modelica_metatype _indices = NULL;
  modelica_integer _shift;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _indices has no default value.
  _shift = (_baseZero?((modelica_integer) 1):((modelica_integer) 0));
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      modelica_metatype _elems = NULL;
      modelica_integer _start;
      modelica_integer _step;
      modelica_integer _stop;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _elems has no default value.
      // _start has no default value.
      // _step has no default value.
      // _stop has no default value.
      tmp4 = 0;
      for (; tmp4 < 6; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_cons(mmc_mk_integer(omc_NFSubscript_toInteger(threadData, _subscript) - _shift), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_List_intRange2(threadData, ((modelica_integer) 1) - _shift, _length - _shift);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,8,3) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 3));
          
          _elems = tmpMeta8;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar7;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_metatype __omcQ_24tmpVar6;
            modelica_integer tmp12;
            modelica_metatype _e_loopVar = 0;
            modelica_integer tmp13;
            modelica_metatype _e;
            _e_loopVar = _elems;
            tmp13 = 1;
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar7 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar7;
            while(1) {
              tmp12 = 1;
              if (tmp13 <= arrayLength(_e_loopVar)) {
                _e = arrayGet(_e_loopVar, tmp13++);
                tmp12--;
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar6 = mmc_mk_integer(omc_NFExpression_toInteger(threadData, _e));
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar6,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar7;
          }
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_integer tmp17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_integer tmp21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_integer tmp24;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,10,4) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta15,0,1) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta15), 2));
          tmp17 = mmc_unbox_integer(tmpMeta16);
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 4));
          if (optionNone(tmpMeta18)) goto tmp3_end;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta18), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta19,0,1) == 0) goto tmp3_end;
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta19), 2));
          tmp21 = mmc_unbox_integer(tmpMeta20);
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta22,0,1) == 0) goto tmp3_end;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta22), 2));
          tmp24 = mmc_unbox_integer(tmpMeta23);
          _start = tmp17  /* pattern as ty=Integer */;
          _step = tmp21  /* pattern as ty=Integer */;
          _stop = tmp24  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_List_intRange3(threadData, _start - _shift, _step, _stop - _shift);
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_integer tmp28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_integer tmp32;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,1) == 0) goto tmp3_end;
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta25,10,4) == 0) goto tmp3_end;
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta25), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta26,0,1) == 0) goto tmp3_end;
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta26), 2));
          tmp28 = mmc_unbox_integer(tmpMeta27);
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta25), 4));
          if (!optionNone(tmpMeta29)) goto tmp3_end;
          tmpMeta30 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta25), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta30,0,1) == 0) goto tmp3_end;
          tmpMeta31 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta30), 2));
          tmp32 = mmc_unbox_integer(tmpMeta31);
          _start = tmp28  /* pattern as ty=Integer */;
          _stop = tmp32  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_List_intRange2(threadData, _start - _shift, _stop - _shift);
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          
          /* Pattern matching succeeded */
          tmpMeta33 = stringAppend(_OMC_LIT35,omc_NFSubscript_toString(threadData, _subscript));
          tmpMeta34 = stringAppend(tmpMeta33,_OMC_LIT36);
          omc_Error_assertion(threadData, 0 /* false */, tmpMeta34, _OMC_LIT37);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _indices = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _indices;
}
modelica_metatype boxptr_NFSubscript_toIndexList(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype _length, modelica_metatype _baseZero)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _indices = NULL;
  tmp1 = mmc_unbox_integer(_length);
  tmp2 = mmc_unbox_integer(_baseZero);
  _indices = omc_NFSubscript_toIndexList(threadData, _subscript, tmp1, tmp2);
  /* skip box _indices; list<#Integer> */
  return _indices;
}

DLLDirection
modelica_metatype omc_NFSubscript_toIntegerOpt(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _int = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _int has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = mmc_mk_some(mmc_mk_integer(omc_NFExpression_toInteger(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = mmc_mk_none();
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _int = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _int;
}

DLLDirection
modelica_integer omc_NFSubscript_toInteger(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _int;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _int has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 1; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_toInteger(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2))));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _int = tmp1;
  _return: OMC_LABEL_UNUSED
  return _int;
}
modelica_metatype boxptr_NFSubscript_toInteger(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_integer _int;
  modelica_metatype out_int;
  _int = omc_NFSubscript_toInteger(threadData, _subscript);
  out_int = mmc_mk_icon(_int);
  return out_int;
}

DLLDirection
modelica_metatype omc_NFSubscript_toExp(threadData_t *threadData, modelica_metatype _subscript)
{
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _exp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _subscript;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_subscript), 2)));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_metatype omc_NFSubscript_fromTypedExp(threadData_t *threadData, modelica_metatype _exp)
{
  modelica_metatype _subscript = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_boolean tmp3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscript has no default value.
  tmp3 = (modelica_boolean)omc_NFType_isArray(threadData, omc_NFExpression_typeOf(threadData, _exp));
  if(tmp3)
  {
    tmpMeta1 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, _exp);
    tmpMeta4 = tmpMeta1;
  }
  else
  {
    tmpMeta2 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _exp);
    tmpMeta4 = tmpMeta2;
  }
  _subscript = tmpMeta4;
  _return: OMC_LABEL_UNUSED
  return _subscript;
}

DLLDirection
modelica_metatype omc_NFSubscript_fromExp(threadData_t *threadData, modelica_metatype _exp)
{
  modelica_metatype _subscript = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscript has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _exp;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _exp);
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _exp);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _exp);
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box2(4, &NFSubscript_UNTYPED__desc, _exp);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscript = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscript;
}

