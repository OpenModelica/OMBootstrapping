#include "omc_simulation_settings.h"
#include "NFSCodeFlattenRedeclare.h"
#define _OMC_LIT0_data "pushing: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,9,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data " redeclare: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,12,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "\n	"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,2,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
#define _OMC_LIT3_data "into baseclases: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT3,17,_OMC_LIT3_data);
#define _OMC_LIT3 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT3)
#define _OMC_LIT4_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT4,1,_OMC_LIT4_data);
#define _OMC_LIT4 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,2,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "called from env: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,17,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,1,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
#define _OMC_LIT8_data "-----------------\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT8,18,_OMC_LIT8_data);
#define _OMC_LIT8 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "tracePushRedeclareIntoExtends failed on element: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,49,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
#define _OMC_LIT10_data "replacing element: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT10,19,_OMC_LIT10_data);
#define _OMC_LIT10 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data " env: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,6,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "Old Element:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,12,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "New Element:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,12,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "\n===============\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,17,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data "traceReplaceElementInScope failed on element: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,46,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data "Internal error %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,17,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT19,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT18}};
#define _OMC_LIT19 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(63)),_OMC_LIT16,_OMC_LIT17,_OMC_LIT19}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "NFSCodeFlattenRedeclare.propagateAttributes failed on unknown item."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,67,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,2,1) {_OMC_LIT21,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "NFSCodeFlattenRedeclare.pushRedeclareIntoExtends2 couldn't find the base classes {"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,82,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "} for "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,6,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "Modified element %s not found in class %s."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,42,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT25}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(214)),_OMC_LIT16,_OMC_LIT17,_OMC_LIT26}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "failtrace"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,9,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
#define _OMC_LIT29_data "Sets whether to print a failtrace or not."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT29,41,_OMC_LIT29_data);
#define _OMC_LIT29 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT29}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT31,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT28,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT30}};
#define _OMC_LIT31 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT31)
#define _OMC_LIT32_data "- NFSCodeFlattenRedeclare.replaceRedeclaredElementsInEnv failed for:\n	"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT32,70,_OMC_LIT32_data);
#define _OMC_LIT32 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data "redeclares: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,12,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
#define _OMC_LIT34_data "\n---------\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT34,11,_OMC_LIT34_data);
#define _OMC_LIT34 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "\n	item: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,8,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "\n	in scope:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,11,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT37,2,3) {&NFInstPrefix_Prefix_EMPTY__PREFIX__desc,MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT37 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT37)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT38,1,3) {&NFSCodeEnv_ClassType_USERDEFINED__desc,}};
#define _OMC_LIT38 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT38)
#define _OMC_LIT39_data "- NFSCodeFlattenRedeclare.processRedeclare failed on "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT39,53,_OMC_LIT39_data);
#define _OMC_LIT39 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,10,3) {&SCodeDump_SCodeDumpOptions_OPTIONS__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data " in "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,4,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
#define _OMC_LIT42_data "Illegal redeclare of element %s, no inherited element with that name exists."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT42,76,_OMC_LIT42_data);
#define _OMC_LIT42 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT42)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT43,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT42}};
#define _OMC_LIT43 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(228)),_OMC_LIT16,_OMC_LIT17,_OMC_LIT43}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
#define _OMC_LIT45_data "- NFSCodeFlattenRedeclare.addElementRedeclarationsToEnv failed for "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT45,67,_OMC_LIT45_data);
#define _OMC_LIT45 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT45)
#include "util/modelica.h"

#include "NFSCodeFlattenRedeclare_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC void omc_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inEnv, modelica_metatype _inEtNew, modelica_metatype _inEtOld);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends,0}};
#define boxvar_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends)
PROTECTED_FUNCTION_STATIC void omc_NFSCodeFlattenRedeclare_traceReplaceElementInScope(threadData_t *threadData, modelica_string _inElementName, modelica_metatype _inOldItem, modelica_metatype _inNewItem, modelica_metatype _inEnv);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_traceReplaceElementInScope,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_traceReplaceElementInScope,0}};
#define boxvar_NFSCodeFlattenRedeclare_traceReplaceElementInScope MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_traceReplaceElementInScope)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateIsField(threadData_t *threadData, modelica_metatype _inOriginalIsField, modelica_metatype _inNewIsField);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateIsField,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateIsField,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateIsField MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateIsField)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateDirection(threadData_t *threadData, modelica_metatype _inOriginalDirection, modelica_metatype _inNewDirection);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateDirection,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateDirection,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateDirection MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateDirection)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateVariability(threadData_t *threadData, modelica_metatype _inOriginalVariability, modelica_metatype _inNewVariability);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateVariability,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateVariability,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateVariability MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateVariability)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateParallelism(threadData_t *threadData, modelica_metatype _inOriginalParallelism, modelica_metatype _inNewParallelism);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateParallelism,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateParallelism,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateParallelism MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateParallelism)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateConnectorType(threadData_t *threadData, modelica_metatype _inOriginalConnectorType, modelica_metatype _inNewConnectorType);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateConnectorType,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateConnectorType,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateConnectorType MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateConnectorType)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateArrayDimensions(threadData_t *threadData, modelica_metatype _inOriginalDims, modelica_metatype _inNewDims);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateArrayDimensions,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateArrayDimensions,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateArrayDimensions MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateArrayDimensions)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateAttributes(threadData_t *threadData, modelica_metatype _inOriginalAttributes, modelica_metatype _inNewAttributes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateAttributes,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateAttributes,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateAttributes MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateAttributes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter(threadData_t *threadData, modelica_metatype _inOriginalIO, modelica_metatype _inIO);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagatePrefixes(threadData_t *threadData, modelica_metatype _inOriginalPrefixes, modelica_metatype _inNewPrefixes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagatePrefixes,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagatePrefixes,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagatePrefixes MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagatePrefixes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateItemPrefixes(threadData_t *threadData, modelica_metatype _inOriginalItem, modelica_metatype _inNewItem);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateItemPrefixes,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_propagateItemPrefixes,0}};
#define boxvar_NFSCodeFlattenRedeclare_propagateItemPrefixes MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_propagateItemPrefixes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_string _inName, modelica_metatype _inRedeclares, modelica_metatype _inOutRedeclares);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3,0}};
#define boxvar_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3 MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inExtends);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2,0}};
#define boxvar_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2 MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inEnv);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends,0}};
#define boxvar_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inEnv);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail,0}};
#define boxvar_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_metatype _inEnv);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv,0}};
#define boxvar_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod(threadData_t *threadData, modelica_metatype _inMod, modelica_metatype _inRedeclares);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod,0}};
#define boxvar_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2(threadData_t *threadData, modelica_metatype _inRedeclaredElement, modelica_metatype _inBaseClasses, modelica_metatype _inExtends);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2,0}};
#define boxvar_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2 MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable(threadData_t *threadData, modelica_metatype _inRedeclaredElement, modelica_metatype _inBaseClasses, modelica_metatype _inEnv, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable,0}};
#define boxvar_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_lookupElementRedeclaration(threadData_t *threadData, modelica_string _inName, modelica_metatype _inEnv, modelica_metatype _inInfo);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_lookupElementRedeclaration,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_lookupElementRedeclaration,0}};
#define boxvar_NFSCodeFlattenRedeclare_lookupElementRedeclaration MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_lookupElementRedeclaration)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_metatype _inEnv);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2,2,0) {(void*) boxptr_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2,0}};
#define boxvar_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2 MMC_REFSTRUCTLIT(boxvar_lit_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2)

PROTECTED_FUNCTION_STATIC void omc_NFSCodeFlattenRedeclare_tracePushRedeclareIntoExtends(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inEnv, modelica_metatype _inEtNew, modelica_metatype _inEtOld)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT0,_inName);
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT1);
          tmpMeta7 = stringAppend(tmpMeta6,omc_NFSCodeEnv_itemStr(threadData, _inRedeclare));
          tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta8),stdout);

          {
            modelica_metatype __omcQ_24tmpVar1;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_string __omcQ_24tmpVar0;
            modelica_integer tmp12;
            modelica_metatype _p_loopVar = 0;
            modelica_metatype _p;
            _p_loopVar = _inBaseClasses;
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar1 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar1;
            while(1) {
              tmp12 = 1;
              if (!listEmpty(_p_loopVar)) {
                _p = MMC_CAR(_p_loopVar);
                _p_loopVar = MMC_CDR(_p_loopVar);
                tmp12--;
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar0 = omc_AbsynUtil_pathString(threadData, _p, _OMC_LIT4, 1 /* true */, 0 /* false */);
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar0,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_1;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar1;
          }
          tmpMeta13 = stringAppend(_OMC_LIT3,stringDelimitList(tmpMeta9, _OMC_LIT5));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta14),stdout);

          tmpMeta15 = stringAppend(_OMC_LIT6,omc_NFSCodeEnv_getEnvName(threadData, _inEnv));
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT7);
          fputs(MMC_STRINGDATA(tmpMeta16),stdout);

          fputs(MMC_STRINGDATA(_OMC_LIT8),stdout);
          goto tmp2_done;
        }
        case 1: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          /* Pattern matching succeeded */
          tmpMeta17 = stringAppend(_OMC_LIT9,_inName);
          tmpMeta18 = stringAppend(tmpMeta17,_OMC_LIT7);
          fputs(MMC_STRINGDATA(tmpMeta18),stdout);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

PROTECTED_FUNCTION_STATIC void omc_NFSCodeFlattenRedeclare_traceReplaceElementInScope(threadData_t *threadData, modelica_string _inElementName, modelica_metatype _inOldItem, modelica_metatype _inNewItem, modelica_metatype _inEnv)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT10,_inElementName);
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT11);
          tmpMeta7 = stringAppend(tmpMeta6,omc_NFSCodeEnv_getEnvName(threadData, _inEnv));
          tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta8),stdout);

          tmpMeta9 = stringAppend(_OMC_LIT12,omc_NFSCodeEnv_itemStr(threadData, _inOldItem));
          tmpMeta10 = stringAppend(tmpMeta9,_OMC_LIT11);
          tmpMeta11 = stringAppend(tmpMeta10,omc_NFSCodeEnv_getEnvName(threadData, omc_NFSCodeEnv_getItemEnvNoFail(threadData, _inOldItem)));
          tmpMeta12 = stringAppend(tmpMeta11,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta12),stdout);

          tmpMeta13 = stringAppend(_OMC_LIT13,omc_NFSCodeEnv_itemStr(threadData, _inNewItem));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT11);
          tmpMeta15 = stringAppend(tmpMeta14,omc_NFSCodeEnv_getEnvName(threadData, omc_NFSCodeEnv_getItemEnvNoFail(threadData, _inNewItem)));
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT14);
          fputs(MMC_STRINGDATA(tmpMeta16),stdout);
          goto tmp2_done;
        }
        case 1: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          /* Pattern matching succeeded */
          tmpMeta17 = stringAppend(_OMC_LIT15,_inElementName);
          tmpMeta18 = stringAppend(tmpMeta17,_OMC_LIT7);
          fputs(MMC_STRINGDATA(tmpMeta18),stdout);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateIsField(threadData_t *threadData, modelica_metatype _inOriginalIsField, modelica_metatype _inNewIsField)
{
  modelica_metatype _outNewIsField = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewIsField has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewIsField;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalIsField;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewIsField;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewIsField = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewIsField;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateDirection(threadData_t *threadData, modelica_metatype _inOriginalDirection, modelica_metatype _inNewDirection)
{
  modelica_metatype _outNewDirection = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewDirection has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewDirection;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalDirection;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewDirection;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewDirection = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewDirection;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateVariability(threadData_t *threadData, modelica_metatype _inOriginalVariability, modelica_metatype _inNewVariability)
{
  modelica_metatype _outNewVariability = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewVariability has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewVariability;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalVariability;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewVariability;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewVariability = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewVariability;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateParallelism(threadData_t *threadData, modelica_metatype _inOriginalParallelism, modelica_metatype _inNewParallelism)
{
  modelica_metatype _outNewParallelism = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewParallelism has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewParallelism;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalParallelism;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewParallelism;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewParallelism = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewParallelism;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateConnectorType(threadData_t *threadData, modelica_metatype _inOriginalConnectorType, modelica_metatype _inNewConnectorType)
{
  modelica_metatype _outNewConnectorType = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewConnectorType has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewConnectorType;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalConnectorType;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewConnectorType;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewConnectorType = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewConnectorType;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateArrayDimensions(threadData_t *threadData, modelica_metatype _inOriginalDims, modelica_metatype _inNewDims)
{
  modelica_metatype _outNewDims = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewDims has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inNewDims;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalDims;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewDims;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewDims = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewDims;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateAttributes(threadData_t *threadData, modelica_metatype _inOriginalAttributes, modelica_metatype _inNewAttributes)
{
  modelica_metatype _outNewAttributes = NULL;
  modelica_metatype _dims1 = NULL;
  modelica_metatype _dims2 = NULL;
  modelica_metatype _ct1 = NULL;
  modelica_metatype _ct2 = NULL;
  modelica_metatype _prl1 = NULL;
  modelica_metatype _prl2 = NULL;
  modelica_metatype _var1 = NULL;
  modelica_metatype _var2 = NULL;
  modelica_metatype _dir1 = NULL;
  modelica_metatype _dir2 = NULL;
  modelica_metatype _isf1 = NULL;
  modelica_metatype _isf2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewAttributes has no default value.
  // _dims1 has no default value.
  // _dims2 has no default value.
  // _ct1 has no default value.
  // _ct2 has no default value.
  // _prl1 has no default value.
  // _prl2 has no default value.
  // _var1 has no default value.
  // _var2 has no default value.
  // _dir1 has no default value.
  // _dir2 has no default value.
  // _isf1 has no default value.
  // _isf2 has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inOriginalAttributes;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 5));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 6));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 7));
  _dims1 = tmpMeta2;
  _ct1 = tmpMeta3;
  _prl1 = tmpMeta4;
  _var1 = tmpMeta5;
  _dir1 = tmpMeta6;
  _isf1 = tmpMeta7;

  /* Pattern-matching assignment */
  tmpMeta8 = _inNewAttributes;
  tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
  tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 4));
  tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 5));
  tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 6));
  tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 7));
  _dims2 = tmpMeta9;
  _ct2 = tmpMeta10;
  _prl2 = tmpMeta11;
  _var2 = tmpMeta12;
  _dir2 = tmpMeta13;
  _isf2 = tmpMeta14;

  _dims2 = omc_NFSCodeFlattenRedeclare_propagateArrayDimensions(threadData, _dims1, _dims2);

  _ct2 = omc_NFSCodeFlattenRedeclare_propagateConnectorType(threadData, _ct1, _ct2);

  _prl2 = omc_NFSCodeFlattenRedeclare_propagateParallelism(threadData, _prl1, _prl2);

  _var2 = omc_NFSCodeFlattenRedeclare_propagateVariability(threadData, _var1, _var2);

  _dir2 = omc_NFSCodeFlattenRedeclare_propagateDirection(threadData, _dir1, _dir2);

  _isf2 = omc_NFSCodeFlattenRedeclare_propagateIsField(threadData, _isf1, _isf2);

  tmpMeta15 = mmc_mk_box7(3, &SCode_Attributes_ATTR__desc, _dims2, _ct2, _prl2, _var2, _dir2, _isf2);
  _outNewAttributes = tmpMeta15;
  _return: OMC_LABEL_UNUSED
  return _outNewAttributes;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter(threadData_t *threadData, modelica_metatype _inOriginalIO, modelica_metatype _inIO)
{
  modelica_metatype _outIO = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outIO has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inIO;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _inOriginalIO;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inIO;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outIO = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outIO;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagatePrefixes(threadData_t *threadData, modelica_metatype _inOriginalPrefixes, modelica_metatype _inNewPrefixes)
{
  modelica_metatype _outNewPrefixes = NULL;
  modelica_metatype _vis1 = NULL;
  modelica_metatype _vis2 = NULL;
  modelica_metatype _io1 = NULL;
  modelica_metatype _io2 = NULL;
  modelica_metatype _rdp = NULL;
  modelica_metatype _fp = NULL;
  modelica_metatype _rpp = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewPrefixes has no default value.
  // _vis1 has no default value.
  // _vis2 has no default value.
  // _io1 has no default value.
  // _io2 has no default value.
  // _rdp has no default value.
  // _fp has no default value.
  // _rpp has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inOriginalPrefixes;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 5));
  _vis1 = tmpMeta2;
  _io1 = tmpMeta3;

  /* Pattern-matching assignment */
  tmpMeta4 = _inNewPrefixes;
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 2));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 3));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 4));
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 5));
  tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 6));
  _vis2 = tmpMeta5;
  _rdp = tmpMeta6;
  _fp = tmpMeta7;
  _io2 = tmpMeta8;
  _rpp = tmpMeta9;

  _io2 = omc_NFSCodeFlattenRedeclare_propagatePrefixInnerOuter(threadData, _io1, _io2);

  tmpMeta10 = mmc_mk_box6(3, &SCode_Prefixes_PREFIXES__desc, _vis2, _rdp, _fp, _io2, _rpp);
  _outNewPrefixes = tmpMeta10;
  _return: OMC_LABEL_UNUSED
  return _outNewPrefixes;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_propagateAttributesClass(threadData_t *threadData, modelica_metatype _inOriginalClass, modelica_metatype _inNewClass)
{
  modelica_metatype _outNewClass = NULL;
  modelica_string _name = NULL;
  modelica_metatype _pref1 = NULL;
  modelica_metatype _pref2 = NULL;
  modelica_metatype _ep = NULL;
  modelica_metatype _pp = NULL;
  modelica_metatype _res = NULL;
  modelica_metatype _cdef = NULL;
  modelica_metatype _info = NULL;
  modelica_metatype _cmt = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewClass has no default value.
  // _name has no default value.
  // _pref1 has no default value.
  // _pref2 has no default value.
  // _ep has no default value.
  // _pp has no default value.
  // _res has no default value.
  // _cdef has no default value.
  // _info has no default value.
  // _cmt has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inOriginalClass;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,2,8) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  _pref1 = tmpMeta2;

  /* Pattern-matching assignment */
  tmpMeta3 = _inNewClass;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta3,2,8) == 0) MMC_THROW_INTERNAL();
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 2));
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 3));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 4));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 5));
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 6));
  tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 7));
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 8));
  tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 9));
  _name = tmpMeta4;
  _pref2 = tmpMeta5;
  _ep = tmpMeta6;
  _pp = tmpMeta7;
  _res = tmpMeta8;
  _cdef = tmpMeta9;
  _cmt = tmpMeta10;
  _info = tmpMeta11;

  _pref2 = omc_NFSCodeFlattenRedeclare_propagatePrefixes(threadData, _pref1, _pref2);

  tmpMeta12 = mmc_mk_box9(5, &SCode_Element_CLASS__desc, _name, _pref2, _ep, _pp, _res, _cdef, _cmt, _info);
  _outNewClass = tmpMeta12;
  _return: OMC_LABEL_UNUSED
  return _outNewClass;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_propagateAttributesVar(threadData_t *threadData, modelica_metatype _inOriginalVar, modelica_metatype _inNewVar)
{
  modelica_metatype _outNewVar = NULL;
  modelica_string _name = NULL;
  modelica_metatype _pref1 = NULL;
  modelica_metatype _pref2 = NULL;
  modelica_metatype _attr1 = NULL;
  modelica_metatype _attr2 = NULL;
  modelica_metatype _ty = NULL;
  modelica_metatype _mod = NULL;
  modelica_metatype _cmt = NULL;
  modelica_metatype _cond = NULL;
  modelica_metatype _info = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewVar has no default value.
  // _name has no default value.
  // _pref1 has no default value.
  // _pref2 has no default value.
  // _attr1 has no default value.
  // _attr2 has no default value.
  // _ty has no default value.
  // _mod has no default value.
  // _cmt has no default value.
  // _cond has no default value.
  // _info has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inOriginalVar;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,3,8) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  _pref1 = tmpMeta2;
  _attr1 = tmpMeta3;

  /* Pattern-matching assignment */
  tmpMeta4 = _inNewVar;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta4,3,8) == 0) MMC_THROW_INTERNAL();
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 2));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 3));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 4));
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 5));
  tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 6));
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 7));
  tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 8));
  tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 9));
  _name = tmpMeta5;
  _pref2 = tmpMeta6;
  _attr2 = tmpMeta7;
  _ty = tmpMeta8;
  _mod = tmpMeta9;
  _cmt = tmpMeta10;
  _cond = tmpMeta11;
  _info = tmpMeta12;

  _pref2 = omc_NFSCodeFlattenRedeclare_propagatePrefixes(threadData, _pref1, _pref2);

  _attr2 = omc_NFSCodeFlattenRedeclare_propagateAttributes(threadData, _attr1, _attr2);

  tmpMeta13 = mmc_mk_box9(6, &SCode_Element_COMPONENT__desc, _name, _pref2, _attr2, _ty, _mod, _cmt, _cond, _info);
  _outNewVar = tmpMeta13;
  _return: OMC_LABEL_UNUSED
  return _outNewVar;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_propagateItemPrefixes(threadData_t *threadData, modelica_metatype _inOriginalItem, modelica_metatype _inNewItem)
{
  modelica_metatype _outNewItem = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outNewItem has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _inOriginalItem;
    tmp4_2 = _inNewItem;
    {
      modelica_metatype _el1 = NULL;
      modelica_metatype _el2 = NULL;
      modelica_metatype _iu2 = NULL;
      modelica_metatype _env1 = NULL;
      modelica_metatype _env2 = NULL;
      modelica_metatype _ty2 = NULL;
      modelica_metatype _item = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _el1 has no default value.
      // _el2 has no default value.
      // _iu2 has no default value.
      // _env1 has no default value.
      // _env2 has no default value.
      // _ty2 has no default value.
      // _item has no default value.
      tmp4 = 0;
      for (; tmp4 < 7; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          _el1 = tmpMeta6;
          _el2 = tmpMeta7;
          _iu2 = tmpMeta8;
          /* Pattern matching succeeded */
          _el2 = omc_NFSCodeFlattenRedeclare_propagateAttributesVar(threadData, _el1, _el2);
          tmpMeta9 = mmc_mk_box3(3, &NFSCodeEnv_Item_VAR__desc, _el2, _iu2);
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          _el1 = tmpMeta10;
          _el2 = tmpMeta11;
          _env2 = tmpMeta12;
          _ty2 = tmpMeta13;
          /* Pattern matching succeeded */
          _el2 = omc_NFSCodeFlattenRedeclare_propagateAttributesClass(threadData, _el1, _el2);
          tmpMeta14 = mmc_mk_box4(4, &NFSCodeEnv_Item_CLASS__desc, _el2, _env2, _ty2);
          tmpMeta1 = tmpMeta14;
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewItem;
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inNewItem;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta15;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _item = tmpMeta15;
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _inOriginalItem = _item;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,3,2) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          
          _item = tmpMeta16;
          _env1 = tmpMeta17;
          /* Pattern matching succeeded */
          _item = omc_NFSCodeFlattenRedeclare_propagateItemPrefixes(threadData, _inOriginalItem, _item);
          tmpMeta18 = mmc_mk_box3(6, &NFSCodeEnv_Item_REDECLARED__ITEM__desc, _item, _env1);
          tmpMeta1 = tmpMeta18;
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT20, _OMC_LIT22);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outNewItem = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outNewItem;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_replaceElementInScope(threadData_t *threadData, modelica_string _inElementName, modelica_metatype _inElement, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inEnv;
    {
      modelica_metatype _tree = NULL;
      modelica_metatype _old_item = NULL;
      modelica_metatype _new_item = NULL;
      modelica_metatype _env = NULL;
      modelica_metatype _repl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _tree has no default value.
      // _old_item has no default value.
      // _new_item has no default value.
      // _env has no default value.
      // _repl has no default value.
      tmp4 = 0;
      for (; tmp4 < 1; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          if (listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_CAR(tmpMeta6);
          tmpMeta8 = MMC_CDR(tmpMeta6);
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 4));
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _env = tmpMeta6;
          _tree = tmpMeta9;
          _repl = tmpMeta10;
          /* Pattern matching succeeded */
          _old_item = omc_NFSCodeEnv_EnvTree_get(threadData, _tree, _inElementName);

          _new_item = omc_NFSCodeFlattenRedeclare_propagateItemPrefixes(threadData, _old_item, _inElement);

          _new_item = omc_NFSCodeEnv_linkItemUsage(threadData, _old_item, _new_item);

          _tree = omc_NFSCodeEnv_EnvTree_add(threadData, _tree, _inElementName, _new_item, boxvar_NFSCodeEnv_EnvTree_addConflictReplace);

          _env = omc_NFSCodeEnv_setEnvClsAndVars(threadData, _tree, _env);

          tmpMeta12 = mmc_mk_box5(3, &NFSCodeFlattenRedeclare_Replacement_REPLACED__desc, _inElementName, _old_item, _new_item, _env);
          tmpMeta11 = mmc_mk_cons(tmpMeta12, _repl);
          _repl = tmpMeta11;
          tmpMeta13 = mmc_mk_box2(0, _env, _repl);
          tmpMeta1 = tmpMeta13;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outEnv = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_string _inName, modelica_metatype _inRedeclares, modelica_metatype _inOutRedeclares)
{
  modelica_metatype _outRedeclares = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outRedeclares has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inRedeclares;
    {
      modelica_metatype _item = NULL;
      modelica_metatype _redecl = NULL;
      modelica_metatype _rest_redecls = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _item has no default value.
      // _redecl has no default value.
      // _rest_redecls has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,1) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          _item = tmpMeta8;
          _rest_redecls = tmpMeta7;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(stringEqual(omc_NFSCodeEnv_getItemName(threadData, _item), _inName))) goto tmp3_end;
          tmpMeta10 = mmc_mk_box2(4, &NFSCodeEnv_Redeclaration_PROCESSED__MODIFIER__desc, _inRedeclare);
          tmpMeta9 = mmc_mk_cons(tmpMeta10, _rest_redecls);
          tmpMeta1 = omc_List_append__reverse(threadData, _inOutRedeclares, tmpMeta9);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta11 = MMC_CAR(tmp4_1);
          tmpMeta12 = MMC_CDR(tmp4_1);
          _redecl = tmpMeta11;
          _rest_redecls = tmpMeta12;
          /* Pattern matching succeeded */
          tmpMeta13 = mmc_mk_cons(_redecl, _inOutRedeclares);
          /* Tail recursive call */
          _inRedeclares = _rest_redecls;
          _inOutRedeclares = tmpMeta13;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta15 = mmc_mk_box2(4, &NFSCodeEnv_Redeclaration_PROCESSED__MODIFIER__desc, _inRedeclare);
          tmpMeta14 = mmc_mk_cons(tmpMeta15, _inOutRedeclares);
          tmpMeta1 = listReverse(tmpMeta14);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outRedeclares = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outRedeclares;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inExtends)
{
  modelica_metatype _outExtends = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outExtends has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _inBaseClasses;
    tmp4_2 = _inExtends;
    {
      modelica_metatype _bc1 = NULL;
      modelica_metatype _bc2 = NULL;
      modelica_metatype _rest_bc = NULL;
      modelica_metatype _ext = NULL;
      modelica_metatype _rest_exts = NULL;
      modelica_metatype _redecls = NULL;
      modelica_integer _index;
      modelica_metatype _info = NULL;
      modelica_metatype _bc_strl = NULL;
      modelica_string _bcl_str = NULL;
      modelica_string _err_msg = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _bc1 has no default value.
      // _bc2 has no default value.
      // _rest_bc has no default value.
      // _ext has no default value.
      // _rest_exts has no default value.
      // _redecls has no default value.
      // _index has no default value.
      // _info has no default value.
      // _bc_strl has no default value.
      // _bcl_str has no default value.
      // _err_msg has no default value.
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_2);
          tmpMeta9 = MMC_CDR(tmp4_2);
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 4));
          tmp13 = mmc_unbox_integer(tmpMeta12);
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 5));
          _bc1 = tmpMeta6;
          _rest_bc = tmpMeta7;
          _bc2 = tmpMeta10;
          _redecls = tmpMeta11;
          _index = tmp13  /* pattern as ty=Integer */;
          _info = tmpMeta14;
          _rest_exts = tmpMeta9;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_AbsynUtil_pathEqual(threadData, _bc1, _bc2)) goto tmp3_end;
          tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
          _redecls = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends3(threadData, _inRedeclare, _inName, _redecls, tmpMeta15);

          _rest_exts = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2(threadData, _inName, _inRedeclare, _rest_bc, _rest_exts);
          tmpMeta17 = mmc_mk_box5(3, &NFSCodeEnv_Extends_EXTENDS__desc, _bc2, _redecls, mmc_mk_integer(_index), _info);
          tmpMeta16 = mmc_mk_cons(tmpMeta17, _rest_exts);
          tmpMeta1 = tmpMeta16;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta18 = MMC_CAR(tmp4_2);
          tmpMeta19 = MMC_CDR(tmp4_2);
          
          _ext = tmpMeta18;
          _rest_exts = tmpMeta19;
          _rest_bc = tmp4_1;
          /* Pattern matching succeeded */
          _rest_exts = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2(threadData, _inName, _inRedeclare, _rest_bc, _rest_exts);
          tmpMeta20 = mmc_mk_cons(_ext, _rest_exts);
          tmpMeta1 = tmpMeta20;
          goto tmp3_done;
        }
        case 2: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inExtends;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar3;
            modelica_metatype* tmp22;
            modelica_metatype tmpMeta23;
            modelica_string __omcQ_24tmpVar2;
            modelica_integer tmp24;
            modelica_metatype _p_loopVar = 0;
            modelica_metatype _p;
            _p_loopVar = _inBaseClasses;
            tmpMeta23 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar3 = tmpMeta23; /* defaultValue */
            tmp22 = &__omcQ_24tmpVar3;
            while(1) {
              tmp24 = 1;
              if (!listEmpty(_p_loopVar)) {
                _p = MMC_CAR(_p_loopVar);
                _p_loopVar = MMC_CDR(_p_loopVar);
                tmp24--;
              }
              if (tmp24 == 0) {
                __omcQ_24tmpVar2 = omc_AbsynUtil_pathString(threadData, _p, _OMC_LIT4, 1 /* true */, 0 /* false */);
                *tmp22 = mmc_mk_cons(__omcQ_24tmpVar2,0);
                tmp22 = &MMC_CDR(*tmp22);
              } else if (tmp24 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp22 = mmc_mk_nil();
            tmpMeta21 = __omcQ_24tmpVar3;
          }
          _bc_strl = tmpMeta21;

          _bcl_str = stringDelimitList(_bc_strl, _OMC_LIT5);

          tmpMeta25 = stringAppend(_OMC_LIT23,_bcl_str);
          tmpMeta26 = stringAppend(tmpMeta25,_OMC_LIT24);
          tmpMeta27 = stringAppend(tmpMeta26,_inName);
          _err_msg = tmpMeta27;

          tmpMeta28 = mmc_mk_cons(_err_msg, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT20, tmpMeta28);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outExtends = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outExtends;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inBaseClasses, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype _exts = NULL;
  modelica_metatype _re = NULL;
  modelica_metatype _cei = NULL;
  modelica_metatype _etNew = NULL;
  modelica_metatype _etOld = NULL;
  modelica_string _name = NULL;
  modelica_metatype _env = NULL;
  modelica_metatype _repl = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  // _exts has no default value.
  // _re has no default value.
  // _cei has no default value.
  // _etNew has no default value.
  // _etOld has no default value.
  // _name has no default value.
  // _env has no default value.
  // _repl has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inEnv;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _env = tmpMeta2;
  _repl = tmpMeta3;

  /* Pattern-matching assignment */
  tmpMeta4 = _env;
  if (listEmpty(tmpMeta4)) MMC_THROW_INTERNAL();
  tmpMeta5 = MMC_CAR(tmpMeta4);
  tmpMeta6 = MMC_CDR(tmpMeta4);
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 5));
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
  tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 3));
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 4));
  _etOld = tmpMeta7;
  _exts = tmpMeta8;
  _re = tmpMeta9;
  _cei = tmpMeta10;

  _exts = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends2(threadData, _inName, _inRedeclare, _inBaseClasses, _exts);

  tmpMeta11 = mmc_mk_box4(3, &NFSCodeEnv_ExtendsTable_EXTENDS__TABLE__desc, _exts, _re, _cei);
  _etNew = tmpMeta11;

  _env = omc_NFSCodeEnv_setEnvExtendsTable(threadData, _etNew, _env);

  tmpMeta13 = mmc_mk_box7(4, &NFSCodeFlattenRedeclare_Replacement_PUSHED__desc, _inName, _inRedeclare, _inBaseClasses, _etOld, _etNew, _env);
  tmpMeta12 = mmc_mk_cons(tmpMeta13, _repl);
  _repl = tmpMeta12;

  tmpMeta14 = mmc_mk_box2(0, _env, _repl);
  _outEnv = tmpMeta14;
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail(threadData_t *threadData, modelica_string _inName, modelica_metatype _inRedeclare, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  { /* matchcontinue expression */
    {
      modelica_metatype _bcl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _bcl has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          /* Pattern matching succeeded */
          _bcl = omc_NFSCodeLookup_lookupBaseClasses(threadData, _inName, omc_Util_tuple21(threadData, _inEnv));
          tmpMeta1 = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends(threadData, _inName, _inRedeclare, _bcl, _inEnv);
          goto tmp3_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          tmpMeta1 = _inEnv;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outEnv = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _inRedeclare;
    {
      modelica_string _name = NULL;
      modelica_string _scope_name = NULL;
      modelica_metatype _item = NULL;
      modelica_metatype _info = NULL;
      modelica_metatype _bcl = NULL;
      modelica_metatype _envRpl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _name has no default value.
      // _scope_name has no default value.
      // _item has no default value.
      // _info has no default value.
      // _bcl has no default value.
      // _envRpl has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _item = tmpMeta6;
          /* Pattern matching succeeded */
          _name = omc_NFSCodeEnv_getItemName(threadData, _item);

          _envRpl = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtendsNoFail(threadData, _name, _item, _inEnv);
          tmpMeta1 = omc_NFSCodeFlattenRedeclare_replaceElementInScope(threadData, _name, _item, _envRpl);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _item = tmpMeta7;
          /* Pattern matching succeeded */
          _name = omc_NFSCodeEnv_getItemName(threadData, _item);

          _bcl = omc_NFSCodeLookup_lookupBaseClasses(threadData, _name, omc_Util_tuple21(threadData, _inEnv));
          tmpMeta1 = omc_NFSCodeFlattenRedeclare_pushRedeclareIntoExtends(threadData, _name, _item, _bcl, _inEnv);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          _item = tmpMeta8;
          /* Pattern matching succeeded */
          _scope_name = omc_NFSCodeEnv_getScopeName(threadData, omc_Util_tuple21(threadData, _inEnv));

          _name = omc_NFSCodeEnv_getItemName(threadData, _item);

          _info = omc_NFSCodeEnv_getItemInfo(threadData, _item);

          tmpMeta9 = mmc_mk_cons(_name, mmc_mk_cons(_scope_name, MMC_REFSTRUCTLIT(mmc_nil)));
          omc_Error_addSourceMessage(threadData, _OMC_LIT27, tmpMeta9, _info);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outEnv = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod(threadData_t *threadData, modelica_metatype _inMod, modelica_metatype _inRedeclares)
{
  modelica_metatype _outRedeclares = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outRedeclares has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inMod;
    {
      modelica_metatype _el = NULL;
      modelica_metatype _redecl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _el has no default value.
      // _redecl has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,3) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 4));
          _el = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box2(3, &NFSCodeEnv_Redeclaration_RAW__MODIFIER__desc, _el);
          _redecl = tmpMeta8;

          omc_NFSCodeCheck_checkDuplicateRedeclarations(threadData, _redecl, _inRedeclares);
          tmpMeta9 = mmc_mk_cons(_redecl, _inRedeclares);
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inRedeclares;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outRedeclares = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outRedeclares;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_extractRedeclaresFromModifier(threadData_t *threadData, modelica_metatype _inMod)
{
  modelica_metatype _outRedeclares = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outRedeclares has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inMod;
    {
      modelica_metatype _sub_mods = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _sub_mods has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,6) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          
          _sub_mods = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = omc_List_fold(threadData, _sub_mods, boxvar_NFSCodeFlattenRedeclare_extractRedeclareFromSubMod, tmpMeta7);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outRedeclares = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outRedeclares;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_replaceRedeclaredElementsInEnv(threadData_t *threadData, modelica_metatype _inRedeclares, modelica_metatype _inItem, modelica_metatype _inTypeEnv, modelica_metatype _inElementEnv, modelica_metatype _inPrefix, modelica_metatype *out_outEnv, modelica_metatype *out_outReplacements)
{
  modelica_metatype _outItem = NULL;
  modelica_metatype _outEnv = NULL;
  modelica_metatype _outReplacements = NULL;
  modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outItem has no default value.
  // _outEnv has no default value.
  // _outReplacements has no default value.
  
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _inRedeclares;
    tmp4_2 = _inItem;
    {
      modelica_metatype _cls = NULL;
      modelica_metatype _env = NULL;
      modelica_metatype _item_env = NULL;
      modelica_metatype _cls_ty = NULL;
      modelica_metatype _redecls = NULL;
      modelica_metatype _repl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _cls has no default value.
      // _env has no default value.
      // _item_env has no default value.
      // _cls_ty has no default value.
      // _redecls has no default value.
      // _repl has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta[0+0] = _inItem;
          tmpMeta[0+1] = _inTypeEnv;
          tmpMeta[0+2] = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          if (listEmpty(tmpMeta8)) goto tmp3_end;
          tmpMeta9 = MMC_CAR(tmpMeta8);
          tmpMeta10 = MMC_CDR(tmpMeta8);
          if (!listEmpty(tmpMeta10)) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          
          _cls = tmpMeta7;
          _item_env = tmpMeta9;
          _cls_ty = tmpMeta11;
          /* Pattern matching succeeded */
          _env = omc_NFSCodeEnv_enterFrame(threadData, _item_env, _inTypeEnv);

          _redecls = omc_List_map2(threadData, _inRedeclares, boxvar_NFSCodeFlattenRedeclare_processRedeclare, _inElementEnv, _inPrefix);

          /* Pattern-matching assignment */
          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta13 = mmc_mk_box2(0, _env, tmpMeta12);
          tmpMeta14 = omc_List_fold(threadData, _redecls, boxvar_NFSCodeFlattenRedeclare_replaceRedeclaredElementInEnv, tmpMeta13);
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 1));
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 2));
          _env = tmpMeta15;
          _repl = tmpMeta16;

          /* Pattern-matching assignment */
          tmpMeta17 = _env;
          if (listEmpty(tmpMeta17)) goto goto_2;
          tmpMeta18 = MMC_CAR(tmpMeta17);
          tmpMeta19 = MMC_CDR(tmpMeta17);
          _item_env = tmpMeta18;
          _env = tmpMeta19;
          tmpMeta20 = mmc_mk_cons(_item_env, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta21 = mmc_mk_box4(4, &NFSCodeEnv_Item_CLASS__desc, _cls, tmpMeta20, _cls_ty);
          tmpMeta[0+0] = tmpMeta21;
          tmpMeta[0+1] = _env;
          tmpMeta[0+2] = _repl;
          goto tmp3_done;
        }
        case 2: {
          modelica_boolean tmp22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp22 = omc_Flags_isSet(threadData, _OMC_LIT31);
          if (1 /* true */ != tmp22) goto goto_2;

          omc_Debug_trace(threadData, _OMC_LIT32);

          tmpMeta23 = stringAppend(_OMC_LIT33,stringDelimitList(omc_List_map(threadData, _inRedeclares, boxvar_NFSCodeEnv_printRedeclarationStr), _OMC_LIT34));
          tmpMeta24 = stringAppend(tmpMeta23,_OMC_LIT35);
          tmpMeta25 = stringAppend(tmpMeta24,omc_NFSCodeEnv_itemStr(threadData, _inItem));
          tmpMeta26 = stringAppend(tmpMeta25,_OMC_LIT36);
          tmpMeta27 = stringAppend(tmpMeta26,omc_NFSCodeEnv_getEnvName(threadData, _inElementEnv));
          omc_Debug_traceln(threadData, tmpMeta27);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outItem = tmpMeta[0+0];
  _outEnv = tmpMeta[0+1];
  _outReplacements = tmpMeta[0+2];
  _return: OMC_LABEL_UNUSED
  if (out_outEnv) { *out_outEnv = _outEnv; }
  if (out_outReplacements) { *out_outReplacements = _outReplacements; }
  return _outItem;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_replaceRedeclares(threadData_t *threadData, modelica_metatype _inRedeclares, modelica_metatype _inClassItem, modelica_metatype _inClassEnv, modelica_metatype _inElementEnv, modelica_metatype _inReplaceRedeclares, modelica_metatype *out_outEnv)
{
  modelica_metatype _outItem = NULL;
  modelica_metatype _outEnv = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outItem has no default value.
  // _outEnv has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _inReplaceRedeclares;
    {
      modelica_metatype _item = NULL;
      modelica_metatype _env = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _item has no default value.
      // _env has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta[0+0] = mmc_mk_some(_inClassItem);
          tmpMeta[0+1] = mmc_mk_some(_inClassEnv);
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          _item = omc_NFSCodeFlattenRedeclare_replaceRedeclaredElementsInEnv(threadData, _inRedeclares, _inClassItem, _inClassEnv, _inElementEnv, _OMC_LIT37 ,&_env ,NULL);
          tmpMeta[0+0] = mmc_mk_some(_item);
          tmpMeta[0+1] = mmc_mk_some(_env);
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = mmc_mk_none();
          tmpMeta[0+1] = mmc_mk_none();
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outItem = tmpMeta[0+0];
  _outEnv = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_outEnv) { *out_outEnv = _outEnv; }
  return _outItem;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_processRedeclare(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_metatype _inEnv, modelica_metatype _inPrefix)
{
  modelica_metatype _outRedeclare = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outRedeclare has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _inRedeclare;
    {
      modelica_metatype _el_item = NULL;
      modelica_metatype _redecl_item = NULL;
      modelica_metatype _el = NULL;
      modelica_metatype _cls_env = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _el_item has no default value.
      // _redecl_item has no default value.
      // _el has no default value.
      // _cls_env has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,2,8) == 0) goto tmp3_end;
          
          _el = tmpMeta6;
          tmp4 += 2; /* Pattern matching succeeded; we may skip some cases if we fail */
          _cls_env = omc_NFSCodeEnv_makeClassEnvironment(threadData, _el, 1 /* true */);

          _el_item = omc_NFSCodeEnv_newClassItem(threadData, _el, _cls_env, _OMC_LIT38);

          tmpMeta7 = mmc_mk_box3(6, &NFSCodeEnv_Item_REDECLARED__ITEM__desc, _el_item, _inEnv);
          _redecl_item = tmpMeta7;
          tmpMeta8 = mmc_mk_box2(4, &NFSCodeEnv_Redeclaration_PROCESSED__MODIFIER__desc, _redecl_item);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,3,8) == 0) goto tmp3_end;
          
          _el = tmpMeta9;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _el_item = omc_NFSCodeEnv_newVarItem(threadData, _el, 1 /* true */);

          tmpMeta10 = mmc_mk_box3(6, &NFSCodeEnv_Item_REDECLARED__ITEM__desc, _el_item, _inEnv);
          _redecl_item = tmpMeta10;
          tmpMeta11 = mmc_mk_box2(4, &NFSCodeEnv_Redeclaration_PROCESSED__MODIFIER__desc, _redecl_item);
          tmpMeta1 = tmpMeta11;
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inRedeclare;
          goto tmp3_done;
        }
        case 3: {
          modelica_boolean tmp12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp12 = omc_Flags_isSet(threadData, _OMC_LIT31);
          if (1 /* true */ != tmp12) goto goto_2;

          tmpMeta13 = stringAppend(_OMC_LIT39,omc_SCodeDump_unparseElementStr(threadData, omc_NFSCodeEnv_getRedeclarationElement(threadData, _inRedeclare), _OMC_LIT40));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT41);
          tmpMeta15 = stringAppend(tmpMeta14,omc_AbsynUtil_pathString(threadData, omc_NFSCodeEnv_getEnvPath(threadData, _inEnv), _OMC_LIT4, 1 /* true */, 0 /* false */));
          omc_Debug_traceln(threadData, tmpMeta15);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 4) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outRedeclare = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outRedeclare;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2(threadData_t *threadData, modelica_metatype _inRedeclaredElement, modelica_metatype _inBaseClasses, modelica_metatype _inExtends)
{
  modelica_metatype _outExtends = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outExtends has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _inBaseClasses;
    tmp4_2 = _inExtends;
    {
      modelica_metatype _ex = NULL;
      modelica_metatype _exl = NULL;
      modelica_metatype _bc1 = NULL;
      modelica_metatype _bc2 = NULL;
      modelica_metatype _rest_bc = NULL;
      modelica_metatype _el = NULL;
      modelica_integer _index;
      modelica_metatype _info = NULL;
      modelica_metatype _redecl = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _ex has no default value.
      // _exl has no default value.
      // _bc1 has no default value.
      // _bc2 has no default value.
      // _rest_bc has no default value.
      // _el has no default value.
      // _index has no default value.
      // _info has no default value.
      // _redecl has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_boolean tmp15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_2);
          tmpMeta9 = MMC_CDR(tmp4_2);
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 4));
          tmp13 = mmc_unbox_integer(tmpMeta12);
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 5));
          _bc1 = tmpMeta6;
          _rest_bc = tmpMeta7;
          _bc2 = tmpMeta10;
          _el = tmpMeta11;
          _index = tmp13  /* pattern as ty=Integer */;
          _info = tmpMeta14;
          _exl = tmpMeta9;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp15 = omc_AbsynUtil_pathEqual(threadData, _bc1, _bc2);
          if (1 /* true */ != tmp15) goto goto_2;

          tmpMeta16 = mmc_mk_box2(4, &NFSCodeEnv_Redeclaration_PROCESSED__MODIFIER__desc, _inRedeclaredElement);
          _redecl = tmpMeta16;

          omc_NFSCodeCheck_checkDuplicateRedeclarations(threadData, _redecl, _el);

          tmpMeta17 = mmc_mk_cons(_redecl, _el);
          tmpMeta18 = mmc_mk_box5(3, &NFSCodeEnv_Extends_EXTENDS__desc, _bc2, tmpMeta17, mmc_mk_integer(_index), _info);
          _ex = tmpMeta18;

          _exl = omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2(threadData, _inRedeclaredElement, _rest_bc, _exl);
          tmpMeta19 = mmc_mk_cons(_ex, _exl);
          tmpMeta1 = tmpMeta19;
          goto tmp3_done;
        }
        case 1: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _inExtends;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta20 = MMC_CAR(tmp4_2);
          tmpMeta21 = MMC_CDR(tmp4_2);
          
          _ex = tmpMeta20;
          _exl = tmpMeta21;
          /* Pattern matching succeeded */
          _exl = omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2(threadData, _inRedeclaredElement, _inBaseClasses, _exl);
          tmpMeta22 = mmc_mk_cons(_ex, _exl);
          tmpMeta1 = tmpMeta22;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outExtends = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outExtends;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable(threadData_t *threadData, modelica_metatype _inRedeclaredElement, modelica_metatype _inBaseClasses, modelica_metatype _inEnv, modelica_metatype _inInfo)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype _bcl = NULL;
  modelica_metatype _re = NULL;
  modelica_metatype _cei = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  // _bcl has no default value.
  // _re has no default value.
  // _cei has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = omc_NFSCodeEnv_getEnvExtendsTable(threadData, _inEnv);
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  _bcl = tmpMeta2;
  _re = tmpMeta3;
  _cei = tmpMeta4;

  _bcl = omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable2(threadData, _inRedeclaredElement, _inBaseClasses, _bcl);

  tmpMeta5 = mmc_mk_box4(3, &NFSCodeEnv_ExtendsTable_EXTENDS__TABLE__desc, _bcl, _re, _cei);
  _outEnv = omc_NFSCodeEnv_setEnvExtendsTable(threadData, tmpMeta5, _inEnv);
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_lookupElementRedeclaration(threadData_t *threadData, modelica_string _inName, modelica_metatype _inEnv, modelica_metatype _inInfo)
{
  modelica_metatype _outPaths = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outPaths has no default value.
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFSCodeLookup_lookupBaseClasses(threadData, _inName, _inEnv);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_cons(_inName, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addSourceMessage(threadData, _OMC_LIT44, tmpMeta6, _inInfo);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outPaths = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outPaths;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2(threadData_t *threadData, modelica_metatype _inRedeclare, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  { /* matchcontinue expression */
    {
      modelica_string _name = NULL;
      modelica_metatype _info = NULL;
      modelica_metatype _env_path = NULL;
      modelica_metatype _ext_pathl = NULL;
      modelica_metatype _item = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _name has no default value.
      // _info has no default value.
      // _env_path has no default value.
      // _ext_pathl has no default value.
      // _item has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          /* Pattern matching succeeded */
          _name = omc_SCodeUtil_elementName(threadData, _inRedeclare);

          _info = omc_SCodeUtil_elementInfo(threadData, _inRedeclare);

          _ext_pathl = omc_NFSCodeFlattenRedeclare_lookupElementRedeclaration(threadData, _name, _inEnv, _info);

          _env_path = omc_NFSCodeEnv_getEnvPath(threadData, _inEnv);

          tmpMeta6 = mmc_mk_box4(5, &NFSCodeEnv_Item_ALIAS__desc, _name, mmc_mk_some(_env_path), _info);
          _item = tmpMeta6;
          tmpMeta1 = omc_NFSCodeFlattenRedeclare_addRedeclareToEnvExtendsTable(threadData, _item, _ext_pathl, _inEnv, _info);
          goto tmp3_done;
        }
        case 1: {
          modelica_boolean tmp7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp7 = omc_Flags_isSet(threadData, _OMC_LIT31);
          if (1 /* true */ != tmp7) goto goto_2;

          tmpMeta8 = stringAppend(_OMC_LIT45,omc_SCodeUtil_elementName(threadData, _inRedeclare));
          tmpMeta9 = stringAppend(tmpMeta8,_OMC_LIT41);
          tmpMeta10 = stringAppend(tmpMeta9,omc_NFSCodeEnv_getEnvName(threadData, _inEnv));
          tmpMeta11 = stringAppend(tmpMeta10,_OMC_LIT7);
          omc_Debug_traceln(threadData, tmpMeta11);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outEnv = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

DLLDirection
modelica_metatype omc_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv(threadData_t *threadData, modelica_metatype _inRedeclares, modelica_metatype _inEnv)
{
  modelica_metatype _outEnv = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEnv has no default value.
  _outEnv = omc_List_fold(threadData, _inRedeclares, boxvar_NFSCodeFlattenRedeclare_addElementRedeclarationsToEnv2, _inEnv);
  _return: OMC_LABEL_UNUSED
  return _outEnv;
}

