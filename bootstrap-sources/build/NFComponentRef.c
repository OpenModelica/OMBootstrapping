#include "omc_simulation_settings.h"
#include "NFComponentRef.h"
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT0,1,8) {&NFSubscript_WHOLE__desc,}};
#define _OMC_LIT0 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,0,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT2,0.0);
#define _OMC_LIT2 MMC_REFREALLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT1,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT2}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,1,3) {&NFType_INTEGER__desc,}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,2,3) {&NFExpression_INTEGER__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT6,2,5) {&NFSubscript_INDEX__desc,_OMC_LIT5}};
#define _OMC_LIT6 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT7,1,4) {&NFComponentRef_EMPTY__desc,}};
#define _OMC_LIT7 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT7)
#define _OMC_LIT8_data "$SUBST_CREF"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT8,11,_OMC_LIT8_data);
#define _OMC_LIT8 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "time"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,4,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,2,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT11,2,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT11 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT11)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT12,4,3) {&NFCeval_EvalTarget_EVAL__TARGET__desc,_OMC_LIT3,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT12 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,1,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "name"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,4,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data "subscripts"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,10,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
#define _OMC_LIT16_data "$kind"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT16,5,_OMC_LIT16_data);
#define _OMC_LIT16 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT16)
#define _OMC_LIT17_data "cref"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT17,4,_OMC_LIT17_data);
#define _OMC_LIT17 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data "parts"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,5,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data "{"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,1,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data ","
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,1,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "}"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,1,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
#define _OMC_LIT22_data "'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT22,1,_OMC_LIT22_data);
#define _OMC_LIT22 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,2,1) {_OMC_LIT22,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,1,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "'.'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,3,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
#define _OMC_LIT26_data ".'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT26,2,_OMC_LIT26_data);
#define _OMC_LIT26 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,1,6) {&DAE_ComponentRef_WILD__desc,}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT28,1,6) {&Absyn_ComponentRef_WILD__desc,}};
#define _OMC_LIT28 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT28)
#define _OMC_LIT29_data "$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT29,1,_OMC_LIT29_data);
#define _OMC_LIT29 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT29)
#define _OMC_LIT30_data "NFComponentRef.compare failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT30,29,_OMC_LIT30_data);
#define _OMC_LIT30 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT30)
#define _OMC_LIT31_data "/home/adrpo33/OpenModelica/OMCompiler/Compiler/NFFrontEnd/NFComponentRef.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT31,75,_OMC_LIT31_data);
#define _OMC_LIT31 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT32_6,1.758197185e9);
#define _OMC_LIT32_6 MMC_REFREALLIT(_OMC_LIT_STRUCT32_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT31,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1149)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1149)),MMC_IMMEDIATE(MMC_TAGFIXNUM(76)),_OMC_LIT32_6}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data "NFComponentRef.transferSubscripts failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,40,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT34_6,1.758197185e9);
#define _OMC_LIT34_6 MMC_REFREALLIT(_OMC_LIT_STRUCT34_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT31,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(960)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(960)),MMC_IMMEDIATE(MMC_TAGFIXNUM(78)),_OMC_LIT34_6}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "NFComponentRef.mergeSubscripts failed because the subscripts "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,61,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,2,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
#define _OMC_LIT37_data " could not be fully merged onto "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT37,32,_OMC_LIT37_data);
#define _OMC_LIT37 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT37)
#define _OMC_LIT38_data ".\nResult: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT38,10,_OMC_LIT38_data);
#define _OMC_LIT38 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT38)
#define _OMC_LIT39_data " with leftover: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT39,16,_OMC_LIT39_data);
#define _OMC_LIT39 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT40_6,1.758197185e9);
#define _OMC_LIT40_6 MMC_REFREALLIT(_OMC_LIT_STRUCT40_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT31,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(683)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(686)),MMC_IMMEDIATE(MMC_TAGFIXNUM(102)),_OMC_LIT40_6}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT41,1,13) {&NFType_UNKNOWN__desc,}};
#define _OMC_LIT41 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT41)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT42,1,5) {&NFComponentRef_WILD__desc,}};
#define _OMC_LIT42 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT42)
#include "util/modelica.h"

#include "NFComponentRef_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFComponentRef_iterate_iterate__impl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype __omcQ_24in_5Fiterators, modelica_metatype *out_iterators);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_iterate_iterate__impl,2,0) {(void*) boxptr_NFComponentRef_iterate_iterate__impl,0}};
#define boxvar_NFComponentRef_iterate_iterate__impl MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_iterate_iterate__impl)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFComponentRef_isSliced_is__sliced__impl(threadData_t *threadData, modelica_metatype _cref);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_isSliced_is__sliced__impl(threadData_t *threadData, modelica_metatype _cref);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_isSliced_is__sliced__impl,2,0) {(void*) boxptr_NFComponentRef_isSliced_is__sliced__impl,0}};
#define boxvar_NFComponentRef_isSliced_is__sliced__impl MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_isSliced_is__sliced__impl)
PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_hashStrip_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_integer __omcQ_24in_5Fhash);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_hashStrip_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fhash);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_hashStrip_hash__rest,2,0) {(void*) boxptr_NFComponentRef_hashStrip_hash__rest,0}};
#define boxvar_NFComponentRef_hashStrip_hash__rest MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_hashStrip_hash__rest)
PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_hash_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_integer __omcQ_24in_5Fhash);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_hash_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fhash);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_hash_hash__rest,2,0) {(void*) boxptr_NFComponentRef_hash_hash__rest,0}};
#define boxvar_NFComponentRef_hash_hash__rest MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_hash_hash__rest)
PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_purity_sub__purity(threadData_t *threadData, modelica_metatype _sub, modelica_integer __omcQ_24in_5Fpur);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_purity_sub__purity(threadData_t *threadData, modelica_metatype _sub, modelica_metatype __omcQ_24in_5Fpur);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_purity_sub__purity,2,0) {(void*) boxptr_NFComponentRef_purity_sub__purity,0}};
#define boxvar_NFComponentRef_purity_sub__purity MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_purity_sub__purity)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFComponentRef_isTopLevel_isTopLevelRecord(threadData_t *threadData, modelica_metatype _cref);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_isTopLevel_isTopLevelRecord(threadData_t *threadData, modelica_metatype _cref);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NFComponentRef_isTopLevel_isTopLevelRecord,2,0) {(void*) boxptr_NFComponentRef_isTopLevel_isTopLevelRecord,0}};
#define boxvar_NFComponentRef_isTopLevel_isTopLevelRecord MMC_REFSTRUCTLIT(boxvar_lit_NFComponentRef_isTopLevel_isTopLevelRecord)

DLLDirection
modelica_metatype omc_NFComponentRef_getRecordChildren(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _children = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _ty = NULL;
  modelica_metatype _children_nodes = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta9;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _children = tmpMeta1;
  _ty = omc_NFType_arrayElementType(threadData, omc_NFComponentRef_getComponentType(threadData, _cref));
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _children_nodes = tmpMeta2;
  if(omc_NFType_isComplex(threadData, _ty))
  {
    { /* match expression */
      modelica_metatype tmp6_1;
      tmp6_1 = _cref;
      {
        volatile mmc_switch_type tmp6;
        int tmp7;
        tmp6 = 0;
        for (; tmp6 < 2; tmp6++) {
          switch (MMC_SWITCH_CAST(tmp6)) {
          case 0: {
            if (mmc__uniontype__metarecord__typedef__equal(tmp6_1,0,5) == 0) goto tmp5_end;
            
            /* Pattern matching succeeded */
            tmpMeta3 = arrayList(omc_NFClassTree_ClassTree_getComponents(threadData, omc_NFClass_classTree(threadData, omc_NFInstNode_InstNode_getClass(threadData, omc_NFComponent_classInstance(threadData, omc_NFInstNode_InstNode_component(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))))))));
            goto tmp5_done;
          }
          case 1: {
            modelica_metatype tmpMeta8;
            
            /* Pattern matching succeeded */
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta3 = tmpMeta8;
            goto tmp5_done;
          }
          }
          goto tmp5_end;
          tmp5_end: ;
        }
        goto goto_4;
        goto_4:;
        MMC_THROW_INTERNAL();
        goto tmp5_done;
        tmp5_done:;
      }
    }
    _children_nodes = tmpMeta3;
  }

  if((!listEmpty(_children_nodes)))
  {
    {
      modelica_metatype __omcQ_24tmpVar1;
      modelica_metatype* tmp10;
      modelica_metatype tmpMeta11;
      modelica_metatype tmpMeta12;
      modelica_metatype __omcQ_24tmpVar0;
      modelica_integer tmp13;
      modelica_metatype _node_loopVar = 0;
      modelica_metatype _node;
      _node_loopVar = _children_nodes;
      tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
      __omcQ_24tmpVar1 = tmpMeta11; /* defaultValue */
      tmp10 = &__omcQ_24tmpVar1;
      while(1) {
        tmp13 = 1;
        if (!listEmpty(_node_loopVar)) {
          _node = MMC_CAR(_node_loopVar);
          _node_loopVar = MMC_CDR(_node_loopVar);
          tmp13--;
        }
        if (tmp13 == 0) {
          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          __omcQ_24tmpVar0 = omc_NFComponentRef_prefixCref(threadData, _node, omc_NFInstNode_InstNode_getType(threadData, _node), tmpMeta12, _cref);
          *tmp10 = mmc_mk_cons(__omcQ_24tmpVar0,0);
          tmp10 = &MMC_CDR(*tmp10);
        } else if (tmp13 == 1) {
          break;
        } else {
          MMC_THROW_INTERNAL();
        }
      }
      *tmp10 = mmc_mk_nil();
      tmpMeta9 = __omcQ_24tmpVar1;
    }
    _children = tmpMeta9;
  }
  _return: OMC_LABEL_UNUSED
  return _children;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NFComponentRef_iterate_iterate__impl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype __omcQ_24in_5Fiterators, modelica_metatype *out_iterators)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _iterators = NULL;
  modelica_metatype _rest_cref = NULL;
  modelica_metatype _dim = NULL;
  modelica_metatype _dims = NULL;
  modelica_integer _dim_count;
  modelica_integer _sub_count;
  modelica_metatype _subs = NULL;
  modelica_metatype _isubs = NULL;
  modelica_integer _dim_index;
  modelica_metatype _iterator = NULL;
  modelica_metatype _range = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  _iterators = __omcQ_24in_5Fiterators;
  // _rest_cref has no default value.
  // _dim has no default value.
  // _dims has no default value.
  // _dim_count has no default value.
  // _sub_count has no default value.
  // _subs has no default value.
  // _isubs has no default value.
  // _dim_index has no default value.
  // _iterator has no default value.
  // _range has no default value.
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_integer tmp6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
          tmp6 = mmc_unbox_integer(tmpMeta5);
          if (1 != tmp6) goto tmp2_end;
          
          /* Pattern matching succeeded */
          _dims = listReverse(omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))));

          _dim_count = listLength(_dims);

          _sub_count = listLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))));

          _subs = omc_List_consN(threadData, _dim_count - _sub_count, _OMC_LIT0, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))));

          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          _isubs = tmpMeta7;

          _dim_index = _dim_count;

          {
            modelica_metatype _s;
            for (tmpMeta8 = listReverse(_subs); !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
            {
              _s = MMC_CAR(tmpMeta8);
              /* Pattern-matching assignment */
              tmpMeta9 = _dims;
              if (listEmpty(tmpMeta9)) goto goto_1;
              tmpMeta10 = MMC_CAR(tmpMeta9);
              tmpMeta11 = MMC_CDR(tmpMeta9);
              _dim = tmpMeta10;
              _dims = tmpMeta11;

              if((!omc_NFSubscript_isIndex(threadData, _s)))
              {
                { /* match expression */
                  modelica_metatype tmp15_1;
                  tmp15_1 = _s;
                  {
                    volatile mmc_switch_type tmp15;
                    int tmp16;
                    tmp15 = 0;
                    for (; tmp15 < 2; tmp15++) {
                      switch (MMC_SWITCH_CAST(tmp15)) {
                      case 0: {
                        if (mmc__uniontype__metarecord__typedef__equal(tmp15_1,3,1) == 0) goto tmp14_end;
                        
                        /* Pattern matching succeeded */
                        tmpMeta12 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_s), 2)));
                        goto tmp14_done;
                      }
                      case 1: {
                        modelica_metatype tmpMeta17;
                        if (mmc__uniontype__metarecord__typedef__equal(tmp15_1,5,0) == 0) goto tmp14_end;
                        /* Pattern matching succeeded */
                        tmpMeta17 = mmc_mk_box3(9, &NFExpression_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), _cref);
                        tmpMeta12 = omc_NFExpression_makeRange(threadData, omc_NFDimension_lowerBoundExp(threadData, _dim), mmc_mk_none(), omc_NFDimension_endExp(threadData, _dim, tmpMeta17, _dim_index));
                        goto tmp14_done;
                      }
                      }
                      goto tmp14_end;
                      tmp14_end: ;
                    }
                    goto goto_13;
                    goto_13:;
                    goto goto_1;
                    goto tmp14_done;
                    tmp14_done:;
                  }
                }
                _range = tmpMeta12;

                _iterator = omc_NFInstNode_InstNode_newUniqueIterator(threadData, _OMC_LIT3, _OMC_LIT4);

                tmpMeta19 = mmc_mk_box2(0, _iterator, _range);
                tmpMeta18 = mmc_mk_cons(tmpMeta19, _iterators);
                _iterators = tmpMeta18;

                _dim_index = ((modelica_integer) -1) + _dim_index;

                tmpMeta20 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, omc_NFExpression_fromCref(threadData, omc_NFComponentRef_makeIterator(threadData, _iterator, _OMC_LIT4), 0 /* false */));
                _s = tmpMeta20;
              }

              tmpMeta21 = mmc_mk_cons(_s, _isubs);
              _isubs = tmpMeta21;
            }
          }

          tmpMeta23 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta23), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta23))[3] = _isubs;
          _cref = tmpMeta23;

          _rest_cref = omc_NFComponentRef_iterate_iterate__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _iterators ,&_iterators);

          tmpMeta24 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta24), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta24))[6] = _rest_cref;
          _cref = tmpMeta24;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  if (out_iterators) { *out_iterators = _iterators; }
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_iterate(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype *out_iterators)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _iterators = NULL;
  modelica_metatype _rest_cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  // _iterators has no default value.
  // _rest_cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          _rest_cref = omc_NFComponentRef_iterate_iterate__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), tmpMeta6 ,&_iterators);

          if((!listEmpty(_iterators)))
          {
            tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = _rest_cref;
            _cref = tmpMeta7;

            _iterators = listReverseInPlace(_iterators);
          }
          tmpMeta1 = _iterators;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iterators = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_iterators) { *out_iterators = _iterators; }
  return _cref;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFComponentRef_isSliced_is__sliced__impl(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _sliced;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sliced has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _sliced = ((omc_NFType_dimensionCount(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))) > listLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))) || omc_List_any(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), boxvar_NFSubscript_isSliced));
          tmp1 = (_sliced || omc_NFComponentRef_isSliced_is__sliced__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sliced = tmp1;
  _return: OMC_LABEL_UNUSED
  return _sliced;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_isSliced_is__sliced__impl(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _sliced;
  modelica_metatype out_sliced;
  _sliced = omc_NFComponentRef_isSliced_is__sliced__impl(threadData, _cref);
  out_sliced = mmc_mk_icon(_sliced);
  return out_sliced;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isSliced(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _sliced;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sliced has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponentRef_isSliced_is__sliced__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sliced = tmp1;
  _return: OMC_LABEL_UNUSED
  return _sliced;
}
modelica_metatype boxptr_NFComponentRef_isSliced(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _sliced;
  modelica_metatype out_sliced;
  _sliced = omc_NFComponentRef_isSliced(threadData, _cref);
  out_sliced = mmc_mk_icon(_sliced);
  return out_sliced;
}

static modelica_metatype closure0_NFSubscript_isEqual(threadData_t *thData, modelica_metatype closure, modelica_metatype subscript2)
{
  modelica_metatype subscript1 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NFSubscript_isEqual(thData, subscript1, subscript2);
}
DLLDirection
modelica_metatype omc_NFComponentRef_getArrayCrefOpt(threadData_t *threadData, modelica_metatype _scal)
{
  modelica_metatype _arr = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _arr has no default value.
  // _subs has no default value.
  _subs = omc_NFComponentRef_subscriptsAllFlat(threadData, _scal);

  if(listEmpty(_subs))
  {
    _arr = mmc_mk_none();
  }
  else
  {
    tmpMeta1 = mmc_mk_box1(0, _OMC_LIT6);
    if(omc_List_all(threadData, _subs, (modelica_fnptr) mmc_mk_box2(0,closure0_NFSubscript_isEqual,tmpMeta1)))
    {
      _arr = mmc_mk_some(omc_NFComponentRef_stripSubscriptsAll(threadData, _scal));
    }
    else
    {
      _arr = mmc_mk_none();
    }
  }
  _return: OMC_LABEL_UNUSED
  return _arr;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapNodes(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _rest = NULL;
      modelica_metatype _node = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest has no default value.
      // _node has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _node = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));

          _rest = omc_NFComponentRef_mapNodes(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func));
          tmpMeta6 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapTypes(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _rest = NULL;
      modelica_metatype _ty = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest has no default value.
      // _ty has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _ty = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));

          _rest = omc_NFComponentRef_mapTypes(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func));
          tmpMeta6 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), _ty, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_removeOuterCrefPrefix(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          if(omc_NFInstNode_InstNode_isGeneratedInner(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))))
          {
            tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = _OMC_LIT7;
            _cref = tmpMeta5;
          }
          else
          {
            tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NFComponentRef_removeOuterCrefPrefix(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
            _cref = tmpMeta6;
          }
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_boolean omc_NFComponentRef_listHasDiscrete(threadData_t *threadData, modelica_metatype _cref_lst)
{
  modelica_boolean _result;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _result = 0 /* false */;
  {
    modelica_metatype _cref;
    for (tmpMeta1 = _cref_lst; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _cref = MMC_CAR(tmpMeta1);
      if(omc_NFType_isDiscrete(threadData, omc_NFComponentRef_nodeType(threadData, _cref)))
      {
        _result = 1 /* true */;

        goto _return;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _result;
}
modelica_metatype boxptr_NFComponentRef_listHasDiscrete(threadData_t *threadData, modelica_metatype _cref_lst)
{
  modelica_boolean _result;
  modelica_metatype out_result;
  _result = omc_NFComponentRef_listHasDiscrete(threadData, _cref_lst);
  out_result = mmc_mk_icon(_result);
  return out_result;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isSubstitute(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = (stringEqual(omc_NFComponentRef_firstName(threadData, _cref, 0 /* false */), _OMC_LIT8));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isSubstitute(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isSubstitute(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isTime(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = (stringEqual(omc_NFComponentRef_firstName(threadData, _cref, 0 /* false */), _OMC_LIT9));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isTime(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isTime(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapFoldExpShallow(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_metatype *out_arg)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype _arg = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      modelica_metatype _rest = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      // _rest has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _subs = omc_List_map1Fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), boxvar_NFSubscript_mapFoldExpShallow, ((modelica_fnptr) _func), _arg ,&_arg);

          _rest = omc_NFComponentRef_mapFoldExpShallow(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func), _arg ,&_arg);
          tmpMeta6 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_arg) { *out_arg = _arg; }
  return _outCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapFoldExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_metatype *out_arg)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype _arg = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      modelica_metatype _rest = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      // _rest has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _subs = omc_List_map1Fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), boxvar_NFSubscript_mapFoldExp, ((modelica_fnptr) _func), _arg ,&_arg);

          _rest = omc_NFComponentRef_mapFoldExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func), _arg ,&_arg);
          tmpMeta6 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_arg) { *out_arg = _arg; }
  return _outCref;
}

static modelica_metatype closure1_NFSubscript_foldExp(threadData_t *thData, modelica_metatype closure, modelica_metatype subscript, modelica_metatype arg)
{
  modelica_fnptr func = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NFSubscript_foldExp(thData, subscript, func, arg);
}
DLLDirection
modelica_metatype omc_NFComponentRef_foldExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg)
{
  modelica_metatype _arg = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box1(0, ((modelica_fnptr) _func));
          _arg = omc_List_fold(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), (modelica_fnptr) mmc_mk_box2(0,closure1_NFSubscript_foldExp,tmpMeta5), _arg);

          _arg = omc_NFComponentRef_foldExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func), _arg);
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _arg;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapExpShallow(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      modelica_metatype _rest = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      // _rest has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar3;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar2;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar3 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar3;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar2 = omc_NFSubscript_mapShallowExp(threadData, _s, ((modelica_fnptr) _func));
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar2,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar3;
          }
          _subs = tmpMeta6;

          _rest = omc_NFComponentRef_mapExpShallow(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func));
          tmpMeta10 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta10;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_metatype _outCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      modelica_metatype _rest = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      // _rest has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar5;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar4;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar5 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar5;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar4 = omc_NFSubscript_mapExp(threadData, _s, ((modelica_fnptr) _func));
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar4,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar5;
          }
          _subs = tmpMeta6;

          _rest = omc_NFComponentRef_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func));
          tmpMeta10 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest);
          tmpMeta1 = tmpMeta10;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outCref;
}

DLLDirection
void omc_NFComponentRef_applyExpShallow(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype _s;
            for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
            {
              _s = MMC_CAR(tmpMeta5);
              omc_NFSubscript_applyExpShallow(threadData, _s, ((modelica_fnptr) _func));
            }
          }

          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          ;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
void omc_NFComponentRef_applyExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype _s;
            for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
            {
              _s = MMC_CAR(tmpMeta5);
              omc_NFSubscript_applyExp(threadData, _s, ((modelica_fnptr) _func));
            }
          }

          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          ;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_boolean omc_NFComponentRef_containsExpShallow(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFSubscript_listContainsExpShallow(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), ((modelica_fnptr) _func)) || omc_NFComponentRef_containsExpShallow(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func)));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_containsExpShallow(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_containsExpShallow(threadData, _cref, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_containsExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFSubscript_listContainsExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), ((modelica_fnptr) _func)) || omc_NFComponentRef_containsExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func)));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_containsExp(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_containsExp(threadData, _cref, _func);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isComplexArray2(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _complexArray;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _complexArray has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFType_isArray(threadData, omc_NFType_subscript(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), 1 /* true */))) goto tmp3_end;
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _complexArray = tmp1;
  _return: OMC_LABEL_UNUSED
  return _complexArray;
}
modelica_metatype boxptr_NFComponentRef_isComplexArray2(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _complexArray;
  modelica_metatype out_complexArray;
  _complexArray = omc_NFComponentRef_isComplexArray2(threadData, _cref);
  out_complexArray = mmc_mk_icon(_complexArray);
  return out_complexArray;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isComplexArray(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _complexArray;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _complexArray has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponentRef_isComplexArray2(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _complexArray = tmp1;
  _return: OMC_LABEL_UNUSED
  return _complexArray;
}
modelica_metatype boxptr_NFComponentRef_isComplexArray(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _complexArray;
  modelica_metatype out_complexArray;
  _complexArray = omc_NFComponentRef_isComplexArray(threadData, _cref);
  out_complexArray = mmc_mk_icon(_complexArray);
  return out_complexArray;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isEmptyArray(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isEmpty;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEmpty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFType_isEmptyArray(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))) || omc_NFComponentRef_isEmptyArray(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isEmpty = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isEmpty;
}
modelica_metatype boxptr_NFComponentRef_isEmptyArray(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isEmpty;
  modelica_metatype out_isEmpty;
  _isEmpty = omc_NFComponentRef_isEmptyArray(threadData, _cref);
  out_isEmpty = mmc_mk_icon(_isEmpty);
  return out_isEmpty;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsToExpression(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _addScalar)
{
  modelica_metatype _e_lst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _e_lst = tmpMeta1;
  tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
  {
    modelica_metatype _subs_tmp;
    for (tmpMeta2 = omc_NFComponentRef_subscriptsAllReverse(threadData, _cref, tmpMeta8); !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _subs_tmp = MMC_CAR(tmpMeta2);
      if((_addScalar && listEmpty(_subs_tmp)))
      {
        tmpMeta3 = mmc_mk_cons(_OMC_LIT5, _e_lst);
        _e_lst = tmpMeta3;
      }
      else
      {
        {
          modelica_metatype _sub;
          for (tmpMeta4 = _subs_tmp; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
          {
            _sub = MMC_CAR(tmpMeta4);
            tmpMeta5 = mmc_mk_cons(omc_NFSubscript_toExp(threadData, _sub), _e_lst);
            _e_lst = tmpMeta5;
          }
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _e_lst;
}
modelica_metatype boxptr_NFComponentRef_subscriptsToExpression(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _addScalar)
{
  modelica_integer tmp1;
  modelica_metatype _e_lst = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_addScalar);
  _e_lst = omc_NFComponentRef_subscriptsToExpression(threadData, _cref, tmp1);
  /* skip box _e_lst; list<NFExpression> */
  return _e_lst;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsToInteger(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _s_lst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _s_lst = tmpMeta1;
  tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
  {
    modelica_metatype _subs_tmp;
    for (tmpMeta2 = omc_NFComponentRef_subscriptsAllReverse(threadData, _cref, tmpMeta8); !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _subs_tmp = MMC_CAR(tmpMeta2);
      if(listEmpty(_subs_tmp))
      {
        tmpMeta3 = mmc_mk_cons(mmc_mk_integer(((modelica_integer) 1)), _s_lst);
        _s_lst = tmpMeta3;
      }
      else
      {
        {
          modelica_metatype _sub;
          for (tmpMeta4 = _subs_tmp; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
          {
            _sub = MMC_CAR(tmpMeta4);
            tmpMeta5 = mmc_mk_cons(mmc_mk_integer(omc_NFExpression_integerValueOrDefault(threadData, omc_NFSubscript_toExp(threadData, _sub), ((modelica_integer) 1))), _s_lst);
            _s_lst = tmpMeta5;
          }
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _s_lst;
}

DLLDirection
modelica_boolean omc_NFComponentRef_sizeKnown(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFType_sizeKnown(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_sizeKnown(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_sizeKnown(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NFComponentRef_sizes__local(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _withComplex, modelica_boolean _resize)
{
  modelica_metatype _s_lst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _complex_size = NULL;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _s_lst = tmpMeta1;
  // _complex_size has no default value.
  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _cref;
    {
      volatile mmc_switch_type tmp5;
      int tmp6;
      tmp5 = 0;
      for (; tmp5 < 2; tmp5++) {
        switch (MMC_SWITCH_CAST(tmp5)) {
        case 0: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,1,0) == 0) goto tmp4_end;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta2 = tmpMeta7;
          goto tmp4_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,0,5) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          _complex_size = omc_NFType_complexSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), 0 /* false */);

          {
            modelica_metatype __omcQ_24tmpVar7;
            modelica_metatype* tmp9;
            modelica_metatype tmpMeta10;
            modelica_metatype __omcQ_24tmpVar6;
            modelica_integer tmp11;
            modelica_metatype _dim_loopVar = 0;
            modelica_metatype _dim;
            _dim_loopVar = omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));
            tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar7 = tmpMeta10; /* defaultValue */
            tmp9 = &__omcQ_24tmpVar7;
            while(1) {
              tmp11 = 1;
              if (!listEmpty(_dim_loopVar)) {
                _dim = MMC_CAR(_dim_loopVar);
                _dim_loopVar = MMC_CDR(_dim_loopVar);
                tmp11--;
              }
              if (tmp11 == 0) {
                __omcQ_24tmpVar6 = mmc_mk_integer(omc_NFDimension_size(threadData, _dim, _resize));
                *tmp9 = mmc_mk_cons(__omcQ_24tmpVar6,0);
                tmp9 = &MMC_CDR(*tmp9);
              } else if (tmp11 == 1) {
                break;
              } else {
                goto goto_3;
              }
            }
            *tmp9 = mmc_mk_nil();
            tmpMeta8 = __omcQ_24tmpVar7;
          }
          _s_lst = tmpMeta8;

          if((_withComplex && isSome(_complex_size)))
          {
            tmpMeta12 = mmc_mk_cons(omc_Util_getOption(threadData, _complex_size), _s_lst);
            _s_lst = tmpMeta12;
          }
          tmpMeta2 = (listEmpty(_s_lst)?_OMC_LIT10:_s_lst);
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_3;
      goto_3:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _s_lst = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _s_lst;
}
modelica_metatype boxptr_NFComponentRef_sizes__local(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _withComplex, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _s_lst = NULL;
  modelica_metatype tmpMeta3;
  tmp1 = mmc_unbox_integer(_withComplex);
  tmp2 = mmc_unbox_integer(_resize);
  _s_lst = omc_NFComponentRef_sizes__local(threadData, _cref, tmp1, tmp2);
  /* skip box _s_lst; list<#Integer> */
  return _s_lst;
}

DLLDirection
modelica_metatype omc_NFComponentRef_sizes(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _withComplex, modelica_boolean _resize, modelica_metatype __omcQ_24in_5Fs_5Flst)
{
  modelica_metatype _s_lst = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _s_lst = __omcQ_24in_5Fs_5Flst;
  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _cref;
    {
      modelica_metatype _local_lst = NULL;
      modelica_metatype tmpMeta3;
      int tmp5;
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      _local_lst = tmpMeta3;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp5_1))) {
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = listReverse(_s_lst);
          goto tmp4_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          _local_lst = omc_NFComponentRef_sizes__local(threadData, _cref, _withComplex, _resize);

          _s_lst = listAppend(_local_lst, _s_lst);
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          __omcQ_24in_5Fs_5Flst = _s_lst;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp4_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT11;
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _s_lst = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _s_lst;
}
modelica_metatype boxptr_NFComponentRef_sizes(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _withComplex, modelica_metatype _resize, modelica_metatype __omcQ_24in_5Fs_5Flst)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _s_lst = NULL;
  tmp1 = mmc_unbox_integer(_withComplex);
  tmp2 = mmc_unbox_integer(_resize);
  _s_lst = omc_NFComponentRef_sizes(threadData, _cref, tmp1, tmp2, __omcQ_24in_5Fs_5Flst);
  /* skip box _s_lst; list<#Integer> */
  return _s_lst;
}

DLLDirection
modelica_integer omc_NFComponentRef_size(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _withComplex, modelica_boolean _resize)
{
  modelica_integer _s;
  modelica_integer tmp1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_integer __omcQ_24tmpVar9;
    modelica_integer __omcQ_24tmpVar8;
    modelica_integer tmp2;
    modelica_metatype _i_loopVar = 0;
    modelica_metatype tmpMeta3;
    modelica_metatype _i;
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    _i_loopVar = omc_NFComponentRef_sizes(threadData, _cref, _withComplex, _resize, tmpMeta3);
    __omcQ_24tmpVar9 = ((modelica_integer) 1); /* defaultValue */
    while(1) {
      tmp2 = 1;
      if (!listEmpty(_i_loopVar)) {
        _i = MMC_CAR(_i_loopVar);
        _i_loopVar = MMC_CDR(_i_loopVar);
        tmp2--;
      }
      if (tmp2 == 0) {
        __omcQ_24tmpVar8 = mmc_unbox_integer(_i);
        __omcQ_24tmpVar9 = (__omcQ_24tmpVar9) * (__omcQ_24tmpVar8);
      } else if (tmp2 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp1 = __omcQ_24tmpVar9;
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NFComponentRef_size(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _withComplex, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer _s;
  modelica_integer tmp3;
  modelica_metatype out_s;
  tmp1 = mmc_unbox_integer(_withComplex);
  tmp2 = mmc_unbox_integer(_resize);
  _s = omc_NFComponentRef_size(threadData, _cref, tmp1, tmp2);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

DLLDirection
modelica_integer omc_NFComponentRef_depth(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _d;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _d = ((modelica_integer) 0);
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1) + _d;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1) + omc_NFComponentRef_depth(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _d = tmp1;
  _return: OMC_LABEL_UNUSED
  return _d;
}
modelica_metatype boxptr_NFComponentRef_depth(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _d;
  modelica_metatype out_d;
  _d = omc_NFComponentRef_depth(threadData, _cref);
  out_d = mmc_mk_icon(_d);
  return out_d;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toListReverse(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _includeScope, modelica_metatype _accum)
{
  modelica_metatype _crefs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _crefs has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!_includeScope) goto tmp3_end;
          tmpMeta7 = mmc_mk_cons(_cref, _accum);
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accum = tmpMeta7;
          _cref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          if (1 != tmp9) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta11 = mmc_mk_cons(_cref, _accum);
          /* Tail recursive call */
          tmpMeta10 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accum = tmpMeta11;
          _cref = tmpMeta10;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accum;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _crefs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _crefs;
}
modelica_metatype boxptr_NFComponentRef_toListReverse(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _includeScope, modelica_metatype _accum)
{
  modelica_integer tmp1;
  modelica_metatype _crefs = NULL;
  tmp1 = mmc_unbox_integer(_includeScope);
  _crefs = omc_NFComponentRef_toListReverse(threadData, _cref, tmp1, _accum);
  /* skip box _crefs; list<NFComponentRef> */
  return _crefs;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isFromCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _fromCref;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _fromCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _fromCref = tmp1;
  _return: OMC_LABEL_UNUSED
  return _fromCref;
}
modelica_metatype boxptr_NFComponentRef_isFromCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _fromCref;
  modelica_metatype out_fromCref;
  _fromCref = omc_NFComponentRef_isFromCref(threadData, _cref);
  out_fromCref = mmc_mk_icon(_fromCref);
  return out_fromCref;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isDeleted(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isDeleted;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isDeleted has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _node = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _node has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          if (1 != tmp8) goto tmp3_end;
          
          _node = tmpMeta6;
          /* Pattern matching succeeded */
          tmp1 = ((omc_NFInstNode_InstNode_isComponent(threadData, _node) && omc_NFComponent_isDeleted(threadData, omc_NFInstNode_InstNode_component(threadData, _node))) || omc_NFComponentRef_isDeleted(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isDeleted = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isDeleted;
}
modelica_metatype boxptr_NFComponentRef_isDeleted(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isDeleted;
  modelica_metatype out_isDeleted;
  _isDeleted = omc_NFComponentRef_isDeleted(threadData, _cref);
  out_isDeleted = mmc_mk_icon(_isDeleted);
  return out_isDeleted;
}

DLLDirection
modelica_metatype omc_NFComponentRef_evaluateSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (!listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          if (1 != tmp8) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[6] = omc_NFComponentRef_evaluateSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          _cref = tmpMeta9;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_integer tmp11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta16;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp11 = mmc_unbox_integer(tmpMeta10);
          if (1 != tmp11) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar11;
            modelica_metatype* tmp13;
            modelica_metatype tmpMeta14;
            modelica_metatype __omcQ_24tmpVar10;
            modelica_integer tmp15;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar11 = tmpMeta14; /* defaultValue */
            tmp13 = &__omcQ_24tmpVar11;
            while(1) {
              tmp15 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp15--;
              }
              if (tmp15 == 0) {
                __omcQ_24tmpVar10 = omc_NFSubscript_eval(threadData, _s, _OMC_LIT12);
                *tmp13 = mmc_mk_cons(__omcQ_24tmpVar10,0);
                tmp13 = &MMC_CDR(*tmp13);
              } else if (tmp15 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp13 = mmc_mk_nil();
            tmpMeta12 = __omcQ_24tmpVar11;
          }
          _subs = tmpMeta12;
          tmpMeta16 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), omc_NFComponentRef_evaluateSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          tmpMeta1 = tmpMeta16;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_simplifySubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_boolean _trim)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (!listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          if (1 != tmp8) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[6] = omc_NFComponentRef_simplifySubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _trim);
          _cref = tmpMeta9;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_integer tmp11;
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp11 = mmc_unbox_integer(tmpMeta10);
          if (1 != tmp11) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _subs = omc_NFSubscript_simplifyList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))), _trim);
          tmpMeta12 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), omc_NFComponentRef_simplifySubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _trim));
          tmpMeta1 = tmpMeta12;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}
modelica_metatype boxptr_NFComponentRef_simplifySubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _trim)
{
  modelica_integer tmp1;
  modelica_metatype _cref = NULL;
  tmp1 = mmc_unbox_integer(_trim);
  _cref = omc_NFComponentRef_simplifySubscripts(threadData, __omcQ_24in_5Fcref, tmp1);
  /* skip box _cref; NFComponentRef */
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_stripIteratorSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _subs = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  // _subs has no default value.
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          if(((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))) && omc_NFSubscript_isIterator(threadData, omc_List_last(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)))))))
          {
            _subs = listReverse((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))));

            _subs = omc_List_trim(threadData, _subs, boxvar_NFSubscript_isIterator);

            tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = listReverseInPlace(_subs);
            _cref = tmpMeta5;
          }

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NFComponentRef_stripIteratorSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          _cref = tmpMeta6;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_stripSubscriptsExceptModel(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _node = NULL;
      modelica_metatype _restCref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _node has no default value.
      // _restCref has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          _node = tmpMeta6;
          _restCref = tmpMeta7;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFInstNode_InstNode_isModel(threadData, _node)) goto tmp3_end;
          tmpMeta8 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), omc_NFComponentRef_stripSubscriptsExceptModel(threadData, _restCref));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          _restCref = tmpMeta9;
          /* Pattern matching succeeded */
          tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta11 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), tmpMeta10, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), omc_NFComponentRef_stripSubscriptsExceptModel(threadData, _restCref));
          tmpMeta1 = tmpMeta11;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_stripSubscriptsAll(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _strippedCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _strippedCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta7 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), tmpMeta6, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), omc_NFComponentRef_stripSubscriptsAll(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _strippedCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _strippedCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_stripSubscripts(threadData_t *threadData, modelica_metatype _cref, modelica_metatype *out_subs)
{
  modelica_metatype _strippedCref = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _strippedCref has no default value.
  // _subs has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta7 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), tmpMeta6, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          tmpMeta[0+0] = tmpMeta7;
          tmpMeta[0+1] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta[0+0] = _cref;
          tmpMeta[0+1] = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _strippedCref = tmpMeta[0+0];
  _subs = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_subs) { *out_subs = _subs; }
  return _strippedCref;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isPackageConstant2(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isPkgConst;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isPkgConst has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,7) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_isUserdefinedClass(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          if (1 != tmp8) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isPkgConst = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isPkgConst;
}
modelica_metatype boxptr_NFComponentRef_isPackageConstant2(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isPkgConst;
  modelica_metatype out_isPkgConst;
  _isPkgConst = omc_NFComponentRef_isPackageConstant2(threadData, _cref);
  out_isPkgConst = mmc_mk_icon(_isPkgConst);
  return out_isPkgConst;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isPackageConstant(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isPkgConst;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isPkgConst has no default value.
  _isPkgConst = ((omc_NFComponentRef_nodeVariability(threadData, _cref) <= 3) && omc_NFComponentRef_isPackageConstant2(threadData, _cref));
  _return: OMC_LABEL_UNUSED
  return _isPkgConst;
}
modelica_metatype boxptr_NFComponentRef_isPackageConstant(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isPkgConst;
  modelica_metatype out_isPkgConst;
  _isPkgConst = omc_NFComponentRef_isPackageConstant(threadData, _cref);
  out_isPkgConst = mmc_mk_icon(_isPkgConst);
  return out_isPkgConst;
}

DLLDirection
modelica_metatype omc_NFComponentRef_scalarizeSlice(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _slice, modelica_boolean _resize)
{
  modelica_metatype _crefs = NULL;
  modelica_metatype _next = NULL;
  modelica_metatype _nested_crefs = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _crefs has no default value.
  _next = _cref;
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _nested_crefs = tmpMeta1;
  while(1)
  {
    if(!(!omc_NFComponentRef_isEmpty(threadData, _next))) break;
    tmpMeta2 = mmc_mk_cons(omc_NFComponentRef_scalarize(threadData, _next, _resize), _nested_crefs);
    _nested_crefs = tmpMeta2;

    /* Pattern-matching assignment */
    tmpMeta3 = _next;
    if (mmc__uniontype__metarecord__typedef__equal(tmpMeta3,0,5) == 0) MMC_THROW_INTERNAL();
    tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 6));
    _next = tmpMeta4;
  }

  tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
  _crefs = omc_NFComponentRef_scalarizeAll__Nesting(threadData, _nested_crefs, _OMC_LIT7, tmpMeta5);

  if((!listEmpty(_slice)))
  {
    _crefs = omc_List_getAtIndexLst(threadData, _crefs, _slice, 1 /* true */);
  }
  _return: OMC_LABEL_UNUSED
  return _crefs;
}
modelica_metatype boxptr_NFComponentRef_scalarizeSlice(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _slice, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _crefs = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _crefs = omc_NFComponentRef_scalarizeSlice(threadData, _cref, _slice, tmp1);
  /* skip box _crefs; list<NFComponentRef> */
  return _crefs;
}

DLLDirection
modelica_metatype omc_NFComponentRef_scalarizeAll__Nesting(threadData_t *threadData, modelica_metatype _nested_crefs, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fcrefs)
{
  modelica_metatype _crefs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _crefs = __omcQ_24in_5Fcrefs;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _nested_crefs;
    {
      modelica_metatype _head = NULL;
      modelica_metatype _tail = NULL;
      modelica_boolean _empty;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _head has no default value.
      // _tail has no default value.
      // _empty has no default value.
      tmp4 = 0;
      for (; tmp4 < 1; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta16;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _head = tmpMeta6;
          _tail = tmpMeta7;
          /* Pattern matching succeeded */
          _empty = listEmpty(_tail);

          {
            modelica_metatype _head_cref;
            for (tmpMeta8 = _head; !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
            {
              _head_cref = MMC_CAR(tmpMeta8);
              { /* match expression */
                modelica_metatype tmp12_1;
                tmp12_1 = _head_cref;
                {
                  volatile mmc_switch_type tmp12;
                  int tmp13;
                  tmp12 = 0;
                  for (; tmp12 < 1; tmp12++) {
                    switch (MMC_SWITCH_CAST(tmp12)) {
                    case 0: {
                      modelica_metatype tmpMeta14;
                      modelica_metatype tmpMeta15;
                      if (mmc__uniontype__metarecord__typedef__equal(tmp12_1,0,5) == 0) goto tmp11_end;
                      
                      /* Pattern matching succeeded */
                      tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(7));
                      memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_head_cref), 7*sizeof(modelica_metatype));
                      ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[6] = _cref;
                      _head_cref = tmpMeta14;

                      if(_empty)
                      {
                        tmpMeta15 = mmc_mk_cons(_head_cref, _crefs);
                        _crefs = tmpMeta15;
                      }
                      else
                      {
                        _crefs = omc_NFComponentRef_scalarizeAll__Nesting(threadData, _tail, _head_cref, _crefs);
                      }
                      tmpMeta9 = _crefs;
                      goto tmp11_done;
                    }
                    }
                    goto tmp11_end;
                    tmp11_end: ;
                  }
                  goto goto_10;
                  goto_10:;
                  goto goto_2;
                  goto tmp11_done;
                  tmp11_done:;
                }
              }
              _crefs = tmpMeta9;
            }
          }
          tmpMeta1 = _crefs;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _crefs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _crefs;
}

DLLDirection
modelica_metatype omc_NFComponentRef_scalarizeAll(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _resize)
{
  modelica_metatype _crefs = NULL;
  modelica_metatype _next = NULL;
  modelica_metatype _nested_crefs = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _crefs has no default value.
  _next = _cref;
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _nested_crefs = tmpMeta1;
  while(1)
  {
    if(!(!omc_NFComponentRef_isEmpty(threadData, _next))) break;
    tmpMeta2 = mmc_mk_cons(omc_NFComponentRef_scalarize(threadData, _next, _resize), _nested_crefs);
    _nested_crefs = tmpMeta2;

    /* Pattern-matching assignment */
    tmpMeta3 = _next;
    if (mmc__uniontype__metarecord__typedef__equal(tmpMeta3,0,5) == 0) MMC_THROW_INTERNAL();
    tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 6));
    _next = tmpMeta4;
  }

  tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
  _crefs = omc_NFComponentRef_scalarizeAll__Nesting(threadData, _nested_crefs, _OMC_LIT7, tmpMeta5);
  _return: OMC_LABEL_UNUSED
  return _crefs;
}
modelica_metatype boxptr_NFComponentRef_scalarizeAll(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _crefs = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _crefs = omc_NFComponentRef_scalarizeAll(threadData, _cref, tmp1);
  /* skip box _crefs; list<NFComponentRef> */
  return _crefs;
}

DLLDirection
modelica_metatype omc_NFComponentRef_scalarize(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _resize)
{
  modelica_metatype _crefs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _crefs has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _dims = NULL;
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _dims has no default value.
      // _subs has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _dims = omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));

          _subs = omc_NFSubscript_scalarizeList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), _dims, _resize);

          _subs = omc_List_combination(threadData, _subs);
          {
            modelica_metatype __omcQ_24tmpVar13;
            modelica_metatype* tmp8;
            modelica_metatype tmpMeta9;
            modelica_metatype __omcQ_24tmpVar12;
            modelica_integer tmp10;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = _subs;
            tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar13 = tmpMeta9; /* defaultValue */
            tmp8 = &__omcQ_24tmpVar13;
            while(1) {
              tmp10 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp10--;
              }
              if (tmp10 == 0) {
                __omcQ_24tmpVar12 = omc_NFComponentRef_setSubscripts(threadData, _s, _cref);
                *tmp8 = mmc_mk_cons(__omcQ_24tmpVar12,0);
                tmp8 = &MMC_CDR(*tmp8);
              } else if (tmp10 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp8 = mmc_mk_nil();
            tmpMeta7 = __omcQ_24tmpVar13;
          }
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = mmc_mk_cons(_cref, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta11;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _crefs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _crefs;
}
modelica_metatype boxptr_NFComponentRef_scalarize(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _crefs = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _crefs = omc_NFComponentRef_scalarize(threadData, _cref, tmp1);
  /* skip box _crefs; list<NFComponentRef> */
  return _crefs;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fromNodeList(threadData_t *threadData, modelica_metatype _nodes)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = _OMC_LIT7;
  {
    modelica_metatype _n;
    for (tmpMeta1 = _nodes; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _n = MMC_CAR(tmpMeta1);
      tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
      tmpMeta3 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _n, tmpMeta2, omc_NFInstNode_InstNode_getType(threadData, _n), mmc_mk_integer(2), _cref);
      _cref = tmpMeta3;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toPath__impl(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumPath)
{
  modelica_metatype _path = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _path has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box3(3, &Absyn_Path_QUALIFIED__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), _accumPath);
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumPath = tmpMeta7;
          _cref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accumPath;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _path = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _path;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toPath(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _path = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _path has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 1; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box2(4, &Absyn_Path_IDENT__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))));
          tmpMeta1 = omc_NFComponentRef_toPath__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), tmpMeta6);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _path = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _path;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_hashStrip_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_integer __omcQ_24in_5Fhash)
{
  modelica_integer _hash;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _hash = __omcQ_24in_5Fhash;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          __omcQ_24in_5Fhash = stringHashDjb2Continue(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), _hash);
          _cref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = _hash;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hash = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hash;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_hashStrip_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fhash)
{
  modelica_integer tmp1;
  modelica_integer _hash;
  modelica_metatype out_hash;
  tmp1 = mmc_unbox_integer(__omcQ_24in_5Fhash);
  _hash = omc_NFComponentRef_hashStrip_hash__rest(threadData, _cref, tmp1);
  out_hash = mmc_mk_icon(_hash);
  return out_hash;
}

DLLDirection
modelica_integer omc_NFComponentRef_hashStrip(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _hash;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _hash has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponentRef_hashStrip_hash__rest(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), stringHashDjb2(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = stringHashDjb2(_OMC_LIT13);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hash = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hash;
}
modelica_metatype boxptr_NFComponentRef_hashStrip(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _hash;
  modelica_metatype out_hash;
  _hash = omc_NFComponentRef_hashStrip(threadData, _cref);
  out_hash = mmc_mk_icon(_hash);
  return out_hash;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_hash_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_integer __omcQ_24in_5Fhash)
{
  modelica_integer _hash;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _hash = __omcQ_24in_5Fhash;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _hash = stringHashDjb2Continue(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), _hash);

          {
            modelica_metatype _s;
            for (tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _s = MMC_CAR(tmpMeta6);
              _hash = stringHashDjb2Continue(omc_NFSubscript_toString(threadData, _s), _hash);
            }
          }
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          __omcQ_24in_5Fhash = _hash;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = _hash;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hash = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hash;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_hash_hash__rest(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fhash)
{
  modelica_integer tmp1;
  modelica_integer _hash;
  modelica_metatype out_hash;
  tmp1 = mmc_unbox_integer(__omcQ_24in_5Fhash);
  _hash = omc_NFComponentRef_hash_hash__rest(threadData, _cref, tmp1);
  out_hash = mmc_mk_icon(_hash);
  return out_hash;
}

DLLDirection
modelica_integer omc_NFComponentRef_hash(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _hash;
  modelica_integer _h;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _hash has no default value.
  // _h has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          _h = stringHashDjb2(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))));

          {
            modelica_metatype _s;
            for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
            {
              _s = MMC_CAR(tmpMeta5);
              _h = stringHashDjb2Continue(omc_NFSubscript_toString(threadData, _s), _h);
            }
          }
          tmp1 = omc_NFComponentRef_hash_hash__rest(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _h);
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = stringHashDjb2(_OMC_LIT13);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hash = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hash;
}
modelica_metatype boxptr_NFComponentRef_hash(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _hash;
  modelica_metatype out_hash;
  _hash = omc_NFComponentRef_hash(threadData, _cref);
  out_hash = mmc_mk_icon(_hash);
  return out_hash;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toJSON__impl(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accum)
{
  modelica_metatype _objs = NULL;
  modelica_metatype _obj = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _objs has no default value.
  // _obj has no default value.
  // _subs has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _obj = omc_JSON_emptyListObject(threadData);

          _obj = omc_JSON_addPair(threadData, _OMC_LIT14, omc_JSON_makeString(threadData, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))))), _obj);

          if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))))
          {
            _obj = omc_JSON_addPair(threadData, _OMC_LIT15, omc_NFSubscript_toJSONList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)))), _obj);
          }
          tmpMeta6 = mmc_mk_cons(_obj, _accum);
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accum = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accum;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _objs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _objs;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toJSON(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _json = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _json has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          _json = omc_JSON_emptyListObject(threadData);

          _json = omc_JSON_addPair(threadData, _OMC_LIT16, omc_JSON_makeString(threadData, _OMC_LIT17), _json);
          tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = omc_JSON_addPair(threadData, _OMC_LIT18, omc_JSON_makeArray(threadData, omc_NFComponentRef_toJSON__impl(threadData, _cref, tmpMeta5)), _json);
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_JSON_makeNull(threadData);
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          _json = omc_JSON_emptyListObject(threadData);

          _json = omc_JSON_addPair(threadData, _OMC_LIT16, omc_JSON_makeString(threadData, _OMC_LIT17), _json);
          tmpMeta6 = mmc_mk_cons(omc_JSON_fromPair(threadData, _OMC_LIT14, omc_JSON_makeString(threadData, _OMC_LIT13)), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = omc_JSON_addPair(threadData, _OMC_LIT18, omc_JSON_makeArray(threadData, tmpMeta6), _json);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_JSON_makeString(threadData, omc_NFComponentRef_toString(threadData, _cref));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _json = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _json;
}

DLLDirection
modelica_string omc_NFComponentRef_listToString(threadData_t *threadData, modelica_metatype _crs)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  tmpMeta1 = stringAppend(_OMC_LIT19,stringDelimitList(omc_List_map(threadData, _crs, boxvar_NFComponentRef_toString), _OMC_LIT20));
  tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT21);
  _str = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_string omc_NFComponentRef_toFlatString(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _format)
{
  modelica_string _str = NULL;
  modelica_metatype _strl = NULL;
  modelica_metatype _crefs = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype _cr = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  // _strl has no default value.
  // _crefs has no default value.
  // _subs has no default value.
  // _cr has no default value.
  _str = omc_NFComponentRef_firstName(threadData, _cref, 1 /* true */);

  if(((stringEqual(_str, _OMC_LIT9)) || (stringEqual(_str, _OMC_LIT1))))
  {
    goto _return;
  }

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _crefs = omc_NFComponentRef_toListReverse(threadData, _cref, 1 /* true */, tmpMeta1);

  _strl = _OMC_LIT23;

  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _subs = tmpMeta2;

  if((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_format), 2)))) == 3))
  {
    while(1)
    {
      if(!(!listEmpty(_crefs))) break;
      /* Pattern-matching assignment */
      tmpMeta3 = _crefs;
      if (listEmpty(tmpMeta3)) MMC_THROW_INTERNAL();
      tmpMeta4 = MMC_CAR(tmpMeta3);
      tmpMeta5 = MMC_CDR(tmpMeta3);
      _cr = tmpMeta4;
      _crefs = tmpMeta5;

      tmpMeta6 = mmc_mk_cons(omc_Util_escapeQuotes(threadData, omc_NFComponentRef_firstName(threadData, _cr, 1 /* true */)), _strl);
      _strl = tmpMeta6;

      _subs = listAppend(omc_NFComponentRef_getSubscripts(threadData, _cr), _subs);

      if(((((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_format), 3)))) == 1) && omc_NFComponentRef_isCref(threadData, _cr)) && omc_NFType_isRecord(threadData, omc_NFComponentRef_scalarType(threadData, _cr))) && (!listEmpty(_crefs))))
      {
        tmpMeta7 = mmc_mk_cons(_OMC_LIT22, _strl);
        _strl = tmpMeta7;

        if((!listEmpty(_subs)))
        {
          tmpMeta8 = mmc_mk_cons(omc_NFSubscript_toFlatStringList(threadData, _subs, _format), _strl);
          _strl = tmpMeta8;

          tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
          _subs = tmpMeta9;
        }

        if((!listEmpty(_crefs)))
        {
          tmpMeta10 = mmc_mk_cons(_OMC_LIT26, _strl);
          _strl = tmpMeta10;
        }
      }
      else
      {
        if((!listEmpty(_crefs)))
        {
          tmpMeta11 = mmc_mk_cons(_OMC_LIT24, _strl);
          _strl = tmpMeta11;
        }
      }
    }
  }
  else
  {
    while(1)
    {
      if(!(!listEmpty(_crefs))) break;
      /* Pattern-matching assignment */
      tmpMeta12 = _crefs;
      if (listEmpty(tmpMeta12)) MMC_THROW_INTERNAL();
      tmpMeta13 = MMC_CAR(tmpMeta12);
      tmpMeta14 = MMC_CDR(tmpMeta12);
      _cr = tmpMeta13;
      _crefs = tmpMeta14;

      tmpMeta15 = mmc_mk_cons(omc_Util_escapeQuotes(threadData, omc_NFComponentRef_firstName(threadData, _cr, 1 /* true */)), _strl);
      _strl = tmpMeta15;

      _subs = omc_NFComponentRef_getSubscripts(threadData, _cr);

      if(((!listEmpty(_subs)) && (!((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_format), 2)))) == 2) && listEmpty(_crefs)))))
      {
        tmpMeta16 = mmc_mk_cons(omc_NFSubscript_toFlatStringList(threadData, _subs, _format), _strl);
        _strl = tmpMeta16;
      }

      if((!listEmpty(_crefs)))
      {
        if((((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_format), 3)))) == 1) && omc_NFComponentRef_isCref(threadData, _cr)) && omc_NFType_isRecord(threadData, omc_NFComponentRef_scalarType(threadData, _cr))))
        {
          tmpMeta17 = mmc_mk_cons(_OMC_LIT25, _strl);
          _strl = tmpMeta17;
        }
        else
        {
          tmpMeta18 = mmc_mk_cons(_OMC_LIT24, _strl);
          _strl = tmpMeta18;
        }
      }
    }

    if((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_format), 2)))) == 2))
    {
      _subs = omc_NFComponentRef_getSubscripts(threadData, _cref);
    }
    else
    {
      tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
      _subs = tmpMeta19;
    }
  }

  tmpMeta20 = mmc_mk_cons(_OMC_LIT22, _strl);
  _strl = tmpMeta20;

  if((!listEmpty(_subs)))
  {
    tmpMeta21 = mmc_mk_cons(omc_NFSubscript_toFlatStringList(threadData, _subs, _format), _strl);
    _strl = tmpMeta21;
  }

  _str = stringAppendList(listReverse(_strl));
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toString__impl(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fstrl)
{
  modelica_metatype _strl = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _strl = __omcQ_24in_5Fstrl;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_string _str = NULL;
      int tmp4;
      // _str has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))),omc_NFSubscript_toStringList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)))));
          _str = tmpMeta5;
          tmpMeta6 = mmc_mk_cons(_str, _strl);
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          __omcQ_24in_5Fstrl = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_cons(_OMC_LIT13, _strl);
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _strl;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _strl = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _strl;
}

DLLDirection
modelica_string omc_NFComponentRef_toString(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _str = stringDelimitList(omc_NFComponentRef_toString__impl(threadData, _cref, tmpMeta1), _OMC_LIT24);
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toDAE__impl(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumCref)
{
  modelica_metatype _dcref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _dcref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _ty = NULL;
      modelica_metatype _dty = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _ty has no default value.
      // _dty has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _accumCref;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _ty = (omc_NFType_isUnknown(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))))?omc_NFInstNode_InstNode_getType(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))):(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));

          _dty = omc_NFType_toDAE(threadData, _ty, 0 /* false */);

          {
            modelica_metatype __omcQ_24tmpVar15;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar14;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar15 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar15;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar14 = omc_NFSubscript_toDAE(threadData, _s);
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar14,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar15;
          }
          tmpMeta10 = mmc_mk_box5(3, &DAE_ComponentRef_CREF__QUAL__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), _dty, tmpMeta6, _accumCref);
          _dcref = tmpMeta10;
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumCref = _dcref;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _dcref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _dcref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toDAE(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _dcref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _dcref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar17;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar16;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar17 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar17;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar16 = omc_NFSubscript_toDAE(threadData, _s);
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar16,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar17;
          }
          tmpMeta10 = mmc_mk_box4(4, &DAE_ComponentRef_CREF__IDENT__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), omc_NFType_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), 1 /* true */), tmpMeta6);
          _dcref = tmpMeta10;
          tmpMeta1 = omc_NFComponentRef_toDAE__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _dcref);
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT27;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _dcref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _dcref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toAbsyn__impl(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumCref)
{
  modelica_metatype _acref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _acref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _accumCref;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar19;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar18;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar19 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar19;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar18 = omc_NFSubscript_toAbsyn(threadData, _s);
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar18,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar19;
          }
          tmpMeta10 = mmc_mk_box4(4, &Absyn_ComponentRef_CREF__QUAL__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), tmpMeta6, _accumCref);
          _acref = tmpMeta10;
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumCref = _acref;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _acref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _acref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_toAbsyn(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _acref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _acref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar21;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar20;
            modelica_integer tmp9;
            modelica_metatype _s_loopVar = 0;
            modelica_metatype _s;
            _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar21 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar21;
            while(1) {
              tmp9 = 1;
              if (!listEmpty(_s_loopVar)) {
                _s = MMC_CAR(_s_loopVar);
                _s_loopVar = MMC_CDR(_s_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar20 = omc_NFSubscript_toAbsyn(threadData, _s);
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar20,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar21;
          }
          tmpMeta10 = mmc_mk_box3(5, &Absyn_ComponentRef_CREF__IDENT__desc, omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))), tmpMeta6);
          _acref = tmpMeta10;
          tmpMeta1 = omc_NFComponentRef_toAbsyn__impl(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _acref);
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT28;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _acref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _acref;
}

DLLDirection
modelica_boolean omc_NFComponentRef_backendCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = omc_StringUtil_startsWith(threadData, omc_NFComponentRef_firstName(threadData, _cref, 0 /* false */), _OMC_LIT29);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_backendCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_backendCref(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isPrefix(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isPrefix;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isPrefix has no default value.
  if(referenceEq(_cref1, _cref2))
  {
    _isPrefix = 1 /* true */;

    goto _return;
  }

  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _cref1;
    tmp4_2 = _cref2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((stringEqual(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 2)))), omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 2))))))?omc_NFComponentRef_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 6))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 6)))):omc_NFComponentRef_isEqual(threadData, _cref1, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isPrefix = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isPrefix;
}
modelica_metatype boxptr_NFComponentRef_isPrefix(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isPrefix;
  modelica_metatype out_isPrefix;
  _isPrefix = omc_NFComponentRef_isPrefix(threadData, _cref1, _cref2);
  out_isPrefix = mmc_mk_icon(_isPrefix);
  return out_isPrefix;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isGreater(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isGreater;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _isGreater = (omc_NFComponentRef_compare(threadData, _cref1, _cref2) > ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _isGreater;
}
modelica_metatype boxptr_NFComponentRef_isGreater(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isGreater;
  modelica_metatype out_isGreater;
  _isGreater = omc_NFComponentRef_isGreater(threadData, _cref1, _cref2);
  out_isGreater = mmc_mk_icon(_isGreater);
  return out_isGreater;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isLess(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isLess;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _isLess = (omc_NFComponentRef_compare(threadData, _cref1, _cref2) < ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _isLess;
}
modelica_metatype boxptr_NFComponentRef_isLess(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _isLess;
  modelica_metatype out_isLess;
  _isLess = omc_NFComponentRef_isLess(threadData, _cref1, _cref2);
  out_isLess = mmc_mk_icon(_isLess);
  return out_isLess;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isEqualStrip(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  if(referenceEq(_cref1, _cref2))
  {
    _b = 1 /* true */;

    goto _return;
  }

  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _cref1;
    tmp4_2 = _cref2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((stringEqual(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 2)))), omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 2)))))) && omc_NFComponentRef_isEqualStrip(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 6))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 6)))));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isEqualStrip(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isEqualStrip(threadData, _cref1, _cref2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isEqual(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  if(referenceEq(_cref1, _cref2))
  {
    _b = 1 /* true */;

    goto _return;
  }

  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _cref1;
    tmp4_2 = _cref2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (((stringEqual(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 2)))), omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 2)))))) && omc_NFSubscript_isEqualList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 3))))) && omc_NFComponentRef_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 6))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 6)))));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isEqual(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isEqual(threadData, _cref1, _cref2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NFComponentRef_compare(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_integer _comp;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _comp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _cref1;
    tmp4_2 = _cref2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 8; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _comp = stringCompare(omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 2)))), omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 2)))));

          if((_comp != ((modelica_integer) 0)))
          {
            goto _return;
          }

          _comp = omc_NFSubscript_compareList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 3))));

          if((_comp != ((modelica_integer) 0)))
          {
            goto _return;
          }
          /* Tail recursive call */
          _cref1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref1), 6)));
          _cref2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref2), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1);
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1);
          goto tmp3_done;
        }
        case 5: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) -1);
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) -1);
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          omc_Error_assertion(threadData, 0 /* false */, _OMC_LIT30, _OMC_LIT32);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _comp = tmp1;
  _return: OMC_LABEL_UNUSED
  return _comp;
}
modelica_metatype boxptr_NFComponentRef_compare(threadData_t *threadData, modelica_metatype _cref1, modelica_metatype _cref2)
{
  modelica_integer _comp;
  modelica_metatype out_comp;
  _comp = omc_NFComponentRef_compare(threadData, _cref1, _cref2);
  out_comp = mmc_mk_icon(_comp);
  return out_comp;
}

DLLDirection
modelica_metatype omc_NFComponentRef_combineSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  // _subs has no default value.
  _cref = omc_NFComponentRef_fillSubscripts(threadData, _cref);

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _subs = omc_List_flatten(threadData, omc_NFComponentRef_subscriptsAllReverse(threadData, _cref, tmpMeta1));

  if(listEmpty(_subs))
  {
    goto _return;
  }

  _cref = omc_NFComponentRef_setSubscripts(threadData, _subs, omc_NFComponentRef_stripSubscriptsAll(threadData, _cref));
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_replaceWholeSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      modelica_metatype _dims = NULL;
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _dims has no default value.
      // _subs has no default value.
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          if(omc_List_any(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), boxvar_NFSubscript_isWhole))
          {
            _dims = omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));

            tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
            _subs = tmpMeta5;

            {
              modelica_metatype _s;
              for (tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
              {
                _s = MMC_CAR(tmpMeta6);
                if(omc_NFSubscript_isWhole(threadData, _s))
                {
                  _s = omc_NFSubscript_fromDimension(threadData, listHead(_dims));
                }

                tmpMeta7 = mmc_mk_cons(_s, _subs);
                _subs = tmpMeta7;

                _dims = listRest(_dims);
              }
            }

            tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[3] = listReverseInPlace(_subs);
            _cref = tmpMeta9;
          }

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = omc_NFComponentRef_replaceWholeSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          _cref = tmpMeta10;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fillSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      modelica_metatype _dims = NULL;
      modelica_integer _dim_count;
      modelica_integer _sub_count;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _dims has no default value.
      // _dim_count has no default value.
      // _sub_count has no default value.
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          _dims = omc_NFType_arrayDims(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));

          _dim_count = listLength(_dims);

          _sub_count = listLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))));

          if((_sub_count < _dim_count))
          {
            tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = omc_List_consN(threadData, _dim_count - _sub_count, _OMC_LIT0, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))));
            _cref = tmpMeta5;
          }

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NFComponentRef_fillSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          _cref = tmpMeta6;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mapSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_fnptr _func, modelica_boolean _applyToScope)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_applyToScope || (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5)))) == 1))) goto tmp3_end;
          if((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))))
          {
            {
              modelica_metatype __omcQ_24tmpVar23;
              modelica_metatype* tmp8;
              modelica_metatype tmpMeta9;
              modelica_metatype __omcQ_24tmpVar22;
              modelica_integer tmp10;
              modelica_metatype _s_loopVar = 0;
              modelica_metatype _s;
              _s_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
              tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar23 = tmpMeta9; /* defaultValue */
              tmp8 = &__omcQ_24tmpVar23;
              while(1) {
                tmp10 = 1;
                if (!listEmpty(_s_loopVar)) {
                  _s = MMC_CAR(_s_loopVar);
                  _s_loopVar = MMC_CDR(_s_loopVar);
                  tmp10--;
                }
                if (tmp10 == 0) {
                  __omcQ_24tmpVar22 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _s) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _s);
                  *tmp8 = mmc_mk_cons(__omcQ_24tmpVar22,0);
                  tmp8 = &MMC_CDR(*tmp8);
                } else if (tmp10 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp8 = mmc_mk_nil();
              tmpMeta7 = __omcQ_24tmpVar23;
            }
            tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = tmpMeta7;
            _cref = tmpMeta6;
          }

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[6] = omc_NFComponentRef_mapSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func), _applyToScope);
          _cref = tmpMeta11;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}
modelica_metatype boxptr_NFComponentRef_mapSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_fnptr _func, modelica_metatype _applyToScope)
{
  modelica_integer tmp1;
  modelica_metatype _cref = NULL;
  tmp1 = mmc_unbox_integer(_applyToScope);
  _cref = omc_NFComponentRef_mapSubscripts(threadData, __omcQ_24in_5Fcref, _func, tmp1);
  /* skip box _cref; NFComponentRef */
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_foldSubscripts(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_boolean _applyToScope)
{
  modelica_metatype _arg = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _arg = __omcQ_24in_5Farg;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_applyToScope || (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5)))) == 1))) goto tmp3_end;
          {
            modelica_metatype _sub;
            for (tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _sub = MMC_CAR(tmpMeta6);
              _arg = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _sub, _arg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _sub, _arg);
            }
          }
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          __omcQ_24in_5Farg = _arg;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _arg;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _arg = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _arg;
}
modelica_metatype boxptr_NFComponentRef_foldSubscripts(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype __omcQ_24in_5Farg, modelica_metatype _applyToScope)
{
  modelica_integer tmp1;
  modelica_metatype _arg = NULL;
  tmp1 = mmc_unbox_integer(_applyToScope);
  _arg = omc_NFComponentRef_foldSubscripts(threadData, _cref, _func, __omcQ_24in_5Farg, tmp1);
  /* skip box _arg; polymorphic<ArgT> */
  return _arg;
}

DLLDirection
void omc_NFComponentRef_applySubscripts(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_boolean _applyToScope)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_applyToScope || (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5)))) == 1))) goto tmp2_end;
          {
            modelica_metatype _sub;
            for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
            {
              _sub = MMC_CAR(tmpMeta5);
              (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((void(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _sub) : ((void(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _sub);
            }
          }

          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          ;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}
void boxptr_NFComponentRef_applySubscripts(threadData_t *threadData, modelica_metatype _cref, modelica_fnptr _func, modelica_metatype _applyToScope)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_applyToScope);
  omc_NFComponentRef_applySubscripts(threadData, _cref, _func, tmp1);
  return;
}

DLLDirection
modelica_metatype omc_NFComponentRef_transferSubscripts(threadData_t *threadData, modelica_metatype _srcCref, modelica_metatype _dstCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _cref has no default value.
  // _subs has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _srcCref;
    tmp4_2 = _dstCref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 8; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _dstCref;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _dstCref;
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _dstCref;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (3 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _dstCref;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          if (1 != tmp9) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_dstCref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = omc_NFComponentRef_transferSubscripts(threadData, _srcCref, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 6))));
          _dstCref = tmpMeta10;
          tmpMeta1 = _dstCref;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFInstNode_InstNode_refEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_srcCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 2))))) goto tmp3_end;
          _cref = omc_NFComponentRef_transferSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_srcCref), 6))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 6))));

          _subs = (listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_srcCref), 3))))?(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 3))):(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_srcCref), 3))));
          tmpMeta11 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_dstCref), 5))), _cref);
          tmpMeta1 = tmpMeta11;
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _srcCref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_srcCref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          omc_Error_assertion(threadData, 0 /* false */, _OMC_LIT33, _OMC_LIT34);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsN(threadData_t *threadData, modelica_metatype _cref, modelica_integer _n)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _subs = NULL;
  modelica_metatype _rest = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  modelica_integer tmp8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _subscripts = tmpMeta1;
  // _subs has no default value.
  _rest = _cref;
  tmp6 = ((modelica_integer) 1); tmp7 = 1; tmp8 = _n;
  if(!(((tmp7 > 0) && (tmp6 > tmp8)) || ((tmp7 < 0) && (tmp6 < tmp8))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp6, tmp8); _i += tmp7)
    {
      if(omc_NFComponentRef_isEmpty(threadData, _rest))
      {
        break;
      }

      /* Pattern-matching assignment */
      tmpMeta2 = _rest;
      if (mmc__uniontype__metarecord__typedef__equal(tmpMeta2,0,5) == 0) MMC_THROW_INTERNAL();
      tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 3));
      tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 6));
      _subs = tmpMeta3;
      _rest = tmpMeta4;

      tmpMeta5 = mmc_mk_cons(_subs, _subscripts);
      _subscripts = tmpMeta5;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}
modelica_metatype boxptr_NFComponentRef_subscriptsN(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _n)
{
  modelica_integer tmp1;
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_n);
  _subscripts = omc_NFComponentRef_subscriptsN(threadData, _cref, tmp1);
  /* skip box _subscripts; list<list<NFSubscript>> */
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsExceptModel(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumSubs)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFInstNode_InstNode_isModel(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))))) goto tmp3_end;
          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta6 = mmc_mk_cons(tmpMeta7, _accumSubs);
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumSubs = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), _accumSubs);
          /* Tail recursive call */
          tmpMeta8 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumSubs = tmpMeta9;
          _cref = tmpMeta8;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accumSubs;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsAllFlat(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _subscripts = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _subscripts = omc_List_flattenReverse(threadData, omc_NFComponentRef_subscriptsAll(threadData, _cref));
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsAllReverse(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumSubs)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), _accumSubs);
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumSubs = tmpMeta7;
          _cref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accumSubs;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsAll(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _subscripts = listReverseInPlace(omc_NFComponentRef_subscriptsAllReverse(threadData, _cref, tmpMeta1));
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsAllWithWholeFlat(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _subscripts = omc_List_flatten(threadData, omc_NFComponentRef_subscriptsAllWithWhole(threadData, _cref, tmpMeta1));
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_subscriptsAllWithWhole(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accumSubs)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _sizes_ = NULL;
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _sizes_ has no default value.
      // _subs has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (!listEmpty(tmpMeta6)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(!omc_NFComponentRef_backendCref(threadData, _cref))) goto tmp3_end;
          _sizes_ = omc_NFComponentRef_sizes__local(threadData, _cref, 0 /* false */, 0 /* false */);

          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          _subs = tmpMeta7;

          {
            modelica_metatype _size;
            for (tmpMeta8 = listReverse(_sizes_); !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
            {
              _size = MMC_CAR(tmpMeta8);
              if((mmc_unbox_integer(_size) != ((modelica_integer) 1)))
              {
                tmpMeta10 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _size);
                tmpMeta11 = mmc_mk_box5(13, &NFExpression_RANGE__desc, _OMC_LIT4, _OMC_LIT5, mmc_mk_none(), tmpMeta10);
                tmpMeta12 = mmc_mk_box2(6, &NFSubscript_SLICE__desc, tmpMeta11);
                tmpMeta9 = mmc_mk_cons(tmpMeta12, _subs);
                _subs = tmpMeta9;
              }
            }
          }
          tmpMeta14 = mmc_mk_cons(_subs, _accumSubs);
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumSubs = tmpMeta14;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta16 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), _accumSubs);
          /* Tail recursive call */
          tmpMeta15 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accumSubs = tmpMeta16;
          _cref = tmpMeta15;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accumSubs;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_copySubscripts(threadData_t *threadData, modelica_metatype _origin, modelica_metatype __omcQ_24in_5Ftarget)
{
  modelica_metatype _target = NULL;
  modelica_metatype _subs = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _target = __omcQ_24in_5Ftarget;
  _subs = omc_NFComponentRef_subscriptsAllFlat(threadData, _origin);
  if((!listEmpty(_subs)))
  {
    _target = omc_NFComponentRef_mergeSubscripts(threadData, _subs, _target, 1 /* true */, 1 /* true */);
  }
  _return: OMC_LABEL_UNUSED
  return _target;
}

DLLDirection
modelica_metatype omc_NFComponentRef_setSubscriptsList(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _subscripts;
    tmp4_2 = _cref;
    {
      modelica_metatype _subs = NULL;
      modelica_metatype _rest_subs = NULL;
      modelica_metatype _rest_cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _subs has no default value.
      // _rest_subs has no default value.
      // _rest_cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          _subs = tmpMeta6;
          _rest_subs = tmpMeta7;
          /* Pattern matching succeeded */
          _rest_cref = omc_NFComponentRef_setSubscriptsList(threadData, _rest_subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          tmpMeta8 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest_cref);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 1: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_setSubscripts(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 1; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = _subscripts;
          _cref = tmpMeta5;
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_getSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3)));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_expandSplitSubscripts(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_integer tmp6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
          tmp6 = mmc_unbox_integer(tmpMeta5);
          if (1 != tmp6) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[3] = omc_NFSubscript_expandSplitIndices(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), tmpMeta8);
          _cref = tmpMeta7;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[6] = omc_NFComponentRef_expandSplitSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          _cref = tmpMeta9;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_boolean omc_NFComponentRef_hasSplitSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_List_any(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), boxvar_NFSubscript_isSplitIndex) || omc_NFComponentRef_hasSplitSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_hasSplitSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_hasSplitSubscripts(threadData, _cref);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_hasNonModelSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _hasSubscripts;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _hasSubscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFInstNode_InstNode_isModel(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))))) goto tmp3_end;
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))) || omc_NFComponentRef_hasNonModelSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hasSubscripts = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hasSubscripts;
}
modelica_metatype boxptr_NFComponentRef_hasNonModelSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _hasSubscripts;
  modelica_metatype out_hasSubscripts;
  _hasSubscripts = omc_NFComponentRef_hasNonModelSubscripts(threadData, _cref);
  out_hasSubscripts = mmc_mk_icon(_hasSubscripts);
  return out_hasSubscripts;
}

DLLDirection
modelica_boolean omc_NFComponentRef_hasSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _hasSubscripts;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _hasSubscripts has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((!listEmpty((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))))) || omc_NFComponentRef_hasSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _hasSubscripts = tmp1;
  _return: OMC_LABEL_UNUSED
  return _hasSubscripts;
}
modelica_metatype boxptr_NFComponentRef_hasSubscripts(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _hasSubscripts;
  modelica_metatype out_hasSubscripts;
  _hasSubscripts = omc_NFComponentRef_hasSubscripts(threadData, _cref);
  out_hasSubscripts = mmc_mk_icon(_hasSubscripts);
  return out_hasSubscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mergeSubscripts2(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fsubscripts, modelica_metatype __omcQ_24in_5Fcref, modelica_boolean _applyToScope, modelica_boolean _backend, modelica_metatype *out_cref)
{
  modelica_metatype _subscripts = NULL;
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _subscripts = __omcQ_24in_5Fsubscripts;
  _cref = __omcQ_24in_5Fcref;
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _rest_cref = NULL;
      modelica_metatype _cref_subs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest_cref has no default value.
      // _cref_subs has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _cref_subs = tmpMeta6;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_applyToScope || (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5)))) == 1))) goto tmp3_end;
          _subscripts = omc_NFComponentRef_mergeSubscripts2(threadData, _subscripts, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _applyToScope, _backend ,&_rest_cref);

          if((!listEmpty(_subscripts)))
          {
            _cref_subs = omc_NFSubscript_mergeList(threadData, _subscripts, _cref_subs, omc_NFType_dimensionCount(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))), _backend ,&_subscripts);
          }
          tmpMeta7 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _cref_subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 5))), _rest_cref);
          tmpMeta[0+0] = _subscripts;
          tmpMeta[0+1] = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _subscripts;
          tmpMeta[0+1] = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _subscripts = tmpMeta[0+0];
  _cref = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_cref) { *out_cref = _cref; }
  return _subscripts;
}
modelica_metatype boxptr_NFComponentRef_mergeSubscripts2(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fsubscripts, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _applyToScope, modelica_metatype _backend, modelica_metatype *out_cref)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _subscripts = NULL;
  tmp1 = mmc_unbox_integer(_applyToScope);
  tmp2 = mmc_unbox_integer(_backend);
  _subscripts = omc_NFComponentRef_mergeSubscripts2(threadData, __omcQ_24in_5Fsubscripts, __omcQ_24in_5Fcref, tmp1, tmp2, out_cref);
  /* skip box _subscripts; list<NFSubscript> */
  /* skip box _cref; NFComponentRef */
  return _subscripts;
}

DLLDirection
modelica_metatype omc_NFComponentRef_mergeSubscripts(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype __omcQ_24in_5Fcref, modelica_boolean _applyToScope, modelica_boolean _backend)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _old_cref = NULL;
  modelica_metatype _new_subscripts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  _old_cref = _cref;
  // _new_subscripts has no default value.
  _new_subscripts = omc_NFComponentRef_mergeSubscripts2(threadData, _subscripts, _cref, _applyToScope, _backend ,&_cref);

  if((!listEmpty(_new_subscripts)))
  {
    tmpMeta1 = stringAppend(_OMC_LIT35,omc_List_toString(threadData, _subscripts, boxvar_NFSubscript_toString, _OMC_LIT1, _OMC_LIT19, _OMC_LIT36, _OMC_LIT21, 1 /* true */, ((modelica_integer) 0)));
    tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT37);
    tmpMeta3 = stringAppend(tmpMeta2,omc_NFComponentRef_toString(threadData, _old_cref));
    tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT38);
    tmpMeta5 = stringAppend(tmpMeta4,omc_NFComponentRef_toString(threadData, _cref));
    tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT39);
    tmpMeta7 = stringAppend(tmpMeta6,omc_List_toString(threadData, _new_subscripts, boxvar_NFSubscript_toString, _OMC_LIT1, _OMC_LIT19, _OMC_LIT36, _OMC_LIT21, 1 /* true */, ((modelica_integer) 0)));
    tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT24);
    omc_Error_assertion(threadData, 0 /* false */, tmpMeta8, _OMC_LIT40);

    MMC_THROW_INTERNAL();
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}
modelica_metatype boxptr_NFComponentRef_mergeSubscripts(threadData_t *threadData, modelica_metatype _subscripts, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _applyToScope, modelica_metatype _backend)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _cref = NULL;
  tmp1 = mmc_unbox_integer(_applyToScope);
  tmp2 = mmc_unbox_integer(_backend);
  _cref = omc_NFComponentRef_mergeSubscripts(threadData, _subscripts, __omcQ_24in_5Fcref, tmp1, tmp2);
  /* skip box _cref; NFComponentRef */
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_addSubscript(threadData_t *threadData, modelica_metatype _subscript, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 1; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_cons(_subscript, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = listAppend((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), tmpMeta6);
          _cref = tmpMeta5;
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_rename(threadData_t *threadData, modelica_string _name, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[2] = omc_NFInstNode_InstNode_rename(threadData, _name, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          _cref = tmpMeta6;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_integer omc_NFComponentRef_visibility(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _vis;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _vis has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_boolean tmp6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp6 = (modelica_boolean)omc_NFInstNode_InstNode_isProtected(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          if(tmp6)
          {
            tmp7 = 2;
          }
          else
          {
            /* Tail recursive call */
            _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
            goto _tailrecursive;
            /* TODO: Make sure any eventual dead code below is never generated */
          }
          tmp1 = tmp7;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 1;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _vis = tmp1;
  _return: OMC_LABEL_UNUSED
  return _vis;
}
modelica_metatype boxptr_NFComponentRef_visibility(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _vis;
  modelica_metatype out_vis;
  _vis = omc_NFComponentRef_visibility(threadData, _cref);
  out_vis = mmc_mk_icon(_vis);
  return out_vis;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_NFComponentRef_purity_sub__purity(threadData_t *threadData, modelica_metatype _sub, modelica_integer __omcQ_24in_5Fpur)
{
  modelica_integer _pur;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _pur = (modelica_integer)__omcQ_24in_5Fpur;
  _pur = omc_NFPrefixes_purityMin(threadData, (modelica_integer)_pur, omc_NFSubscript_purity(threadData, _sub));
  _return: OMC_LABEL_UNUSED
  return _pur;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_purity_sub__purity(threadData_t *threadData, modelica_metatype _sub, modelica_metatype __omcQ_24in_5Fpur)
{
  modelica_integer tmp1;
  modelica_integer _pur;
  modelica_metatype out_pur;
  tmp1 = mmc_unbox_integer(__omcQ_24in_5Fpur);
  _pur = omc_NFComponentRef_purity_sub__purity(threadData, _sub, tmp1);
  out_pur = mmc_mk_icon(_pur);
  return out_pur;
}

DLLDirection
modelica_integer omc_NFComponentRef_purity(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _pur;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pur has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (3 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 2;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = mmc_unbox_integer(omc_NFComponentRef_foldSubscripts(threadData, _cref, boxvar_NFComponentRef_purity_sub__purity, mmc_mk_integer(1), 0 /* false */));
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _pur = tmp1;
  _return: OMC_LABEL_UNUSED
  return _pur;
}
modelica_metatype boxptr_NFComponentRef_purity(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _pur;
  modelica_metatype out_pur;
  _pur = omc_NFComponentRef_purity(threadData, _cref);
  out_pur = mmc_mk_icon(_pur);
  return out_pur;
}

DLLDirection
modelica_integer omc_NFComponentRef_variability(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _var;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _var = omc_NFPrefixes_variabilityMax(threadData, omc_NFComponentRef_nodeVariability(threadData, _cref), omc_NFComponentRef_subscriptsVariability(threadData, _cref, 1));
  _return: OMC_LABEL_UNUSED
  return _var;
}
modelica_metatype boxptr_NFComponentRef_variability(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _var;
  modelica_metatype out_var;
  _var = omc_NFComponentRef_variability(threadData, _cref);
  out_var = mmc_mk_icon(_var);
  return out_var;
}

DLLDirection
modelica_integer omc_NFComponentRef_subscriptsVariability(threadData_t *threadData, modelica_metatype _cref, modelica_integer __omcQ_24in_5Fvar)
{
  modelica_integer _var;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _var = (modelica_integer)__omcQ_24in_5Fvar;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_integer tmp6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
          tmp6 = mmc_unbox_integer(tmpMeta5);
          if (1 != tmp6) goto tmp2_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype _sub;
            for (tmpMeta7 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta7); tmpMeta7=MMC_CDR(tmpMeta7))
            {
              _sub = MMC_CAR(tmpMeta7);
              _var = omc_NFPrefixes_variabilityMax(threadData, (modelica_integer)_var, omc_NFSubscript_variability(threadData, _sub));
            }
          }
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _var;
}
modelica_metatype boxptr_NFComponentRef_subscriptsVariability(threadData_t *threadData, modelica_metatype _cref, modelica_metatype __omcQ_24in_5Fvar)
{
  modelica_integer tmp1;
  modelica_integer _var;
  modelica_metatype out_var;
  tmp1 = mmc_unbox_integer(__omcQ_24in_5Fvar);
  _var = omc_NFComponentRef_subscriptsVariability(threadData, _cref, tmp1);
  out_var = mmc_mk_icon(_var);
  return out_var;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isResizable(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _v = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _v has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponent_isResizable(threadData, omc_NFInstNode_InstNode_component(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_boolean tmp9 = 0;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,7,2) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 3));
          
          _v = tmpMeta8;
          /* Pattern matching succeeded */
          { /* match expression */
            modelica_metatype tmp12_1;
            tmp12_1 = omc_Pointer_access(threadData, _v);
            {
              volatile mmc_switch_type tmp12;
              int tmp13;
              tmp12 = 0;
              for (; tmp12 < 2; tmp12++) {
                switch (MMC_SWITCH_CAST(tmp12)) {
                case 0: {
                  modelica_metatype tmpMeta14;
                  modelica_metatype tmpMeta15;
                  modelica_metatype tmpMeta16;
                  modelica_integer tmp17;
                  if (mmc__uniontype__metarecord__typedef__equal(tmp12_1,0,10) == 0) goto tmp11_end;
                  tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp12_1), 11));
                  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,0,7) == 0) goto tmp11_end;
                  tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 4));
                  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta15,0,2) == 0) goto tmp11_end;
                  tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta15), 3));
                  tmp17 = mmc_unbox_integer(tmpMeta16);
                  
                  _b = tmp17  /* pattern as ty=Boolean */;
                  /* Pattern matching succeeded */
                  tmp9 = _b;
                  goto tmp11_done;
                }
                case 1: {
                  
                  /* Pattern matching succeeded */
                  tmp9 = 0 /* false */;
                  goto tmp11_done;
                }
                }
                goto tmp11_end;
                tmp11_end: ;
              }
              goto goto_10;
              goto_10:;
              goto goto_2;
              goto tmp11_done;
              tmp11_done:;
            }
          }tmp1 = tmp9;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isResizable(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isResizable(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NFComponentRef_nodeVariability(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _var;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _var has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _v = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _v has no default value.
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponent_variability(threadData, omc_NFInstNode_InstNode_component(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2)))));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,0,7) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,7,2) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          
          _v = tmpMeta9;
          /* Pattern matching succeeded */
          tmp1 = omc_NFVariable_variability(threadData, omc_Pointer_access(threadData, _v));
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = 7;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _var = tmp1;
  _return: OMC_LABEL_UNUSED
  return _var;
}
modelica_metatype boxptr_NFComponentRef_nodeVariability(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_integer _var;
  modelica_metatype out_var;
  _var = omc_NFComponentRef_nodeVariability(threadData, _cref);
  out_var = mmc_mk_icon(_var);
  return out_var;
}

DLLDirection
modelica_metatype omc_NFComponentRef_lookupVarAttr(threadData_t *threadData, modelica_metatype _cref, modelica_string _attr_name)
{
  modelica_metatype _attrValue = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _attrValue has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      modelica_metatype _v = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _v has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,7,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          
          _v = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFBinding_typedExp(threadData, omc_NFVariable_lookupTypeAttribute(threadData, _attr_name, omc_Pointer_access(threadData, _v)));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = mmc_mk_none();
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _attrValue = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _attrValue;
}

DLLDirection
modelica_metatype omc_NFComponentRef_getSubscriptedType2(threadData_t *threadData, modelica_metatype _restCref, modelica_metatype _accumTy, modelica_boolean _includeScope)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _restCref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!((mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_restCref), 5)))) == 1) || _includeScope)) goto tmp3_end;
          _ty = omc_NFType_liftArrayLeftList(threadData, _accumTy, omc_NFType_arrayDims(threadData, omc_NFType_subscript(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_restCref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_restCref), 3))), 1 /* true */)));
          /* Tail recursive call */
          _restCref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_restCref), 6)));
          _accumTy = _ty;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accumTy;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}
modelica_metatype boxptr_NFComponentRef_getSubscriptedType2(threadData_t *threadData, modelica_metatype _restCref, modelica_metatype _accumTy, modelica_metatype _includeScope)
{
  modelica_integer tmp1;
  modelica_metatype _ty = NULL;
  tmp1 = mmc_unbox_integer(_includeScope);
  _ty = omc_NFComponentRef_getSubscriptedType2(threadData, _restCref, _accumTy, tmp1);
  /* skip box _ty; NFType */
  return _ty;
}

DLLDirection
modelica_metatype omc_NFComponentRef_getSubscriptedType(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _includeScope)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFComponentRef_getSubscriptedType2(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), omc_NFType_subscript(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))), 1 /* true */), _includeScope);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT41;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}
modelica_metatype boxptr_NFComponentRef_getSubscriptedType(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _includeScope)
{
  modelica_integer tmp1;
  modelica_metatype _ty = NULL;
  tmp1 = mmc_unbox_integer(_includeScope);
  _ty = omc_NFComponentRef_getSubscriptedType(threadData, _cref, tmp1);
  /* skip box _ty; NFType */
  return _ty;
}

DLLDirection
modelica_metatype omc_NFComponentRef_getComponentType(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT41;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}

DLLDirection
modelica_metatype omc_NFComponentRef_prepend(threadData_t *threadData, modelica_metatype _restCref, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = _restCref;
          _cref = tmpMeta6;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _restCref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_appendScope(threadData_t *threadData, modelica_metatype _scope, modelica_metatype __omcQ_24in_5Fcref, modelica_boolean _includeRoot)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _prefix = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  // _prefix has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _prefix = omc_NFComponentRef_fromNodeList(threadData, omc_NFInstNode_InstNode_scopeList(threadData, _scope, _includeRoot, tmpMeta1));

  if((!omc_NFComponentRef_isEmpty(threadData, _prefix)))
  {
    _cref = omc_NFComponentRef_append(threadData, _cref, _prefix);

    _cref = omc_NFComponentRef_removeOuterCrefPrefix(threadData, _cref);
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}
modelica_metatype boxptr_NFComponentRef_appendScope(threadData_t *threadData, modelica_metatype _scope, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _includeRoot)
{
  modelica_integer tmp1;
  modelica_metatype _cref = NULL;
  tmp1 = mmc_unbox_integer(_includeRoot);
  _cref = omc_NFComponentRef_appendScope(threadData, _scope, __omcQ_24in_5Fcref, tmp1);
  /* skip box _cref; NFComponentRef */
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_append(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _restCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NFComponentRef_append(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _restCref);
          _cref = tmpMeta6;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _restCref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_firstNonScope(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _first = NULL;
  modelica_metatype _rest_cr = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _first has no default value.
  _rest_cr = omc_NFComponentRef_rest(threadData, _cref);
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _rest_cr;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (2 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _cref = _rest_cr;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _first = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _first;
}

DLLDirection
modelica_metatype omc_NFComponentRef_last(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _lastCref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lastCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _cref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _lastCref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _lastCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_rest(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _restCref = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _restCref has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _cref;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,0,5) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 6));
  _restCref = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _restCref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_first(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = _OMC_LIT7;
          _cref = tmpMeta5;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_string omc_NFComponentRef_firstName(threadData_t *threadData, modelica_metatype _cref, modelica_boolean _baseModelica)
{
  modelica_string _name = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _name has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_name(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = (_baseModelica?_OMC_LIT1:_OMC_LIT13);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT1;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _name = tmp1;
  _return: OMC_LABEL_UNUSED
  return _name;
}
modelica_metatype boxptr_NFComponentRef_firstName(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _baseModelica)
{
  modelica_integer tmp1;
  modelica_string _name = NULL;
  tmp1 = mmc_unbox_integer(_baseModelica);
  _name = omc_NFComponentRef_firstName(threadData, _cref, tmp1);
  /* skip box _name; String */
  return _name;
}

DLLDirection
modelica_metatype omc_NFComponentRef_applyToType(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_fnptr _func)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4))));
          _cref = tmpMeta6;

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NFComponentRef_applyToType(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), ((modelica_fnptr) _func));
          _cref = tmpMeta7;
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _cref;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_scalarType(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _cref;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,0,5) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  _ty = tmpMeta2;

  _ty = omc_NFType_arrayElementType(threadData, _ty);
  _return: OMC_LABEL_UNUSED
  return _ty;
}

DLLDirection
modelica_metatype omc_NFComponentRef_updateNodeType(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFInstNode_InstNode_isComponent(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))))) goto tmp2_end;
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[4] = omc_NFInstNode_InstNode_getType(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          _cref = tmpMeta5;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_setNodeType(threadData_t *threadData, modelica_metatype _ty, modelica_metatype __omcQ_24in_5Fcref)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _cref;
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_cref), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[4] = _ty;
          _cref = tmpMeta5;
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_nodeType(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _cref;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,0,5) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  _ty = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _ty;
}

DLLDirection
modelica_boolean omc_NFComponentRef_containsNode(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _node)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFInstNode_InstNode_refEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _node) || omc_NFComponentRef_containsNode(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))), _node));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_containsNode(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _node)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_containsNode(threadData, _cref, _node);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_metatype omc_NFComponentRef_nodesIncludingSplitSubs(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accum)
{
  modelica_metatype _nodes = NULL;
  modelica_metatype _node = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _nodes = _accum;
  // _node has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype _s;
            for (tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 3))); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _s = MMC_CAR(tmpMeta6);
              if(omc_NFSubscript_isSplitIndex(threadData, _s))
              {
                /* Pattern-matching assignment */
                tmpMeta7 = _s;
                if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,7,2) == 0) goto goto_2;
                tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
                _node = tmpMeta8;

                tmpMeta9 = mmc_mk_cons(_node, _nodes);
                _nodes = tmpMeta9;
              }
            }
          }
          tmpMeta12 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _nodes);
          /* Tail recursive call */
          tmpMeta11 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accum = tmpMeta12;
          _cref = tmpMeta11;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _nodes;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _nodes = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _nodes;
}

DLLDirection
modelica_metatype omc_NFComponentRef_nodes(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _accum)
{
  modelica_metatype _nodes = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _nodes has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))), _accum);
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)));
          _accum = tmpMeta7;
          _cref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _accum;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _nodes = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _nodes;
}

DLLDirection
modelica_metatype omc_NFComponentRef_node(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_metatype _node = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _node has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _cref;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,0,5) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _node = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _node;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isRecordChild(threadData_t *threadData, modelica_metatype _child, modelica_metatype _recd)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _recd;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFComponentRef_isEqual(threadData, _child, _recd) || omc_NFComponentRef_isRecordChild(threadData, _child, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_recd), 6)))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isRecordChild(threadData_t *threadData, modelica_metatype _child, modelica_metatype _recd)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isRecordChild(threadData, _child, _recd);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isEqualRecordChild(threadData_t *threadData, modelica_metatype _child, modelica_metatype _recd)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = (omc_NFComponentRef_size(threadData, _child, 1 /* true */, 0 /* false */) == omc_NFComponentRef_size(threadData, _recd, 1 /* true */, 0 /* false */));
  if(_b)
  {
    _b = omc_NFComponentRef_isRecordChild(threadData, _child, _recd);
  }
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isEqualRecordChild(threadData_t *threadData, modelica_metatype _child, modelica_metatype _recd)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isEqualRecordChild(threadData, _child, _recd);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isNameNode(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,4,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_isNameNode(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_isNameNode(threadData, _cref);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isOutput(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_isOutput(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_isOutput(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_isOutput(threadData, _cref);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isInput(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _res has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFInstNode_InstNode_isInput(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _res = tmp1;
  _return: OMC_LABEL_UNUSED
  return _res;
}
modelica_metatype boxptr_NFComponentRef_isInput(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _res;
  modelica_metatype out_res;
  _res = omc_NFComponentRef_isInput(threadData, _cref);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isIterator(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isIterator;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isIterator has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (3 != tmp7) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isIterator = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isIterator;
}
modelica_metatype boxptr_NFComponentRef_isIterator(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isIterator;
  modelica_metatype out_isIterator;
  _isIterator = omc_NFComponentRef_isIterator(threadData, _cref);
  out_isIterator = mmc_mk_icon(_isIterator);
  return out_isIterator;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isCref;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isCref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isCref = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isCref;
}
modelica_metatype boxptr_NFComponentRef_isCref(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isCref;
  modelica_metatype out_isCref;
  _isCref = omc_NFComponentRef_isCref(threadData, _cref);
  out_isCref = mmc_mk_icon(_isCref);
  return out_isCref;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_NFComponentRef_isTopLevel_isTopLevelRecord(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFType_isRecord(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 4)))) && omc_NFComponentRef_isTopLevel_isTopLevelRecord(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6)))));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NFComponentRef_isTopLevel_isTopLevelRecord(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isTopLevel_isTopLevelRecord(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isTopLevel(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFComponentRef_isTopLevel_isTopLevelRecord(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cref), 6))));
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NFComponentRef_isTopLevel(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NFComponentRef_isTopLevel(threadData, _cref);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isSimple(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isSimple;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isSimple has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isSimple = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isSimple;
}
modelica_metatype boxptr_NFComponentRef_isSimple(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isSimple;
  modelica_metatype out_isSimple;
  _isSimple = omc_NFComponentRef_isSimple(threadData, _cref);
  out_isSimple = mmc_mk_icon(_isSimple);
  return out_isSimple;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isEmpty(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isEmpty;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEmpty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isEmpty = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isEmpty;
}
modelica_metatype boxptr_NFComponentRef_isEmpty(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isEmpty;
  modelica_metatype out_isEmpty;
  _isEmpty = omc_NFComponentRef_isEmpty(threadData, _cref);
  out_isEmpty = mmc_mk_icon(_isEmpty);
  return out_isEmpty;
}

DLLDirection
modelica_boolean omc_NFComponentRef_isWild(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isWild;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isWild has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cref;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isWild = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isWild;
}
modelica_metatype boxptr_NFComponentRef_isWild(threadData_t *threadData, modelica_metatype _cref)
{
  modelica_boolean _isWild;
  modelica_metatype out_isWild;
  _isWild = omc_NFComponentRef_isWild(threadData, _cref);
  out_isWild = mmc_mk_icon(_isWild);
  return out_isWild;
}

DLLDirection
modelica_metatype omc_NFComponentRef_makeIterator(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, tmpMeta1, _ty, mmc_mk_integer(3), _OMC_LIT7);
  _cref = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fromBuiltin(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, tmpMeta1, _ty, mmc_mk_integer(2), _OMC_LIT7);
  _cref = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fromAbsynCref(threadData_t *threadData, modelica_metatype _acref, modelica_metatype _restCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _cref has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _acref;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 5: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box2(7, &NFInstNode_InstNode_NAME__NODE__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 2))));
          tmpMeta1 = omc_NFComponentRef_fromAbsyn(threadData, tmpMeta5, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 3))), _restCref);
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box2(7, &NFInstNode_InstNode_NAME__NODE__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 2))));
          /* Tail recursive call */
          tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 4)));
          _restCref = omc_NFComponentRef_fromAbsyn(threadData, tmpMeta7, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 3))), _restCref);
          _acref = tmpMeta6;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _acref = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_acref), 2)));
          _restCref = _OMC_LIT7;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT42;
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT42;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fromAbsyn(threadData_t *threadData, modelica_metatype _node, modelica_metatype _subs, modelica_metatype _restCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype _sl = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _cref has no default value.
  // _sl has no default value.
  {
    modelica_metatype __omcQ_24tmpVar27;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype tmpMeta4;
    modelica_metatype __omcQ_24tmpVar26;
    modelica_integer tmp5;
    modelica_metatype _s_loopVar = 0;
    modelica_metatype _s;
    _s_loopVar = _subs;
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar27 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar27;
    while(1) {
      tmp5 = 1;
      if (!listEmpty(_s_loopVar)) {
        _s = MMC_CAR(_s_loopVar);
        _s_loopVar = MMC_CDR(_s_loopVar);
        tmp5--;
      }
      if (tmp5 == 0) {
        tmpMeta4 = mmc_mk_box2(3, &NFSubscript_RAW__SUBSCRIPT__desc, _s);
        __omcQ_24tmpVar26 = tmpMeta4;
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar26,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp5 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar27;
  }
  _sl = tmpMeta1;

  tmpMeta6 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, _sl, _OMC_LIT41, mmc_mk_integer(1), _restCref);
  _cref = tmpMeta6;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_prefixScope(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty, modelica_metatype _subs, modelica_metatype _restCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, _subs, _ty, mmc_mk_integer(2), _restCref);
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_prefixCref(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty, modelica_metatype _subs, modelica_metatype _restCref)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, _subs, _ty, mmc_mk_integer(1), _restCref);
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NFComponentRef_fromNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty, modelica_metatype _subs, modelica_integer _origin)
{
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = mmc_mk_box6(3, &NFComponentRef_CREF__desc, _node, _subs, _ty, mmc_mk_integer((modelica_integer)_origin), _OMC_LIT7);
  _cref = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _cref;
}
modelica_metatype boxptr_NFComponentRef_fromNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _ty, modelica_metatype _subs, modelica_metatype _origin)
{
  modelica_integer tmp1;
  modelica_metatype _cref = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_origin);
  _cref = omc_NFComponentRef_fromNode(threadData, _node, _ty, _subs, tmp1);
  /* skip box _cref; NFComponentRef */
  return _cref;
}

