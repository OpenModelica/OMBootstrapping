#include "omc_simulation_settings.h"
#include "DumpGraphML.h"
#define _OMC_LIT0_data "e"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,1,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,1,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "000000"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,6,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,1,3) {&GraphML_LineType_LINE__desc,}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,1,3) {&GraphML_ArrowType_ARROWSTANDART__desc,}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,1,4) {&GraphML_ArrowType_ARROWNONE__desc,}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT6,2,0) {_OMC_LIT4,_OMC_LIT5}};
#define _OMC_LIT6 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data ":"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,1,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
#define _OMC_LIT8_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT8,1,_OMC_LIT8_data);
#define _OMC_LIT8 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT8)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT9,1,3) {&GraphML_FontStyle_FONTPLAIN__desc,}};
#define _OMC_LIT9 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT9)
#define _OMC_LIT10_data "339966"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT10,6,_OMC_LIT10_data);
#define _OMC_LIT10 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT10)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT11,1,3) {&GraphML_ShapeType_RECTANGLE__desc,}};
#define _OMC_LIT11 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT11)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT12,2,0) {_OMC_LIT5,_OMC_LIT4}};
#define _OMC_LIT12 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "#0000FF"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,7,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT14,1,1) {_OMC_LIT13}};
#define _OMC_LIT14 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data "v"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,1,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,1,4) {&GraphML_LineType_DASHED__desc,}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,2,0) {_OMC_LIT5,_OMC_LIT5}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data ": "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,2,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data "993366"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,6,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data "0000FF"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,6,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "FFFF00"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,6,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,1,5) {&GraphML_ShapeType_ELLIPSE__desc,}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "FF0000"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,6,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT24,1,4) {&BackendDAE_IndexType_NORMAL__desc,}};
#define _OMC_LIT24 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "G"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,1,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
#include "util/modelica.h"

#include "DumpGraphML_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_boolean omc_DumpGraphML_isUnMarked(threadData_t *threadData, modelica_metatype _ass, modelica_integer _indx);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_isUnMarked(threadData_t *threadData, modelica_metatype _ass, modelica_metatype _indx);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_isUnMarked,2,0) {(void*) boxptr_DumpGraphML_isUnMarked,0}};
#define boxvar_DumpGraphML_isUnMarked MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_isUnMarked)
PROTECTED_FUNCTION_STATIC modelica_integer omc_DumpGraphML_addCompEdgesGraph(threadData_t *threadData, modelica_metatype _iVars, modelica_metatype _varcomp, modelica_metatype _markarray, modelica_integer _mark, modelica_integer _iN, modelica_integer _id, modelica_metatype _iGraph, modelica_metatype *out_oGraph);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompEdgesGraph(threadData_t *threadData, modelica_metatype _iVars, modelica_metatype _varcomp, modelica_metatype _markarray, modelica_metatype _mark, modelica_metatype _iN, modelica_metatype _id, modelica_metatype _iGraph, modelica_metatype *out_oGraph);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompEdgesGraph,2,0) {(void*) boxptr_DumpGraphML_addCompEdgesGraph,0}};
#define boxvar_DumpGraphML_addCompEdgesGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompEdgesGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_getUsedVarsComp(threadData_t *threadData, modelica_metatype _iEqns, modelica_metatype _m, modelica_metatype _markarray, modelica_integer _mark);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_getUsedVarsComp(threadData_t *threadData, modelica_metatype _iEqns, modelica_metatype _m, modelica_metatype _markarray, modelica_metatype _mark);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_getUsedVarsComp,2,0) {(void*) boxptr_DumpGraphML_getUsedVarsComp,0}};
#define boxvar_DumpGraphML_getUsedVarsComp MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_getUsedVarsComp)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addCompsEdgesGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _m, modelica_metatype _varcomp, modelica_integer _iN, modelica_integer _id, modelica_metatype _markarray, modelica_integer _mark, modelica_metatype _iGraph);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompsEdgesGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _m, modelica_metatype _varcomp, modelica_metatype _iN, modelica_metatype _id, modelica_metatype _markarray, modelica_metatype _mark, modelica_metatype _iGraph);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompsEdgesGraph,2,0) {(void*) boxptr_DumpGraphML_addCompsEdgesGraph,0}};
#define boxvar_DumpGraphML_addCompsEdgesGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompsEdgesGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addCompsGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _vars, modelica_metatype _varcomp, modelica_integer _iN, modelica_metatype _iGraph);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompsGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _vars, modelica_metatype _varcomp, modelica_metatype _iN, modelica_metatype _iGraph);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompsGraph,2,0) {(void*) boxptr_DumpGraphML_addCompsGraph,0}};
#define boxvar_DumpGraphML_addCompsGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addCompsGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedNumEdgeGraph(threadData_t *threadData, modelica_integer _v, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedNumEdgeGraph(threadData_t *threadData, modelica_metatype _v, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedNumEdgeGraph,2,0) {(void*) boxptr_DumpGraphML_addDirectedNumEdgeGraph,0}};
#define boxvar_DumpGraphML_addDirectedNumEdgeGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedNumEdgeGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedNumEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedNumEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedNumEdgesGraph,2,0) {(void*) boxptr_DumpGraphML_addDirectedNumEdgesGraph,0}};
#define boxvar_DumpGraphML_addDirectedNumEdgesGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedNumEdgesGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedEdgeGraph(threadData_t *threadData, modelica_integer _v, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedEdgeGraph(threadData_t *threadData, modelica_metatype _v, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedEdgeGraph,2,0) {(void*) boxptr_DumpGraphML_addDirectedEdgeGraph,0}};
#define boxvar_DumpGraphML_addDirectedEdgeGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedEdgeGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedEdgesGraph,2,0) {(void*) boxptr_DumpGraphML_addDirectedEdgesGraph,0}};
#define boxvar_DumpGraphML_addDirectedEdgesGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addDirectedEdgesGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEdgeGraph(threadData_t *threadData, modelica_integer _V, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEdgeGraph(threadData_t *threadData, modelica_metatype _V, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addEdgeGraph,2,0) {(void*) boxptr_DumpGraphML_addEdgeGraph,0}};
#define boxvar_DumpGraphML_addEdgeGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addEdgeGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEqnGraphMatch(threadData_t *threadData, modelica_integer _inNode, modelica_metatype _eqns, modelica_metatype _atpl, modelica_boolean _numberMode, modelica_metatype _inGraph);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEqnGraphMatch(threadData_t *threadData, modelica_metatype _inNode, modelica_metatype _eqns, modelica_metatype _atpl, modelica_metatype _numberMode, modelica_metatype _inGraph);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addEqnGraphMatch,2,0) {(void*) boxptr_DumpGraphML_addEqnGraphMatch,0}};
#define boxvar_DumpGraphML_addEqnGraphMatch MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addEqnGraphMatch)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addEdgesGraph,2,0) {(void*) boxptr_DumpGraphML_addEdgesGraph,0}};
#define boxvar_DumpGraphML_addEdgesGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addEdgesGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEqnGraph(threadData_t *threadData, modelica_integer _inNode, modelica_metatype _eqns, modelica_metatype _mapIncRowEqn, modelica_boolean _numberMode, modelica_metatype _inGraph);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEqnGraph(threadData_t *threadData, modelica_metatype _inNode, modelica_metatype _eqns, modelica_metatype _mapIncRowEqn, modelica_metatype _numberMode, modelica_metatype _inGraph);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addEqnGraph,2,0) {(void*) boxptr_DumpGraphML_addEqnGraph,0}};
#define boxvar_DumpGraphML_addEqnGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addEqnGraph)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addVarGraphMatch(threadData_t *threadData, modelica_metatype _inVar, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addVarGraphMatch,2,0) {(void*) boxptr_DumpGraphML_addVarGraphMatch,0}};
#define boxvar_DumpGraphML_addVarGraphMatch MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addVarGraphMatch)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addVarGraph(threadData_t *threadData, modelica_metatype _inVar, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_DumpGraphML_addVarGraph,2,0) {(void*) boxptr_DumpGraphML_addVarGraph,0}};
#define boxvar_DumpGraphML_addVarGraph MMC_REFSTRUCTLIT(boxvar_lit_DumpGraphML_addVarGraph)

PROTECTED_FUNCTION_STATIC modelica_boolean omc_DumpGraphML_isUnMarked(threadData_t *threadData, modelica_metatype _ass, modelica_integer _indx)
{
  modelica_boolean _b;
  modelica_metatype _arr = NULL;
  modelica_integer _mark;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _arr has no default value.
  // _mark has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _ass;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmp4 = mmc_unbox_integer(tmpMeta3);
  _arr = tmpMeta2;
  _mark = tmp4  /* pattern as ty=Integer */;

  _b = (!(mmc_unbox_integer(arrayGet(_arr,labs(_indx)) /* DAE.ASUB */) == _mark));
  _return: OMC_LABEL_UNUSED
  return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_isUnMarked(threadData_t *threadData, modelica_metatype _ass, modelica_metatype _indx)
{
  modelica_integer tmp1;
  modelica_boolean _b;
  modelica_metatype out_b;
  tmp1 = mmc_unbox_integer(_indx);
  _b = omc_DumpGraphML_isUnMarked(threadData, _ass, tmp1);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_DumpGraphML_addCompEdgesGraph(threadData_t *threadData, modelica_metatype _iVars, modelica_metatype _varcomp, modelica_metatype _markarray, modelica_integer _mark, modelica_integer _iN, modelica_integer _id, modelica_metatype _iGraph, modelica_metatype *out_oGraph)
{
  modelica_integer _oN;
  modelica_metatype _oGraph = NULL;
  modelica_integer tmp1_c0 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oN has no default value.
  // _oGraph has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _iVars;
    {
      modelica_metatype _rest = NULL;
      modelica_integer _v;
      modelica_integer _c;
      modelica_metatype _graph = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest has no default value.
      // _v has no default value.
      // _c has no default value.
      // _graph has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          tmp4 += 2; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmp1_c0 = _id;
          tmpMeta[0+1] = _iGraph;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_boolean tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          _v = tmp8  /* pattern as ty=Integer */;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          _c = mmc_unbox_integer(arrayGet(_varcomp,_v) /* DAE.ASUB */);

          /* Pattern-matching assignment */
          tmp9 = (mmc_unbox_integer(arrayGet(_markarray,_c) /* DAE.ASUB */) == _mark);
          if (0 /* false */ != tmp9) goto goto_2;

          arrayUpdate(_markarray, _c, mmc_mk_integer(_mark));

          tmpMeta10 = stringAppend(_OMC_LIT0,intString(_id));
          tmpMeta11 = stringAppend(_OMC_LIT1,intString(_c));
          tmpMeta12 = stringAppend(_OMC_LIT1,intString(_iN));
          tmpMeta13 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
          _graph = omc_GraphML_addEdge(threadData, tmpMeta10, tmpMeta11, tmpMeta12, _OMC_LIT2, _OMC_LIT3, 2.0, 0 /* false */, tmpMeta13, _OMC_LIT6, tmpMeta14, _iGraph, NULL);
          tmp1_c0 = omc_DumpGraphML_addCompEdgesGraph(threadData, _rest, _varcomp, _markarray, _mark, _iN, ((modelica_integer) 1) + _id, _graph, &tmpMeta[0+1]);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta15 = MMC_CAR(tmp4_1);
          tmpMeta16 = MMC_CDR(tmp4_1);
          _rest = tmpMeta16;
          /* Pattern matching succeeded */
          tmp1_c0 = omc_DumpGraphML_addCompEdgesGraph(threadData, _rest, _varcomp, _markarray, _mark, _iN, _id, _iGraph, &tmpMeta[0+1]);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _oN = tmp1_c0;
  _oGraph = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_oGraph) { *out_oGraph = _oGraph; }
  return _oN;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompEdgesGraph(threadData_t *threadData, modelica_metatype _iVars, modelica_metatype _varcomp, modelica_metatype _markarray, modelica_metatype _mark, modelica_metatype _iN, modelica_metatype _id, modelica_metatype _iGraph, modelica_metatype *out_oGraph)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer _oN;
  modelica_metatype out_oN;
  tmp1 = mmc_unbox_integer(_mark);
  tmp2 = mmc_unbox_integer(_iN);
  tmp3 = mmc_unbox_integer(_id);
  _oN = omc_DumpGraphML_addCompEdgesGraph(threadData, _iVars, _varcomp, _markarray, tmp1, tmp2, tmp3, _iGraph, out_oGraph);
  out_oN = mmc_mk_icon(_oN);
  /* skip box _oGraph; GraphML.GraphInfo */
  return out_oN;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_getUsedVarsComp(threadData_t *threadData, modelica_metatype _iEqns, modelica_metatype _m, modelica_metatype _markarray, modelica_integer _mark)
{
  modelica_metatype _oVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _vlst = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _oVars = tmpMeta1;
  // _vlst has no default value.
  {
    modelica_metatype _eq;
    for (tmpMeta2 = _iEqns; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _eq = MMC_CAR(tmpMeta2);
      _vlst = omc_List_select1(threadData, arrayGet(_m,mmc_unbox_integer(_eq)) /* DAE.ASUB */, boxvar_intGt, mmc_mk_integer(((modelica_integer) 0)));

      tmpMeta3 = mmc_mk_box2(0, _markarray, mmc_mk_integer(_mark));
      _vlst = omc_List_select1r(threadData, _vlst, boxvar_DumpGraphML_isUnMarked, tmpMeta3);

      omc_List_fold1r(threadData, _vlst, boxvar_arrayUpdate, mmc_mk_integer(_mark), _markarray);

      _oVars = listAppend(_vlst, _oVars);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _oVars;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_getUsedVarsComp(threadData_t *threadData, modelica_metatype _iEqns, modelica_metatype _m, modelica_metatype _markarray, modelica_metatype _mark)
{
  modelica_integer tmp1;
  modelica_metatype _oVars = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_mark);
  _oVars = omc_DumpGraphML_getUsedVarsComp(threadData, _iEqns, _m, _markarray, tmp1);
  /* skip box _oVars; list<#Integer> */
  return _oVars;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addCompsEdgesGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _m, modelica_metatype _varcomp, modelica_integer _iN, modelica_integer _id, modelica_metatype _markarray, modelica_integer _mark, modelica_metatype _iGraph)
{
  modelica_metatype _oGraph = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oGraph has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iComps;
    {
      modelica_metatype _rest = NULL;
      modelica_metatype _comp = NULL;
      modelica_metatype _elst = NULL;
      modelica_metatype _vlst = NULL;
      modelica_integer _n;
      modelica_metatype _graph = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest has no default value.
      // _comp has no default value.
      // _elst has no default value.
      // _vlst has no default value.
      // _n has no default value.
      // _graph has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _iGraph;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _comp = tmpMeta6;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          _elst = omc_BackendDAETransform_getEquationAndSolvedVarIndxes(threadData, _comp ,&_vlst);

          omc_List_fold1r(threadData, _vlst, boxvar_arrayUpdate, mmc_mk_integer(_mark), _markarray);

          _vlst = omc_DumpGraphML_getUsedVarsComp(threadData, _elst, _m, _markarray, _mark);

          _n = omc_DumpGraphML_addCompEdgesGraph(threadData, _vlst, _varcomp, _markarray, ((modelica_integer) 1) + _mark, _iN, _id, _iGraph ,&_graph);
          /* Tail recursive call */
          _iComps = _rest;
          _iN = ((modelica_integer) 1) + _iN;
          _id = _n;
          _mark = ((modelica_integer) 2) + _mark;
          _iGraph = _graph;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _oGraph = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oGraph;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompsEdgesGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _m, modelica_metatype _varcomp, modelica_metatype _iN, modelica_metatype _id, modelica_metatype _markarray, modelica_metatype _mark, modelica_metatype _iGraph)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_metatype _oGraph = NULL;
  tmp1 = mmc_unbox_integer(_iN);
  tmp2 = mmc_unbox_integer(_id);
  tmp3 = mmc_unbox_integer(_mark);
  _oGraph = omc_DumpGraphML_addCompsEdgesGraph(threadData, _iComps, _m, _varcomp, tmp1, tmp2, _markarray, tmp3, _iGraph);
  /* skip box _oGraph; GraphML.GraphInfo */
  return _oGraph;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addCompsGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _vars, modelica_metatype _varcomp, modelica_integer _iN, modelica_metatype _iGraph)
{
  modelica_metatype _oGraph = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oGraph has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _iComps;
    tmp4_2 = _iGraph;
    {
      modelica_metatype _rest = NULL;
      modelica_metatype _comp = NULL;
      modelica_metatype _vlst = NULL;
      modelica_integer _graph;
      modelica_metatype _graphInfo = NULL;
      modelica_metatype _label = NULL;
      modelica_metatype _varcomp1 = NULL;
      modelica_string _text = NULL;
      modelica_metatype _varlst = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _rest has no default value.
      // _comp has no default value.
      // _vlst has no default value.
      // _graph has no default value.
      // _graphInfo has no default value.
      // _label has no default value.
      // _varcomp1 has no default value.
      // _text has no default value.
      // _varlst has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _iGraph;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_integer tmp10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp10 = mmc_unbox_integer(tmpMeta9);
          _comp = tmpMeta6;
          _rest = tmpMeta7;
          _graphInfo = tmpMeta8;
          _graph = tmp10  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          omc_BackendDAETransform_getEquationAndSolvedVarIndxes(threadData, _comp ,&_vlst);

          _varcomp1 = omc_List_fold1r(threadData, _vlst, boxvar_arrayUpdate, mmc_mk_integer(_iN), _varcomp);

          _varlst = omc_List_map1r(threadData, _vlst, boxvar_BackendVariable_getVarAt, _vars);

          tmpMeta11 = stringAppend(intString(_iN),_OMC_LIT7);
          tmpMeta12 = stringAppend(tmpMeta11,stringDelimitList(omc_List_mapMap(threadData, _varlst, boxvar_BackendVariable_varCref, boxvar_ComponentReference_printComponentRefStr), _OMC_LIT8));
          _text = tmpMeta12;

          tmpMeta13 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _text, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta13;

          tmpMeta14 = stringAppend(_OMC_LIT1,intString(_iN));
          tmpMeta15 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta14, _OMC_LIT10, 1.0, tmpMeta15, _OMC_LIT11, mmc_mk_none(), tmpMeta16, _graph, _graphInfo, NULL);
          tmpMeta17 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          /* Tail recursive call */
          _iComps = _rest;
          _varcomp = _varcomp1;
          _iN = ((modelica_integer) 1) + _iN;
          _iGraph = tmpMeta17;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _oGraph = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oGraph;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addCompsGraph(threadData_t *threadData, modelica_metatype _iComps, modelica_metatype _vars, modelica_metatype _varcomp, modelica_metatype _iN, modelica_metatype _iGraph)
{
  modelica_integer tmp1;
  modelica_metatype _oGraph = NULL;
  tmp1 = mmc_unbox_integer(_iN);
  _oGraph = omc_DumpGraphML_addCompsGraph(threadData, _iComps, _vars, _varcomp, tmp1, _iGraph);
  /* skip box _oGraph; tuple<GraphML.GraphInfo, #Integer> */
  return _oGraph;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedNumEdgeGraph(threadData_t *threadData, modelica_integer _v, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_integer _r;
  modelica_integer _n;
  modelica_metatype _graph = NULL;
  modelica_metatype _arrow = NULL;
  modelica_string _text = NULL;
  modelica_metatype _labels = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_boolean tmp11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _r has no default value.
  // _n has no default value.
  // _graph has no default value.
  // _arrow has no default value.
  // _text has no default value.
  // _labels has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmp5 = mmc_unbox_integer(tmpMeta4);
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  _id = tmp3  /* pattern as ty=Integer */;
  _r = tmp5  /* pattern as ty=Integer */;
  _text = tmpMeta6;
  _graph = tmpMeta7;

  _arrow = ((_r == _v)?_OMC_LIT6:_OMC_LIT12);

  tmp11 = (modelica_boolean)(_r == _v);
  if(tmp11)
  {
    tmpMeta9 = mmc_mk_box4(3, &GraphML_EdgeLabel_EDGELABEL__desc, _text, _OMC_LIT14, mmc_mk_integer(((modelica_integer) 12)));
    tmpMeta8 = mmc_mk_cons(tmpMeta9, MMC_REFSTRUCTLIT(mmc_nil));
    tmpMeta12 = tmpMeta8;
  }
  else
  {
    tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
    tmpMeta12 = tmpMeta10;
  }
  _labels = tmpMeta12;

  tmpMeta13 = stringAppend(_OMC_LIT0,intString(_id));
  tmpMeta14 = stringAppend(_OMC_LIT1,intString(_e));
  tmpMeta15 = stringAppend(_OMC_LIT15,intString(_v));
  tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
  _graph = omc_GraphML_addEdge(threadData, tmpMeta13, tmpMeta14, tmpMeta15, _OMC_LIT2, _OMC_LIT3, 2.0, 0 /* false */, _labels, _arrow, tmpMeta16, _graph, NULL);

  tmpMeta17 = mmc_mk_box4(0, mmc_mk_integer(((modelica_integer) 1) + _id), mmc_mk_integer(_r), _text, _graph);
  _outTpl = tmpMeta17;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedNumEdgeGraph(threadData_t *threadData, modelica_metatype _v, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_v);
  tmp2 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addDirectedNumEdgeGraph(threadData, tmp1, tmp2, _inTpl);
  /* skip box _outTpl; tuple<#Integer, #Integer, String, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedNumEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_integer _v;
  modelica_metatype _graph = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _vec2 = NULL;
  modelica_metatype _vec3 = NULL;
  modelica_metatype _mapIncRowEqn = NULL;
  modelica_string _text = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_integer tmp11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _v has no default value.
  // _graph has no default value.
  // _m has no default value.
  // _vars has no default value.
  // _vec2 has no default value.
  // _vec3 has no default value.
  // _mapIncRowEqn has no default value.
  // _text has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 5));
  _id = tmp3  /* pattern as ty=Integer */;
  _m = tmpMeta4;
  _vec2 = tmpMeta5;
  _vec3 = tmpMeta6;
  _graph = tmpMeta7;

  _vars = omc_List_select(threadData, arrayGet(_m,_e) /* DAE.ASUB */, boxvar_Util_intPositive);

  _v = mmc_unbox_integer(arrayGet(_vec2,_e) /* DAE.ASUB */);

  _text = intString(mmc_unbox_integer(arrayGet(_vec3,_e) /* DAE.ASUB */));

  /* Pattern-matching assignment */
  tmpMeta8 = mmc_mk_box4(0, mmc_mk_integer(_id), mmc_mk_integer(_v), _text, _graph);
  tmpMeta9 = omc_List_fold1(threadData, _vars, boxvar_DumpGraphML_addDirectedNumEdgeGraph, mmc_mk_integer(_e), tmpMeta8);
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 1));
  tmp11 = mmc_unbox_integer(tmpMeta10);
  tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 4));
  _id = tmp11  /* pattern as ty=Integer */;
  _graph = tmpMeta12;

  tmpMeta13 = mmc_mk_box5(0, mmc_mk_integer(_id), _m, _vec2, _vec3, _graph);
  _outTpl = tmpMeta13;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedNumEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addDirectedNumEdgesGraph(threadData, tmp1, _inTpl);
  /* skip box _outTpl; tuple<#Integer, array<list<#Integer>>, array<#Integer>, array<#Integer>, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedEdgeGraph(threadData_t *threadData, modelica_integer _v, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_integer _r;
  modelica_integer _absv;
  modelica_metatype _graph = NULL;
  modelica_metatype _arrow = NULL;
  modelica_metatype _lt = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _r has no default value.
  // _absv has no default value.
  // _graph has no default value.
  // _arrow has no default value.
  // _lt has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmp5 = mmc_unbox_integer(tmpMeta4);
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  _id = tmp3  /* pattern as ty=Integer */;
  _r = tmp5  /* pattern as ty=Integer */;
  _graph = tmpMeta6;

  _absv = labs(_v);

  _arrow = ((_r == _absv)?_OMC_LIT6:_OMC_LIT12);

  _lt = ((_v > ((modelica_integer) 0))?_OMC_LIT3:_OMC_LIT16);

  tmpMeta7 = stringAppend(_OMC_LIT0,intString(_id));
  tmpMeta8 = stringAppend(_OMC_LIT1,intString(_e));
  tmpMeta9 = stringAppend(_OMC_LIT15,intString(_absv));
  tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
  _graph = omc_GraphML_addEdge(threadData, tmpMeta7, tmpMeta8, tmpMeta9, _OMC_LIT2, _lt, 2.0, 0 /* false */, tmpMeta10, _arrow, tmpMeta11, _graph, NULL);

  tmpMeta12 = mmc_mk_box3(0, mmc_mk_integer(((modelica_integer) 1) + _id), mmc_mk_integer(_r), _graph);
  _outTpl = tmpMeta12;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedEdgeGraph(threadData_t *threadData, modelica_metatype _v, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_v);
  tmp2 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addDirectedEdgeGraph(threadData, tmp1, tmp2, _inTpl);
  /* skip box _outTpl; tuple<#Integer, #Integer, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addDirectedEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_integer _v;
  modelica_integer _n;
  modelica_metatype _graph = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _vec2 = NULL;
  modelica_metatype _mapIncRowEqn = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_integer tmp11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _v has no default value.
  // _n has no default value.
  // _graph has no default value.
  // _m has no default value.
  // _vars has no default value.
  // _vec2 has no default value.
  // _mapIncRowEqn has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 5));
  _id = tmp3  /* pattern as ty=Integer */;
  _m = tmpMeta4;
  _vec2 = tmpMeta5;
  _mapIncRowEqn = tmpMeta6;
  _graph = tmpMeta7;

  _vars = arrayGet(_m,_e) /* DAE.ASUB */;

  _v = mmc_unbox_integer(arrayGet(_vec2,_e) /* DAE.ASUB */);

  /* Pattern-matching assignment */
  tmpMeta8 = mmc_mk_box3(0, mmc_mk_integer(_id), mmc_mk_integer(_v), _graph);
  tmpMeta9 = omc_List_fold1(threadData, _vars, boxvar_DumpGraphML_addDirectedEdgeGraph, arrayGet(_mapIncRowEqn,_e) /* DAE.ASUB */, tmpMeta8);
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 1));
  tmp11 = mmc_unbox_integer(tmpMeta10);
  tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 3));
  _id = tmp11  /* pattern as ty=Integer */;
  _graph = tmpMeta12;

  tmpMeta13 = mmc_mk_box5(0, mmc_mk_integer(_id), _m, _vec2, _mapIncRowEqn, _graph);
  _outTpl = tmpMeta13;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addDirectedEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addDirectedEdgesGraph(threadData, tmp1, _inTpl);
  /* skip box _outTpl; tuple<#Integer, array<list<#Integer>>, array<#Integer>, array<#Integer>, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEdgeGraph(threadData_t *threadData, modelica_integer _V, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_integer _v;
  modelica_metatype _graph = NULL;
  modelica_metatype _ln = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _v has no default value.
  // _graph has no default value.
  // _ln has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _id = tmp3  /* pattern as ty=Integer */;
  _graph = tmpMeta4;

  _v = labs(_V);

  _ln = ((_V > ((modelica_integer) 0))?_OMC_LIT3:_OMC_LIT16);

  tmpMeta5 = stringAppend(_OMC_LIT0,intString(_id));
  tmpMeta6 = stringAppend(_OMC_LIT1,intString(_e));
  tmpMeta7 = stringAppend(_OMC_LIT15,intString(_v));
  tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
  _graph = omc_GraphML_addEdge(threadData, tmpMeta5, tmpMeta6, tmpMeta7, _OMC_LIT2, _ln, 2.0, 0 /* false */, tmpMeta8, _OMC_LIT17, tmpMeta9, _graph, NULL);

  tmpMeta10 = mmc_mk_box2(0, mmc_mk_integer(((modelica_integer) 1) + _id), _graph);
  _outTpl = tmpMeta10;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEdgeGraph(threadData_t *threadData, modelica_metatype _V, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_V);
  tmp2 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addEdgeGraph(threadData, tmp1, tmp2, _inTpl);
  /* skip box _outTpl; tuple<#Integer, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEqnGraphMatch(threadData_t *threadData, modelica_integer _inNode, modelica_metatype _eqns, modelica_metatype _atpl, modelica_boolean _numberMode, modelica_metatype _inGraph)
{
  modelica_metatype _outGraph = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outGraph has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_boolean tmp4_2;volatile modelica_metatype tmp4_3;
    tmp4_1 = _atpl;
    tmp4_2 = _numberMode;
    tmp4_3 = _inGraph;
    {
      modelica_metatype _eqn = NULL;
      modelica_string _str = NULL;
      modelica_string _color = NULL;
      modelica_integer _e;
      modelica_integer _graph;
      modelica_metatype _graphInfo = NULL;
      modelica_metatype _label = NULL;
      modelica_metatype _vec2 = NULL;
      modelica_metatype _mapIncRowEqn = NULL;
      modelica_metatype _eqnsflag = NULL;
      modelica_string _labelText = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _eqn has no default value.
      // _str has no default value.
      // _color has no default value.
      // _e has no default value.
      // _graph has no default value.
      // _graphInfo has no default value.
      // _label has no default value.
      // _vec2 has no default value.
      // _mapIncRowEqn has no default value.
      // _eqnsflag has no default value.
      // _labelText has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_integer tmp11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          if (0 /* false */ != tmp4_2) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 1));
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
          tmp11 = mmc_unbox_integer(tmpMeta10);
          _vec2 = tmpMeta6;
          _mapIncRowEqn = tmpMeta7;
          _eqnsflag = tmpMeta8;
          _graphInfo = tmpMeta9;
          _graph = tmp11  /* pattern as ty=Integer */;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _e = mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */);

          /* Pattern-matching assignment */
          tmpMeta12 = arrayGet(_eqnsflag,_e) /* DAE.ASUB */;
          tmp13 = mmc_unbox_integer(tmpMeta12);
          if (0 /* false */ != tmp13) goto goto_2;

          _eqn = omc_BackendEquation_get(threadData, _eqns, mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */));

          _str = omc_BackendDump_equationString(threadData, _eqn);

          tmpMeta14 = stringAppend(intString(_e),_OMC_LIT18);
          tmpMeta15 = stringAppend(tmpMeta14,_str);
          _str = tmpMeta15;

          _str = omc_Util_xmlEscape(threadData, _str);

          _color = ((mmc_unbox_integer(arrayGet(_vec2,_inNode) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT10:_OMC_LIT19);

          tmpMeta16 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _str, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta16;

          tmpMeta17 = stringAppend(_OMC_LIT1,intString(_e));
          tmpMeta18 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta17, _color, 1.0, tmpMeta18, _OMC_LIT11, mmc_mk_none(), tmpMeta19, _graph, _graphInfo, NULL);
          tmpMeta20 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta1 = tmpMeta20;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_integer tmp26;
          modelica_metatype tmpMeta27;
          modelica_integer tmp28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          if (1 /* true */ != tmp4_2) goto tmp3_end;
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 1));
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
          tmp26 = mmc_unbox_integer(tmpMeta25);
          _vec2 = tmpMeta21;
          _mapIncRowEqn = tmpMeta22;
          _eqnsflag = tmpMeta23;
          _graphInfo = tmpMeta24;
          _graph = tmp26  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _e = mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */);

          /* Pattern-matching assignment */
          tmpMeta27 = arrayGet(_eqnsflag,_e) /* DAE.ASUB */;
          tmp28 = mmc_unbox_integer(tmpMeta27);
          if (0 /* false */ != tmp28) goto goto_2;

          _eqn = omc_BackendEquation_get(threadData, _eqns, mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */));

          _str = omc_BackendDump_equationString(threadData, _eqn);

          _str = omc_Util_xmlEscape(threadData, _str);

          _color = ((mmc_unbox_integer(arrayGet(_vec2,_inNode) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT10:_OMC_LIT19);

          _labelText = intString(_e);

          tmpMeta29 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta29;

          tmpMeta30 = stringAppend(_OMC_LIT1,intString(_e));
          tmpMeta31 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta32 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta30, _color, 1.0, tmpMeta31, _OMC_LIT11, mmc_mk_some(_str), tmpMeta32, _graph, _graphInfo, NULL);
          tmpMeta33 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta1 = tmpMeta33;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_integer tmp37;
          tmpMeta34 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta35 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _mapIncRowEqn = tmpMeta34;
          _eqnsflag = tmpMeta35;
          /* Pattern matching succeeded */
          _e = mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */);

          /* Pattern-matching assignment */
          tmpMeta36 = arrayGet(_eqnsflag,_e) /* DAE.ASUB */;
          tmp37 = mmc_unbox_integer(tmpMeta36);
          if (1 /* true */ != tmp37) goto goto_2;
          tmpMeta1 = _inGraph;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outGraph = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outGraph;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEqnGraphMatch(threadData_t *threadData, modelica_metatype _inNode, modelica_metatype _eqns, modelica_metatype _atpl, modelica_metatype _numberMode, modelica_metatype _inGraph)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outGraph = NULL;
  tmp1 = mmc_unbox_integer(_inNode);
  tmp2 = mmc_unbox_integer(_numberMode);
  _outGraph = omc_DumpGraphML_addEqnGraphMatch(threadData, tmp1, _eqns, _atpl, tmp2, _inGraph);
  /* skip box _outGraph; tuple<GraphML.GraphInfo, #Integer> */
  return _outGraph;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEdgesGraph(threadData_t *threadData, modelica_integer _e, modelica_metatype _inTpl)
{
  modelica_metatype _outTpl = NULL;
  modelica_integer _id;
  modelica_metatype _graph = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_integer tmp9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outTpl has no default value.
  // _id has no default value.
  // _graph has no default value.
  // _m has no default value.
  // _vars has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmp3 = mmc_unbox_integer(tmpMeta2);
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  _id = tmp3  /* pattern as ty=Integer */;
  _m = tmpMeta4;
  _graph = tmpMeta5;

  _vars = omc_List_select(threadData, arrayGet(_m,_e) /* DAE.ASUB */, boxvar_Util_intPositive);

  _vars = arrayGet(_m,_e) /* DAE.ASUB */;

  /* Pattern-matching assignment */
  tmpMeta6 = mmc_mk_box2(0, mmc_mk_integer(_id), _graph);
  tmpMeta7 = omc_List_fold1(threadData, _vars, boxvar_DumpGraphML_addEdgeGraph, mmc_mk_integer(_e), tmpMeta6);
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 1));
  tmp9 = mmc_unbox_integer(tmpMeta8);
  tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
  _id = tmp9  /* pattern as ty=Integer */;
  _graph = tmpMeta10;

  tmpMeta11 = mmc_mk_box3(0, mmc_mk_integer(_id), _m, _graph);
  _outTpl = tmpMeta11;
  _return: OMC_LABEL_UNUSED
  return _outTpl;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEdgesGraph(threadData_t *threadData, modelica_metatype _e, modelica_metatype _inTpl)
{
  modelica_integer tmp1;
  modelica_metatype _outTpl = NULL;
  tmp1 = mmc_unbox_integer(_e);
  _outTpl = omc_DumpGraphML_addEdgesGraph(threadData, tmp1, _inTpl);
  /* skip box _outTpl; tuple<#Integer, array<list<#Integer>>, GraphML.GraphInfo> */
  return _outTpl;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addEqnGraph(threadData_t *threadData, modelica_integer _inNode, modelica_metatype _eqns, modelica_metatype _mapIncRowEqn, modelica_boolean _numberMode, modelica_metatype _inGraph)
{
  modelica_metatype _outGraph = NULL;
  modelica_metatype _eqn = NULL;
  modelica_string _str = NULL;
  modelica_metatype _graphInfo = NULL;
  modelica_integer _graph;
  modelica_metatype _label = NULL;
  modelica_string _labelText = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outGraph has no default value.
  // _eqn has no default value.
  // _str has no default value.
  // _graphInfo has no default value.
  // _graph has no default value.
  // _label has no default value.
  // _labelText has no default value.
  { /* match expression */
    modelica_boolean tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _numberMode;
    tmp4_2 = _inGraph;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (0 /* false */ != tmp4_1) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          _graphInfo = tmpMeta6;
          _graph = tmp8  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _eqn = omc_BackendEquation_get(threadData, _eqns, mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */));

          _str = omc_BackendDump_equationString(threadData, _eqn);

          tmpMeta9 = stringAppend(intString(_inNode),_OMC_LIT18);
          tmpMeta10 = stringAppend(tmpMeta9,omc_BackendDump_equationString(threadData, _eqn));
          _str = tmpMeta10;

          _str = omc_Util_xmlEscape(threadData, _str);

          tmpMeta11 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _str, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta11;

          tmpMeta12 = stringAppend(_OMC_LIT1,intString(_inNode));
          tmpMeta13 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta12, _OMC_LIT10, 1.0, tmpMeta13, _OMC_LIT11, mmc_mk_none(), tmpMeta14, _graph, _graphInfo, NULL);
          tmpMeta15 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta1 = tmpMeta15;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_integer tmp18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          if (1 /* true */ != tmp4_1) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp18 = mmc_unbox_integer(tmpMeta17);
          _graphInfo = tmpMeta16;
          _graph = tmp18  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _eqn = omc_BackendEquation_get(threadData, _eqns, mmc_unbox_integer(arrayGet(_mapIncRowEqn,_inNode) /* DAE.ASUB */));

          _str = omc_BackendDump_equationString(threadData, _eqn);

          _str = omc_Util_xmlEscape(threadData, _str);

          _labelText = intString(_inNode);

          tmpMeta19 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta19;

          tmpMeta20 = stringAppend(_OMC_LIT1,intString(_inNode));
          tmpMeta21 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta20, _OMC_LIT10, 1.0, tmpMeta21, _OMC_LIT11, mmc_mk_some(_str), tmpMeta22, _graph, _graphInfo, NULL);
          tmpMeta23 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta1 = tmpMeta23;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outGraph = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outGraph;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_DumpGraphML_addEqnGraph(threadData_t *threadData, modelica_metatype _inNode, modelica_metatype _eqns, modelica_metatype _mapIncRowEqn, modelica_metatype _numberMode, modelica_metatype _inGraph)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _outGraph = NULL;
  tmp1 = mmc_unbox_integer(_inNode);
  tmp2 = mmc_unbox_integer(_numberMode);
  _outGraph = omc_DumpGraphML_addEqnGraph(threadData, tmp1, _eqns, _mapIncRowEqn, tmp2, _inGraph);
  /* skip box _outGraph; tuple<GraphML.GraphInfo, #Integer> */
  return _outGraph;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addVarGraphMatch(threadData_t *threadData, modelica_metatype _inVar, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
  modelica_metatype _outVar = NULL;
  modelica_metatype _outTpl = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outVar has no default value.
  // _outTpl has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _inVar;
    tmp4_2 = _inTpl;
    {
      modelica_metatype _v = NULL;
      modelica_metatype _graphInfo = NULL;
      modelica_metatype _label = NULL;
      modelica_integer _graph;
      modelica_metatype _cr = NULL;
      modelica_integer _id;
      modelica_metatype _vec1 = NULL;
      modelica_string _color = NULL;
      modelica_string _desc = NULL;
      modelica_string _labelText = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _v has no default value.
      // _graphInfo has no default value.
      // _label has no default value.
      // _graph has no default value.
      // _cr has no default value.
      // _id has no default value.
      // _vec1 has no default value.
      // _color has no default value.
      // _desc has no default value.
      // _labelText has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_integer tmp14;
          modelica_metatype tmpMeta15;
          modelica_boolean tmp16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (0 /* false */ != tmp7) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 1));
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 2));
          tmp14 = mmc_unbox_integer(tmpMeta13);
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp9  /* pattern as ty=Integer */;
          _vec1 = tmpMeta10;
          _graphInfo = tmpMeta12;
          _graph = tmp14  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta15;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp16 = omc_BackendVariable_isStateVar(threadData, _v);
          if (1 /* true */ != tmp16) goto goto_2;

          _color = ((mmc_unbox_integer(arrayGet(_vec1,_id) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT20:_OMC_LIT21);

          tmpMeta17 = stringAppend(intString(_id),_OMC_LIT18);
          tmpMeta18 = stringAppend(tmpMeta17,omc_ComponentReference_printComponentRefStr(threadData, _cr));
          _labelText = tmpMeta18;

          tmpMeta19 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta19;

          tmpMeta20 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta21 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta20, _color, 1.0, tmpMeta21, _OMC_LIT22, mmc_mk_none(), tmpMeta22, _graph, _graphInfo, NULL);
          tmpMeta23 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta24 = mmc_mk_box4(0, mmc_mk_boolean(0 /* false */), mmc_mk_integer(((modelica_integer) 1) + _id), _vec1, tmpMeta23);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta24;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta25;
          modelica_integer tmp26;
          modelica_metatype tmpMeta27;
          modelica_integer tmp28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_integer tmp33;
          modelica_metatype tmpMeta34;
          modelica_boolean tmp35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_metatype tmpMeta41;
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp26 = mmc_unbox_integer(tmpMeta25);
          if (1 /* true */ != tmp26) goto tmp3_end;
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp28 = mmc_unbox_integer(tmpMeta27);
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta30 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          tmpMeta31 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta30), 1));
          tmpMeta32 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta30), 2));
          tmp33 = mmc_unbox_integer(tmpMeta32);
          tmpMeta34 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp28  /* pattern as ty=Integer */;
          _vec1 = tmpMeta29;
          _graphInfo = tmpMeta31;
          _graph = tmp33  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta34;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp35 = omc_BackendVariable_isStateVar(threadData, _v);
          if (1 /* true */ != tmp35) goto goto_2;

          _color = ((mmc_unbox_integer(arrayGet(_vec1,_id) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT20:_OMC_LIT21);

          _desc = omc_ComponentReference_printComponentRefStr(threadData, _cr);

          _labelText = intString(_id);

          tmpMeta36 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta36;

          tmpMeta37 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta38 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta39 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta37, _color, 1.0, tmpMeta38, _OMC_LIT22, mmc_mk_some(_desc), tmpMeta39, _graph, _graphInfo, NULL);
          tmpMeta40 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta41 = mmc_mk_box4(0, mmc_mk_boolean(1 /* true */), mmc_mk_integer(((modelica_integer) 1) + _id), _vec1, tmpMeta40);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta41;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta42;
          modelica_integer tmp43;
          modelica_metatype tmpMeta44;
          modelica_integer tmp45;
          modelica_metatype tmpMeta46;
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          modelica_metatype tmpMeta49;
          modelica_integer tmp50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          modelica_metatype tmpMeta55;
          modelica_metatype tmpMeta56;
          modelica_metatype tmpMeta57;
          modelica_metatype tmpMeta58;
          modelica_metatype tmpMeta59;
          tmpMeta42 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp43 = mmc_unbox_integer(tmpMeta42);
          if (0 /* false */ != tmp43) goto tmp3_end;
          tmpMeta44 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp45 = mmc_unbox_integer(tmpMeta44);
          tmpMeta46 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta47 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          tmpMeta48 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta47), 1));
          tmpMeta49 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta47), 2));
          tmp50 = mmc_unbox_integer(tmpMeta49);
          tmpMeta51 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp45  /* pattern as ty=Integer */;
          _vec1 = tmpMeta46;
          _graphInfo = tmpMeta48;
          _graph = tmp50  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta51;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _color = ((mmc_unbox_integer(arrayGet(_vec1,_id) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT23:_OMC_LIT21);

          tmpMeta52 = stringAppend(intString(_id),_OMC_LIT18);
          tmpMeta53 = stringAppend(tmpMeta52,omc_ComponentReference_printComponentRefStr(threadData, _cr));
          _labelText = tmpMeta53;

          tmpMeta54 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta54;

          tmpMeta55 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta56 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta57 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta55, _color, 1.0, tmpMeta56, _OMC_LIT22, mmc_mk_none(), tmpMeta57, _graph, _graphInfo, NULL);
          tmpMeta58 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta59 = mmc_mk_box4(0, mmc_mk_boolean(0 /* false */), mmc_mk_integer(((modelica_integer) 1) + _id), _vec1, tmpMeta58);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta59;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta60;
          modelica_integer tmp61;
          modelica_metatype tmpMeta62;
          modelica_integer tmp63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          modelica_metatype tmpMeta67;
          modelica_integer tmp68;
          modelica_metatype tmpMeta69;
          modelica_metatype tmpMeta70;
          modelica_metatype tmpMeta71;
          modelica_metatype tmpMeta72;
          modelica_metatype tmpMeta73;
          modelica_metatype tmpMeta74;
          modelica_metatype tmpMeta75;
          tmpMeta60 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp61 = mmc_unbox_integer(tmpMeta60);
          if (1 /* true */ != tmp61) goto tmp3_end;
          tmpMeta62 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp63 = mmc_unbox_integer(tmpMeta62);
          tmpMeta64 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta65 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          tmpMeta66 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta65), 1));
          tmpMeta67 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta65), 2));
          tmp68 = mmc_unbox_integer(tmpMeta67);
          tmpMeta69 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp63  /* pattern as ty=Integer */;
          _vec1 = tmpMeta64;
          _graphInfo = tmpMeta66;
          _graph = tmp68  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta69;
          /* Pattern matching succeeded */
          _color = ((mmc_unbox_integer(arrayGet(_vec1,_id) /* DAE.ASUB */) > ((modelica_integer) 0))?_OMC_LIT23:_OMC_LIT21);

          _desc = omc_ComponentReference_printComponentRefStr(threadData, _cr);

          _labelText = intString(_id);

          tmpMeta70 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta70;

          tmpMeta71 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta72 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta73 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta71, _color, 1.0, tmpMeta72, _OMC_LIT22, mmc_mk_some(_desc), tmpMeta73, _graph, _graphInfo, NULL);
          tmpMeta74 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta75 = mmc_mk_box4(0, mmc_mk_boolean(1 /* true */), mmc_mk_integer(((modelica_integer) 1) + _id), _vec1, tmpMeta74);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta75;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _inVar;
          tmpMeta[0+1] = _inTpl;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 5) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outVar = tmpMeta[0+0];
  _outTpl = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_outTpl) { *out_outTpl = _outTpl; }
  return _outVar;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_DumpGraphML_addVarGraph(threadData_t *threadData, modelica_metatype _inVar, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
  modelica_metatype _outVar = NULL;
  modelica_metatype _outTpl = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outVar has no default value.
  // _outTpl has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _inVar;
    tmp4_2 = _inTpl;
    {
      modelica_metatype _v = NULL;
      modelica_metatype _graphInfo = NULL;
      modelica_metatype _label = NULL;
      modelica_integer _graph;
      modelica_metatype _cr = NULL;
      modelica_integer _id;
      modelica_boolean _b;
      modelica_string _color = NULL;
      modelica_string _desc = NULL;
      modelica_string _labelText = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _v has no default value.
      // _graphInfo has no default value.
      // _label has no default value.
      // _graph has no default value.
      // _cr has no default value.
      // _id has no default value.
      // _b has no default value.
      // _color has no default value.
      // _desc has no default value.
      // _labelText has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_boolean tmp15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 /* true */ != tmp7) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 1));
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 2));
          tmp13 = mmc_unbox_integer(tmpMeta12);
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp9  /* pattern as ty=Integer */;
          _graphInfo = tmpMeta11;
          _graph = tmp13  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta14;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp15 = omc_BackendVariable_isStateVar(threadData, _v);
          if (1 /* true */ != tmp15) goto goto_2;

          _labelText = intString(_id);

          tmpMeta16 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta16;

          _desc = omc_ComponentReference_printComponentRefStr(threadData, _cr);

          tmpMeta17 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta18 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta17, _OMC_LIT20, 1.0, tmpMeta18, _OMC_LIT22, mmc_mk_some(_desc), tmpMeta19, _graph, _graphInfo, NULL);
          tmpMeta20 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta21 = mmc_mk_box3(0, mmc_mk_boolean(1 /* true */), mmc_mk_integer(((modelica_integer) 1) + _id), tmpMeta20);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta21;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta22;
          modelica_integer tmp23;
          modelica_metatype tmpMeta24;
          modelica_integer tmp25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_integer tmp29;
          modelica_metatype tmpMeta30;
          modelica_boolean tmp31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp23 = mmc_unbox_integer(tmpMeta22);
          if (0 /* false */ != tmp23) goto tmp3_end;
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp25 = mmc_unbox_integer(tmpMeta24);
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta26), 1));
          tmpMeta28 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta26), 2));
          tmp29 = mmc_unbox_integer(tmpMeta28);
          tmpMeta30 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp25  /* pattern as ty=Integer */;
          _graphInfo = tmpMeta27;
          _graph = tmp29  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta30;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp31 = omc_BackendVariable_isStateVar(threadData, _v);
          if (1 /* true */ != tmp31) goto goto_2;

          tmpMeta32 = stringAppend(intString(_id),_OMC_LIT18);
          tmpMeta33 = stringAppend(tmpMeta32,omc_ComponentReference_printComponentRefStr(threadData, _cr));
          _labelText = tmpMeta33;

          tmpMeta34 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta34;

          tmpMeta35 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta36 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta37 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta35, _OMC_LIT20, 1.0, tmpMeta36, _OMC_LIT22, mmc_mk_none(), tmpMeta37, _graph, _graphInfo, NULL);
          tmpMeta38 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta39 = mmc_mk_box3(0, mmc_mk_boolean(0 /* false */), mmc_mk_integer(((modelica_integer) 1) + _id), tmpMeta38);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta39;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta40;
          modelica_integer tmp41;
          modelica_metatype tmpMeta42;
          modelica_integer tmp43;
          modelica_metatype tmpMeta44;
          modelica_metatype tmpMeta45;
          modelica_metatype tmpMeta46;
          modelica_integer tmp47;
          modelica_metatype tmpMeta48;
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          tmpMeta40 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp41 = mmc_unbox_integer(tmpMeta40);
          if (1 /* true */ != tmp41) goto tmp3_end;
          tmpMeta42 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp43 = mmc_unbox_integer(tmpMeta42);
          tmpMeta44 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta45 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta44), 1));
          tmpMeta46 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta44), 2));
          tmp47 = mmc_unbox_integer(tmpMeta46);
          tmpMeta48 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp43  /* pattern as ty=Integer */;
          _graphInfo = tmpMeta45;
          _graph = tmp47  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta48;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _b = omc_BackendVariable_isVarDiscrete(threadData, _v);

          _color = (_b?_OMC_LIT19:_OMC_LIT23);

          _labelText = intString(_id);

          tmpMeta49 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta49;

          _desc = omc_ComponentReference_printComponentRefStr(threadData, _cr);

          tmpMeta50 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta51 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta52 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta50, _color, 1.0, tmpMeta51, _OMC_LIT22, mmc_mk_some(_desc), tmpMeta52, _graph, _graphInfo, NULL);
          tmpMeta53 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta54 = mmc_mk_box3(0, mmc_mk_boolean(1 /* true */), mmc_mk_integer(((modelica_integer) 1) + _id), tmpMeta53);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta54;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta55;
          modelica_integer tmp56;
          modelica_metatype tmpMeta57;
          modelica_integer tmp58;
          modelica_metatype tmpMeta59;
          modelica_metatype tmpMeta60;
          modelica_metatype tmpMeta61;
          modelica_integer tmp62;
          modelica_metatype tmpMeta63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          modelica_metatype tmpMeta67;
          modelica_metatype tmpMeta68;
          modelica_metatype tmpMeta69;
          modelica_metatype tmpMeta70;
          modelica_metatype tmpMeta71;
          tmpMeta55 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp56 = mmc_unbox_integer(tmpMeta55);
          if (0 /* false */ != tmp56) goto tmp3_end;
          tmpMeta57 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          tmp58 = mmc_unbox_integer(tmpMeta57);
          tmpMeta59 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          tmpMeta60 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta59), 1));
          tmpMeta61 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta59), 2));
          tmp62 = mmc_unbox_integer(tmpMeta61);
          tmpMeta63 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _id = tmp58  /* pattern as ty=Integer */;
          _graphInfo = tmpMeta60;
          _graph = tmp62  /* pattern as ty=Integer */;
          _v = tmp4_1;
          _cr = tmpMeta63;
          /* Pattern matching succeeded */
          _b = omc_BackendVariable_isVarDiscrete(threadData, _v);

          _color = (_b?_OMC_LIT19:_OMC_LIT23);

          tmpMeta64 = stringAppend(intString(_id),_OMC_LIT18);
          tmpMeta65 = stringAppend(tmpMeta64,omc_ComponentReference_printComponentRefStr(threadData, _cr));
          _labelText = tmpMeta65;

          tmpMeta66 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT9);
          _label = tmpMeta66;

          tmpMeta67 = stringAppend(_OMC_LIT15,intString(_id));
          tmpMeta68 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta69 = MMC_REFSTRUCTLIT(mmc_nil);
          _graphInfo = omc_GraphML_addNode(threadData, tmpMeta67, _color, 1.0, tmpMeta68, _OMC_LIT22, mmc_mk_none(), tmpMeta69, _graph, _graphInfo, NULL);
          tmpMeta70 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta71 = mmc_mk_box3(0, mmc_mk_boolean(0 /* false */), mmc_mk_integer(((modelica_integer) 1) + _id), tmpMeta70);
          tmpMeta[0+0] = _v;
          tmpMeta[0+1] = tmpMeta71;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _inVar;
          tmpMeta[0+1] = _inTpl;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 5) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outVar = tmpMeta[0+0];
  _outTpl = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_outTpl) { *out_outTpl = _outTpl; }
  return _outVar;
}

DLLDirection
void omc_DumpGraphML_dumpSystem(threadData_t *threadData, modelica_metatype _inSystem, modelica_metatype _inShared, modelica_metatype _inids, modelica_string _filename, modelica_boolean _numberMode)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;modelica_metatype tmp3_2;
    tmp3_1 = _inSystem;
    tmp3_2 = _inids;
    {
      modelica_metatype _vars = NULL;
      modelica_metatype _eqns = NULL;
      modelica_metatype _m = NULL;
      modelica_metatype _mt = NULL;
      modelica_metatype _graphInfo = NULL;
      modelica_integer _graph;
      modelica_metatype _eqnsids = NULL;
      modelica_integer _neqns;
      modelica_metatype _vec1 = NULL;
      modelica_metatype _vec2 = NULL;
      modelica_metatype _vec3 = NULL;
      modelica_metatype _mapIncRowEqn = NULL;
      modelica_metatype _eqnsflag = NULL;
      modelica_metatype _funcs = NULL;
      modelica_metatype _comps = NULL;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _vars has no default value.
      // _eqns has no default value.
      // _m has no default value.
      // _mt has no default value.
      // _graphInfo has no default value.
      // _graph has no default value.
      // _eqnsids has no default value.
      // _neqns has no default value.
      // _vec1 has no default value.
      // _vec2 has no default value.
      // _vec3 has no default value.
      // _mapIncRowEqn has no default value.
      // _eqnsflag has no default value.
      // _funcs has no default value.
      // _comps has no default value.
      tmp3 = 0;
      for (; tmp3 < 5; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_integer tmp16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_integer tmp21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta5,0,0) == 0) goto tmp2_end;
          if (!optionNone(tmp3_2)) goto tmp2_end;
          /* Pattern matching succeeded */
          _vars = omc_BackendVariable_daeVars(threadData, _inSystem);

          _eqns = omc_BackendEquation_getEqnsFromEqSystem(threadData, _inSystem);

          _funcs = omc_BackendDAEUtil_getFunctions(threadData, _inShared);

          omc_BackendDAEUtil_getAdjacencyMatrix(threadData, _inSystem, _OMC_LIT24, mmc_mk_some(_funcs), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared) ,&_m ,NULL);

          _mapIncRowEqn = omc_Array_createIntRange(threadData, arrayLength(_m));

          _graphInfo = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta9 = omc_GraphML_addGraph(threadData, _OMC_LIT25, 0 /* false */, _graphInfo, &tmpMeta6);
          _graphInfo = tmpMeta9;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          _graph = tmp8  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta10 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta11 = mmc_mk_box3(0, mmc_mk_boolean(_numberMode), mmc_mk_integer(((modelica_integer) 1)), tmpMeta10);
          tmpMeta12 = omc_BackendVariable_traverseBackendDAEVars(threadData, _vars, boxvar_DumpGraphML_addVarGraph, tmpMeta11);
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 3));
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta13), 1));
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta13), 2));
          tmp16 = mmc_unbox_integer(tmpMeta15);
          _graphInfo = tmpMeta14;
          _graph = tmp16  /* pattern as ty=Integer */;

          _neqns = omc_BackendEquation_getNumberOfEquations(threadData, _eqns);

          _eqnsids = omc_List_intRange(threadData, _neqns);

          /* Pattern-matching assignment */
          tmpMeta17 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta18 = omc_List_fold3(threadData, _eqnsids, boxvar_DumpGraphML_addEqnGraph, _eqns, _mapIncRowEqn, mmc_mk_boolean(_numberMode), tmpMeta17);
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta18), 1));
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta18), 2));
          tmp21 = mmc_unbox_integer(tmpMeta20);
          _graphInfo = tmpMeta19;
          _graph = tmp21  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta22 = mmc_mk_box3(0, mmc_mk_integer(((modelica_integer) 1)), _m, _graphInfo);
          tmpMeta23 = omc_List_fold(threadData, _eqnsids, boxvar_DumpGraphML_addEdgesGraph, tmpMeta22);
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta23), 3));
          _graphInfo = tmpMeta24;

          omc_GraphML_dumpGraph(threadData, _graphInfo, _filename);
          goto tmp2_done;
        }
        case 1: {
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_integer tmp32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_integer tmp40;
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          modelica_integer tmp45;
          modelica_metatype tmpMeta46;
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          if (!optionNone(tmp3_2)) goto tmp2_end;
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 4));
          if (optionNone(tmpMeta25)) goto tmp2_end;
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta25), 1));
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 5));
          if (optionNone(tmpMeta27)) goto tmp2_end;
          tmpMeta28 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta27), 1));
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta29,0,0) == 0) goto tmp2_end;
          
          _m = tmpMeta26;
          /* Pattern matching succeeded */
          _vars = omc_BackendVariable_daeVars(threadData, _inSystem);

          _eqns = omc_BackendEquation_getEqnsFromEqSystem(threadData, _inSystem);

          _graphInfo = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta33 = omc_GraphML_addGraph(threadData, _OMC_LIT25, 0 /* false */, _graphInfo, &tmpMeta30);
          _graphInfo = tmpMeta33;
          tmpMeta31 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta30), 2));
          tmp32 = mmc_unbox_integer(tmpMeta31);
          _graph = tmp32  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta34 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta35 = mmc_mk_box3(0, mmc_mk_boolean(_numberMode), mmc_mk_integer(((modelica_integer) 1)), tmpMeta34);
          tmpMeta36 = omc_BackendVariable_traverseBackendDAEVars(threadData, _vars, boxvar_DumpGraphML_addVarGraph, tmpMeta35);
          tmpMeta37 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta36), 3));
          tmpMeta38 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta37), 1));
          tmpMeta39 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta37), 2));
          tmp40 = mmc_unbox_integer(tmpMeta39);
          _graphInfo = tmpMeta38;
          _graph = tmp40  /* pattern as ty=Integer */;

          _neqns = omc_BackendEquation_getNumberOfEquations(threadData, _eqns);

          _eqnsids = omc_List_intRange(threadData, _neqns);

          _mapIncRowEqn = omc_Array_createIntRange(threadData, arrayLength(_m));

          /* Pattern-matching assignment */
          tmpMeta41 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta42 = omc_List_fold3(threadData, _eqnsids, boxvar_DumpGraphML_addEqnGraph, _eqns, _mapIncRowEqn, mmc_mk_boolean(_numberMode), tmpMeta41);
          tmpMeta43 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta42), 1));
          tmpMeta44 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta42), 2));
          tmp45 = mmc_unbox_integer(tmpMeta44);
          _graphInfo = tmpMeta43;
          _graph = tmp45  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta46 = mmc_mk_box3(0, mmc_mk_integer(((modelica_integer) 1)), _m, _graphInfo);
          tmpMeta47 = omc_List_fold(threadData, _eqnsids, boxvar_DumpGraphML_addEdgesGraph, tmpMeta46);
          tmpMeta48 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta47), 3));
          _graphInfo = tmpMeta48;

          omc_GraphML_dumpGraph(threadData, _graphInfo, _filename);
          goto tmp2_done;
        }
        case 2: {
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          modelica_integer tmp55;
          modelica_metatype tmpMeta56;
          modelica_metatype tmpMeta57;
          modelica_metatype tmpMeta58;
          modelica_metatype tmpMeta59;
          modelica_metatype tmpMeta60;
          modelica_metatype tmpMeta61;
          modelica_metatype tmpMeta62;
          modelica_integer tmp63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          modelica_metatype tmpMeta67;
          modelica_metatype tmpMeta68;
          modelica_integer tmp69;
          modelica_metatype tmpMeta70;
          modelica_metatype tmpMeta71;
          modelica_metatype tmpMeta72;
          if (!optionNone(tmp3_2)) goto tmp2_end;
          tmpMeta49 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta49,1,3) == 0) goto tmp2_end;
          tmpMeta50 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta49), 2));
          tmpMeta51 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta49), 3));
          tmpMeta52 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta49), 4));
          if (!listEmpty(tmpMeta52)) goto tmp2_end;
          
          _vec1 = tmpMeta50;
          _vec2 = tmpMeta51;
          /* Pattern matching succeeded */
          _vars = omc_BackendVariable_daeVars(threadData, _inSystem);

          _eqns = omc_BackendEquation_getEqnsFromEqSystem(threadData, _inSystem);

          _funcs = omc_BackendDAEUtil_getFunctions(threadData, _inShared);

          omc_BackendDAEUtil_getAdjacencyMatrixScalar(threadData, _inSystem, _OMC_LIT24, mmc_mk_some(_funcs), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared) ,&_m ,NULL ,NULL ,&_mapIncRowEqn);

          _graphInfo = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta56 = omc_GraphML_addGraph(threadData, _OMC_LIT25, 0 /* false */, _graphInfo, &tmpMeta53);
          _graphInfo = tmpMeta56;
          tmpMeta54 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta53), 2));
          tmp55 = mmc_unbox_integer(tmpMeta54);
          _graph = tmp55  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta57 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta58 = mmc_mk_box4(0, mmc_mk_boolean(_numberMode), mmc_mk_integer(((modelica_integer) 1)), _vec1, tmpMeta57);
          tmpMeta59 = omc_BackendVariable_traverseBackendDAEVars(threadData, _vars, boxvar_DumpGraphML_addVarGraphMatch, tmpMeta58);
          tmpMeta60 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta59), 4));
          tmpMeta61 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta60), 1));
          tmpMeta62 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta60), 2));
          tmp63 = mmc_unbox_integer(tmpMeta62);
          _graphInfo = tmpMeta61;
          _graph = tmp63  /* pattern as ty=Integer */;

          _neqns = omc_BackendEquation_equationArraySize(threadData, _eqns);

          _eqnsids = omc_List_intRange(threadData, _neqns);

          _eqnsflag = arrayCreate(_neqns, mmc_mk_boolean(0 /* false */));

          /* Pattern-matching assignment */
          tmpMeta64 = mmc_mk_box3(0, _vec2, _mapIncRowEqn, _eqnsflag);
          tmpMeta65 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta66 = omc_List_fold3(threadData, _eqnsids, boxvar_DumpGraphML_addEqnGraphMatch, _eqns, tmpMeta64, mmc_mk_boolean(_numberMode), tmpMeta65);
          tmpMeta67 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta66), 1));
          tmpMeta68 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta66), 2));
          tmp69 = mmc_unbox_integer(tmpMeta68);
          _graphInfo = tmpMeta67;
          _graph = tmp69  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta70 = mmc_mk_box5(0, mmc_mk_integer(((modelica_integer) 1)), _m, _vec2, _mapIncRowEqn, _graphInfo);
          tmpMeta71 = omc_List_fold(threadData, _eqnsids, boxvar_DumpGraphML_addDirectedEdgesGraph, tmpMeta70);
          tmpMeta72 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta71), 5));
          _graphInfo = tmpMeta72;

          omc_GraphML_dumpGraph(threadData, _graphInfo, _filename);
          goto tmp2_done;
        }
        case 3: {
          modelica_metatype tmpMeta73;
          modelica_metatype tmpMeta74;
          modelica_metatype tmpMeta75;
          modelica_metatype tmpMeta76;
          modelica_metatype tmpMeta77;
          modelica_metatype tmpMeta78;
          modelica_integer tmp79;
          modelica_metatype tmpMeta80;
          modelica_metatype tmpMeta81;
          modelica_metatype tmpMeta82;
          modelica_metatype tmpMeta83;
          modelica_metatype tmpMeta84;
          modelica_metatype tmpMeta85;
          modelica_metatype tmpMeta86;
          modelica_integer tmp87;
          modelica_metatype tmpMeta88;
          modelica_metatype tmpMeta89;
          modelica_metatype tmpMeta90;
          modelica_metatype tmpMeta91;
          modelica_integer tmp92;
          modelica_metatype tmpMeta93;
          modelica_metatype tmpMeta94;
          modelica_metatype tmpMeta95;
          if (optionNone(tmp3_2)) goto tmp2_end;
          tmpMeta73 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_2), 1));
          tmpMeta74 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta74,1,3) == 0) goto tmp2_end;
          tmpMeta75 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta74), 3));
          tmpMeta76 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta74), 4));
          if (!listEmpty(tmpMeta76)) goto tmp2_end;
          
          _vec3 = tmpMeta73;
          _vec2 = tmpMeta75;
          /* Pattern matching succeeded */
          _vars = omc_BackendVariable_daeVars(threadData, _inSystem);

          _eqns = omc_BackendEquation_getEqnsFromEqSystem(threadData, _inSystem);

          _funcs = omc_BackendDAEUtil_getFunctions(threadData, _inShared);

          omc_BackendDAEUtil_getAdjacencyMatrixScalar(threadData, _inSystem, _OMC_LIT24, mmc_mk_some(_funcs), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared) ,&_m ,NULL ,NULL ,&_mapIncRowEqn);

          _graphInfo = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta80 = omc_GraphML_addGraph(threadData, _OMC_LIT25, 0 /* false */, _graphInfo, &tmpMeta77);
          _graphInfo = tmpMeta80;
          tmpMeta78 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta77), 2));
          tmp79 = mmc_unbox_integer(tmpMeta78);
          _graph = tmp79  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta81 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta82 = mmc_mk_box3(0, mmc_mk_boolean(_numberMode), mmc_mk_integer(((modelica_integer) 1)), tmpMeta81);
          tmpMeta83 = omc_BackendVariable_traverseBackendDAEVars(threadData, _vars, boxvar_DumpGraphML_addVarGraph, tmpMeta82);
          tmpMeta84 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta83), 3));
          tmpMeta85 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta84), 1));
          tmpMeta86 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta84), 2));
          tmp87 = mmc_unbox_integer(tmpMeta86);
          _graphInfo = tmpMeta85;
          _graph = tmp87  /* pattern as ty=Integer */;

          _neqns = omc_BackendEquation_equationArraySize(threadData, _eqns);

          _eqnsids = omc_List_intRange(threadData, _neqns);

          /* Pattern-matching assignment */
          tmpMeta88 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta89 = omc_List_fold3(threadData, _eqnsids, boxvar_DumpGraphML_addEqnGraph, _eqns, _mapIncRowEqn, mmc_mk_boolean(_numberMode), tmpMeta88);
          tmpMeta90 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta89), 1));
          tmpMeta91 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta89), 2));
          tmp92 = mmc_unbox_integer(tmpMeta91);
          _graphInfo = tmpMeta90;
          _graph = tmp92  /* pattern as ty=Integer */;

          /* Pattern-matching assignment */
          tmpMeta93 = mmc_mk_box5(0, mmc_mk_integer(((modelica_integer) 1)), _m, _vec2, _vec3, _graphInfo);
          tmpMeta94 = omc_List_fold(threadData, _eqnsids, boxvar_DumpGraphML_addDirectedNumEdgesGraph, tmpMeta93);
          tmpMeta95 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta94), 5));
          _graphInfo = tmpMeta95;

          omc_GraphML_dumpGraph(threadData, _graphInfo, _filename);
          goto tmp2_done;
        }
        case 4: {
          modelica_metatype tmpMeta96;
          modelica_metatype tmpMeta97;
          modelica_metatype tmpMeta98;
          modelica_metatype tmpMeta99;
          modelica_integer tmp100;
          modelica_metatype tmpMeta101;
          modelica_metatype tmpMeta102;
          modelica_metatype tmpMeta103;
          modelica_metatype tmpMeta104;
          modelica_metatype tmpMeta105;
          modelica_integer tmp106;
          tmpMeta96 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 7));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta96,1,3) == 0) goto tmp2_end;
          tmpMeta97 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta96), 4));
          if (!optionNone(tmp3_2)) goto tmp2_end;
          _comps = tmpMeta97;
          /* Pattern matching succeeded */
          _vars = omc_BackendVariable_daeVars(threadData, _inSystem);

          omc_BackendEquation_getEqnsFromEqSystem(threadData, _inSystem);

          _funcs = omc_BackendDAEUtil_getFunctions(threadData, _inShared);

          omc_BackendDAEUtil_getAdjacencyMatrix(threadData, _inSystem, _OMC_LIT24, mmc_mk_some(_funcs), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared) ,&_m ,&_mt);

          _graphInfo = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta101 = omc_GraphML_addGraph(threadData, _OMC_LIT25, 0 /* false */, _graphInfo, &tmpMeta98);
          _graphInfo = tmpMeta101;
          tmpMeta99 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta98), 2));
          tmp100 = mmc_unbox_integer(tmpMeta99);
          _graph = tmp100  /* pattern as ty=Integer */;

          _vec3 = arrayCreate(arrayLength(_mt), mmc_mk_integer(((modelica_integer) -1)));

          /* Pattern-matching assignment */
          tmpMeta102 = mmc_mk_box2(0, _graphInfo, mmc_mk_integer(_graph));
          tmpMeta103 = omc_DumpGraphML_addCompsGraph(threadData, _comps, _vars, _vec3, ((modelica_integer) 1), tmpMeta102);
          tmpMeta104 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta103), 1));
          tmpMeta105 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta103), 2));
          tmp106 = mmc_unbox_integer(tmpMeta105);
          _graphInfo = tmpMeta104;
          _graph = tmp106  /* pattern as ty=Integer */;

          _mapIncRowEqn = arrayCreate(arrayLength(_mt), mmc_mk_integer(((modelica_integer) -1)));

          _graphInfo = omc_DumpGraphML_addCompsEdgesGraph(threadData, _comps, _m, _vec3, ((modelica_integer) 1), ((modelica_integer) 1), _mapIncRowEqn, ((modelica_integer) 1), _graphInfo);

          omc_GraphML_dumpGraph(threadData, _graphInfo, _filename);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}
void boxptr_DumpGraphML_dumpSystem(threadData_t *threadData, modelica_metatype _inSystem, modelica_metatype _inShared, modelica_metatype _inids, modelica_metatype _filename, modelica_metatype _numberMode)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_numberMode);
  omc_DumpGraphML_dumpSystem(threadData, _inSystem, _inShared, _inids, _filename, tmp1);
  return;
}

