#include "omc_simulation_settings.h"
#include "SBFunctions.h"
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT0,1.0);
#define _OMC_LIT0 MMC_REFREALLIT(_OMC_LIT_STRUCT0)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT1,2,1) {_OMC_LIT0,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT1 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT1)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT2,2,1) {_OMC_LIT0,_OMC_LIT1}};
#define _OMC_LIT2 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT3,0.0);
#define _OMC_LIT3 MMC_REFREALLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,2,1) {_OMC_LIT3,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT5,2,1) {_OMC_LIT3,_OMC_LIT4}};
#define _OMC_LIT5 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT5)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT6,1001.0);
#define _OMC_LIT6 MMC_REFREALLIT(_OMC_LIT_STRUCT6)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT7,101.0);
#define _OMC_LIT7 MMC_REFREALLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,2,1) {_OMC_LIT7,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT9,2,1) {_OMC_LIT6,_OMC_LIT8}};
#define _OMC_LIT9 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,2,1) {_OMC_LIT0,_OMC_LIT4}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT11,-1998.0);
#define _OMC_LIT11 MMC_REFREALLIT(_OMC_LIT_STRUCT11)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT12,100.0);
#define _OMC_LIT12 MMC_REFREALLIT(_OMC_LIT_STRUCT12)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT13,2,1) {_OMC_LIT12,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT13 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT13)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT14,2,1) {_OMC_LIT11,_OMC_LIT13}};
#define _OMC_LIT14 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT15,2,1) {_OMC_LIT3,_OMC_LIT1}};
#define _OMC_LIT15 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT16,3001.0);
#define _OMC_LIT16 MMC_REFREALLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,2,1) {_OMC_LIT16,_OMC_LIT8}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT18,3000.0);
#define _OMC_LIT18 MMC_REFREALLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT19,-99.0);
#define _OMC_LIT19 MMC_REFREALLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,2,1) {_OMC_LIT19,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT21,2,1) {_OMC_LIT18,_OMC_LIT20}};
#define _OMC_LIT21 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT22,1000.0);
#define _OMC_LIT22 MMC_REFREALLIT(_OMC_LIT_STRUCT22)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT23,2,1) {_OMC_LIT22,_OMC_LIT8}};
#define _OMC_LIT23 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT24,2002.0);
#define _OMC_LIT24 MMC_REFREALLIT(_OMC_LIT_STRUCT24)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT25,201.0);
#define _OMC_LIT25 MMC_REFREALLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,2,1) {_OMC_LIT25,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT27,2,1) {_OMC_LIT24,_OMC_LIT26}};
#define _OMC_LIT27 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT27)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT28,-998.0);
#define _OMC_LIT28 MMC_REFREALLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,2,1) {_OMC_LIT28,_OMC_LIT8}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT30,4001.0);
#define _OMC_LIT30 MMC_REFREALLIT(_OMC_LIT_STRUCT30)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT31,2,1) {_OMC_LIT30,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT31 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,2,1) {_OMC_LIT30,_OMC_LIT31}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT33,4002.0);
#define _OMC_LIT33 MMC_REFREALLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,2,1) {_OMC_LIT33,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT35,2,1) {_OMC_LIT33,_OMC_LIT34}};
#define _OMC_LIT35 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,1,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT37,1002.0);
#define _OMC_LIT37 MMC_REFREALLIT(_OMC_LIT_STRUCT37)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT38,2,1) {_OMC_LIT37,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT38 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT38)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT39,1004.0);
#define _OMC_LIT39 MMC_REFREALLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,2,1) {_OMC_LIT39,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT41,2000.0);
#define _OMC_LIT41 MMC_REFREALLIT(_OMC_LIT_STRUCT41)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT42,2,1) {_OMC_LIT41,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT42 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT42)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT43,2.0);
#define _OMC_LIT43 MMC_REFREALLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,2,1) {_OMC_LIT43,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT45,1003.0);
#define _OMC_LIT45 MMC_REFREALLIT(_OMC_LIT_STRUCT45)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT46,2,1) {_OMC_LIT45,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT46 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT46)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT47,-1.0);
#define _OMC_LIT47 MMC_REFREALLIT(_OMC_LIT_STRUCT47)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT48,2,1) {_OMC_LIT47,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT48 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT48)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT49,2,1) {_OMC_LIT6,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT49 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT49)
#include "util/modelica.h"

#include "SBFunctions_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_real omc_SBFunctions_mapInf_max__inter(threadData_t *threadData, modelica_metatype _aset, modelica_real _offset, modelica_integer _dim, modelica_real __omcQ_24in_5Fits);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_SBFunctions_mapInf_max__inter(threadData_t *threadData, modelica_metatype _aset, modelica_metatype _offset, modelica_metatype _dim, modelica_metatype __omcQ_24in_5Fits);
static const MMC_DEFSTRUCTLIT(boxvar_lit_SBFunctions_mapInf_max__inter,2,0) {(void*) boxptr_SBFunctions_mapInf_max__inter,0}};
#define boxvar_SBFunctions_mapInf_max__inter MMC_REFSTRUCTLIT(boxvar_lit_SBFunctions_mapInf_max__inter)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_SBFunctions_minAtomPW_make__result(threadData_t *threadData, modelica_metatype _aset, modelica_metatype _map);
static const MMC_DEFSTRUCTLIT(boxvar_lit_SBFunctions_minAtomPW_make__result,2,0) {(void*) boxptr_SBFunctions_minAtomPW_make__result,0}};
#define boxvar_SBFunctions_minAtomPW_make__result MMC_REFSTRUCTLIT(boxvar_lit_SBFunctions_minAtomPW_make__result)

DLLDirection
void omc_SBFunctions_test3(threadData_t *threadData)
{
  modelica_metatype _vss = NULL;
  modelica_metatype _emap1 = NULL;
  modelica_metatype _emap2 = NULL;
  modelica_metatype _res = NULL;
  modelica_metatype _sets = NULL;
  modelica_metatype _pws1 = NULL;
  modelica_metatype _pws2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _vss has no default value.
  // _emap1 has no default value.
  // _emap2 has no default value.
  // _res has no default value.
  // _sets has no default value.
  // _pws1 has no default value.
  // _pws2 has no default value.
  tmpMeta2 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 100)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta3 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1001), ((modelica_integer) 1), ((modelica_integer) 2000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 101), ((modelica_integer) 1), ((modelica_integer) 200)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta4 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2001), ((modelica_integer) 1), ((modelica_integer) 3000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 201), ((modelica_integer) 1), ((modelica_integer) 300)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta5 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3001), ((modelica_integer) 1), ((modelica_integer) 4000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 301), ((modelica_integer) 1), ((modelica_integer) 400)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta6 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 4001), ((modelica_integer) 1), ((modelica_integer) 4001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta7 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 4002), ((modelica_integer) 1), ((modelica_integer) 4002)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta1 = mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta2), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta3), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta4), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta5), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta6), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta7), MMC_REFSTRUCTLIT(mmc_nil)))))));
  _sets = tmpMeta1;

  _vss = omc_SBSet_newEmpty(threadData);

  {
    modelica_metatype _s;
    for (tmpMeta8 = _sets; !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
    {
      _s = MMC_CAR(tmpMeta8);
      _vss = omc_SBSet_union(threadData, _vss, _s);
    }
  }

  tmpMeta11 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 999)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 99)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta12 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1000), ((modelica_integer) 1), ((modelica_integer) 1998)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 100), ((modelica_integer) 1), ((modelica_integer) 198)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta13 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1999), ((modelica_integer) 1), ((modelica_integer) 2998)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 199), ((modelica_integer) 1), ((modelica_integer) 199)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta14 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2999), ((modelica_integer) 1), ((modelica_integer) 2999)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 200), ((modelica_integer) 1), ((modelica_integer) 299)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta15 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3000), ((modelica_integer) 1), ((modelica_integer) 3000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 300), ((modelica_integer) 1), ((modelica_integer) 399)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta10 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta11, _OMC_LIT2, _OMC_LIT5), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta12, _OMC_LIT2, _OMC_LIT9), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta13, _OMC_LIT10, _OMC_LIT14), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta14, _OMC_LIT15, _OMC_LIT17), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta15, _OMC_LIT15, _OMC_LIT21), MMC_REFSTRUCTLIT(mmc_nil))))));
  _pws1 = tmpMeta10;

  /* Pattern-matching assignment */
  tmpMeta16 = _pws1;
  if (listEmpty(tmpMeta16)) MMC_THROW_INTERNAL();
  tmpMeta17 = MMC_CAR(tmpMeta16);
  tmpMeta18 = MMC_CDR(tmpMeta16);
  _emap1 = tmpMeta17;
  _pws1 = tmpMeta18;

  {
    modelica_metatype _pw;
    for (tmpMeta19 = _pws1; !listEmpty(tmpMeta19); tmpMeta19=MMC_CDR(tmpMeta19))
    {
      _pw = MMC_CAR(tmpMeta19);
      _emap1 = omc_SBPWLinearMap_combine(threadData, _pw, _emap1);
    }
  }

  tmpMeta22 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 999)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 99)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta23 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1000), ((modelica_integer) 1), ((modelica_integer) 1998)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 100), ((modelica_integer) 1), ((modelica_integer) 198)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta24 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1999), ((modelica_integer) 1), ((modelica_integer) 2998)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 199), ((modelica_integer) 1), ((modelica_integer) 199)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta25 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2999), ((modelica_integer) 1), ((modelica_integer) 2999)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 200), ((modelica_integer) 1), ((modelica_integer) 299)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta26 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3000), ((modelica_integer) 1), ((modelica_integer) 3000)), mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 300), ((modelica_integer) 1), ((modelica_integer) 399)), MMC_REFSTRUCTLIT(mmc_nil)));
  tmpMeta21 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta22, _OMC_LIT2, _OMC_LIT23), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta23, _OMC_LIT2, _OMC_LIT27), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta24, _OMC_LIT10, _OMC_LIT29), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta25, _OMC_LIT5, _OMC_LIT32), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta26, _OMC_LIT5, _OMC_LIT35), MMC_REFSTRUCTLIT(mmc_nil))))));
  _pws2 = tmpMeta21;

  /* Pattern-matching assignment */
  tmpMeta27 = _pws2;
  if (listEmpty(tmpMeta27)) MMC_THROW_INTERNAL();
  tmpMeta28 = MMC_CAR(tmpMeta27);
  tmpMeta29 = MMC_CDR(tmpMeta27);
  _emap2 = tmpMeta28;
  _pws2 = tmpMeta29;

  {
    modelica_metatype _pw;
    for (tmpMeta30 = _pws2; !listEmpty(tmpMeta30); tmpMeta30=MMC_CDR(tmpMeta30))
    {
      _pw = MMC_CAR(tmpMeta30);
      _emap2 = omc_SBPWLinearMap_combine(threadData, _pw, _emap2);
    }
  }

  _res = omc_SBFunctions_connectedComponents(threadData, _vss, _emap1, _emap2);

  tmpMeta32 = stringAppend(omc_SBPWLinearMap_toString(threadData, _res),_OMC_LIT36);
  fputs(MMC_STRINGDATA(tmpMeta32),stdout);
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
void omc_SBFunctions_test2(threadData_t *threadData)
{
  modelica_metatype _vss = NULL;
  modelica_metatype _emap1 = NULL;
  modelica_metatype _emap2 = NULL;
  modelica_metatype _sets = NULL;
  modelica_metatype _pws1 = NULL;
  modelica_metatype _pws2 = NULL;
  modelica_metatype _res = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  modelica_metatype tmpMeta33;
  modelica_metatype tmpMeta34;
  modelica_metatype tmpMeta35;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _vss has no default value.
  // _emap1 has no default value.
  // _emap2 has no default value.
  // _sets has no default value.
  // _pws1 has no default value.
  // _pws2 has no default value.
  // _res has no default value.
  tmpMeta2 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta3 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 1001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta4 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1002), ((modelica_integer) 1), ((modelica_integer) 1002)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta5 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1003), ((modelica_integer) 1), ((modelica_integer) 1003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta6 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1004), ((modelica_integer) 1), ((modelica_integer) 2003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta7 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2004), ((modelica_integer) 1), ((modelica_integer) 3003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta8 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3004), ((modelica_integer) 1), ((modelica_integer) 4003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta1 = mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta2), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta3), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta4), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta5), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta6), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta7), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta8), MMC_REFSTRUCTLIT(mmc_nil))))))));
  _sets = tmpMeta1;

  _vss = omc_SBSet_newEmpty(threadData);

  {
    modelica_metatype _s;
    for (tmpMeta9 = _sets; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
    {
      _s = MMC_CAR(tmpMeta9);
      _vss = omc_SBSet_union(threadData, _vss, _s);
    }
  }

  tmpMeta12 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta13 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 2)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta14 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3), ((modelica_integer) 1), ((modelica_integer) 3)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta15 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 4), ((modelica_integer) 1), ((modelica_integer) 1002)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta16 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1003), ((modelica_integer) 1), ((modelica_integer) 2001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta17 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2002), ((modelica_integer) 1), ((modelica_integer) 3001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta11 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta12, _OMC_LIT4, _OMC_LIT1), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta13, _OMC_LIT4, _OMC_LIT38), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta14, _OMC_LIT4, _OMC_LIT40), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta15, _OMC_LIT1, _OMC_LIT42), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta16, _OMC_LIT1, _OMC_LIT44), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta17, _OMC_LIT1, _OMC_LIT38), MMC_REFSTRUCTLIT(mmc_nil)))))));
  _pws1 = tmpMeta11;

  /* Pattern-matching assignment */
  tmpMeta18 = _pws1;
  if (listEmpty(tmpMeta18)) MMC_THROW_INTERNAL();
  tmpMeta19 = MMC_CAR(tmpMeta18);
  tmpMeta20 = MMC_CDR(tmpMeta18);
  _emap1 = tmpMeta19;
  _pws1 = tmpMeta20;

  {
    modelica_metatype _pw;
    for (tmpMeta21 = _pws1; !listEmpty(tmpMeta21); tmpMeta21=MMC_CDR(tmpMeta21))
    {
      _pw = MMC_CAR(tmpMeta21);
      _emap1 = omc_SBPWLinearMap_combine(threadData, _pw, _emap1);
    }
  }

  tmpMeta24 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta25 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 2)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta26 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3), ((modelica_integer) 1), ((modelica_integer) 3)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta27 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 4), ((modelica_integer) 1), ((modelica_integer) 1002)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta28 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1003), ((modelica_integer) 1), ((modelica_integer) 2001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta29 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2002), ((modelica_integer) 1), ((modelica_integer) 3001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta23 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta24, _OMC_LIT4, _OMC_LIT44), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta25, _OMC_LIT4, _OMC_LIT46), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta26, _OMC_LIT4, _OMC_LIT46), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta27, _OMC_LIT1, _OMC_LIT48), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta28, _OMC_LIT1, _OMC_LIT1), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta29, _OMC_LIT1, _OMC_LIT44), MMC_REFSTRUCTLIT(mmc_nil)))))));
  _pws2 = tmpMeta23;

  /* Pattern-matching assignment */
  tmpMeta30 = _pws2;
  if (listEmpty(tmpMeta30)) MMC_THROW_INTERNAL();
  tmpMeta31 = MMC_CAR(tmpMeta30);
  tmpMeta32 = MMC_CDR(tmpMeta30);
  _emap2 = tmpMeta31;
  _pws2 = tmpMeta32;

  {
    modelica_metatype _pw;
    for (tmpMeta33 = _pws2; !listEmpty(tmpMeta33); tmpMeta33=MMC_CDR(tmpMeta33))
    {
      _pw = MMC_CAR(tmpMeta33);
      _emap2 = omc_SBPWLinearMap_combine(threadData, _pw, _emap2);
    }
  }

  _res = omc_SBFunctions_connectedComponents(threadData, _vss, _emap1, _emap2);

  tmpMeta35 = stringAppend(omc_SBPWLinearMap_toString(threadData, _res),_OMC_LIT36);
  fputs(MMC_STRINGDATA(tmpMeta35),stdout);
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
void omc_SBFunctions_test1(threadData_t *threadData)
{
  modelica_metatype _vss = NULL;
  modelica_metatype _emap1 = NULL;
  modelica_metatype _emap2 = NULL;
  modelica_metatype _sets = NULL;
  modelica_metatype _pws1 = NULL;
  modelica_metatype _pws2 = NULL;
  modelica_metatype _res = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  modelica_metatype tmpMeta33;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _vss has no default value.
  // _emap1 has no default value.
  // _emap2 has no default value.
  // _sets has no default value.
  // _pws1 has no default value.
  // _pws2 has no default value.
  // _res has no default value.
  tmpMeta2 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta3 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 1001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta4 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1002), ((modelica_integer) 1), ((modelica_integer) 1002)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta5 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1003), ((modelica_integer) 1), ((modelica_integer) 1003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta6 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1004), ((modelica_integer) 1), ((modelica_integer) 2003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta7 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2004), ((modelica_integer) 1), ((modelica_integer) 3003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta8 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3004), ((modelica_integer) 1), ((modelica_integer) 4003)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta1 = mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta2), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta3), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta4), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta5), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta6), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta7), mmc_mk_cons(omc_SBFunctions_make__set(threadData, tmpMeta8), MMC_REFSTRUCTLIT(mmc_nil))))))));
  _sets = tmpMeta1;

  _vss = omc_SBSet_newEmpty(threadData);

  {
    modelica_metatype _s;
    for (tmpMeta9 = _sets; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
    {
      _s = MMC_CAR(tmpMeta9);
      _vss = omc_SBSet_union(threadData, _vss, _s);
    }
  }

  tmpMeta12 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta13 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 2)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta14 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3), ((modelica_integer) 1), ((modelica_integer) 1001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta15 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1002), ((modelica_integer) 1), ((modelica_integer) 2001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta16 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2002), ((modelica_integer) 1), ((modelica_integer) 3001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta11 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta12, _OMC_LIT4, _OMC_LIT1), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta13, _OMC_LIT4, _OMC_LIT38), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta14, _OMC_LIT1, _OMC_LIT49), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta15, _OMC_LIT1, _OMC_LIT38), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta16, _OMC_LIT1, _OMC_LIT38), MMC_REFSTRUCTLIT(mmc_nil))))));
  _pws1 = tmpMeta11;

  /* Pattern-matching assignment */
  tmpMeta17 = _pws1;
  if (listEmpty(tmpMeta17)) MMC_THROW_INTERNAL();
  tmpMeta18 = MMC_CAR(tmpMeta17);
  tmpMeta19 = MMC_CDR(tmpMeta17);
  _emap1 = tmpMeta18;
  _pws1 = tmpMeta19;

  {
    modelica_metatype _pw;
    for (tmpMeta20 = _pws1; !listEmpty(tmpMeta20); tmpMeta20=MMC_CDR(tmpMeta20))
    {
      _pw = MMC_CAR(tmpMeta20);
      _emap1 = omc_SBPWLinearMap_combine(threadData, _pw, _emap1);
    }
  }

  tmpMeta23 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1), ((modelica_integer) 1), ((modelica_integer) 1)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta24 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2), ((modelica_integer) 1), ((modelica_integer) 2)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta25 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 3), ((modelica_integer) 1), ((modelica_integer) 1001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta26 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 1002), ((modelica_integer) 1), ((modelica_integer) 2001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta27 = mmc_mk_cons(omc_SBInterval_new(threadData, ((modelica_integer) 2002), ((modelica_integer) 1), ((modelica_integer) 3001)), MMC_REFSTRUCTLIT(mmc_nil));
  tmpMeta22 = mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta23, _OMC_LIT4, _OMC_LIT44), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta24, _OMC_LIT4, _OMC_LIT46), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta25, _OMC_LIT1, _OMC_LIT4), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta26, _OMC_LIT1, _OMC_LIT44), mmc_mk_cons(omc_SBFunctions_make__pw(threadData, tmpMeta27, _OMC_LIT4, _OMC_LIT46), MMC_REFSTRUCTLIT(mmc_nil))))));
  _pws2 = tmpMeta22;

  /* Pattern-matching assignment */
  tmpMeta28 = _pws2;
  if (listEmpty(tmpMeta28)) MMC_THROW_INTERNAL();
  tmpMeta29 = MMC_CAR(tmpMeta28);
  tmpMeta30 = MMC_CDR(tmpMeta28);
  _emap2 = tmpMeta29;
  _pws2 = tmpMeta30;

  {
    modelica_metatype _pw;
    for (tmpMeta31 = _pws2; !listEmpty(tmpMeta31); tmpMeta31=MMC_CDR(tmpMeta31))
    {
      _pw = MMC_CAR(tmpMeta31);
      _emap2 = omc_SBPWLinearMap_combine(threadData, _pw, _emap2);
    }
  }

  _res = omc_SBFunctions_connectedComponents(threadData, _vss, _emap1, _emap2);

  tmpMeta33 = stringAppend(omc_SBPWLinearMap_toString(threadData, _res),_OMC_LIT36);
  fputs(MMC_STRINGDATA(tmpMeta33),stdout);
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_SBFunctions_make__pw(threadData_t *threadData, modelica_metatype _i, modelica_metatype _gain, modelica_metatype _offset)
{
  modelica_metatype _pw = NULL;
  modelica_metatype _dom = NULL;
  modelica_metatype _lmap = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pw has no default value.
  // _dom has no default value.
  // _lmap has no default value.
  _dom = omc_SBFunctions_make__set(threadData, _i);

  _lmap = omc_SBLinearMap_new(threadData, listArray(_gain), listArray(_offset));

  _pw = omc_SBPWLinearMap_newScalar(threadData, _dom, _lmap);
  _return: OMC_LABEL_UNUSED
  return _pw;
}

DLLDirection
modelica_metatype omc_SBFunctions_make__set(threadData_t *threadData, modelica_metatype _i)
{
  modelica_metatype _s = NULL;
  modelica_metatype _ss = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _s has no default value.
  // _ss has no default value.
  _ss = omc_UnorderedSet_new(threadData, boxvar_SBAtomicSet_hash, boxvar_SBAtomicSet_isEqual, ((modelica_integer) 13));

  omc_UnorderedSet_add(threadData, omc_SBAtomicSet_new(threadData, omc_SBMultiInterval_fromList(threadData, _i)), _ss);

  _s = omc_SBSet_new(threadData, _ss);
  _return: OMC_LABEL_UNUSED
  return _s;
}

DLLDirection
void omc_SBFunctions_test(threadData_t *threadData)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  omc_SBFunctions_test1(threadData);

  omc_SBFunctions_test2(threadData);

  omc_SBFunctions_test3(threadData);
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_SBFunctions_connectedComponents(threadData_t *threadData, modelica_metatype _vss, modelica_metatype _emap1, modelica_metatype _emap2)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _ermap1 = NULL;
  modelica_metatype _ermap2 = NULL;
  modelica_metatype _rmap1 = NULL;
  modelica_metatype _rmap2 = NULL;
  modelica_metatype _new_res = NULL;
  modelica_metatype _last_im = NULL;
  modelica_metatype _new_im = NULL;
  modelica_metatype _diff_im = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _ermap1 has no default value.
  // _ermap2 has no default value.
  // _rmap1 has no default value.
  // _rmap2 has no default value.
  // _new_res has no default value.
  // _last_im has no default value.
  // _new_im has no default value.
  // _diff_im has no default value.
  _outMap = omc_SBPWLinearMap_newIdentity(threadData, _vss);

  _new_im = _vss;

  _diff_im = _vss;

  while(1)
  {
    if(!(!omc_SBSet_isEmpty(threadData, _diff_im))) break;
    _ermap1 = omc_SBPWLinearMap_compPW(threadData, _outMap, _emap1);

    _ermap2 = omc_SBPWLinearMap_compPW(threadData, _outMap, _emap2);

    _rmap1 = omc_SBFunctions_minAdjMap(threadData, _ermap1, _ermap2);

    _rmap2 = omc_SBFunctions_minAdjMap(threadData, _ermap2, _ermap1);

    _rmap1 = omc_SBPWLinearMap_combine(threadData, _rmap1, _outMap);

    _rmap2 = omc_SBPWLinearMap_combine(threadData, _rmap2, _outMap);

    _new_res = omc_SBFunctions_minMap(threadData, _rmap1, _rmap2);

    _last_im = _new_im;

    _new_im = omc_SBPWLinearMap_image(threadData, _new_res, _vss);

    _diff_im = omc_SBSet_complement(threadData, _last_im, _new_im);

    if((!omc_SBSet_isEmpty(threadData, _diff_im)))
    {
      _outMap = omc_SBFunctions_mapInf(threadData, _new_res);

      _new_im = omc_SBPWLinearMap_image(threadData, _outMap, _vss);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_minAdjMap(threadData_t *threadData, modelica_metatype _pw2, modelica_metatype _pw1)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _dom2 = NULL;
  modelica_metatype _lm2 = NULL;
  modelica_metatype _map1 = NULL;
  modelica_metatype _mapi = NULL;
  modelica_metatype _min_adj = NULL;
  modelica_metatype _min_m = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _dom2 has no default value.
  // _lm2 has no default value.
  // _map1 has no default value.
  // _mapi has no default value.
  // _min_adj has no default value.
  // _min_m has no default value.
  if(omc_SBPWLinearMap_isEmpty(threadData, _pw2))
  {
    _outMap = omc_SBPWLinearMap_newEmpty(threadData);

    goto _return;
  }

  _dom2 = omc_SBPWLinearMap_dom(threadData, _pw2);

  _lm2 = omc_SBPWLinearMap_lmap(threadData, _pw2);

  _map1 = omc_SBPWLinearMap_newScalar(threadData, arrayGet(_dom2,((modelica_integer) 1)) /* DAE.ASUB */, arrayGet(_lm2,((modelica_integer) 1)) /* DAE.ASUB */);

  _outMap = omc_SBFunctions_minAdjCompMap(threadData, _map1, _pw1);

  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = arrayLength(_dom2);
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      _mapi = omc_SBPWLinearMap_newScalar(threadData, arrayGet(_dom2,_i) /* DAE.ASUB */, arrayGet(_lm2,_i) /* DAE.ASUB */);

      _min_adj = omc_SBFunctions_minAdjCompMap(threadData, _mapi, _pw1);

      _min_m = omc_SBFunctions_minMap(threadData, _outMap, _min_adj);

      _outMap = omc_SBPWLinearMap_combine(threadData, _min_adj, _outMap);

      if((!omc_SBPWLinearMap_isEmpty(threadData, _min_m)))
      {
        _outMap = omc_SBPWLinearMap_combine(threadData, _min_m, _outMap);
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_minAdjCompMap(threadData_t *threadData, modelica_metatype _pw2, modelica_metatype _pw1)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _dom = NULL;
  modelica_metatype _lmap = NULL;
  modelica_metatype _d = NULL;
  modelica_metatype _dom_inv = NULL;
  modelica_metatype _aux = NULL;
  modelica_metatype _lm_inv = NULL;
  modelica_metatype _aux_lm1 = NULL;
  modelica_metatype _aux_lm2 = NULL;
  modelica_metatype _lm_res = NULL;
  modelica_metatype _inv_pw = NULL;
  modelica_metatype _aux_inv = NULL;
  modelica_metatype _aux_res = NULL;
  modelica_real _min_g;
  modelica_real _max_g;
  modelica_real _inf;
  modelica_real _g;
  modelica_metatype _min_aux = NULL;
  modelica_metatype _resg = NULL;
  modelica_metatype _reso = NULL;
  modelica_metatype _gain = NULL;
  modelica_metatype _off = NULL;
  modelica_metatype _gres = NULL;
  modelica_metatype _oi = NULL;
  modelica_metatype _ginv = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _dom has no default value.
  // _lmap has no default value.
  // _d has no default value.
  // _dom_inv has no default value.
  // _aux has no default value.
  // _lm_inv has no default value.
  // _aux_lm1 has no default value.
  // _aux_lm2 has no default value.
  // _lm_res has no default value.
  // _inv_pw has no default value.
  // _aux_inv has no default value.
  // _aux_res has no default value.
  // _min_g has no default value.
  // _max_g has no default value.
  // _inf has no default value.
  // _g has no default value.
  // _min_aux has no default value.
  // _resg has no default value.
  // _reso has no default value.
  // _gain has no default value.
  // _off has no default value.
  // _gres has no default value.
  // _oi has no default value.
  // _ginv has no default value.
  _dom = omc_SBPWLinearMap_dom(threadData, _pw2);

  _lmap = omc_SBPWLinearMap_lmap(threadData, _pw2);

  if((arrayLength(_dom) != ((modelica_integer) 1)))
  {
    _outMap = omc_SBPWLinearMap_newEmpty(threadData);

    goto _return;
  }

  _d = arrayGet(_dom,((modelica_integer) 1)) /* DAE.ASUB */;

  _dom_inv = omc_SBPWLinearMap_image(threadData, _pw2, _d);

  _lm_inv = omc_SBLinearMap_inverse(threadData, arrayGet(_lmap,((modelica_integer) 1)) /* DAE.ASUB */);

  _inv_pw = omc_SBPWLinearMap_newScalar(threadData, _dom_inv, _lm_inv);

  _inf = ((modelica_real)intMaxLit());

  if((mmc_unbox_real(omc_Array_maxElement(threadData, omc_SBLinearMap_gain(threadData, _lm_inv), boxvar_realLt)) < _inf))
  {
    _outMap = omc_SBPWLinearMap_compPW(threadData, _pw1, _inv_pw);
  }
  else
  {
    if((mmc_unbox_real(omc_Array_minElement(threadData, omc_SBLinearMap_gain(threadData, _lm_inv), boxvar_realLt)) == _inf))
    {
      if((!omc_SBPWLinearMap_isEmpty(threadData, _pw2)))
      {
        _aux = omc_SBPWLinearMap_image(threadData, _pw1, _d);

        _min_aux = omc_SBSet_minElem(threadData, _aux);

        _resg = arrayCreate(arrayLength(_min_aux), _OMC_LIT3);

        _reso = omc_Array_map(threadData, _min_aux, boxvar_intReal);

        _lm_res = omc_SBLinearMap_new(threadData, _resg, _reso);

        _outMap = omc_SBPWLinearMap_newScalar(threadData, _dom_inv, _lm_res);
      }
      else
      {
        _outMap = omc_SBPWLinearMap_newEmpty(threadData);
      }
    }
    else
    {
      _min_aux = omc_SBSet_minElem(threadData, _d);

      _gain = omc_SBLinearMap_gain(threadData, _lm_inv);

      _off = omc_SBLinearMap_offset(threadData, _lm_inv);

      _resg = arrayCreateNoInit(arrayLength(_gain), _OMC_LIT3);

      _reso = arrayCreateNoInit(arrayLength(_gain), _OMC_LIT3);

      tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = arrayLength(_gain);
      if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
      {
        modelica_integer _i;
        for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
        {
          _g = mmc_unbox_real(arrayGetNoBoundsChecking(_gain, _i));

          if((_g == _inf))
          {
            arrayUpdate(_resg,_i,_OMC_LIT3);

            arrayUpdate(_reso,_i,mmc_mk_real(((modelica_real)mmc_unbox_integer(arrayGet(_min_aux,_i) /* DAE.ASUB */))));
          }
          else
          {
            arrayUpdate(_resg,_i,mmc_mk_real(_g));

            arrayUpdate(_reso,_i,arrayGet(_off,_i) /* DAE.ASUB */);
          }
        }
      }

      _aux_lm1 = omc_SBLinearMap_new(threadData, _resg, _reso);

      _aux_inv = omc_SBPWLinearMap_newScalar(threadData, _dom_inv, _aux_lm1);

      _aux_res = omc_SBPWLinearMap_compPW(threadData, _pw1, _aux_inv);

      if(omc_SBPWLinearMap_isEmpty(threadData, _aux_res))
      {
        _outMap = omc_SBPWLinearMap_newEmpty(threadData);
      }
      else
      {
        _aux = omc_SBPWLinearMap_image(threadData, _pw1, _d);

        _min_aux = omc_SBSet_minElem(threadData, _aux);

        _lm_res = arrayGet(omc_SBPWLinearMap_lmap(threadData, _aux_res), ((modelica_integer) 1));

        _gres = omc_SBLinearMap_gain(threadData, _lm_res);

        _oi = omc_SBLinearMap_offset(threadData, _lm_res);

        _ginv = omc_SBLinearMap_gain(threadData, _lm_inv);

        tmp4 = ((modelica_integer) 1); tmp5 = 1; tmp6 = arrayLength(_gain);
        if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
        {
          modelica_integer _i;
          for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp4, tmp6); _i += tmp5)
          {
            _g = mmc_unbox_real(arrayGetNoBoundsChecking(_gain, _i));

            if((_g == _inf))
            {
              arrayUpdate(_resg,_i,_OMC_LIT3);

              arrayUpdate(_reso,_i,mmc_mk_real(((modelica_real)mmc_unbox_integer(arrayGet(_min_aux,_i) /* DAE.ASUB */))));
            }
            else
            {
              arrayUpdate(_resg,_i,arrayGet(_gres,_i) /* DAE.ASUB */);

              arrayUpdate(_reso,_i,arrayGet(_oi,_i) /* DAE.ASUB */);
            }
          }
        }

        _aux_lm2 = omc_SBLinearMap_new(threadData, _resg, _reso);

        _outMap = omc_SBPWLinearMap_newScalar(threadData, arrayGet(omc_SBPWLinearMap_dom(threadData, _aux_res), ((modelica_integer) 1)), _aux_lm2);
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

PROTECTED_FUNCTION_STATIC modelica_real omc_SBFunctions_mapInf_max__inter(threadData_t *threadData, modelica_metatype _aset, modelica_real _offset, modelica_integer _dim, modelica_real __omcQ_24in_5Fits)
{
  modelica_real _its;
  modelica_metatype _is = NULL;
  modelica_metatype _i = NULL;
  modelica_real _hi;
  modelica_real _lo;
  modelica_real tmp1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _its = __omcQ_24in_5Fits;
  // _is has no default value.
  // _i has no default value.
  // _hi has no default value.
  // _lo has no default value.
  _is = omc_SBMultiInterval_intervals(threadData, omc_SBAtomicSet_aset(threadData, _aset));

  _i = arrayGet(_is,_dim) /* DAE.ASUB */;

  _hi = ((modelica_real)omc_SBInterval_upperBound(threadData, _i));

  _lo = ((modelica_real)omc_SBInterval_lowerBound(threadData, _i));

  tmp1 = fabs(_offset);
  if (tmp1 == 0) {MMC_THROW_INTERNAL();}
  _its = fmax(_its,ceil((_hi - _lo) / tmp1));
  _return: OMC_LABEL_UNUSED
  return _its;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_SBFunctions_mapInf_max__inter(threadData_t *threadData, modelica_metatype _aset, modelica_metatype _offset, modelica_metatype _dim, modelica_metatype __omcQ_24in_5Fits)
{
  modelica_real tmp1;
  modelica_integer tmp2;
  modelica_real tmp3;
  modelica_real _its;
  modelica_metatype out_its;
  tmp1 = mmc_unbox_real(_offset);
  tmp2 = mmc_unbox_integer(_dim);
  tmp3 = mmc_unbox_real(__omcQ_24in_5Fits);
  _its = omc_SBFunctions_mapInf_max__inter(threadData, _aset, tmp1, tmp2, tmp3);
  out_its = mmc_mk_rcon(_its);
  return out_its;
}

static modelica_metatype closure0_SBFunctions_mapInf_max__inter(threadData_t *thData, modelica_metatype closure, modelica_metatype aset, modelica_metatype $in_its)
{
  modelica_metatype offset = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype dim = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  return boxptr_SBFunctions_mapInf_max__inter(thData, aset, offset, dim, $in_its);
}
DLLDirection
modelica_metatype omc_SBFunctions_mapInf(threadData_t *threadData, modelica_metatype _pw)
{
  modelica_metatype _outMap = NULL;
  modelica_integer _max_it;
  modelica_metatype _dom = NULL;
  modelica_metatype _lmap = NULL;
  modelica_metatype _d = NULL;
  modelica_metatype _lm = NULL;
  modelica_metatype _gain = NULL;
  modelica_metatype _off = NULL;
  modelica_real _a;
  modelica_real _b;
  modelica_real _its;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_metatype tmpMeta7;
  modelica_integer tmp8;
  modelica_integer tmp9;
  modelica_integer tmp10;
  modelica_integer tmp11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  modelica_integer tmp14;
  modelica_integer tmp15;
  modelica_integer tmp16;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _max_it has no default value.
  // _dom has no default value.
  // _lmap has no default value.
  // _d has no default value.
  // _lm has no default value.
  // _gain has no default value.
  // _off has no default value.
  // _a has no default value.
  // _b has no default value.
  // _its has no default value.
  if(omc_SBPWLinearMap_isEmpty(threadData, _pw))
  {
    _outMap = omc_SBPWLinearMap_newEmpty(threadData);

    goto _return;
  }

  _outMap = omc_SBFunctions_reduceMapN(threadData, _pw, ((modelica_integer) 1));

  tmp1 = ((modelica_integer) 2); tmp2 = 1; tmp3 = omc_SBPWLinearMap_ndim(threadData, _outMap);
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 2); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      _outMap = omc_SBFunctions_reduceMapN(threadData, _pw, _i);
    }
  }

  _max_it = ((modelica_integer) 0);

  _dom = omc_SBPWLinearMap_dom(threadData, _outMap);

  _lmap = omc_SBPWLinearMap_lmap(threadData, _outMap);

  tmp11 = ((modelica_integer) 1); tmp12 = 1; tmp13 = arrayLength(_dom);
  if(!(((tmp12 > 0) && (tmp11 > tmp13)) || ((tmp12 < 0) && (tmp11 < tmp13))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp11, tmp13); _i += tmp12)
    {
      _d = arrayGet(_dom,_i) /* DAE.ASUB */;

      _lm = arrayGet(_lmap,_i) /* DAE.ASUB */;

      _gain = omc_SBLinearMap_gain(threadData, _lm);

      _off = omc_SBLinearMap_offset(threadData, _lm);

      _a = 0.0;

      _b = mmc_unbox_real(arrayGet(_gain,((modelica_integer) 1)) /* DAE.ASUB */);

      tmp4 = ((modelica_integer) 1); tmp5 = 1; tmp6 = arrayLength(_gain);
      if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp4, tmp6); _j += tmp5)
        {
          _a = fmax(_a,(mmc_unbox_real(arrayGet(_gain,_j) /* DAE.ASUB */)) * (fabs(mmc_unbox_real(arrayGet(_off,_j) /* DAE.ASUB */))));

          _b = fmin(_b,mmc_unbox_real(arrayGet(_gain,_j) /* DAE.ASUB */));
        }
      }

      if((_a > 0.0))
      {
        _its = 0.0;

        tmp8 = ((modelica_integer) 1); tmp9 = 1; tmp10 = omc_SBPWLinearMap_ndim(threadData, _outMap);
        if(!(((tmp9 > 0) && (tmp8 > tmp10)) || ((tmp9 < 0) && (tmp8 < tmp10))))
        {
          modelica_integer _dim;
          for(_dim = ((modelica_integer) 1); in_range_integer(_dim, tmp8, tmp10); _dim += tmp9)
          {
            if(((mmc_unbox_real(arrayGet(_gain,_dim) /* DAE.ASUB */) == 1.0) && (mmc_unbox_real(arrayGet(_off,_dim) /* DAE.ASUB */) < 0.0)))
            {
              tmpMeta7 = mmc_mk_box2(0, arrayGet(_off,_dim) /* DAE.ASUB */, mmc_mk_integer(_dim));
              _its = mmc_unbox_real(omc_UnorderedSet_fold(threadData, omc_SBSet_asets(threadData, _d), (modelica_fnptr) mmc_mk_box2(0,closure0_SBFunctions_mapInf_max__inter,tmpMeta7), mmc_mk_real(_its)));
            }
          }
        }

        _max_it = _max_it + ((modelica_integer)floor(_its));
      }
      else
      {
        if((_b == 0.0))
        {
          _max_it = ((modelica_integer) 1) + _max_it;
        }
      }
    }
  }

  tmp14 = ((modelica_integer) 1); tmp15 = 1; tmp16 = omc_Util_msb(threadData, _max_it);
  if(!(((tmp15 > 0) && (tmp14 > tmp16)) || ((tmp15 < 0) && (tmp14 < tmp16))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp14, tmp16); _i += tmp15)
    {
      _outMap = omc_SBPWLinearMap_compPW(threadData, _outMap, _outMap);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_reduceMapN(threadData_t *threadData, modelica_metatype _pw, modelica_integer _dim)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _dom = NULL;
  modelica_metatype _new_s = NULL;
  modelica_metatype _sres = NULL;
  modelica_metatype _lmap = NULL;
  modelica_metatype _new_l = NULL;
  modelica_metatype _lres = NULL;
  modelica_metatype _pw_copy = NULL;
  modelica_metatype _new_map = NULL;
  modelica_metatype _di = NULL;
  modelica_metatype _new_domi = NULL;
  modelica_metatype _li = NULL;
  modelica_metatype _new_lm = NULL;
  modelica_real _gdim;
  modelica_real _odim;
  modelica_integer _off;
  modelica_metatype _mi = NULL;
  modelica_metatype _idim = NULL;
  modelica_metatype _new_inter = NULL;
  modelica_integer _loint;
  modelica_integer _hiint;
  modelica_metatype _resg = NULL;
  modelica_metatype _reso = NULL;
  modelica_metatype _aux_as = NULL;
  modelica_metatype _aux_newd = NULL;
  modelica_metatype _asets = NULL;
  modelica_metatype tmpMeta1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_integer tmp7;
  modelica_integer tmp8;
  modelica_metatype tmpMeta9;
  modelica_integer tmp10;
  modelica_integer tmp11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  modelica_integer tmp14;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _dom has no default value.
  // _new_s has no default value.
  // _sres has no default value.
  // _lmap has no default value.
  // _new_l has no default value.
  // _lres has no default value.
  // _pw_copy has no default value.
  // _new_map has no default value.
  // _di has no default value.
  // _new_domi has no default value.
  // _li has no default value.
  // _new_lm has no default value.
  // _gdim has no default value.
  // _odim has no default value.
  // _off has no default value.
  // _mi has no default value.
  // _idim has no default value.
  // _new_inter has no default value.
  // _loint has no default value.
  // _hiint has no default value.
  // _resg has no default value.
  // _reso has no default value.
  // _aux_as has no default value.
  // _aux_newd has no default value.
  // _asets has no default value.
  _dom = omc_SBPWLinearMap_dom(threadData, _pw);

  _lmap = omc_SBPWLinearMap_lmap(threadData, _pw);

  _pw_copy = omc_SBPWLinearMap_copy(threadData, _pw);

  _sres = omc_Vector_fromArray(threadData, omc_SBPWLinearMap_dom(threadData, _pw_copy));

  _lres = omc_Vector_fromArray(threadData, omc_SBPWLinearMap_lmap(threadData, _pw_copy));

  tmp12 = ((modelica_integer) 1); tmp13 = 1; tmp14 = arrayLength(_dom);
  if(!(((tmp13 > 0) && (tmp12 > tmp14)) || ((tmp13 < 0) && (tmp12 < tmp14))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp12, tmp14); _i += tmp13)
    {
      _di = arrayGet(_dom,_i) /* DAE.ASUB */;

      _li = arrayGet(_lmap,_i) /* DAE.ASUB */;

      _gdim = mmc_unbox_real(arrayGet(omc_SBLinearMap_gain(threadData, _li), _dim));

      _odim = mmc_unbox_real(arrayGet(omc_SBLinearMap_offset(threadData, _li), _dim));

      if(((_gdim == 1.0) && (_odim < 0.0)))
      {
        _off = ((modelica_integer)floor((-_odim)));

        _asets = omc_UnorderedSet_toArray(threadData, omc_SBSet_asets(threadData, _di));

        {
          modelica_metatype _adom;
          for (tmpMeta1 = _asets, tmp11 = arrayLength(tmpMeta1), tmp10 = 1; tmp10 <= tmp11; tmp10++)
          {
            _adom = arrayGet(tmpMeta1,tmp10);
            _mi = omc_SBAtomicSet_aset(threadData, _adom);

            _idim = arrayGet(omc_SBMultiInterval_intervals(threadData, _mi), _dim);

            _loint = omc_SBInterval_lowerBound(threadData, _idim);

            _hiint = omc_SBInterval_upperBound(threadData, _idim);

            if((_hiint - _loint > (_off) * (_off)))
            {
              _new_s = arrayCreateNoInit(_off, _di);

              _new_l = arrayCreateNoInit(_off, _li);

              tmp2 = ((modelica_integer) 1); tmp3 = 1; tmp4 = _off;
              if(!(((tmp3 > 0) && (tmp2 > tmp4)) || ((tmp3 < 0) && (tmp2 < tmp4))))
              {
                modelica_integer _k;
                for(_k = ((modelica_integer) 1); in_range_integer(_k, tmp2, tmp4); _k += tmp3)
                {
                  _resg = arrayCopy(omc_SBLinearMap_gain(threadData, _li));

                  _reso = arrayCopy(omc_SBLinearMap_offset(threadData, _li));

                  arrayUpdate(_resg,_dim,_OMC_LIT3);

                  arrayUpdate(_reso,_dim,mmc_mk_real(((modelica_real)((modelica_integer) -1) + _loint + _k - _off)));

                  arrayUpdate(_new_l,_k,omc_SBLinearMap_new(threadData, _resg, _reso));

                  _new_inter = omc_SBInterval_new(threadData, ((modelica_integer) -1) + _loint + _k, _off, _hiint);

                  _aux_as = omc_SBAtomicSet_replace(threadData, _new_inter, _dim, _adom);

                  arrayUpdate(_new_s,_k,omc_SBSet_addAtomicSet(threadData, _aux_as, omc_SBSet_newEmpty(threadData)));
                }
              }

              _new_map = omc_SBPWLinearMap_new(threadData, _new_s, _new_l);

              _aux_newd = omc_UnorderedSet_new(threadData, boxvar_SBAtomicSet_hash, boxvar_SBAtomicSet_isEqual, ((modelica_integer) 13));

              {
                modelica_metatype _aux_asi;
                for (tmpMeta5 = _asets, tmp8 = arrayLength(tmpMeta5), tmp7 = 1; tmp7 <= tmp8; tmp7++)
                {
                  _aux_asi = arrayGet(tmpMeta5,tmp7);
                  if((!omc_SBAtomicSet_isEqual(threadData, _aux_asi, _adom)))
                  {
                    omc_UnorderedSet_add(threadData, _aux_asi, _aux_newd);
                  }
                }
              }

              _new_domi = omc_SBSet_new(threadData, _aux_newd);

              if(omc_SBSet_isEmpty(threadData, _new_domi))
              {
                if((_i < omc_Vector_size(threadData, _sres)))
                {
                  omc_Vector_remove(threadData, _sres, _i);

                  omc_Vector_remove(threadData, _lres, _i);
                }
                else
                {
                  omc_Vector_shrink(threadData, _sres, ((modelica_integer) 1) + _i);

                  omc_Vector_shrink(threadData, _lres, ((modelica_integer) 1) + _i);
                }
              }
              else
              {
                omc_Vector_update(threadData, _sres, _i, _new_domi);
              }

              omc_Vector_appendArray(threadData, _sres, omc_SBPWLinearMap_dom(threadData, _new_map));

              omc_Vector_appendArray(threadData, _lres, omc_SBPWLinearMap_lmap(threadData, _new_map));
            }
          }
        }
      }
    }
  }

  _outMap = omc_SBPWLinearMap_new(threadData, omc_Vector_toArray(threadData, _sres), omc_Vector_toArray(threadData, _lres));
  _return: OMC_LABEL_UNUSED
  return _outMap;
}
modelica_metatype boxptr_SBFunctions_reduceMapN(threadData_t *threadData, modelica_metatype _pw, modelica_metatype _dim)
{
  modelica_integer tmp1;
  modelica_metatype _outMap = NULL;
  tmp1 = mmc_unbox_integer(_dim);
  _outMap = omc_SBFunctions_reduceMapN(threadData, _pw, tmp1);
  /* skip box _outMap; SBPWLinearMap */
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_minMap(threadData_t *threadData, modelica_metatype _pw1, modelica_metatype _pw2)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _d1 = NULL;
  modelica_metatype _d2 = NULL;
  modelica_metatype _lm1 = NULL;
  modelica_metatype _lm2 = NULL;
  modelica_metatype _d1i = NULL;
  modelica_metatype _dom = NULL;
  modelica_metatype _lm1i = NULL;
  modelica_metatype _aux = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _outMap = omc_SBPWLinearMap_newEmpty(threadData);
  // _d1 has no default value.
  // _d2 has no default value.
  // _lm1 has no default value.
  // _lm2 has no default value.
  // _d1i has no default value.
  // _dom has no default value.
  // _lm1i has no default value.
  // _aux has no default value.
  if((omc_SBPWLinearMap_isEmpty(threadData, _pw1) || omc_SBPWLinearMap_isEmpty(threadData, _pw2)))
  {
    goto _return;
  }

  _d1 = omc_SBPWLinearMap_dom(threadData, _pw1);

  _lm1 = omc_SBPWLinearMap_lmap(threadData, _pw1);

  _d2 = omc_SBPWLinearMap_dom(threadData, _pw2);

  _lm2 = omc_SBPWLinearMap_lmap(threadData, _pw2);

  tmp4 = ((modelica_integer) 1); tmp5 = 1; tmp6 = arrayLength(_d1);
  if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp4, tmp6); _i += tmp5)
    {
      _d1i = arrayGet(_d1,_i) /* DAE.ASUB */;

      _lm1i = arrayGet(_lm1,_i) /* DAE.ASUB */;

      tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = arrayLength(_d2);
      if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp1, tmp3); _j += tmp2)
        {
          _dom = omc_SBSet_intersection(threadData, _d1i, arrayGet(_d2,_j) /* DAE.ASUB */);

          if((!omc_SBSet_isEmpty(threadData, _dom)))
          {
            _aux = omc_SBFunctions_minPW(threadData, _dom, _lm1i, arrayGet(_lm2,_j) /* DAE.ASUB */);

            _outMap = (omc_SBPWLinearMap_isEmpty(threadData, _outMap)?_aux:omc_SBPWLinearMap_combine(threadData, _aux, _outMap));
          }
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_minPW(threadData_t *threadData, modelica_metatype _dom, modelica_metatype _lm1, modelica_metatype _lm2)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _aux_dom = NULL;
  modelica_metatype _aux_lm = NULL;
  modelica_metatype _sres1 = NULL;
  modelica_metatype _sres2 = NULL;
  modelica_metatype _d = NULL;
  modelica_metatype _lres1 = NULL;
  modelica_metatype _lres2 = NULL;
  modelica_metatype _l = NULL;
  modelica_metatype _asets = NULL;
  modelica_metatype _aux = NULL;
  modelica_metatype _as_aux = NULL;
  modelica_metatype _sres = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _lres = NULL;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  modelica_integer tmp8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _aux_dom has no default value.
  // _aux_lm has no default value.
  // _sres1 has no default value.
  // _sres2 has no default value.
  // _d has no default value.
  // _lres1 has no default value.
  // _lres2 has no default value.
  // _l has no default value.
  // _asets has no default value.
  // _aux has no default value.
  // _as_aux has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _sres = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _lres = tmpMeta2;
  _sres1 = omc_SBSet_newEmpty(threadData);

  _lres1 = omc_SBLinearMap_newEmpty(threadData);

  _sres2 = omc_SBSet_newEmpty(threadData);

  _lres2 = omc_SBLinearMap_newEmpty(threadData);

  if((!omc_SBSet_isEmpty(threadData, _dom)))
  {
    _asets = omc_UnorderedSet_toArray(threadData, omc_SBSet_asets(threadData, _dom));

    _as_aux = arrayGet(_asets,((modelica_integer) 1)) /* DAE.ASUB */;

    _aux = omc_SBFunctions_minAtomPW(threadData, _as_aux, _lm1, _lm2);

    if((!omc_SBPWLinearMap_isEmpty(threadData, _aux)))
    {
      _sres1 = arrayGet(omc_SBPWLinearMap_dom(threadData, _aux), ((modelica_integer) 1));

      _lres1 = arrayGet(omc_SBPWLinearMap_lmap(threadData, _aux), ((modelica_integer) 1));

      tmp6 = ((modelica_integer) 2); tmp7 = 1; tmp8 = arrayLength(_asets);
      if(!(((tmp7 > 0) && (tmp6 > tmp8)) || ((tmp7 < 0) && (tmp6 < tmp8))))
      {
        modelica_integer _i;
        for(_i = ((modelica_integer) 2); in_range_integer(_i, tmp6, tmp8); _i += tmp7)
        {
          _aux = omc_SBFunctions_minAtomPW(threadData, arrayGet(_asets,_i) /* DAE.ASUB */, _lm1, _lm2);

          _aux_dom = omc_SBPWLinearMap_dom(threadData, _aux);

          _aux_lm = omc_SBPWLinearMap_lmap(threadData, _aux);

          tmp3 = ((modelica_integer) 1); tmp4 = 1; tmp5 = arrayLength(_aux_dom);
          if(!(((tmp4 > 0) && (tmp3 > tmp5)) || ((tmp4 < 0) && (tmp3 < tmp5))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp3, tmp5); _i += tmp4)
            {
              _d = arrayGet(_aux_dom,_i) /* DAE.ASUB */;

              _l = arrayGet(_aux_lm,_i) /* DAE.ASUB */;

              if(omc_SBLinearMap_isEqual(threadData, _l, _lres1))
              {
                _sres1 = omc_SBSet_union(threadData, _sres1, _d);
              }
              else
              {
                if(omc_SBSet_isEmpty(threadData, _sres2))
                {
                  _sres2 = omc_SBSet_copy(threadData, _d);

                  _lres2 = omc_SBLinearMap_copy(threadData, _l);
                }
                else
                {
                  _sres2 = omc_SBSet_union(threadData, _sres2, _d);
                }
              }
            }
          }
        }
      }
    }
  }

  if(((!omc_SBSet_isEmpty(threadData, _sres2)) && (!omc_SBLinearMap_isEmpty(threadData, _lres2))))
  {
    tmpMeta9 = mmc_mk_cons(_sres2, _sres);
    _sres = tmpMeta9;

    tmpMeta10 = mmc_mk_cons(_lres2, _lres);
    _lres = tmpMeta10;
  }

  if(((!omc_SBSet_isEmpty(threadData, _sres1)) && (!omc_SBLinearMap_isEmpty(threadData, _lres1))))
  {
    tmpMeta11 = mmc_mk_cons(_sres1, _sres);
    _sres = tmpMeta11;

    tmpMeta12 = mmc_mk_cons(_lres1, _lres);
    _lres = tmpMeta12;
  }

  _outMap = omc_SBPWLinearMap_new(threadData, listArray(_sres), listArray(_lres));
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_SBFunctions_minAtomPW_make__result(threadData_t *threadData, modelica_metatype _aset, modelica_metatype _map)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _set = NULL;
  modelica_metatype _dom = NULL;
  modelica_metatype _lm = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _set has no default value.
  // _dom has no default value.
  // _lm has no default value.
  _dom = arrayCreate(((modelica_integer) 1), omc_SBSet_addAtomicSet(threadData, _aset, omc_SBSet_newEmpty(threadData)));

  _lm = arrayCreate(((modelica_integer) 1), _map);

  _outMap = omc_SBPWLinearMap_new(threadData, _dom, _lm);
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

DLLDirection
modelica_metatype omc_SBFunctions_minAtomPW(threadData_t *threadData, modelica_metatype _dom, modelica_metatype _lm1, modelica_metatype _lm2)
{
  modelica_metatype _outMap = NULL;
  modelica_metatype _g1 = NULL;
  modelica_metatype _g2 = NULL;
  modelica_metatype _resg = NULL;
  modelica_metatype _o1 = NULL;
  modelica_metatype _o2 = NULL;
  modelica_metatype _reso = NULL;
  modelica_metatype _ints = NULL;
  modelica_metatype _as_aux = NULL;
  modelica_metatype _lm_aux = NULL;
  modelica_metatype _dom_res = NULL;
  modelica_metatype _lm_res = NULL;
  modelica_metatype _s_aux = NULL;
  modelica_metatype _d1 = NULL;
  modelica_metatype _d2 = NULL;
  modelica_real _g1i;
  modelica_real _g2i;
  modelica_real _o1i;
  modelica_real _o2i;
  modelica_real _xinter;
  modelica_metatype _inti = NULL;
  modelica_metatype _i1 = NULL;
  modelica_metatype _i2 = NULL;
  modelica_real tmp1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outMap has no default value.
  // _g1 has no default value.
  // _g2 has no default value.
  // _resg has no default value.
  // _o1 has no default value.
  // _o2 has no default value.
  // _reso has no default value.
  // _ints has no default value.
  // _as_aux has no default value.
  // _lm_aux has no default value.
  // _dom_res has no default value.
  // _lm_res has no default value.
  // _s_aux has no default value.
  // _d1 has no default value.
  // _d2 has no default value.
  // _g1i has no default value.
  // _g2i has no default value.
  // _o1i has no default value.
  // _o2i has no default value.
  // _xinter has no default value.
  // _inti has no default value.
  // _i1 has no default value.
  // _i2 has no default value.
  _g1 = omc_SBLinearMap_gain(threadData, _lm1);

  _o1 = omc_SBLinearMap_offset(threadData, _lm1);

  _g2 = omc_SBLinearMap_gain(threadData, _lm2);

  _o2 = omc_SBLinearMap_offset(threadData, _lm2);

  _ints = omc_SBMultiInterval_intervals(threadData, omc_SBAtomicSet_aset(threadData, _dom));

  _as_aux = omc_SBAtomicSet_copy(threadData, _dom);

  _lm_aux = omc_SBLinearMap_copy(threadData, _lm1);

  _resg = arrayCopy(_g1);

  _reso = arrayCopy(_o1);

  tmp5 = ((modelica_integer) 1); tmp6 = 1; tmp7 = arrayLength(_g1);
  if(!(((tmp6 > 0) && (tmp5 > tmp7)) || ((tmp6 < 0) && (tmp5 < tmp7))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp5, tmp7); _i += tmp6)
    {
      _g1i = mmc_unbox_real(arrayGet(_g1,_i) /* DAE.ASUB */);

      _g2i = mmc_unbox_real(arrayGet(_g2,_i) /* DAE.ASUB */);

      _o1i = mmc_unbox_real(arrayGet(_o1,_i) /* DAE.ASUB */);

      _o2i = mmc_unbox_real(arrayGet(_o2,_i) /* DAE.ASUB */);

      _inti = arrayGet(_ints,_i) /* DAE.ASUB */;

      if((_g1i != _g2i))
      {
        tmp1 = _g1i - _g2i;
        if (tmp1 == 0) {MMC_THROW_INTERNAL();}
        _xinter = (_o2i - _o1i) / tmp1;

        if((_xinter <= ((modelica_real)omc_SBInterval_lowerBound(threadData, _inti))))
        {
          if((_g2i < _g1i))
          {
            _lm_aux = omc_SBLinearMap_copy(threadData, _lm2);
          }

          _outMap = omc_SBFunctions_minAtomPW_make__result(threadData, _as_aux, _lm_aux);
        }
        else
        {
          if((_xinter >= ((modelica_real)omc_SBInterval_upperBound(threadData, _inti))))
          {
            if((_g2i > _g1i))
            {
              _lm_aux = omc_SBLinearMap_copy(threadData, _lm2);
            }

            _outMap = omc_SBFunctions_minAtomPW_make__result(threadData, _as_aux, _lm_aux);
          }
          else
          {
            _i1 = omc_SBInterval_new(threadData, omc_SBInterval_lowerBound(threadData, _inti), omc_SBInterval_stepValue(threadData, _inti), ((modelica_integer)floor(floor(_xinter))));

            _i2 = omc_SBInterval_new(threadData, omc_SBInterval_upperBound(threadData, _i1) + omc_SBInterval_stepValue(threadData, _i1), omc_SBInterval_stepValue(threadData, _inti), omc_SBInterval_upperBound(threadData, _inti));

            _d1 = omc_SBSet_addAtomicSet(threadData, omc_SBAtomicSet_replace(threadData, _i1, _i, _as_aux), omc_SBSet_newEmpty(threadData));

            _d2 = omc_SBSet_addAtomicSet(threadData, omc_SBAtomicSet_replace(threadData, _i2, _i, _as_aux), omc_SBSet_newEmpty(threadData));

            tmpMeta2 = mmc_mk_cons(_d1, mmc_mk_cons(_d2, MMC_REFSTRUCTLIT(mmc_nil)));
            _dom_res = listArray(tmpMeta2);

            if((_g1i > _g2i))
            {
              tmpMeta3 = mmc_mk_cons(omc_SBLinearMap_copy(threadData, _lm1), mmc_mk_cons(omc_SBLinearMap_copy(threadData, _lm2), MMC_REFSTRUCTLIT(mmc_nil)));
              _lm_res = listArray(tmpMeta3);
            }
            else
            {
              tmpMeta4 = mmc_mk_cons(omc_SBLinearMap_copy(threadData, _lm2), mmc_mk_cons(omc_SBLinearMap_copy(threadData, _lm1), MMC_REFSTRUCTLIT(mmc_nil)));
              _lm_res = listArray(tmpMeta4);
            }

            _outMap = omc_SBPWLinearMap_new(threadData, _dom_res, _lm_res);
          }
        }

        goto _return;
      }
      else
      {
        if((_o1i != _o2i))
        {
          if((_o2i < _o1i))
          {
            _lm_aux = omc_SBLinearMap_copy(threadData, _lm2);
          }

          _outMap = omc_SBFunctions_minAtomPW_make__result(threadData, _as_aux, _lm_aux);

          goto _return;
        }
      }
    }
  }

  _outMap = omc_SBFunctions_minAtomPW_make__result(threadData, _as_aux, _lm_aux);
  _return: OMC_LABEL_UNUSED
  return _outMap;
}

