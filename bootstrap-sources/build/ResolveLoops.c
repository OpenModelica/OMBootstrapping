#include "omc_simulation_settings.h"
#include "ResolveLoops.h"
#define _OMC_LIT0_data "_h"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,2,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,1,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,1,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
#define _OMC_LIT3_data "("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT3,1,_OMC_LIT3_data);
#define _OMC_LIT3 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT3)
#define _OMC_LIT4_data ","
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT4,1,_OMC_LIT4_data);
#define _OMC_LIT4 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data ") = "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,4,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "	"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,1,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT7,0.0);
#define _OMC_LIT7 MMC_REFREALLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,2,4) {&DAE_Exp_RCONST__desc,_OMC_LIT7}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "QR$NOM$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,7,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
#define _OMC_LIT10_data "QR$Q$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT10,5,_OMC_LIT10_data);
#define _OMC_LIT10 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "QR$W$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,5,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,1,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data "QR$R$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,5,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "QR$Qb$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,6,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT15,2.0);
#define _OMC_LIT15 MMC_REFREALLIT(_OMC_LIT_STRUCT15)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT16,2,4) {&DAE_Exp_RCONST__desc,_OMC_LIT15}};
#define _OMC_LIT16 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT16)
#define _OMC_LIT17_data "sqrt"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT17,4,_OMC_LIT17_data);
#define _OMC_LIT17 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT17)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT18,2,4) {&DAE_Type_T__REAL__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT18 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data "QR$a$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,5,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data "QR$y1$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,6,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data "QR$h$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,5,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
#define _OMC_LIT22_data "QR$h2$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT22,6,_OMC_LIT22_data);
#define _OMC_LIT22 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "QR$b_$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,6,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "QR$b$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,5,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "QR$A$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,5,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
#define _OMC_LIT26_data "QR$sA$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT26,6,_OMC_LIT26_data);
#define _OMC_LIT26 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT26)
#define _OMC_LIT27_data "QR$sx$"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT27,6,_OMC_LIT27_data);
#define _OMC_LIT27 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,0,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT28,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT7}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,1,4) {&DAE_ComponentPrefix_NOCOMPPRE__desc,}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT31,8,3) {&DAE_ElementSource_SOURCE__desc,_OMC_LIT29,MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT30,MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT31 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,1,9) {&BackendDAE_EquationKind_UNKNOWN__EQUATION__KIND__desc,}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT33,5,3) {&BackendDAE_EvaluationStages_EVALUATION__STAGES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT33 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT33)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT34,4,3) {&BackendDAE_EquationAttributes_EQUATION__ATTRIBUTES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT32,_OMC_LIT33}};
#define _OMC_LIT34 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "maxSizeSolveLinearSystem"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,24,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT36,1,4) {&Flags_FlagVisibility_EXTERNAL__desc,}};
#define _OMC_LIT36 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT36)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT37,2,5) {&Flags_FlagData_INT__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT37 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT37)
#define _OMC_LIT38_data "Max size for solveLinearSystem."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT38,31,_OMC_LIT38_data);
#define _OMC_LIT38 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT38)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT39,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT38}};
#define _OMC_LIT39 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT39)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT40,8,3) {&Flags_ConfigFlag_CONFIG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(57)),_OMC_LIT35,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT36,_OMC_LIT37,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT39}};
#define _OMC_LIT40 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data "resolveEquations failed!\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,25,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
#define _OMC_LIT42_data "reshuffling_post4_resolveAndReplace failed!\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT42,44,_OMC_LIT42_data);
#define _OMC_LIT42 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT42)
#define _OMC_LIT43_data "reshuffling_post3_selectShuffleEqs failed!\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT43,43,_OMC_LIT43_data);
#define _OMC_LIT43 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,1,3) {&BackendDAE_BaseClockPartitionKind_UNKNOWN__PARTITION__desc,}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT45,1,5) {&BackendDAE_IndexType_SOLVABLE__desc,}};
#define _OMC_LIT45 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT45)
#define _OMC_LIT46_data "shuffle_pre"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT46,11,_OMC_LIT46_data);
#define _OMC_LIT46 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT46)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT47,1,4) {&BackendDAE_IndexType_NORMAL__desc,}};
#define _OMC_LIT47 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT47)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT48,1,4) {&BackendDAE_JacobianType_JAC__LINEAR__desc,}};
#define _OMC_LIT48 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT48)
#define _OMC_LIT49_data "reshufflePost"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT49,13,_OMC_LIT49_data);
#define _OMC_LIT49 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT49)
#define _OMC_LIT50_data "Reshuffles the systems of equations."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT50,36,_OMC_LIT50_data);
#define _OMC_LIT50 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT50)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT51,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT50}};
#define _OMC_LIT51 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT51)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT52,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(112)),_OMC_LIT49,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT51}};
#define _OMC_LIT52 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT52)
#define _OMC_LIT53_data "connect2PathsToLoops failed\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT53,28,_OMC_LIT53_data);
#define _OMC_LIT53 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT53)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT54,2,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT54 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT54)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT55,2,1) {MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT55 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT55)
#define _OMC_LIT56_data "add a case to expIsCref:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT56,24,_OMC_LIT56_data);
#define _OMC_LIT56 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT56)
#define _OMC_LIT57_data "add a case to CRefIsPosOnRHS"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT57,28,_OMC_LIT57_data);
#define _OMC_LIT57 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT57)
#define _OMC_LIT58_data "reshuffle"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT58,9,_OMC_LIT58_data);
#define _OMC_LIT58 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT58)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT59,2,5) {&Flags_FlagData_INT__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT59 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT59)
#define _OMC_LIT60_data "sets tolerance of reshuffling algorithm: 1: conservative, 2: more tolerant, 3 resolve all"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT60,89,_OMC_LIT60_data);
#define _OMC_LIT60 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT60)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT61,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT60}};
#define _OMC_LIT61 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT61)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT62,8,3) {&Flags_ConfigFlag_CONFIG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(55)),_OMC_LIT58,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT36,_OMC_LIT59,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT61}};
#define _OMC_LIT62 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT62)
#define _OMC_LIT63_data "function ResolveLoops.getPathTillNextCrossEq failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT63,51,_OMC_LIT63_data);
#define _OMC_LIT63 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT63)
#define _OMC_LIT64_data "/home/adrpo33/OpenModelica/OMCompiler/Compiler/BackEnd/ResolveLoops.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT64,70,_OMC_LIT64_data);
#define _OMC_LIT64 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT64)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT65_6,1.758197185e9);
#define _OMC_LIT65_6 MMC_REFREALLIT(_OMC_LIT_STRUCT65_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT65,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT64,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1538)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1538)),MMC_IMMEDIATE(MMC_TAGFIXNUM(100)),_OMC_LIT65_6}};
#define _OMC_LIT65 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT65)
#define _OMC_LIT66_data "function ResolveLoops.findPathByEnds failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT66,43,_OMC_LIT66_data);
#define _OMC_LIT66 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT66)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT67_6,1.758197185e9);
#define _OMC_LIT67_6 MMC_REFREALLIT(_OMC_LIT_STRUCT67_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT67,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT64,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1417)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1417)),MMC_IMMEDIATE(MMC_TAGFIXNUM(92)),_OMC_LIT67_6}};
#define _OMC_LIT67 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT67)
#define _OMC_LIT68_data "function ResolveLoops.closePathDirectly failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT68,46,_OMC_LIT68_data);
#define _OMC_LIT68 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT68)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT69_6,1.758197185e9);
#define _OMC_LIT69_6 MMC_REFREALLIT(_OMC_LIT_STRUCT69_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT69,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT64,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1383)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1383)),MMC_IMMEDIATE(MMC_TAGFIXNUM(95)),_OMC_LIT69_6}};
#define _OMC_LIT69 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT69)
#define _OMC_LIT70_data "From eqs \n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT70,10,_OMC_LIT70_data);
#define _OMC_LIT70 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT70)
#define _OMC_LIT71_data "resolved the eq \n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT71,17,_OMC_LIT71_data);
#define _OMC_LIT71 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT71)
#define _OMC_LIT72_data "\n\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT72,2,_OMC_LIT72_data);
#define _OMC_LIT72 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT72)
#define _OMC_LIT73_data "resolveLoopsDump"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT73,16,_OMC_LIT73_data);
#define _OMC_LIT73 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT73)
#define _OMC_LIT74_data "Debug Output for ResolveLoops Module."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT74,37,_OMC_LIT74_data);
#define _OMC_LIT74 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT74)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT75,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT74}};
#define _OMC_LIT75 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT75)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT76,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(95)),_OMC_LIT73,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT75}};
#define _OMC_LIT76 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT76)
#define _OMC_LIT77_data "solve the loop: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT77,16,_OMC_LIT77_data);
#define _OMC_LIT77 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT77)
#define _OMC_LIT78_data "{"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT78,1,_OMC_LIT78_data);
#define _OMC_LIT78 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT78)
#define _OMC_LIT79_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT79,2,_OMC_LIT79_data);
#define _OMC_LIT79 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT79)
#define _OMC_LIT80_data "}"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT80,1,_OMC_LIT80_data);
#define _OMC_LIT80 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT80)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT81,1,5) {&AvlSetInt_Tree_EMPTY__desc,}};
#define _OMC_LIT81 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT81)
#define _OMC_LIT82_data "function resolveLoops_findLoops2 failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT82,39,_OMC_LIT82_data);
#define _OMC_LIT82 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT82)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT83_6,1.758197185e9);
#define _OMC_LIT83_6 MMC_REFREALLIT(_OMC_LIT_STRUCT83_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT83,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT64,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(532)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(532)),MMC_IMMEDIATE(MMC_TAGFIXNUM(88)),_OMC_LIT83_6}};
#define _OMC_LIT83 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT83)
#define _OMC_LIT84_data "function resolveLoops_cutNodes failed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT84,37,_OMC_LIT84_data);
#define _OMC_LIT84 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT84)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT85_6,1.758197185e9);
#define _OMC_LIT85_6 MMC_REFREALLIT(_OMC_LIT_STRUCT85_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT85,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT64,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(293)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(293)),MMC_IMMEDIATE(MMC_TAGFIXNUM(86)),_OMC_LIT85_6}};
#define _OMC_LIT85 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT85)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT86,1,3) {&BackendDAE_IndexType_ABSOLUTE__desc,}};
#define _OMC_LIT86 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT86)
#define _OMC_LIT87_data "whole System_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT87,13,_OMC_LIT87_data);
#define _OMC_LIT87 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT87)
#define _OMC_LIT88_data "rL_simpEqs_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT88,11,_OMC_LIT88_data);
#define _OMC_LIT88 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT88)
#define _OMC_LIT89_data "rL_loops_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT89,9,_OMC_LIT89_data);
#define _OMC_LIT89 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT89)
#define _OMC_LIT90_data "rL_after_"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT90,9,_OMC_LIT90_data);
#define _OMC_LIT90 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT90)
#include "util/modelica.h"

#include "ResolveLoops_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_gramSchmidtProcessHelper(threadData_t *threadData, modelica_metatype _w, modelica_metatype _u, modelica_string _name, modelica_integer _offset, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _ishared, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_gramSchmidtProcessHelper(threadData_t *threadData, modelica_metatype _w, modelica_metatype _u, modelica_metatype _name, modelica_metatype _offset, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _ishared, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_gramSchmidtProcessHelper,2,0) {(void*) boxptr_ResolveLoops_gramSchmidtProcessHelper,0}};
#define boxvar_ResolveLoops_gramSchmidtProcessHelper MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_gramSchmidtProcessHelper)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_qrDecomposition3(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_boolean _isMat, modelica_string _s);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_qrDecomposition3(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _isMat, modelica_metatype _s);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition3,2,0) {(void*) boxptr_ResolveLoops_qrDecomposition3,0}};
#define boxvar_ResolveLoops_qrDecomposition3 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition3)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition2(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_integer _i);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition2(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _i);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition2,2,0) {(void*) boxptr_ResolveLoops_qrDecomposition2,0}};
#define boxvar_ResolveLoops_qrDecomposition2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition1(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_integer _i);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition1(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _i);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition1,2,0) {(void*) boxptr_ResolveLoops_qrDecomposition1,0}};
#define boxvar_ResolveLoops_qrDecomposition1 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition(threadData_t *threadData, modelica_metatype _A, modelica_integer _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition(threadData_t *threadData, modelica_metatype _A, modelica_metatype _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition,2,0) {(void*) boxptr_ResolveLoops_qrDecomposition,0}};
#define boxvar_ResolveLoops_qrDecomposition MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecomposition)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrCalc__alpha(threadData_t *threadData, modelica_metatype _y, modelica_metatype _y1, modelica_integer _m);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrCalc__alpha(threadData_t *threadData, modelica_metatype _y, modelica_metatype _y1, modelica_metatype _m);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrCalc__alpha,2,0) {(void*) boxptr_ResolveLoops_qrCalc__alpha,0}};
#define boxvar_ResolveLoops_qrCalc__alpha MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrCalc__alpha)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_qrGet__cA(threadData_t *threadData, modelica_metatype _A, modelica_integer _iter, modelica_integer _j, modelica_integer _n, modelica_metatype _cA);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_qrGet__cA(threadData_t *threadData, modelica_metatype _A, modelica_metatype _iter, modelica_metatype _j, modelica_metatype _n, modelica_metatype _cA);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrGet__cA,2,0) {(void*) boxptr_ResolveLoops_qrGet__cA,0}};
#define boxvar_ResolveLoops_qrGet__cA MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrGet__cA)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecompositionHouseholder(threadData_t *threadData, modelica_metatype _A, modelica_integer _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecompositionHouseholder(threadData_t *threadData, modelica_metatype _A, modelica_metatype _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecompositionHouseholder,2,0) {(void*) boxptr_ResolveLoops_qrDecompositionHouseholder,0}};
#define boxvar_ResolveLoops_qrDecompositionHouseholder MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_qrDecompositionHouseholder)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem4(threadData_t *threadData, modelica_metatype _b_lst, modelica_metatype _jac, modelica_metatype _cr_x, modelica_metatype _var_lst, modelica_integer _n, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_ovars, modelica_integer *out_offset_, modelica_metatype *out_oshared);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem4(threadData_t *threadData, modelica_metatype _b_lst, modelica_metatype _jac, modelica_metatype _cr_x, modelica_metatype _var_lst, modelica_metatype _n, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_ovars, modelica_metatype *out_offset_, modelica_metatype *out_oshared);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem4,2,0) {(void*) boxptr_ResolveLoops_solveLinearSystem4,0}};
#define boxvar_ResolveLoops_solveLinearSystem4 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem4)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem3(threadData_t *threadData, modelica_metatype _inSyst, modelica_metatype _ishared, modelica_metatype _eqn_lst, modelica_metatype _eqn_indxs, modelica_metatype _var_lst, modelica_metatype _var_indxs, modelica_metatype _jac, modelica_integer _offset, modelica_metatype *out_oshared, modelica_integer *out_offset_);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem3(threadData_t *threadData, modelica_metatype _inSyst, modelica_metatype _ishared, modelica_metatype _eqn_lst, modelica_metatype _eqn_indxs, modelica_metatype _var_lst, modelica_metatype _var_indxs, modelica_metatype _jac, modelica_metatype _offset, modelica_metatype *out_oshared, modelica_metatype *out_offset_);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem3,2,0) {(void*) boxptr_ResolveLoops_solveLinearSystem3,0}};
#define boxvar_ResolveLoops_solveLinearSystem3 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem3)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem2(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _comp, modelica_metatype _ii, modelica_integer _offset, modelica_integer _maxSize, modelica_metatype *out_oshared, modelica_boolean *out_outRunMatching, modelica_metatype *out_oi, modelica_integer *out_offset_);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem2(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _comp, modelica_metatype _ii, modelica_metatype _offset, modelica_metatype _maxSize, modelica_metatype *out_oshared, modelica_metatype *out_outRunMatching, modelica_metatype *out_oi, modelica_metatype *out_offset_);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem2,2,0) {(void*) boxptr_ResolveLoops_solveLinearSystem2,0}};
#define boxvar_ResolveLoops_solveLinearSystem2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem1(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _inComps, modelica_metatype _inTpl, modelica_metatype *out_oshared, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem1,2,0) {(void*) boxptr_ResolveLoops_solveLinearSystem1,0}};
#define boxvar_ResolveLoops_solveLinearSystem1 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem0(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _inShared, modelica_metatype _inTpl, modelica_metatype *out_outShared, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem0,2,0) {(void*) boxptr_ResolveLoops_solveLinearSystem0,0}};
#define boxvar_ResolveLoops_solveLinearSystem0 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_solveLinearSystem0)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_isSolvable(threadData_t *threadData, modelica_metatype _entry);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_isSolvable(threadData_t *threadData, modelica_metatype _entry);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_isSolvable,2,0) {(void*) boxptr_ResolveLoops_isSolvable,0}};
#define boxvar_ResolveLoops_isSolvable MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_isSolvable)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_getDoublicates2(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arr);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_getDoublicates2(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arr);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoublicates2,2,0) {(void*) boxptr_ResolveLoops_getDoublicates2,0}};
#define boxvar_ResolveLoops_getDoublicates2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoublicates2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getDoublicates(threadData_t *threadData, modelica_metatype _lstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoublicates,2,0) {(void*) boxptr_ResolveLoops_getDoublicates,0}};
#define boxvar_ResolveLoops_getDoublicates MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoublicates)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_chooseEquation(threadData_t *threadData, modelica_metatype _row, modelica_metatype _meT);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_chooseEquation(threadData_t *threadData, modelica_metatype _row, modelica_metatype _meT);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_chooseEquation,2,0) {(void*) boxptr_ResolveLoops_chooseEquation,0}};
#define boxvar_ResolveLoops_chooseEquation MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_chooseEquation)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getEqPairs(threadData_t *threadData, modelica_integer _eq, modelica_metatype _me, modelica_metatype _meT);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getEqPairs(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _me, modelica_metatype _meT);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getEqPairs,2,0) {(void*) boxptr_ResolveLoops_getEqPairs,0}};
#define boxvar_ResolveLoops_getEqPairs MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getEqPairs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post4__resolveAndReplace(threadData_t *threadData, modelica_metatype _resolveEqLst, modelica_metatype _unassEqsIn, modelica_metatype _unassVarsIn, modelica_metatype _me, modelica_metatype _meT);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post4__resolveAndReplace,2,0) {(void*) boxptr_ResolveLoops_reshuffling__post4__resolveAndReplace,0}};
#define boxvar_ResolveLoops_reshuffling__post4__resolveAndReplace MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post4__resolveAndReplace)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post3__selectShuffleEqs(threadData_t *threadData, modelica_metatype _me, modelica_metatype _meT);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post3__selectShuffleEqs,2,0) {(void*) boxptr_ResolveLoops_reshuffling__post3__selectShuffleEqs,0}};
#define boxvar_ResolveLoops_reshuffling__post3__selectShuffleEqs MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post3__selectShuffleEqs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post2(threadData_t *threadData, modelica_metatype _eqIdcs, modelica_metatype _varIdcs, modelica_metatype _dae, modelica_metatype _shared, modelica_metatype _ojac, modelica_metatype _jacType, modelica_boolean *out_outRunMatching);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_reshuffling__post2(threadData_t *threadData, modelica_metatype _eqIdcs, modelica_metatype _varIdcs, modelica_metatype _dae, modelica_metatype _shared, modelica_metatype _ojac, modelica_metatype _jacType, modelica_metatype *out_outRunMatching);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post2,2,0) {(void*) boxptr_ResolveLoops_reshuffling__post2,0}};
#define boxvar_ResolveLoops_reshuffling__post2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post1(threadData_t *threadData, modelica_metatype _compIn, modelica_metatype _shared, modelica_metatype _systIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post1,2,0) {(void*) boxptr_ResolveLoops_reshuffling__post1,0}};
#define boxvar_ResolveLoops_reshuffling__post1 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post0(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _shared);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post0,2,0) {(void*) boxptr_ResolveLoops_reshuffling__post0,0}};
#define boxvar_ResolveLoops_reshuffling__post0 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_reshuffling__post0)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connectPaths(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _closingPaths);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_connectPaths,2,0) {(void*) boxptr_ResolveLoops_connectPaths,0}};
#define boxvar_ResolveLoops_connectPaths MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_connectPaths)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connect2PathsToLoops(threadData_t *threadData, modelica_metatype _pathsIn, modelica_metatype _loopsIn, modelica_metatype _restPathsIn, modelica_metatype *out_restPathsOut);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_connect2PathsToLoops,2,0) {(void*) boxptr_ResolveLoops_connect2PathsToLoops,0}};
#define boxvar_ResolveLoops_connect2PathsToLoops MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_connect2PathsToLoops)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_lastInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_integer _value);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_lastInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype _value);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_lastInListIsEqual,2,0) {(void*) boxptr_ResolveLoops_lastInListIsEqual,0}};
#define boxvar_ResolveLoops_lastInListIsEqual MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_lastInListIsEqual)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_firstInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_integer _value);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_firstInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype _value);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_firstInListIsEqual,2,0) {(void*) boxptr_ResolveLoops_firstInListIsEqual,0}};
#define boxvar_ResolveLoops_firstInListIsEqual MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_firstInListIsEqual)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sortPathsAsChain1(threadData_t *threadData, modelica_metatype _pathsIn, modelica_integer _firstNode, modelica_integer _lastNode, modelica_metatype _sortedPathsIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sortPathsAsChain1(threadData_t *threadData, modelica_metatype _pathsIn, modelica_metatype _firstNode, modelica_metatype _lastNode, modelica_metatype _sortedPathsIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_sortPathsAsChain1,2,0) {(void*) boxptr_ResolveLoops_sortPathsAsChain1,0}};
#define boxvar_ResolveLoops_sortPathsAsChain1 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_sortPathsAsChain1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sortPathsAsChain(threadData_t *threadData, modelica_metatype _pathsIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_sortPathsAsChain,2,0) {(void*) boxptr_ResolveLoops_sortPathsAsChain,0}};
#define boxvar_ResolveLoops_sortPathsAsChain MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_sortPathsAsChain)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_intLstIsEqual(threadData_t *threadData, modelica_metatype _lst1, modelica_metatype _lst2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_intLstIsEqual(threadData_t *threadData, modelica_metatype _lst1, modelica_metatype _lst2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_intLstIsEqual,2,0) {(void*) boxptr_ResolveLoops_intLstIsEqual,0}};
#define boxvar_ResolveLoops_intLstIsEqual MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_intLstIsEqual)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sumUp2Expressions(threadData_t *threadData, modelica_boolean _sumUp, modelica_metatype _exp1, modelica_metatype _exp2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sumUp2Expressions(threadData_t *threadData, modelica_metatype _sumUp, modelica_metatype _exp1, modelica_metatype _exp2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_sumUp2Expressions,2,0) {(void*) boxptr_ResolveLoops_sumUp2Expressions,0}};
#define boxvar_ResolveLoops_sumUp2Expressions MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_sumUp2Expressions)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_isAddOrSubExp(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTuple, modelica_metatype *out_outTuple);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_isAddOrSubExp,2,0) {(void*) boxptr_ResolveLoops_isAddOrSubExp,0}};
#define boxvar_ResolveLoops_isAddOrSubExp MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_isAddOrSubExp)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_gatherCrossNodes(threadData_t *threadData, modelica_integer _idx, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _lstIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_gatherCrossNodes(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _lstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_gatherCrossNodes,2,0) {(void*) boxptr_ResolveLoops_gatherCrossNodes,0}};
#define boxvar_ResolveLoops_gatherCrossNodes MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_gatherCrossNodes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getArrayEntryAndAppend(threadData_t *threadData, modelica_integer _entry, modelica_metatype _m, modelica_metatype _lstIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getArrayEntryAndAppend(threadData_t *threadData, modelica_metatype _entry, modelica_metatype _m, modelica_metatype _lstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getArrayEntryAndAppend,2,0) {(void*) boxptr_ResolveLoops_getArrayEntryAndAppend,0}};
#define boxvar_ResolveLoops_getArrayEntryAndAppend MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getArrayEntryAndAppend)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayGetIsNegative(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arrayIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayGetIsNegative(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arrayIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetIsNegative,2,0) {(void*) boxptr_ResolveLoops_arrayGetIsNegative,0}};
#define boxvar_ResolveLoops_arrayGetIsNegative MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetIsNegative)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayGetIsNotPositive(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arrayIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayGetIsNotPositive(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arrayIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetIsNotPositive,2,0) {(void*) boxptr_ResolveLoops_arrayGetIsNotPositive,0}};
#define boxvar_ResolveLoops_arrayGetIsNotPositive MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetIsNotPositive)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_colorNodePartitions(threadData_t *threadData, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _checkNextIn, modelica_metatype _markEqs, modelica_metatype _markVars, modelica_integer _currNumberIn, modelica_metatype _partitionsIn, modelica_integer _nextIndex, modelica_metatype *out_partitionsOut);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_colorNodePartitions(threadData_t *threadData, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _checkNextIn, modelica_metatype _markEqs, modelica_metatype _markVars, modelica_metatype _currNumberIn, modelica_metatype _partitionsIn, modelica_metatype _nextIndex, modelica_metatype *out_partitionsOut);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_colorNodePartitions,2,0) {(void*) boxptr_ResolveLoops_colorNodePartitions,0}};
#define boxvar_ResolveLoops_colorNodePartitions MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_colorNodePartitions)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_listLengthIs(threadData_t *threadData, modelica_metatype _lst, modelica_integer _value);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_listLengthIs(threadData_t *threadData, modelica_metatype _lst, modelica_metatype _value);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_listLengthIs,2,0) {(void*) boxptr_ResolveLoops_listLengthIs,0}};
#define boxvar_ResolveLoops_listLengthIs MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_listLengthIs)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_expIsCref(threadData_t *threadData, modelica_metatype _expIn, modelica_metatype _crefIn, modelica_boolean *out_algSign);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_expIsCref(threadData_t *threadData, modelica_metatype _expIn, modelica_metatype _crefIn, modelica_metatype *out_algSign);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_expIsCref,2,0) {(void*) boxptr_ResolveLoops_expIsCref,0}};
#define boxvar_ResolveLoops_expIsCref MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_expIsCref)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_CRefIsPosOnRHS(threadData_t *threadData, modelica_metatype _crefIn, modelica_metatype _eqIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_CRefIsPosOnRHS(threadData_t *threadData, modelica_metatype _crefIn, modelica_metatype _eqIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_CRefIsPosOnRHS,2,0) {(void*) boxptr_ResolveLoops_CRefIsPosOnRHS,0}};
#define boxvar_ResolveLoops_CRefIsPosOnRHS MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_CRefIsPosOnRHS)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_simplifyZeroAssignment(threadData_t *threadData, modelica_metatype _eIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_simplifyZeroAssignment,2,0) {(void*) boxptr_ResolveLoops_simplifyZeroAssignment,0}};
#define boxvar_ResolveLoops_simplifyZeroAssignment MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_simplifyZeroAssignment)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sumUp2Equations(threadData_t *threadData, modelica_boolean _sumUp, modelica_metatype _eq1, modelica_metatype _eq2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sumUp2Equations(threadData_t *threadData, modelica_metatype _sumUp, modelica_metatype _eq1, modelica_metatype _eq2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_sumUp2Equations,2,0) {(void*) boxptr_ResolveLoops_sumUp2Equations,0}};
#define boxvar_ResolveLoops_sumUp2Equations MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_sumUp2Equations)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_updateTripleLoop(threadData_t *threadData, modelica_metatype __omcQ_24in_5FloopFull, modelica_metatype _tplIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_updateTripleLoop,2,0) {(void*) boxptr_ResolveLoops_updateTripleLoop,0}};
#define boxvar_ResolveLoops_updateTripleLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_updateTripleLoop)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_evaluateTripleLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_evaluateTripleLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_evaluateTripleLoop,2,0) {(void*) boxptr_ResolveLoops_evaluateTripleLoop,0}};
#define boxvar_ResolveLoops_evaluateTripleLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_evaluateTripleLoop)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_evaluateLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_evaluateLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_evaluateLoop,2,0) {(void*) boxptr_ResolveLoops_evaluateLoop,0}};
#define boxvar_ResolveLoops_evaluateLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_evaluateLoop)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_priorizeEqsWithVarCrosses2(threadData_t *threadData, modelica_integer _eq, modelica_metatype _mIn, modelica_metatype _varCrossLst, modelica_metatype _priorities);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_priorizeEqsWithVarCrosses2(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _mIn, modelica_metatype _varCrossLst, modelica_metatype _priorities);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_priorizeEqsWithVarCrosses2,2,0) {(void*) boxptr_ResolveLoops_priorizeEqsWithVarCrosses2,0}};
#define boxvar_ResolveLoops_priorizeEqsWithVarCrosses2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_priorizeEqsWithVarCrosses2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_priorizeEqsWithVarCrosses(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _mIn, modelica_metatype _varCrossLst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_priorizeEqsWithVarCrosses,2,0) {(void*) boxptr_ResolveLoops_priorizeEqsWithVarCrosses,0}};
#define boxvar_ResolveLoops_priorizeEqsWithVarCrosses MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_priorizeEqsWithVarCrosses)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_replaceContractedNodes2(threadData_t *threadData, modelica_integer _entryIn, modelica_integer _nodeIn, modelica_metatype _replNodes);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_replaceContractedNodes2(threadData_t *threadData, modelica_metatype _entryIn, modelica_metatype _nodeIn, modelica_metatype _replNodes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_replaceContractedNodes2,2,0) {(void*) boxptr_ResolveLoops_replaceContractedNodes2,0}};
#define boxvar_ResolveLoops_replaceContractedNodes2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_replaceContractedNodes2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_replaceContractedNodes(threadData_t *threadData, modelica_metatype _pathIn, modelica_integer _nodeIn, modelica_metatype _replNodes);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_replaceContractedNodes(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _nodeIn, modelica_metatype _replNodes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_replaceContractedNodes,2,0) {(void*) boxptr_ResolveLoops_replaceContractedNodes,0}};
#define boxvar_ResolveLoops_replaceContractedNodes MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_replaceContractedNodes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_cons1(threadData_t *threadData, modelica_integer _elem, modelica_metatype _lst);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_cons1(threadData_t *threadData, modelica_metatype _elem, modelica_metatype _lst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_cons1,2,0) {(void*) boxptr_ResolveLoops_cons1,0}};
#define boxvar_ResolveLoops_cons1 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_cons1)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getPathTillNextCrossEq(threadData_t *threadData, modelica_metatype _checkEqCrossNodes, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _allEqCrossNodes, modelica_metatype _unfinPathsIn, modelica_metatype _eqPathsIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getPathTillNextCrossEq,2,0) {(void*) boxptr_ResolveLoops_getPathTillNextCrossEq,0}};
#define boxvar_ResolveLoops_getPathTillNextCrossEq MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getPathTillNextCrossEq)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_doubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_doubleEntriesInLst,2,0) {(void*) boxptr_ResolveLoops_doubleEntriesInLst,0}};
#define boxvar_ResolveLoops_doubleEntriesInLst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_doubleEntriesInLst)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_countDoubleEntriesInLstLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_countDoubleEntriesInLstLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_countDoubleEntriesInLstLst,2,0) {(void*) boxptr_ResolveLoops_countDoubleEntriesInLstLst,0}};
#define boxvar_ResolveLoops_countDoubleEntriesInLstLst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_countDoubleEntriesInLstLst)
PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_countDoubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_countDoubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_countDoubleEntriesInLst,2,0) {(void*) boxptr_ResolveLoops_countDoubleEntriesInLst,0}};
#define boxvar_ResolveLoops_countDoubleEntriesInLst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_countDoubleEntriesInLst)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_findPathByEnds(threadData_t *threadData, modelica_metatype _pathLstIn, modelica_integer _startNodeIn, modelica_integer _endNodeIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_findPathByEnds(threadData_t *threadData, modelica_metatype _pathLstIn, modelica_metatype _startNodeIn, modelica_metatype _endNodeIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_findPathByEnds,2,0) {(void*) boxptr_ResolveLoops_findPathByEnds,0}};
#define boxvar_ResolveLoops_findPathByEnds MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_findPathByEnds)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_closePathDirectly(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _pathLstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_closePathDirectly,2,0) {(void*) boxptr_ResolveLoops_closePathDirectly,0}};
#define boxvar_ResolveLoops_closePathDirectly MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_closePathDirectly)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_varSign(threadData_t *threadData, modelica_integer _index, modelica_metatype _varMap, modelica_metatype _daeVarsIn, modelica_metatype _eq1, modelica_metatype _eq2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_varSign(threadData_t *threadData, modelica_metatype _index, modelica_metatype _varMap, modelica_metatype _daeVarsIn, modelica_metatype _eq1, modelica_metatype _eq2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_varSign,2,0) {(void*) boxptr_ResolveLoops_varSign,0}};
#define boxvar_ResolveLoops_varSign MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_varSign)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_crefFromIndex(threadData_t *threadData, modelica_integer _varIdx, modelica_metatype _varMap, modelica_metatype _daeVarsIn);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_crefFromIndex(threadData_t *threadData, modelica_metatype _varIdx, modelica_metatype _varMap, modelica_metatype _daeVarsIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_crefFromIndex,2,0) {(void*) boxptr_ResolveLoops_crefFromIndex,0}};
#define boxvar_ResolveLoops_crefFromIndex MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_crefFromIndex)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveClosedLoop2(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _loopIn, modelica_metatype _m, modelica_metatype __omcQ_24in_5Fm_5Frow, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype *out_m_row);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveClosedLoop2,2,0) {(void*) boxptr_ResolveLoops_resolveClosedLoop2,0}};
#define boxvar_ResolveLoops_resolveClosedLoop2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveClosedLoop2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveClosedLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype *out_m_row);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveClosedLoop,2,0) {(void*) boxptr_ResolveLoops_resolveClosedLoop,0}};
#define boxvar_ResolveLoops_resolveClosedLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveClosedLoop)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getEqNodesForVarLoop(threadData_t *threadData, modelica_metatype _varIdcs, modelica_metatype _mTIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getEqNodesForVarLoop,2,0) {(void*) boxptr_ResolveLoops_getEqNodesForVarLoop,0}};
#define boxvar_ResolveLoops_getEqNodesForVarLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getEqNodesForVarLoop)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getTriples(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype _minAdj, modelica_metatype *out_allPaths);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getTriples,2,0) {(void*) boxptr_ResolveLoops_getTriples,0}};
#define boxvar_ResolveLoops_getTriples MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getTriples)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getDoubles(threadData_t *threadData, modelica_metatype _elemLstIn, modelica_metatype _lstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoubles,2,0) {(void*) boxptr_ResolveLoops_getDoubles,0}};
#define boxvar_ResolveLoops_getDoubles MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getDoubles)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getReverseDoubles(threadData_t *threadData, modelica_metatype _elem, modelica_metatype _elemLst, modelica_metatype _foldLstIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getReverseDoubles,2,0) {(void*) boxptr_ResolveLoops_getReverseDoubles,0}};
#define boxvar_ResolveLoops_getReverseDoubles MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getReverseDoubles)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_arrayGetAppendLst(threadData_t *threadData, modelica_integer _idx, modelica_metatype _appLst, modelica_metatype _arrIn);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_arrayGetAppendLst(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _appLst, modelica_metatype _arrIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetAppendLst,2,0) {(void*) boxptr_ResolveLoops_arrayGetAppendLst,0}};
#define boxvar_ResolveLoops_arrayGetAppendLst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetAppendLst)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_arrayGetDeleteInLst(threadData_t *threadData, modelica_integer _idx, modelica_metatype _delEntries, modelica_metatype _arrIn);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_arrayGetDeleteInLst(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _delEntries, modelica_metatype _arrIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetDeleteInLst,2,0) {(void*) boxptr_ResolveLoops_arrayGetDeleteInLst,0}};
#define boxvar_ResolveLoops_arrayGetDeleteInLst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayGetDeleteInLst)
PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_markDeadEndsInBipartiteGraph(threadData_t *threadData, modelica_integer _varIdx, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _deadEndEqs, modelica_metatype _deadEndVars);
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_markDeadEndsInBipartiteGraph(threadData_t *threadData, modelica_metatype _varIdx, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _deadEndEqs, modelica_metatype _deadEndVars);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_markDeadEndsInBipartiteGraph,2,0) {(void*) boxptr_ResolveLoops_markDeadEndsInBipartiteGraph,0}};
#define boxvar_ResolveLoops_markDeadEndsInBipartiteGraph MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_markDeadEndsInBipartiteGraph)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayIsZeroAt(threadData_t *threadData, modelica_integer _pos, modelica_metatype _arr);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayIsZeroAt(threadData_t *threadData, modelica_metatype _pos, modelica_metatype _arr);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayIsZeroAt,2,0) {(void*) boxptr_ResolveLoops_arrayIsZeroAt,0}};
#define boxvar_ResolveLoops_arrayIsZeroAt MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayIsZeroAt)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_eqIsConst(threadData_t *threadData, modelica_metatype _eq);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_eqIsConst(threadData_t *threadData, modelica_metatype _eq);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_eqIsConst,2,0) {(void*) boxptr_ResolveLoops_eqIsConst,0}};
#define boxvar_ResolveLoops_eqIsConst MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_eqIsConst)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__resolveAndReplace(threadData_t *threadData, modelica_metatype _loopsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype _replEqsIn, modelica_metatype *out_replEqsOut);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__resolveAndReplace,2,0) {(void*) boxptr_ResolveLoops_resolveLoops__resolveAndReplace,0}};
#define boxvar_ResolveLoops_resolveLoops__resolveAndReplace MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__resolveAndReplace)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connectPathsToOneLoop(threadData_t *threadData, modelica_metatype _allPathsIn, modelica_metatype _loopIn);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_connectPathsToOneLoop,2,0) {(void*) boxptr_ResolveLoops_connectPathsToOneLoop,0}};
#define boxvar_ResolveLoops_connectPathsToOneLoop MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_connectPathsToOneLoop)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_connectsLoops(threadData_t *threadData, modelica_metatype _path, modelica_metatype _allLoops);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_connectsLoops(threadData_t *threadData, modelica_metatype _path, modelica_metatype _allLoops);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_connectsLoops,2,0) {(void*) boxptr_ResolveLoops_connectsLoops,0}};
#define boxvar_ResolveLoops_connectsLoops MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_connectsLoops)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData_t *threadData, modelica_metatype _eqCrossLstIn, modelica_metatype _eqCrossSet, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _pathsIn, modelica_boolean _findExactlyOneLoop);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData_t *threadData, modelica_metatype _eqCrossLstIn, modelica_metatype _eqCrossSet, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _pathsIn, modelica_metatype _findExactlyOneLoop);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getShortPathsBetweenEqCrossNodes,2,0) {(void*) boxptr_ResolveLoops_getShortPathsBetweenEqCrossNodes,0}};
#define boxvar_ResolveLoops_getShortPathsBetweenEqCrossNodes MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getShortPathsBetweenEqCrossNodes)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_hasSameIntSortedExcept(threadData_t *threadData, modelica_metatype _inList1, modelica_metatype _inList2, modelica_integer _excl);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_hasSameIntSortedExcept(threadData_t *threadData, modelica_metatype _inList1, modelica_metatype _inList2, modelica_metatype _excl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_hasSameIntSortedExcept,2,0) {(void*) boxptr_ResolveLoops_hasSameIntSortedExcept,0}};
#define boxvar_ResolveLoops_hasSameIntSortedExcept MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_hasSameIntSortedExcept)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_listContains(threadData_t *threadData, modelica_metatype _lst, modelica_integer _int);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_listContains(threadData_t *threadData, modelica_metatype _lst, modelica_metatype _int);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_listContains,2,0) {(void*) boxptr_ResolveLoops_listContains,0}};
#define boxvar_ResolveLoops_listContains MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_listContains)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_pathContainsNode(threadData_t *threadData, modelica_integer _node, modelica_metatype _inPath);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_pathContainsNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _inPath);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_pathContainsNode,2,0) {(void*) boxptr_ResolveLoops_pathContainsNode,0}};
#define boxvar_ResolveLoops_pathContainsNode MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_pathContainsNode)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_removeNode(threadData_t *threadData, modelica_integer _node, modelica_metatype _inPaths, modelica_metatype __omcQ_24in_5FaccPaths);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_removeNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _inPaths, modelica_metatype __omcQ_24in_5FaccPaths);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_removeNode,2,0) {(void*) boxptr_ResolveLoops_removeNode,0}};
#define boxvar_ResolveLoops_removeNode MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_removeNode)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_removeEqualPaths(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype __omcQ_24in_5FminAdj, modelica_metatype __omcQ_24in_5FuniquePaths, modelica_metatype __omcQ_24in_5FmapIndices, modelica_metatype __omcQ_24in_5Fmap, modelica_metatype __omcQ_24in_5FaccCrossNodes, modelica_metatype *out_uniquePaths, modelica_metatype *out_mapIndices, modelica_metatype *out_map, modelica_metatype *out_accCrossNodes);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_removeEqualPaths,2,0) {(void*) boxptr_ResolveLoops_removeEqualPaths,0}};
#define boxvar_ResolveLoops_removeEqualPaths MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_removeEqualPaths)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getMinimalAdjacencyMatrix(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype _uniquePaths);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getMinimalAdjacencyMatrix,2,0) {(void*) boxptr_ResolveLoops_getMinimalAdjacencyMatrix,0}};
#define boxvar_ResolveLoops_getMinimalAdjacencyMatrix MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getMinimalAdjacencyMatrix)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_findEqualPathStructure(threadData_t *threadData, modelica_metatype __omcQ_24in_5FcrossNodes, modelica_metatype __omcQ_24in_5FuniquePaths, modelica_metatype *out_uniquePaths, modelica_metatype *out_mapping, modelica_metatype *out_minAdj);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_findEqualPathStructure,2,0) {(void*) boxptr_ResolveLoops_findEqualPathStructure,0}};
#define boxvar_ResolveLoops_findEqualPathStructure MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_findEqualPathStructure)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__findLoops2(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_boolean _findExactlyOneLoop, modelica_metatype *out_structureMapping);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_resolveLoops__findLoops2(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _findExactlyOneLoop, modelica_metatype *out_structureMapping);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__findLoops2,2,0) {(void*) boxptr_ResolveLoops_resolveLoops__findLoops2,0}};
#define boxvar_ResolveLoops_resolveLoops__findLoops2 MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__findLoops2)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getSimpleEquationVariables(threadData_t *threadData, modelica_metatype _markLinEqVars, modelica_metatype _vars, modelica_metatype *out_varMapArr);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getSimpleEquationVariables,2,0) {(void*) boxptr_ResolveLoops_getSimpleEquationVariables,0}};
#define boxvar_ResolveLoops_getSimpleEquationVariables MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getSimpleEquationVariables)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getSimpleEquations(threadData_t *threadData, modelica_metatype _inEq, modelica_metatype _inTpl, modelica_metatype *out_outTpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_getSimpleEquations,2,0) {(void*) boxptr_ResolveLoops_getSimpleEquations,0}};
#define boxvar_ResolveLoops_getSimpleEquations MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_getSimpleEquations)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayEntryLengthIs(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arr, modelica_integer _len);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayEntryLengthIs(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arr, modelica_metatype _len);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayEntryLengthIs,2,0) {(void*) boxptr_ResolveLoops_arrayEntryLengthIs,0}};
#define boxvar_ResolveLoops_arrayEntryLengthIs MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_arrayEntryLengthIs)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__cutNodes(threadData_t *threadData, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype *out_deadEndEqsMark);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__cutNodes,2,0) {(void*) boxptr_ResolveLoops_resolveLoops__cutNodes,0}};
#define boxvar_ResolveLoops_resolveLoops__cutNodes MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__cutNodes)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__resolvePartitions(threadData_t *threadData, modelica_metatype _partitionsIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _m_uncut, modelica_metatype _mT_uncut, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqs, modelica_metatype _daeVars, modelica_metatype _nonLoopEqMark);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__resolvePartitions,2,0) {(void*) boxptr_ResolveLoops_resolveLoops__resolvePartitions,0}};
#define boxvar_ResolveLoops_resolveLoops__resolvePartitions MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__resolvePartitions)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__main(threadData_t *threadData, modelica_metatype _inEqSys, modelica_metatype _inShared, modelica_integer _inSysIdx, modelica_metatype *out_outShared, modelica_integer *out_outSysIdx);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_resolveLoops__main(threadData_t *threadData, modelica_metatype _inEqSys, modelica_metatype _inShared, modelica_metatype _inSysIdx, modelica_metatype *out_outShared, modelica_metatype *out_outSysIdx);
static const MMC_DEFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__main,2,0) {(void*) boxptr_ResolveLoops_resolveLoops__main,0}};
#define boxvar_ResolveLoops_resolveLoops__main MMC_REFSTRUCTLIT(boxvar_lit_ResolveLoops_resolveLoops__main)

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_gramSchmidtProcessHelper(threadData_t *threadData, modelica_metatype _w, modelica_metatype _u, modelica_string _name, modelica_integer _offset, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _ishared, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_metatype _v = NULL;
  modelica_metatype _oeqns = NULL;
  modelica_metatype _ovars = NULL;
  modelica_metatype _oshared = NULL;
  modelica_metatype _h = NULL;
  modelica_integer _n;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _v has no default value.
  // _oeqns has no default value.
  // _ovars has no default value.
  // _oshared has no default value.
  _h = omc_Expression_makeScalarProduct(threadData, _w, _u);
  _n = arrayLength(_w);
  tmpMeta1 = stringAppend(_name,_OMC_LIT0);
  _h = omc_BackendEquation_makeTmpEqnForExp(threadData, _h, tmpMeta1, _offset, _ieqns, _ivars, _ishared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

  _v = omc_Array_map1(threadData, _u, boxvar_Expression_expMul, _h);

  _v = omc_Expression_subVec(threadData, _w, _v);

  tmp4 = ((modelica_integer) 1); tmp5 = 1; tmp6 = _n;
  if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp4, tmp6); _i += tmp5)
    {
      tmpMeta2 = stringAppend(_name,_OMC_LIT1);
      tmpMeta3 = stringAppend(tmpMeta2,intString(_i));
      _h = omc_BackendEquation_makeTmpEqnForExp(threadData, arrayGet(_v, _i), tmpMeta3, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_v, _i, _h);
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_oeqns) { *out_oeqns = _oeqns; }
  if (out_ovars) { *out_ovars = _ovars; }
  if (out_oshared) { *out_oshared = _oshared; }
  return _v;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_gramSchmidtProcessHelper(threadData_t *threadData, modelica_metatype _w, modelica_metatype _u, modelica_metatype _name, modelica_metatype _offset, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _ishared, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_integer tmp1;
  modelica_metatype _v = NULL;
  tmp1 = mmc_unbox_integer(_offset);
  _v = omc_ResolveLoops_gramSchmidtProcessHelper(threadData, _w, _u, _name, tmp1, _ieqns, _ivars, _ishared, out_oeqns, out_ovars, out_oshared);
  /* skip box _v; array<DAE.Exp> */
  /* skip box _oeqns; ExpandableArray<BackendDAE.Equation> */
  /* skip box _ovars; BackendDAE.Variables */
  /* skip box _oshared; BackendDAE.Shared */
  return _v;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_qrDecomposition3(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_boolean _isMat, modelica_string _s)
{
  modelica_integer _n;
  modelica_integer _m;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_integer tmp8;
  modelica_integer tmp9;
  modelica_integer tmp10;
  modelica_integer tmp11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _n = _sizeA;
  _m = (_isMat?_sizeA:((modelica_integer) 1));
  fputs(MMC_STRINGDATA(_OMC_LIT2),stdout);

  tmp11 = ((modelica_integer) 1); tmp12 = 1; tmp13 = _n;
  if(!(((tmp12 > 0) && (tmp11 > tmp13)) || ((tmp12 < 0) && (tmp11 < tmp13))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp11, tmp13); _i += tmp12)
    {
      fputs(MMC_STRINGDATA(_OMC_LIT2),stdout);

      tmp8 = ((modelica_integer) 1); tmp9 = 1; tmp10 = _m;
      if(!(((tmp9 > 0) && (tmp8 > tmp10)) || ((tmp9 < 0) && (tmp8 < tmp10))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp8, tmp10); _j += tmp9)
        {
          tmpMeta1 = stringAppend(_s,_OMC_LIT3);
          tmpMeta2 = stringAppend(tmpMeta1,intString(_i));
          tmpMeta3 = stringAppend(tmpMeta2,_OMC_LIT4);
          tmpMeta4 = stringAppend(tmpMeta3,intString(_j));
          tmpMeta5 = stringAppend(tmpMeta4,_OMC_LIT5);
          tmpMeta6 = stringAppend(tmpMeta5,omc_ExpressionDump_printExpStr(threadData, arrayGet(_A, (((modelica_integer) -1) + _i) * (_m) + _j)));
          tmpMeta7 = stringAppend(tmpMeta6,_OMC_LIT6);
          fputs(MMC_STRINGDATA(tmpMeta7),stdout);
        }
      }
    }
  }

  fputs(MMC_STRINGDATA(_OMC_LIT2),stdout);
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_qrDecomposition3(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _isMat, modelica_metatype _s)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  tmp1 = mmc_unbox_integer(_sizeA);
  tmp2 = mmc_unbox_integer(_isMat);
  omc_ResolveLoops_qrDecomposition3(threadData, _A, tmp1, tmp2, _s);
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition2(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_integer _i)
{
  modelica_metatype _row = NULL;
  modelica_integer _k;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _row = arrayCreate(_sizeA, _OMC_LIT8);
  _k = ((modelica_integer) -1) + _i;
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = _sizeA;
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _j;
    for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp1, tmp3); _j += tmp2)
    {
      arrayUpdate(_row, _j, arrayGet(_A, _j + (_k) * (_sizeA)));
    }
  }
  _return: OMC_LABEL_UNUSED
  return _row;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition2(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _i)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _row = NULL;
  tmp1 = mmc_unbox_integer(_sizeA);
  tmp2 = mmc_unbox_integer(_i);
  _row = omc_ResolveLoops_qrDecomposition2(threadData, _A, tmp1, tmp2);
  /* skip box _row; array<DAE.Exp> */
  return _row;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition1(threadData_t *threadData, modelica_metatype _A, modelica_integer _sizeA, modelica_integer _i)
{
  modelica_metatype _column = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _column = arrayCreate(_sizeA, _OMC_LIT8);
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = _sizeA;
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _j;
    for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp1, tmp3); _j += tmp2)
    {
      arrayUpdate(_column, _j, arrayGet(_A, _i + (((modelica_integer) -1) + _j) * (_sizeA)));
    }
  }
  _return: OMC_LABEL_UNUSED
  return _column;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition1(threadData_t *threadData, modelica_metatype _A, modelica_metatype _sizeA, modelica_metatype _i)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _column = NULL;
  tmp1 = mmc_unbox_integer(_sizeA);
  tmp2 = mmc_unbox_integer(_i);
  _column = omc_ResolveLoops_qrDecomposition1(threadData, _A, tmp1, tmp2);
  /* skip box _column; array<DAE.Exp> */
  return _column;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecomposition(threadData_t *threadData, modelica_metatype _A, modelica_integer _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_metatype _R = NULL;
  modelica_metatype _b = NULL;
  modelica_metatype _oeqns = NULL;
  modelica_metatype _ovars = NULL;
  modelica_metatype _oshared = NULL;
  modelica_metatype _Q = NULL;
  modelica_metatype _v = NULL;
  modelica_metatype _u = NULL;
  modelica_metatype _w = NULL;
  modelica_metatype _e = NULL;
  modelica_metatype _vv = NULL;
  modelica_metatype _x = NULL;
  modelica_metatype _y = NULL;
  modelica_metatype _p = NULL;
  modelica_metatype _a = NULL;
  modelica_metatype _ex = NULL;
  modelica_metatype _tmpvar = NULL;
  modelica_string _name = NULL;
  modelica_metatype _cr = NULL;
  modelica_integer _kk;
  modelica_integer _m;
  modelica_integer _nn;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_integer tmp9;
  modelica_integer tmp10;
  modelica_integer tmp11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_integer tmp14;
  modelica_integer tmp15;
  modelica_integer tmp16;
  modelica_integer tmp17;
  modelica_integer tmp18;
  modelica_integer tmp19;
  modelica_metatype tmpMeta20;
  modelica_integer tmp21;
  modelica_integer tmp22;
  modelica_integer tmp23;
  modelica_integer tmp24;
  modelica_integer tmp25;
  modelica_integer tmp26;
  modelica_metatype tmpMeta27;
  modelica_integer tmp28;
  modelica_integer tmp29;
  modelica_integer tmp30;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _R = arrayCreate((_n) * (_n), _OMC_LIT8);
  _b = arrayCreate(_n, _OMC_LIT8);
  _oeqns = _ieqns;
  _ovars = _ivars;
  // _oshared has no default value.
  _Q = arrayCreate((_n) * (_n), _OMC_LIT8);
  _v = arrayCreate(_n, _OMC_LIT8);
  _u = arrayCreate(_n, _OMC_LIT8);
  _w = arrayCreate(_n, _OMC_LIT8);
  _e = arrayCreate(_n, _OMC_LIT8);
  _vv = arrayCreate(_n, _OMC_LIT8);
  // _x has no default value.
  // _y has no default value.
  // _p has no default value.
  // _a has no default value.
  // _ex has no default value.
  // _tmpvar has no default value.
  // _name has no default value.
  // _cr has no default value.
  _kk = ((modelica_integer) 1);
  _m = ((modelica_integer) -1) + _n;
  // _nn has no default value.
  _v = omc_ResolveLoops_qrDecomposition1(threadData, _A, _n, _kk);

  tmpMeta1 = stringAppend(_OMC_LIT9,intString(_kk));
  _u = omc_BackendEquation_normalizationVec(threadData, _v, tmpMeta1, _offset, _oeqns, _ovars, _ishared ,&_oeqns ,&_ovars ,&_oshared);

  tmp3 = ((modelica_integer) 1); tmp4 = 1; tmp5 = _n;
  if(!(((tmp4 > 0) && (tmp3 > tmp5)) || ((tmp4 < 0) && (tmp3 < tmp5))))
  {
    modelica_integer _j;
    for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp3, tmp5); _j += tmp4)
    {
      _a = omc_ExpressionSimplify_simplify(threadData, arrayGet(_u, _j), NULL);

      tmpMeta2 = stringAppend(_OMC_LIT10,intString(_kk + (((modelica_integer) -1) + _j) * (_n)));
      _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta2, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_Q, _kk + (((modelica_integer) -1) + _j) * (_n), _a);
    }
  }

  tmp17 = ((modelica_integer) 1); tmp18 = 1; tmp19 = _m;
  if(!(((tmp18 > 0) && (tmp17 > tmp19)) || ((tmp18 < 0) && (tmp17 < tmp19))))
  {
    modelica_integer _k;
    for(_k = ((modelica_integer) 1); in_range_integer(_k, tmp17, tmp19); _k += tmp18)
    {
      _v = omc_ResolveLoops_qrDecomposition1(threadData, _A, _n, ((modelica_integer) 1) + _k);

      tmp9 = ((modelica_integer) 1); tmp10 = 1; tmp11 = _k;
      if(!(((tmp10 > 0) && (tmp9 > tmp11)) || ((tmp10 < 0) && (tmp9 < tmp11))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp9, tmp11); _j += tmp10)
        {
          _u = omc_ResolveLoops_qrDecomposition1(threadData, _Q, _n, _j);

          tmpMeta6 = stringAppend(_OMC_LIT11,intString(_kk));
          tmpMeta7 = stringAppend(tmpMeta6,_OMC_LIT12);
          tmpMeta8 = stringAppend(tmpMeta7,intString(_kk));
          _v = omc_ResolveLoops_gramSchmidtProcessHelper(threadData, _v, _u, tmpMeta8, _offset, _oeqns, _ovars, _oshared ,&_oeqns ,&_ovars ,&_oshared);

          _kk = ((modelica_integer) 1) + _kk;
        }
      }

      tmpMeta12 = stringAppend(_OMC_LIT9,intString(((modelica_integer) 1) + _k));
      _u = omc_BackendEquation_normalizationVec(threadData, _v, tmpMeta12, _offset, _oeqns, _ovars, _oshared ,&_oeqns ,&_ovars ,&_oshared);

      tmp14 = ((modelica_integer) 1); tmp15 = 1; tmp16 = _n;
      if(!(((tmp15 > 0) && (tmp14 > tmp16)) || ((tmp15 < 0) && (tmp14 < tmp16))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp14, tmp16); _j += tmp15)
        {
          _nn = ((modelica_integer) 1) + _k + (((modelica_integer) -1) + _j) * (_n);

          _a = omc_ExpressionSimplify_simplify(threadData, arrayGet(_u, _j), NULL);

          tmpMeta13 = stringAppend(_OMC_LIT10,intString(_nn));
          _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta13, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

          arrayUpdate(_Q, _nn, _a);
        }
      }
    }
  }

  tmp24 = ((modelica_integer) 1); tmp25 = 1; tmp26 = _n;
  if(!(((tmp25 > 0) && (tmp24 > tmp26)) || ((tmp25 < 0) && (tmp24 < tmp26))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp24, tmp26); _i += tmp25)
    {
      _x = omc_ResolveLoops_qrDecomposition1(threadData, _Q, _n, _i);

      _m = (((modelica_integer) -1) + _i) * (_n);

      tmp21 = _i; tmp22 = 1; tmp23 = _n;
      if(!(((tmp22 > 0) && (tmp21 > tmp23)) || ((tmp22 < 0) && (tmp21 < tmp23))))
      {
        modelica_integer _j;
        for(_j = _i; in_range_integer(_j, tmp21, tmp23); _j += tmp22)
        {
          _y = omc_ResolveLoops_qrDecomposition1(threadData, _A, _n, _j);

          _a = omc_Expression_makeScalarProduct(threadData, _x, _y);

          tmpMeta20 = stringAppend(_OMC_LIT13,intString(_m + _j));
          _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta20, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

          arrayUpdate(_R, _m + _j, _a);
        }
      }
    }
  }

  tmp28 = ((modelica_integer) 1); tmp29 = 1; tmp30 = _n;
  if(!(((tmp29 > 0) && (tmp28 > tmp30)) || ((tmp29 < 0) && (tmp28 < tmp30))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp28, tmp30); _i += tmp29)
    {
      _x = omc_ResolveLoops_qrDecomposition1(threadData, _Q, _n, _i);

      _a = omc_Expression_makeScalarProduct(threadData, _x, _ib);

      tmpMeta27 = stringAppend(_OMC_LIT14,intString(_i));
      _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta27, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_b, _i, _a);
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_b) { *out_b = _b; }
  if (out_oeqns) { *out_oeqns = _oeqns; }
  if (out_ovars) { *out_ovars = _ovars; }
  if (out_oshared) { *out_oshared = _oshared; }
  return _R;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecomposition(threadData_t *threadData, modelica_metatype _A, modelica_metatype _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _R = NULL;
  tmp1 = mmc_unbox_integer(_n);
  tmp2 = mmc_unbox_integer(_offset);
  _R = omc_ResolveLoops_qrDecomposition(threadData, _A, tmp1, _ib, _ieqns, _ivars, tmp2, _ishared, out_b, out_oeqns, out_ovars, out_oshared);
  /* skip box _R; array<DAE.Exp> */
  /* skip box _b; array<DAE.Exp> */
  /* skip box _oeqns; ExpandableArray<BackendDAE.Equation> */
  /* skip box _ovars; BackendDAE.Variables */
  /* skip box _oshared; BackendDAE.Shared */
  return _R;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrCalc__alpha(threadData_t *threadData, modelica_metatype _y, modelica_metatype _y1, modelica_integer _m)
{
  modelica_metatype _alpha = NULL;
  modelica_metatype _sgn_y1 = NULL;
  modelica_metatype _norm_y = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _alpha has no default value.
  _sgn_y1 = omc_Expression_makeSign(threadData, _y1);
  _norm_y = omc_Expression_lenVec(threadData, _y);
  {
    modelica_metatype __omcQ_24tmpVar1;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar0;
    modelica_integer tmp4;
    modelica_integer tmp5;
    modelica_integer tmp6;
    modelica_integer _j;
    tmp5 = 1 /* Range step-value */;
    tmp6 = _m /* Range stop-value */;
    _j = ((modelica_integer) 1) /* Range start-value */;
    _j = (((modelica_integer) 1) /* Range start-value */)-tmp5;
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar1 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar1;
    while(1) {
      tmp4 = 1;
      if (tmp5 > 0 ? _j+tmp5 <= tmp6 : _j+tmp5 >= tmp6) {
        _j += tmp5;
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar0 = omc_Expression_expPow(threadData, arrayGet(_y, _j), _OMC_LIT16);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar0,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar1;
  }
  _norm_y = omc_Expression_makeSum1(threadData, tmpMeta1, 0 /* false */);

  tmpMeta7 = mmc_mk_cons(_norm_y, MMC_REFSTRUCTLIT(mmc_nil));
  _norm_y = omc_Expression_makePureBuiltinCall(threadData, _OMC_LIT17, tmpMeta7, _OMC_LIT18);

  _alpha = omc_Expression_expMul(threadData, _sgn_y1, _norm_y);
  _return: OMC_LABEL_UNUSED
  return _alpha;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrCalc__alpha(threadData_t *threadData, modelica_metatype _y, modelica_metatype _y1, modelica_metatype _m)
{
  modelica_integer tmp1;
  modelica_metatype _alpha = NULL;
  tmp1 = mmc_unbox_integer(_m);
  _alpha = omc_ResolveLoops_qrCalc__alpha(threadData, _y, _y1, tmp1);
  /* skip box _alpha; DAE.Exp */
  return _alpha;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_qrGet__cA(threadData_t *threadData, modelica_metatype _A, modelica_integer _iter, modelica_integer _j, modelica_integer _n, modelica_metatype _cA)
{
  modelica_integer _shift;
  modelica_integer _m;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _shift = ((modelica_integer) -1) + (((modelica_integer) -1) + _iter) * (_n) + _iter + _j;
  _m = ((modelica_integer) 1) + _n - _iter;
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = _m;
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      arrayUpdate(_cA, _i, arrayGet(_A, _shift + (((modelica_integer) -1) + _i) * (_n)));
    }
  }

  tmp4 = ((modelica_integer) 1) + _m; tmp5 = 1; tmp6 = _n;
  if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1) + _m; in_range_integer(_i, tmp4, tmp6); _i += tmp5)
    {
      arrayUpdate(_cA, _i, _OMC_LIT8);
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_qrGet__cA(threadData_t *threadData, modelica_metatype _A, modelica_metatype _iter, modelica_metatype _j, modelica_metatype _n, modelica_metatype _cA)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  tmp1 = mmc_unbox_integer(_iter);
  tmp2 = mmc_unbox_integer(_j);
  tmp3 = mmc_unbox_integer(_n);
  omc_ResolveLoops_qrGet__cA(threadData, _A, tmp1, tmp2, tmp3, _cA);
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_qrDecompositionHouseholder(threadData_t *threadData, modelica_metatype _A, modelica_integer _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_metatype _R = NULL;
  modelica_metatype _b = NULL;
  modelica_metatype _oeqns = NULL;
  modelica_metatype _ovars = NULL;
  modelica_metatype _oshared = NULL;
  modelica_metatype _cA = NULL;
  modelica_metatype _v = NULL;
  modelica_metatype _alpha = NULL;
  modelica_metatype _y1 = NULL;
  modelica_metatype _h = NULL;
  modelica_metatype _h2 = NULL;
  modelica_metatype _e1 = NULL;
  modelica_metatype _e2 = NULL;
  modelica_metatype _e = NULL;
  modelica_integer _m;
  modelica_integer _nn;
  modelica_integer _idxVars;
  modelica_integer _shift;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_integer tmp9;
  modelica_integer tmp10;
  modelica_integer tmp11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  modelica_integer tmp14;
  modelica_integer tmp15;
  modelica_integer tmp16;
  modelica_integer tmp17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_integer tmp20;
  modelica_integer tmp21;
  modelica_integer tmp22;
  modelica_integer tmp23;
  modelica_integer tmp24;
  modelica_integer tmp25;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _R = _A;
  _b = _ib;
  _oeqns = _ieqns;
  _ovars = _ivars;
  _oshared = _ishared;
  _cA = arrayCreate(_n, _OMC_LIT8);
  _v = arrayCreate(_n, _OMC_LIT8);
  // _alpha has no default value.
  // _y1 has no default value.
  // _h has no default value.
  // _h2 has no default value.
  // _e1 has no default value.
  // _e2 has no default value.
  // _e has no default value.
  // _m has no default value.
  _nn = ((modelica_integer) -1) + _n;
  _idxVars = ((modelica_integer) 1);
  // _shift has no default value.
  tmp23 = ((modelica_integer) 1); tmp24 = 1; tmp25 = _nn;
  if(!(((tmp24 > 0) && (tmp23 > tmp25)) || ((tmp24 < 0) && (tmp23 < tmp25))))
  {
    modelica_integer _iter;
    for(_iter = ((modelica_integer) 1); in_range_integer(_iter, tmp23, tmp25); _iter += tmp24)
    {
      _m = ((modelica_integer) 1) + _n - _iter;

      omc_ResolveLoops_qrGet__cA(threadData, _A, _iter, ((modelica_integer) 1), _n, _v);

      _y1 = arrayGet(_v, ((modelica_integer) 1));

      _alpha = omc_ResolveLoops_qrCalc__alpha(threadData, _v, _y1, _m);

      tmpMeta1 = stringAppend(_OMC_LIT19,intString(_iter));
      _alpha = omc_BackendEquation_makeTmpEqnForExp(threadData, _alpha, tmpMeta1, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      _e = omc_Expression_expAdd(threadData, _y1, _alpha);

      tmpMeta2 = stringAppend(_OMC_LIT20,intString(_iter));
      _e = omc_BackendEquation_makeTmpEqnForExp(threadData, _e, tmpMeta2, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_v, ((modelica_integer) 1), _e);

      _h = omc_Expression_expAdd(threadData, _y1, _alpha);

      _h = omc_Expression_expMul(threadData, _alpha, _h);

      _h = omc_Expression_negate(threadData, _h);

      tmpMeta3 = stringAppend(_OMC_LIT21,intString(_iter));
      _h = omc_BackendEquation_makeTmpEqnForExp(threadData, _h, tmpMeta3, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      _shift = (((modelica_integer) -1) + _iter) * (_n) + _iter;

      arrayUpdate(_R, _shift, omc_Expression_negate(threadData, _alpha));

      tmp4 = ((modelica_integer) 2); tmp5 = 1; tmp6 = _m;
      if(!(((tmp5 > 0) && (tmp4 > tmp6)) || ((tmp5 < 0) && (tmp4 < tmp6))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 2); in_range_integer(_j, tmp4, tmp6); _j += tmp5)
        {
          arrayUpdate(_R, _shift + (((modelica_integer) -1) + _j) * (_n), _OMC_LIT8);
        }
      }

      tmp12 = ((modelica_integer) 2); tmp13 = 1; tmp14 = _m;
      if(!(((tmp13 > 0) && (tmp12 > tmp14)) || ((tmp13 < 0) && (tmp12 < tmp14))))
      {
        modelica_integer _col;
        for(_col = ((modelica_integer) 2); in_range_integer(_col, tmp12, tmp14); _col += tmp13)
        {
          omc_ResolveLoops_qrGet__cA(threadData, _A, _iter, _col, _n, _cA);

          _h2 = omc_Expression_makeScalarProduct(threadData, _v, _cA);

          _h2 = omc_Expression_expDiv(threadData, _h2, _h);

          tmpMeta7 = stringAppend(_OMC_LIT22,intString(_idxVars));
          _h2 = omc_BackendEquation_makeTmpEqnForExp(threadData, _h2, tmpMeta7, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

          _idxVars = ((modelica_integer) 1) + _idxVars;

          tmp9 = ((modelica_integer) 1); tmp10 = 1; tmp11 = _m;
          if(!(((tmp10 > 0) && (tmp9 > tmp11)) || ((tmp10 < 0) && (tmp9 < tmp11))))
          {
            modelica_integer _j;
            for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp9, tmp11); _j += tmp10)
            {
              _e1 = arrayGet(_cA, _j);

              _e2 = arrayGet(_v, _j);

              _e = omc_Expression_expAdd(threadData, _e1, omc_Expression_expMul(threadData, _h2, _e2));

              tmpMeta8 = stringAppend(_OMC_LIT13,intString(_idxVars));
              _e = omc_BackendEquation_makeTmpEqnForExp(threadData, _e, tmpMeta8, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

              _idxVars = ((modelica_integer) 1) + _idxVars;

              arrayUpdate(_A, ((modelica_integer) -1) + _shift + (((modelica_integer) -1) + _j) * (_n) + _col, _e);
            }
          }
        }
      }

      tmp15 = ((modelica_integer) 1); tmp16 = 1; tmp17 = _m;
      if(!(((tmp16 > 0) && (tmp15 > tmp17)) || ((tmp16 < 0) && (tmp15 < tmp17))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp15, tmp17); _j += tmp16)
        {
          arrayUpdate(_cA, _j, arrayGet(_b, ((modelica_integer) -1) + _iter + _j));
        }
      }

      _h2 = omc_Expression_makeScalarProduct(threadData, _v, _cA);

      _h2 = omc_Expression_expDiv(threadData, _h2, _h);

      tmpMeta18 = stringAppend(_OMC_LIT23,intString(_idxVars));
      _h2 = omc_BackendEquation_makeTmpEqnForExp(threadData, _h2, tmpMeta18, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      _idxVars = ((modelica_integer) 1) + _idxVars;

      tmp20 = ((modelica_integer) 1); tmp21 = 1; tmp22 = _m;
      if(!(((tmp21 > 0) && (tmp20 > tmp22)) || ((tmp21 < 0) && (tmp20 < tmp22))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp20, tmp22); _j += tmp21)
        {
          _e1 = arrayGet(_cA, _j);

          _e2 = arrayGet(_v, _j);

          _e = omc_Expression_expAdd(threadData, _e1, omc_Expression_expMul(threadData, _h2, _e2));

          _e = omc_Expression_expand(threadData, _e);

          _e = omc_ExpressionSimplify_simplify2(threadData, _e, 1 /* true */, 1 /* true */);

          tmpMeta19 = stringAppend(_OMC_LIT24,intString(_idxVars));
          _e = omc_BackendEquation_makeTmpEqnForExp(threadData, _e, tmpMeta19, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

          _idxVars = ((modelica_integer) 1) + _idxVars;

          arrayUpdate(_b, ((modelica_integer) -1) + _iter + _j, _e);
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_b) { *out_b = _b; }
  if (out_oeqns) { *out_oeqns = _oeqns; }
  if (out_ovars) { *out_ovars = _ovars; }
  if (out_oshared) { *out_oshared = _oshared; }
  return _R;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_qrDecompositionHouseholder(threadData_t *threadData, modelica_metatype _A, modelica_metatype _n, modelica_metatype _ib, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_b, modelica_metatype *out_oeqns, modelica_metatype *out_ovars, modelica_metatype *out_oshared)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _R = NULL;
  tmp1 = mmc_unbox_integer(_n);
  tmp2 = mmc_unbox_integer(_offset);
  _R = omc_ResolveLoops_qrDecompositionHouseholder(threadData, _A, tmp1, _ib, _ieqns, _ivars, tmp2, _ishared, out_b, out_oeqns, out_ovars, out_oshared);
  /* skip box _R; array<DAE.Exp> */
  /* skip box _b; array<DAE.Exp> */
  /* skip box _oeqns; ExpandableArray<BackendDAE.Equation> */
  /* skip box _ovars; BackendDAE.Variables */
  /* skip box _oshared; BackendDAE.Shared */
  return _R;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem4(threadData_t *threadData, modelica_metatype _b_lst, modelica_metatype _jac, modelica_metatype _cr_x, modelica_metatype _var_lst, modelica_integer _n, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_integer _offset, modelica_metatype _ishared, modelica_metatype *out_ovars, modelica_integer *out_offset_, modelica_metatype *out_oshared)
{
  modelica_metatype _oeqns = NULL;
  modelica_metatype _ovars = NULL;
  modelica_integer _offset_;
  modelica_metatype _oshared = NULL;
  modelica_metatype _R = NULL;
  modelica_metatype _Qb = NULL;
  modelica_metatype _b = NULL;
  modelica_metatype _A = NULL;
  modelica_metatype _ax = NULL;
  modelica_metatype _scaled_x = NULL;
  modelica_metatype _scaleA = NULL;
  modelica_metatype _a = NULL;
  modelica_metatype _x = NULL;
  modelica_integer _m;
  modelica_integer _ii;
  modelica_integer _jj;
  modelica_integer _mm;
  modelica_metatype _x_lst = NULL;
  modelica_metatype _cr = NULL;
  modelica_metatype _X = NULL;
  modelica_metatype _detA = NULL;
  modelica_metatype _detAb = NULL;
  modelica_metatype _tmpvar = NULL;
  modelica_string _name = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _var = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype _jac_ = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_metatype tmpMeta6;
  modelica_integer tmp7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_integer tmp11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  modelica_metatype tmpMeta14;
  modelica_integer tmp20;
  modelica_integer tmp21;
  modelica_integer tmp22;
  modelica_metatype tmpMeta23;
  modelica_integer tmp24;
  modelica_integer tmp25;
  modelica_integer tmp26;
  modelica_integer tmp27;
  modelica_integer tmp28;
  modelica_integer tmp29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  modelica_metatype tmpMeta33;
  modelica_metatype tmpMeta34;
  modelica_metatype tmpMeta35;
  modelica_metatype tmpMeta36;
  modelica_metatype tmpMeta37;
  modelica_metatype tmpMeta38;
  modelica_integer tmp39;
  modelica_integer tmp40;
  modelica_integer tmp41;
  modelica_metatype tmpMeta42;
  modelica_metatype tmpMeta48;
  modelica_integer tmp49;
  modelica_integer tmp50;
  modelica_integer tmp51;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _oeqns = _ieqns;
  _ovars = _ivars;
  _offset_ = ((modelica_integer) 1) + _offset;
  _oshared = _ishared;
  // _R has no default value.
  _Qb = arrayCreate(_n, _OMC_LIT8);
  _b = arrayCreate(_n, _OMC_LIT8);
  _A = arrayCreate((_n) * (_n), _OMC_LIT8);
  _ax = arrayCreate(_n, _OMC_LIT8);
  _scaled_x = arrayCreate(_n, _OMC_LIT8);
  _scaleA = arrayCreate(_n, _OMC_LIT8);
  // _a has no default value.
  // _x has no default value.
  // _m has no default value.
  // _ii has no default value.
  // _jj has no default value.
  // _mm has no default value.
  _x_lst = omc_List_map(threadData, _cr_x, boxvar_Expression_crefExp);
  // _cr has no default value.
  _X = _cr_x;
  // _detA has no default value.
  // _detAb has no default value.
  // _tmpvar has no default value.
  // _name has no default value.
  _vars = _var_lst;
  // _var has no default value.
  // _eqn has no default value.
  _jac_ = _jac;
  _mm = listLength(_jac);

  tmp11 = ((modelica_integer) 1); tmp12 = 1; tmp13 = _mm;
  if(!(((tmp12 > 0) && (tmp11 > tmp13)) || ((tmp12 < 0) && (tmp11 < tmp13))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp11, tmp13); _i += tmp12)
    {
      /* Pattern-matching assignment */
      tmpMeta1 = _jac_;
      if (listEmpty(tmpMeta1)) MMC_THROW_INTERNAL();
      tmpMeta2 = MMC_CAR(tmpMeta1);
      tmpMeta3 = MMC_CDR(tmpMeta1);
      tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 1));
      tmp5 = mmc_unbox_integer(tmpMeta4);
      tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 2));
      tmp7 = mmc_unbox_integer(tmpMeta6);
      tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 3));
      if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,3,3) == 0) MMC_THROW_INTERNAL();
      tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
      _jj = tmp5  /* pattern as ty=Integer */;
      _ii = tmp7  /* pattern as ty=Integer */;
      _a = tmpMeta9;
      _jac_ = tmpMeta3;

      _m = _ii + (((modelica_integer) -1) + _jj) * (_n);

      tmpMeta10 = stringAppend(_OMC_LIT25,intString(_m));
      _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta10, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_A, _m, _a);
    }
  }

  tmp20 = ((modelica_integer) 1); tmp21 = 1; tmp22 = _n;
  if(!(((tmp21 > 0) && (tmp20 > tmp22)) || ((tmp21 < 0) && (tmp20 < tmp22))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp20, tmp22); _i += tmp21)
    {
      _m = (((modelica_integer) -1) + _i) * (_n);

      {
        modelica_metatype __omcQ_24tmpVar3;
        modelica_metatype* tmp15;
        modelica_metatype tmpMeta16;
        modelica_metatype __omcQ_24tmpVar2;
        modelica_integer tmp17;
        modelica_integer tmp18;
        modelica_integer tmp19;
        modelica_integer _j;
        tmp18 = 1 /* Range step-value */;
        tmp19 = _n /* Range stop-value */;
        _j = ((modelica_integer) 1) /* Range start-value */;
        _j = (((modelica_integer) 1) /* Range start-value */)-tmp18;
        tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
        __omcQ_24tmpVar3 = tmpMeta16; /* defaultValue */
        tmp15 = &__omcQ_24tmpVar3;
        while(1) {
          tmp17 = 1;
          if (tmp18 > 0 ? _j+tmp18 <= tmp19 : _j+tmp18 >= tmp19) {
            _j += tmp18;
            tmp17--;
          }
          if (tmp17 == 0) {
            __omcQ_24tmpVar2 = omc_Expression_makeAbs(threadData, arrayGet(_A, _m + _j));
            *tmp15 = mmc_mk_cons(__omcQ_24tmpVar2,0);
            tmp15 = &MMC_CDR(*tmp15);
          } else if (tmp17 == 1) {
            break;
          } else {
            MMC_THROW_INTERNAL();
          }
        }
        *tmp15 = mmc_mk_nil();
        tmpMeta14 = __omcQ_24tmpVar3;
      }
      _a = omc_Expression_makeSum1(threadData, tmpMeta14, 0 /* false */);

      arrayUpdate(_scaleA, _i, _a);
    }
  }

  tmp27 = ((modelica_integer) 1); tmp28 = 1; tmp29 = _n;
  if(!(((tmp28 > 0) && (tmp27 > tmp29)) || ((tmp28 < 0) && (tmp27 < tmp29))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp27, tmp29); _i += tmp28)
    {
      _m = (((modelica_integer) -1) + _i) * (_n);

      tmp24 = ((modelica_integer) 1); tmp25 = 1; tmp26 = _n;
      if(!(((tmp25 > 0) && (tmp24 > tmp26)) || ((tmp25 < 0) && (tmp24 < tmp26))))
      {
        modelica_integer _j;
        for(_j = ((modelica_integer) 1); in_range_integer(_j, tmp24, tmp26); _j += tmp25)
        {
          _a = arrayGet(_A, _j + _m);

          if((!omc_Expression_isZero(threadData, _a)))
          {
            _a = omc_Expression_expDiv(threadData, _a, arrayGet(_scaleA, _j));

            tmpMeta23 = stringAppend(_OMC_LIT26,intString(_i + (((modelica_integer) -1) + _j) * (_n)));
            _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta23, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

            arrayUpdate(_A, _j + _m, _a);
          }
        }
      }
    }
  }

  _m = ((modelica_integer) 1);

  {
    modelica_metatype _b_;
    for (tmpMeta30 = _b_lst; !listEmpty(tmpMeta30); tmpMeta30=MMC_CDR(tmpMeta30))
    {
      _b_ = MMC_CAR(tmpMeta30);
      tmpMeta31 = stringAppend(_OMC_LIT24,intString(_m));
      _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _b_, tmpMeta31, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_b, _m, _a);

      _m = ((modelica_integer) 1) + _m;
    }
  }

  _m = ((modelica_integer) 1);

  {
    modelica_metatype _xx;
    for (tmpMeta33 = _x_lst; !listEmpty(tmpMeta33); tmpMeta33=MMC_CDR(tmpMeta33))
    {
      _xx = MMC_CAR(tmpMeta33);
      /* Pattern-matching assignment */
      tmpMeta34 = _vars;
      if (listEmpty(tmpMeta34)) MMC_THROW_INTERNAL();
      tmpMeta35 = MMC_CAR(tmpMeta34);
      tmpMeta36 = MMC_CDR(tmpMeta34);
      _var = tmpMeta35;
      _vars = tmpMeta36;

      if(omc_BackendVariable_isStateVar(threadData, _var))
      {
        arrayUpdate(_ax, _m, omc_Expression_expDer(threadData, _xx));
      }
      else
      {
        arrayUpdate(_ax, _m, _xx);
      }

      _m = ((modelica_integer) 1) + _m;
    }
  }

  tmp39 = ((modelica_integer) 1); tmp40 = 1; tmp41 = _n;
  if(!(((tmp40 > 0) && (tmp39 > tmp41)) || ((tmp40 < 0) && (tmp39 < tmp41))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp39, tmp41); _i += tmp40)
    {
      _a = omc_Expression_expMul(threadData, arrayGet(_ax, _i), arrayGet(_scaleA, _i));

      tmpMeta38 = stringAppend(_OMC_LIT27,intString(_i));
      _a = omc_BackendEquation_makeTmpEqnForExp(threadData, _a, tmpMeta38, _offset, _oeqns, _ovars, _oshared, 0 /* false */ ,&_oeqns ,&_ovars ,&_oshared, NULL, NULL);

      arrayUpdate(_scaled_x, _i, _a);
    }
  }

  _R = omc_ResolveLoops_qrDecompositionHouseholder(threadData, _A, _n, _b, _oeqns, _ovars, _offset, _oshared ,&_Qb ,&_oeqns ,&_ovars ,&_oshared);

  tmp49 = _n; tmp50 = ((modelica_integer) -1); tmp51 = ((modelica_integer) 1);
  if(!(((tmp50 > 0) && (tmp49 > tmp51)) || ((tmp50 < 0) && (tmp49 < tmp51))))
  {
    modelica_integer _i;
    for(_i = _n; in_range_integer(_i, tmp49, tmp51); _i += tmp50)
    {
      _m = (((modelica_integer) -1) + _i) * (_n);

      {
        modelica_metatype __omcQ_24tmpVar5;
        modelica_metatype* tmp43;
        modelica_metatype tmpMeta44;
        modelica_metatype __omcQ_24tmpVar4;
        modelica_integer tmp45;
        modelica_integer tmp46;
        modelica_integer tmp47;
        modelica_integer _j;
        tmp46 = 1 /* Range step-value */;
        tmp47 = _n /* Range stop-value */;
        _j = _i /* Range start-value */;
        _j = (_i /* Range start-value */)-tmp46;
        tmpMeta44 = MMC_REFSTRUCTLIT(mmc_nil);
        __omcQ_24tmpVar5 = tmpMeta44; /* defaultValue */
        tmp43 = &__omcQ_24tmpVar5;
        while(1) {
          tmp45 = 1;
          if (tmp46 > 0 ? _j+tmp46 <= tmp47 : _j+tmp46 >= tmp47) {
            _j += tmp46;
            tmp45--;
          }
          if (tmp45 == 0) {
            __omcQ_24tmpVar4 = omc_Expression_expMul(threadData, arrayGet(_R, _m + _j), arrayGet(_scaled_x, _j));
            *tmp43 = mmc_mk_cons(__omcQ_24tmpVar4,0);
            tmp43 = &MMC_CDR(*tmp43);
          } else if (tmp45 == 1) {
            break;
          } else {
            MMC_THROW_INTERNAL();
          }
        }
        *tmp43 = mmc_mk_nil();
        tmpMeta42 = __omcQ_24tmpVar5;
      }
      _a = omc_Expression_makeSum1(threadData, tmpMeta42, 0 /* false */);

      tmpMeta48 = mmc_mk_box5(3, &BackendDAE_Equation_EQUATION__desc, _a, arrayGet(_Qb, _i), _OMC_LIT31, _OMC_LIT34);
      _eqn = tmpMeta48;

      _eqn = omc_BackendEquation_solveEquation(threadData, _eqn, arrayGet(_scaled_x, _i), mmc_mk_none());

      _oeqns = omc_BackendEquation_add(threadData, _eqn, _oeqns);
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_ovars) { *out_ovars = _ovars; }
  if (out_offset_) { *out_offset_ = _offset_; }
  if (out_oshared) { *out_oshared = _oshared; }
  return _oeqns;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem4(threadData_t *threadData, modelica_metatype _b_lst, modelica_metatype _jac, modelica_metatype _cr_x, modelica_metatype _var_lst, modelica_metatype _n, modelica_metatype _ieqns, modelica_metatype _ivars, modelica_metatype _offset, modelica_metatype _ishared, modelica_metatype *out_ovars, modelica_metatype *out_offset_, modelica_metatype *out_oshared)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer _offset_;
  modelica_metatype _oeqns = NULL;
  tmp1 = mmc_unbox_integer(_n);
  tmp2 = mmc_unbox_integer(_offset);
  _oeqns = omc_ResolveLoops_solveLinearSystem4(threadData, _b_lst, _jac, _cr_x, _var_lst, tmp1, _ieqns, _ivars, tmp2, _ishared, out_ovars, &_offset_, out_oshared);
  /* skip box _oeqns; ExpandableArray<BackendDAE.Equation> */
  /* skip box _ovars; BackendDAE.Variables */
  if (out_offset_) { *out_offset_ = mmc_mk_icon(_offset_); }
  /* skip box _oshared; BackendDAE.Shared */
  return _oeqns;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem3(threadData_t *threadData, modelica_metatype _inSyst, modelica_metatype _ishared, modelica_metatype _eqn_lst, modelica_metatype _eqn_indxs, modelica_metatype _var_lst, modelica_metatype _var_indxs, modelica_metatype _jac, modelica_integer _offset, modelica_metatype *out_oshared, modelica_integer *out_offset_)
{
  modelica_metatype _osyst = NULL;
  modelica_metatype _oshared = NULL;
  modelica_integer _offset_;
  modelica_integer tmp1_c2 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _osyst has no default value.
  // _oshared has no default value.
  // _offset_ has no default value.
  
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _inSyst;
    tmp4_2 = _ishared;
    {
      modelica_metatype _vars = NULL;
      modelica_metatype _eqns = NULL;
      modelica_metatype _beqs = NULL;
      modelica_metatype _names = NULL;
      modelica_metatype _funcs = NULL;
      modelica_metatype _shared = NULL;
      modelica_metatype _syst = NULL;
      modelica_integer _n;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _vars has no default value.
      // _eqns has no default value.
      // _beqs has no default value.
      // _names has no default value.
      // _funcs has no default value.
      // _shared has no default value.
      // _syst has no default value.
      // _n has no default value.
      tmp4 = 0;
      for (; tmp4 < 1; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 12));
          
          _syst = tmp4_1;
          _vars = tmpMeta6;
          _eqns = tmpMeta7;
          _shared = tmp4_2;
          _funcs = tmpMeta8;
          /* Pattern matching succeeded */
          _beqs = omc_BackendDAEUtil_getEqnSysRhs(threadData, omc_BackendEquation_listEquation(threadData, _eqn_lst), omc_BackendVariable_listVar1(threadData, _var_lst), mmc_mk_some(_funcs), NULL);

          _beqs = listReverse(_beqs);

          _n = listLength(_beqs);

          _names = omc_List_map(threadData, _var_lst, boxvar_BackendVariable_varCref);

          _eqns = omc_ResolveLoops_solveLinearSystem4(threadData, _beqs, _jac, _names, _var_lst, _n, _eqns, _vars, _offset, _shared ,&_vars ,&_n ,&_shared);

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_syst), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[2] = _vars;
          _syst = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_syst), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[3] = _eqns;
          _syst = tmpMeta10;

          _syst = omc_BackendDAEUtil_setEqSystMatrices(threadData, _syst, mmc_mk_none(), mmc_mk_none(), mmc_mk_none());
          tmpMeta[0+0] = _syst;
          tmpMeta[0+1] = _shared;
          tmp1_c2 = _n;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _osyst = tmpMeta[0+0];
  _oshared = tmpMeta[0+1];
  _offset_ = tmp1_c2;
  _return: OMC_LABEL_UNUSED
  if (out_oshared) { *out_oshared = _oshared; }
  if (out_offset_) { *out_offset_ = _offset_; }
  return _osyst;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem3(threadData_t *threadData, modelica_metatype _inSyst, modelica_metatype _ishared, modelica_metatype _eqn_lst, modelica_metatype _eqn_indxs, modelica_metatype _var_lst, modelica_metatype _var_indxs, modelica_metatype _jac, modelica_metatype _offset, modelica_metatype *out_oshared, modelica_metatype *out_offset_)
{
  modelica_integer tmp1;
  modelica_integer _offset_;
  modelica_metatype _osyst = NULL;
  tmp1 = mmc_unbox_integer(_offset);
  _osyst = omc_ResolveLoops_solveLinearSystem3(threadData, _inSyst, _ishared, _eqn_lst, _eqn_indxs, _var_lst, _var_indxs, _jac, tmp1, out_oshared, &_offset_);
  /* skip box _osyst; BackendDAE.EqSystem */
  /* skip box _oshared; BackendDAE.Shared */
  if (out_offset_) { *out_offset_ = mmc_mk_icon(_offset_); }
  return _osyst;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem2(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _comp, modelica_metatype _ii, modelica_integer _offset, modelica_integer _maxSize, modelica_metatype *out_oshared, modelica_boolean *out_outRunMatching, modelica_metatype *out_oi, modelica_integer *out_offset_)
{
  modelica_metatype _osyst = NULL;
  modelica_metatype _oshared = NULL;
  modelica_boolean _outRunMatching;
  modelica_metatype _oi = NULL;
  modelica_integer _offset_;
  modelica_boolean tmp1_c2 __attribute__((unused)) = 0;
  modelica_integer tmp1_c4 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _osyst has no default value.
  // _oshared has no default value.
  // _outRunMatching has no default value.
  // _oi has no default value.
  // _offset_ has no default value.
  
  
  
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;volatile modelica_metatype tmp4_3;
    tmp4_1 = _isyst;
    tmp4_2 = _ishared;
    tmp4_3 = _comp;
    {
      modelica_metatype _vars = NULL;
      modelica_metatype _eqns = NULL;
      modelica_metatype _eqn_lst = NULL;
      modelica_metatype _var_lst = NULL;
      modelica_metatype _eindex = NULL;
      modelica_metatype _vindx = NULL;
      modelica_metatype _jac = NULL;
      modelica_metatype _syst = NULL;
      modelica_metatype _shared = NULL;
      modelica_integer _toffset;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _vars has no default value.
      // _eqns has no default value.
      // _eqn_lst has no default value.
      // _var_lst has no default value.
      // _eindex has no default value.
      // _vindx has no default value.
      // _jac has no default value.
      // _syst has no default value.
      // _shared has no default value.
      // _toffset has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_boolean tmp14;
          modelica_metatype tmpMeta15;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_3,1,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 3));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,0,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
          if (optionNone(tmpMeta9)) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 1));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_3), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,1,0) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _eindex = tmpMeta6;
          _vindx = tmpMeta7;
          _jac = tmpMeta10;
          _syst = tmp4_1;
          _vars = tmpMeta12;
          _eqns = tmpMeta13;
          _shared = tmp4_2;
          /* Pattern matching succeeded */
          _eqn_lst = omc_BackendEquation_getList(threadData, _eindex, _eqns);

          _var_lst = omc_List_map1r(threadData, _vindx, boxvar_BackendVariable_getVarAt, _vars);

          /* Pattern-matching assignment */
          tmp14 = (listLength(_var_lst) <= _maxSize);
          if (1 /* true */ != tmp14) goto goto_2;

          /* Pattern-matching tuple assignment */
          tmpMeta15 = omc_List_splitOnTrue(threadData, _var_lst, boxvar_BackendVariable_isStateVar, NULL);
          if (!listEmpty(tmpMeta15)) goto goto_2;

          _syst = omc_ResolveLoops_solveLinearSystem3(threadData, _syst, _shared, _eqn_lst, _eindex, _var_lst, _vindx, _jac, _offset ,&_shared ,&_toffset);
          tmpMeta[0+0] = _syst;
          tmpMeta[0+1] = _shared;
          tmp1_c2 = 1 /* true */;
          tmpMeta[0+3] = listAppend(_eindex, _ii);
          tmp1_c4 = _toffset;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _isyst;
          tmpMeta[0+1] = _ishared;
          tmp1_c2 = 0 /* false */;
          tmpMeta[0+3] = _ii;
          tmp1_c4 = _offset;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _osyst = tmpMeta[0+0];
  _oshared = tmpMeta[0+1];
  _outRunMatching = tmp1_c2;
  _oi = tmpMeta[0+3];
  _offset_ = tmp1_c4;
  _return: OMC_LABEL_UNUSED
  if (out_oshared) { *out_oshared = _oshared; }
  if (out_outRunMatching) { *out_outRunMatching = _outRunMatching; }
  if (out_oi) { *out_oi = _oi; }
  if (out_offset_) { *out_offset_ = _offset_; }
  return _osyst;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_solveLinearSystem2(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _comp, modelica_metatype _ii, modelica_metatype _offset, modelica_metatype _maxSize, modelica_metatype *out_oshared, modelica_metatype *out_outRunMatching, modelica_metatype *out_oi, modelica_metatype *out_offset_)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_boolean _outRunMatching;
  modelica_integer _offset_;
  modelica_metatype _osyst = NULL;
  tmp1 = mmc_unbox_integer(_offset);
  tmp2 = mmc_unbox_integer(_maxSize);
  _osyst = omc_ResolveLoops_solveLinearSystem2(threadData, _isyst, _ishared, _comp, _ii, tmp1, tmp2, out_oshared, &_outRunMatching, out_oi, &_offset_);
  /* skip box _osyst; BackendDAE.EqSystem */
  /* skip box _oshared; BackendDAE.Shared */
  if (out_outRunMatching) { *out_outRunMatching = mmc_mk_icon(_outRunMatching); }
  /* skip box _oi; list<#Integer> */
  if (out_offset_) { *out_offset_ = mmc_mk_icon(_offset_); }
  return _osyst;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem1(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _ishared, modelica_metatype _inComps, modelica_metatype _inTpl, modelica_metatype *out_oshared, modelica_metatype *out_outTpl)
{
  modelica_metatype _osyst = NULL;
  modelica_metatype _oshared = NULL;
  modelica_metatype _outTpl = NULL;
  modelica_boolean _b;
  modelica_boolean _runMatching;
  modelica_metatype _ii = NULL;
  modelica_metatype tmpMeta1;
  modelica_integer _offset;
  modelica_integer _maxSize;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  modelica_metatype tmpMeta5;
  modelica_integer tmp6;
  modelica_metatype tmpMeta7;
  modelica_integer tmp8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _osyst = _isyst;
  _oshared = _ishared;
  // _outTpl has no default value.
  // _b has no default value.
  // _runMatching has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _ii = tmpMeta1;
  // _offset has no default value.
  // _maxSize has no default value.
  /* Pattern-matching assignment */
  tmpMeta2 = _inTpl;
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 1));
  tmp4 = mmc_unbox_integer(tmpMeta3);
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 2));
  tmp6 = mmc_unbox_integer(tmpMeta5);
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 3));
  tmp8 = mmc_unbox_integer(tmpMeta7);
  _runMatching = tmp4  /* pattern as ty=Boolean */;
  _offset = tmp6  /* pattern as ty=Integer */;
  _maxSize = tmp8  /* pattern as ty=Integer */;

  {
    modelica_metatype _comp;
    for (tmpMeta9 = _inComps; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
    {
      _comp = MMC_CAR(tmpMeta9);
      _osyst = omc_ResolveLoops_solveLinearSystem2(threadData, _osyst, _oshared, _comp, _ii, _offset, _maxSize ,&_oshared ,&_b ,&_ii ,&_offset);

      _runMatching = (_runMatching || _b);
    }
  }

  tmpMeta11 = mmc_mk_box3(0, mmc_mk_boolean(_runMatching), mmc_mk_integer(_offset), mmc_mk_integer(_maxSize));
  _outTpl = tmpMeta11;

  if(_runMatching)
  {
    { /* match expression */
      modelica_metatype tmp15_1;
      tmp15_1 = _osyst;
      {
        modelica_metatype _vars = NULL;
        modelica_metatype _eqns = NULL;
        modelica_metatype _syst = NULL;
        volatile mmc_switch_type tmp15;
        int tmp16;
        // _vars has no default value.
        // _eqns has no default value.
        // _syst has no default value.
        tmp15 = 0;
        for (; tmp15 < 1; tmp15++) {
          switch (MMC_SWITCH_CAST(tmp15)) {
          case 0: {
            modelica_metatype tmpMeta17;
            modelica_metatype tmpMeta18;
            modelica_metatype tmpMeta19;
            modelica_metatype tmpMeta20;
            tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp15_1), 2));
            tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp15_1), 3));
            
            _syst = tmp15_1;
            _vars = tmpMeta17;
            _eqns = tmpMeta18;
            /* Pattern matching succeeded */
            _eqns = omc_List_fold(threadData, _ii, boxvar_BackendEquation_delete, _eqns);

            tmpMeta19 = MMC_TAGPTR(mmc_alloc_words(11));
            memcpy(MMC_UNTAGPTR(tmpMeta19), MMC_UNTAGPTR(_syst), 11*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta19))[2] = omc_BackendVariable_listVar1(threadData, omc_BackendVariable_varList(threadData, _vars));
            _syst = tmpMeta19;

            tmpMeta20 = MMC_TAGPTR(mmc_alloc_words(11));
            memcpy(MMC_UNTAGPTR(tmpMeta20), MMC_UNTAGPTR(_syst), 11*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta20))[3] = omc_BackendEquation_listEquation(threadData, omc_BackendEquation_equationList(threadData, _eqns));
            _syst = tmpMeta20;
            tmpMeta12 = omc_BackendDAEUtil_clearEqSyst(threadData, _syst);
            goto tmp14_done;
          }
          }
          goto tmp14_end;
          tmp14_end: ;
        }
        goto goto_13;
        goto_13:;
        MMC_THROW_INTERNAL();
        goto tmp14_done;
        tmp14_done:;
      }
    }
    _osyst = tmpMeta12;
  }
  _return: OMC_LABEL_UNUSED
  if (out_oshared) { *out_oshared = _oshared; }
  if (out_outTpl) { *out_outTpl = _outTpl; }
  return _osyst;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_solveLinearSystem0(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _inShared, modelica_metatype _inTpl, modelica_metatype *out_outShared, modelica_metatype *out_outTpl)
{
  modelica_metatype _osyst = NULL;
  modelica_metatype _outShared = NULL;
  modelica_metatype _outTpl = NULL;
  modelica_metatype _comps = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _osyst has no default value.
  // _outShared has no default value.
  // _outTpl has no default value.
  // _comps has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _isyst;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 7));
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta2,1,3) == 0) MMC_THROW_INTERNAL();
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 4));
  _comps = tmpMeta3;

  _osyst = omc_ResolveLoops_solveLinearSystem1(threadData, _isyst, _inShared, _comps, _inTpl ,&_outShared ,&_outTpl);
  _return: OMC_LABEL_UNUSED
  if (out_outShared) { *out_outShared = _outShared; }
  if (out_outTpl) { *out_outTpl = _outTpl; }
  return _osyst;
}

DLLDirection
modelica_metatype omc_ResolveLoops_solveLinearSystem(threadData_t *threadData, modelica_metatype _inDAE)
{
  modelica_metatype _outDAE = NULL;
  modelica_integer _maxSize;
  modelica_boolean _b;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outDAE has no default value.
  _maxSize = omc_Flags_getConfigInt(threadData, _OMC_LIT40);
  _b = (((modelica_integer) 1) < _maxSize);
  if(_b)
  {
    tmpMeta1 = mmc_mk_box3(0, mmc_mk_boolean(0 /* false */), mmc_mk_integer(((modelica_integer) 1)), mmc_mk_integer(_maxSize));
    _outDAE = omc_BackendDAEUtil_mapEqSystemAndFold(threadData, _inDAE, boxvar_ResolveLoops_solveLinearSystem0, tmpMeta1, NULL);
  }
  else
  {
    _outDAE = _inDAE;
  }
  _return: OMC_LABEL_UNUSED
  return _outDAE;
}

DLLDirection
modelica_metatype omc_ResolveLoops_resolveEquations(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _loopIn, modelica_metatype _me, modelica_metatype _meT, modelica_metatype _eqsIn, modelica_metatype _varsIn)
{
  modelica_metatype _eqOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _eq;
    tmp4_2 = _loopIn;
    {
      modelica_integer _startEq;
      modelica_integer _nextEq;
      modelica_integer _sharedVar;
      modelica_metatype _rest = NULL;
      modelica_metatype _vars1 = NULL;
      modelica_metatype _vars2 = NULL;
      modelica_metatype _numEqs = NULL;
      modelica_metatype _eq1 = NULL;
      modelica_metatype _eq2 = NULL;
      modelica_metatype _var = NULL;
      modelica_metatype _attr = NULL;
      modelica_metatype _lhs1 = NULL;
      modelica_metatype _lhs2 = NULL;
      modelica_metatype _rhs1 = NULL;
      modelica_metatype _rhs2 = NULL;
      modelica_metatype _varExp = NULL;
      modelica_metatype _eqExp = NULL;
      modelica_metatype _source = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _startEq has no default value.
      // _nextEq has no default value.
      // _sharedVar has no default value.
      // _rest has no default value.
      // _vars1 has no default value.
      // _vars2 has no default value.
      // _numEqs has no default value.
      // _eq1 has no default value.
      // _eq2 has no default value.
      // _var has no default value.
      // _attr has no default value.
      // _lhs1 has no default value.
      // _lhs2 has no default value.
      // _rhs1 has no default value.
      // _rhs2 has no default value.
      // _varExp has no default value.
      // _eqExp has no default value.
      // _source has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          _eq1 = tmpMeta6;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta1 = _eq1;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          if (!optionNone(tmp4_1)) goto tmp3_end;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta7 = MMC_CAR(tmp4_2);
          tmpMeta8 = MMC_CDR(tmp4_2);
          tmp9 = mmc_unbox_integer(tmpMeta7);
          _startEq = tmp9  /* pattern as ty=Integer */;
          _rest = tmpMeta8;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta10 = _rest;
          if (listEmpty(tmpMeta10)) goto goto_2;
          tmpMeta11 = MMC_CAR(tmpMeta10);
          tmpMeta12 = MMC_CDR(tmpMeta10);
          tmp13 = mmc_unbox_integer(tmpMeta11);
          _nextEq = tmp13  /* pattern as ty=Integer */;
          _rest = tmpMeta12;

          _vars1 = omc_List_map(threadData, arrayGet(_me, _startEq), boxvar_Util_tuple31);

          _vars2 = omc_List_map(threadData, arrayGet(_me, _nextEq), boxvar_Util_tuple31);

          _vars1 = omc_List_intersectionOnTrue(threadData, _vars1, _vars2, boxvar_intEq);

          _numEqs = omc_List_map(threadData, omc_List_map1(threadData, _vars1, boxvar_Array_getIndexFirst, _meT), boxvar_listLength);

          omc_List_filter1OnTrueSync(threadData, _numEqs, boxvar_intEq, mmc_mk_integer(((modelica_integer) 2)), _vars1 ,&_vars1);

          _sharedVar = mmc_unbox_integer(listHead(_vars1));

          _eq1 = listGet(_eqsIn, _startEq);

          _eq2 = listGet(_eqsIn, _nextEq);

          _var = listGet(_varsIn, _sharedVar);

          _varExp = omc_Expression_crefExp(threadData, omc_BackendVariable_varCref(threadData, _var));

          /* Pattern-matching assignment */
          tmpMeta14 = _eq1;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,0,4) == 0) goto goto_2;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 2));
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 3));
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 4));
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 5));
          _lhs1 = tmpMeta15;
          _rhs1 = tmpMeta16;
          _source = tmpMeta17;
          _attr = tmpMeta18;

          /* Pattern-matching assignment */
          tmpMeta19 = _eq2;
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta19,0,4) == 0) goto goto_2;
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta19), 2));
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta19), 3));
          _lhs2 = tmpMeta20;
          _rhs2 = tmpMeta21;

          _eqExp = omc_ExpressionSolve_solve(threadData, _lhs1, _rhs1, _varExp, mmc_mk_none(), NULL);

          /* Pattern-matching assignment */
          tmpMeta22 = omc_Expression_replaceExp(threadData, _lhs2, _varExp, _eqExp);
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta22), 1));
          _lhs2 = tmpMeta23;

          /* Pattern-matching assignment */
          tmpMeta24 = omc_Expression_replaceExp(threadData, _rhs2, _varExp, _eqExp);
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta24), 1));
          _rhs2 = tmpMeta25;

          _lhs2 = omc_ExpressionSimplify_simplify(threadData, _lhs2, NULL);

          _rhs2 = omc_ExpressionSimplify_simplify(threadData, _rhs2, NULL);

          tmpMeta26 = mmc_mk_box5(3, &BackendDAE_Equation_EQUATION__desc, _lhs2, _rhs2, _source, _attr);
          _eq2 = tmpMeta26;
          tmpMeta1 = omc_ResolveLoops_resolveEquations(threadData, mmc_mk_some(_eq2), _rest, _me, _meT, _eqsIn, _varsIn);
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          fputs(MMC_STRINGDATA(_OMC_LIT41),stdout);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _eqOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_isSolvable(threadData_t *threadData, modelica_metatype _entry)
{
  modelica_boolean _solvable;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _solvable has no default value.
  tmpMeta1 = mmc_mk_cons(_entry, MMC_REFSTRUCTLIT(mmc_nil));
  _solvable = (!omc_Tearing_unsolvable(threadData, tmpMeta1));
  _return: OMC_LABEL_UNUSED
  return _solvable;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_isSolvable(threadData_t *threadData, modelica_metatype _entry)
{
  modelica_boolean _solvable;
  modelica_metatype out_solvable;
  _solvable = omc_ResolveLoops_isSolvable(threadData, _entry);
  out_solvable = mmc_mk_icon(_solvable);
  return out_solvable;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_getDoublicates2(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arr)
{
  modelica_integer _entry;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _entry has no default value.
  _entry = mmc_unbox_integer(arrayGet(_arr, _idx));

  arrayUpdate(_arr, _idx, mmc_mk_integer(((modelica_integer) 1) + _entry));
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_getDoublicates2(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arr)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_idx);
  omc_ResolveLoops_getDoublicates2(threadData, tmp1, _arr);
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getDoublicates(threadData_t *threadData, modelica_metatype _lstIn)
{
  modelica_metatype _lstOut = NULL;
  modelica_integer _max;
  modelica_metatype _arr = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lstOut has no default value.
  // _max has no default value.
  // _arr has no default value.
  _max = mmc_unbox_integer(omc_List_fold(threadData, _lstIn, boxvar_intMax, listHead(_lstIn)));

  _arr = arrayCreate(_max, mmc_mk_integer(((modelica_integer) -1)));

  omc_List_map1__0(threadData, _lstIn, boxvar_ResolveLoops_getDoublicates2, _arr);

  omc_List_filter1OnTrueSync(threadData, arrayList(_arr), boxvar_intGe, mmc_mk_integer(((modelica_integer) 1)), omc_List_intRange(threadData, arrayLength(_arr)) ,&_lstOut);
  _return: OMC_LABEL_UNUSED
  return _lstOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_chooseEquation(threadData_t *threadData, modelica_metatype _row, modelica_metatype _meT)
{
  modelica_boolean _chooseThis;
  modelica_boolean _b1;
  modelica_boolean _b2;
  modelica_boolean _b3;
  modelica_metatype _vars = NULL;
  modelica_metatype _eqs = NULL;
  modelica_metatype _numEqs = NULL;
  modelica_metatype _eqLst = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _chooseThis has no default value.
  // _b1 has no default value.
  // _b2 has no default value.
  // _b3 has no default value.
  // _vars has no default value.
  // _eqs has no default value.
  // _numEqs has no default value.
  // _eqLst has no default value.
  _vars = omc_List_map(threadData, _row, boxvar_Util_tuple31);

  _b1 = (listLength(_row) == ((modelica_integer) 2));

  _eqLst = omc_List_mapList(threadData, omc_List_map1(threadData, _vars, boxvar_Array_getIndexFirst, _meT), boxvar_Util_tuple31);

  _numEqs = omc_List_map(threadData, _eqLst, boxvar_listLength);

  _b3 = mmc_unbox_boolean(omc_List_applyAndFold1(threadData, _numEqs, boxvar_boolOr, boxvar_intEq, mmc_mk_integer(((modelica_integer) 2)), mmc_mk_boolean(0 /* false */)));

  _eqs = omc_List_flatten(threadData, _eqLst);

  _b2 = (listLength(_eqs) == ((modelica_integer) 2) + listLength(omc_List_unique(threadData, _eqs)));

  _b1 = ((_b1 && _b2) && _b3);

  _chooseThis = (_b1 && mmc_unbox_boolean(omc_List_applyAndFold(threadData, _row, boxvar_boolAnd, boxvar_ResolveLoops_isSolvable, mmc_mk_boolean(1 /* true */))));
  _return: OMC_LABEL_UNUSED
  return _chooseThis;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_chooseEquation(threadData_t *threadData, modelica_metatype _row, modelica_metatype _meT)
{
  modelica_boolean _chooseThis;
  modelica_metatype out_chooseThis;
  _chooseThis = omc_ResolveLoops_chooseEquation(threadData, _row, _meT);
  out_chooseThis = mmc_mk_icon(_chooseThis);
  return out_chooseThis;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getEqPairs(threadData_t *threadData, modelica_integer _eq, modelica_metatype _me, modelica_metatype _meT)
{
  modelica_metatype _lstOut = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _eqs = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lstOut has no default value.
  // _vars has no default value.
  // _eqs has no default value.
  _vars = omc_List_map(threadData, arrayGet(_me, _eq), boxvar_Util_tuple31);

  _eqs = omc_List_map(threadData, omc_List_flatten(threadData, omc_List_map1(threadData, _vars, boxvar_Array_getIndexFirst, _meT)), boxvar_Util_tuple31);

  _eqs = omc_ResolveLoops_getDoublicates(threadData, _eqs);

  _lstOut = omc_List_consOnTrue(threadData, (!listMember(mmc_mk_integer(_eq), _eqs)), mmc_mk_integer(_eq), _eqs);
  _return: OMC_LABEL_UNUSED
  return _lstOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getEqPairs(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _me, modelica_metatype _meT)
{
  modelica_integer tmp1;
  modelica_metatype _lstOut = NULL;
  tmp1 = mmc_unbox_integer(_eq);
  _lstOut = omc_ResolveLoops_getEqPairs(threadData, tmp1, _me, _meT);
  /* skip box _lstOut; list<#Integer> */
  return _lstOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post4__resolveAndReplace(threadData_t *threadData, modelica_metatype _resolveEqLst, modelica_metatype _unassEqsIn, modelica_metatype _unassVarsIn, modelica_metatype _me, modelica_metatype _meT)
{
  modelica_metatype _unassEqsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _unassEqsOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _resolveEqLst;
    {
      modelica_integer _maxNum;
      modelica_integer _replEqIdx;
      modelica_metatype _numOfAdjVars = NULL;
      modelica_metatype _resolveEqs = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _unassEqs = NULL;
      modelica_metatype _resolvedEq = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _maxNum has no default value.
      // _replEqIdx has no default value.
      // _numOfAdjVars has no default value.
      // _resolveEqs has no default value.
      // _rest has no default value.
      // _unassEqs has no default value.
      // _resolvedEq has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta1 = _unassEqsIn;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _resolveEqs = tmpMeta6;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          _resolvedEq = omc_ResolveLoops_resolveEquations(threadData, mmc_mk_none(), _resolveEqs, _me, _meT, _unassEqsIn, _unassVarsIn);

          _numOfAdjVars = omc_List_map(threadData, omc_List_map1(threadData, _resolveEqs, boxvar_Array_getIndexFirst, _me), boxvar_listLength);

          _maxNum = mmc_unbox_integer(omc_List_fold(threadData, _numOfAdjVars, boxvar_intMax, listHead(_numOfAdjVars)));

          _replEqIdx = mmc_unbox_integer(listGet(_resolveEqs, omc_List_position(threadData, mmc_mk_integer(_maxNum), _numOfAdjVars)));

          _unassEqs = omc_List_replaceAt(threadData, _resolvedEq, _replEqIdx, _unassEqsIn);
          tmpMeta1 = omc_ResolveLoops_reshuffling__post4__resolveAndReplace(threadData, _rest, _unassEqs, _unassVarsIn, _me, _meT);
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          fputs(MMC_STRINGDATA(_OMC_LIT42),stdout);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _unassEqsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _unassEqsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post3__selectShuffleEqs(threadData_t *threadData, modelica_metatype _me, modelica_metatype _meT)
{
  modelica_metatype _resolveEqs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _resolveEqs has no default value.
  { /* matchcontinue expression */
    {
      modelica_metatype _bArr = NULL;
      modelica_metatype _suitableEqs = NULL;
      modelica_metatype _eqPairs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _bArr has no default value.
      // _suitableEqs has no default value.
      // _eqPairs has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          /* Pattern matching succeeded */
          _bArr = omc_Array_map1(threadData, _me, boxvar_ResolveLoops_chooseEquation, _meT);

          omc_List_filter1OnTrueSync(threadData, arrayList(_bArr), boxvar_boolEq, mmc_mk_boolean(1 /* true */), omc_List_intRange(threadData, arrayLength(_me)) ,&_suitableEqs);

          _eqPairs = omc_List_map2(threadData, _suitableEqs, boxvar_ResolveLoops_getEqPairs, _me, _meT);
          tmpMeta1 = omc_List_filterOnTrue(threadData, _eqPairs, boxvar_List_hasSeveralElements);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          /* Pattern matching succeeded */
          fputs(MMC_STRINGDATA(_OMC_LIT43),stdout);
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _resolveEqs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _resolveEqs;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post2(threadData_t *threadData, modelica_metatype _eqIdcs, modelica_metatype _varIdcs, modelica_metatype _dae, modelica_metatype _shared, modelica_metatype _ojac, modelica_metatype _jacType, modelica_boolean *out_outRunMatching)
{
  modelica_metatype _daeOut = NULL;
  modelica_boolean _outRunMatching;
  modelica_integer _size;
  modelica_metatype _resEqs = NULL;
  modelica_metatype _mapEqnIncRow = NULL;
  modelica_metatype _mapIncRowEqn = NULL;
  modelica_metatype _ass1 = NULL;
  modelica_metatype _ass2 = NULL;
  modelica_metatype _ass1Sys = NULL;
  modelica_metatype _ass2Sys = NULL;
  modelica_metatype _varAtts = NULL;
  modelica_metatype _eqAtts = NULL;
  modelica_metatype _eqs = NULL;
  modelica_metatype _replEqs = NULL;
  modelica_metatype _daeEqs = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _daeVars = NULL;
  modelica_metatype _subSys = NULL;
  modelica_metatype _me = NULL;
  modelica_metatype _me2 = NULL;
  modelica_metatype _meT = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype _funcs = NULL;
  modelica_metatype _eqLst = NULL;
  modelica_metatype _eqsInLst = NULL;
  modelica_metatype _varLst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _daeOut has no default value.
  // _outRunMatching has no default value.
  // _size has no default value.
  // _resEqs has no default value.
  // _mapEqnIncRow has no default value.
  // _mapIncRowEqn has no default value.
  // _ass1 has no default value.
  // _ass2 has no default value.
  // _ass1Sys has no default value.
  // _ass2Sys has no default value.
  // _varAtts has no default value.
  // _eqAtts has no default value.
  // _eqs has no default value.
  // _replEqs has no default value.
  // _daeEqs has no default value.
  // _vars has no default value.
  // _daeVars has no default value.
  // _subSys has no default value.
  // _me has no default value.
  // _me2 has no default value.
  // _meT has no default value.
  // _m has no default value.
  // _funcs has no default value.
  // _eqLst has no default value.
  // _eqsInLst has no default value.
  // _varLst has no default value.
  _size = listLength(_varIdcs);

  /* Pattern-matching assignment */
  tmpMeta1 = _dae;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 7));
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta4,1,3) == 0) MMC_THROW_INTERNAL();
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 2));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 3));
  _daeVars = tmpMeta2;
  _daeEqs = tmpMeta3;
  _ass1Sys = tmpMeta5;
  _ass2Sys = tmpMeta6;

  _funcs = omc_BackendDAEUtil_getFunctions(threadData, _shared);

  _eqLst = omc_BackendEquation_getList(threadData, _eqIdcs, _daeEqs);

  _eqs = omc_BackendEquation_listEquation(threadData, _eqLst);

  _varLst = omc_List_map1r(threadData, _varIdcs, boxvar_BackendVariable_getVarAt, _daeVars);

  _vars = omc_BackendVariable_listVar1(threadData, _varLst);

  tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
  _subSys = omc_BackendDAEUtil_createEqSystem(threadData, _vars, _eqs, tmpMeta7, _OMC_LIT44, omc_BackendEquation_emptyEqns(threadData));

  _me = omc_BackendDAEUtil_getAdjacencyMatrixEnhancedScalar(threadData, _subSys, _shared, 0 /* false */ ,&_meT ,NULL ,NULL);

  omc_BackendDAEUtil_getAdjacencyMatrixScalar(threadData, _subSys, _OMC_LIT45, mmc_mk_some(omc_BackendDAEUtil_getFunctions(threadData, _shared)), omc_BackendDAEUtil_isInitializationDAE(threadData, _shared) ,&_m ,NULL ,NULL ,NULL);

  _ass1 = arrayCreate(_size, mmc_mk_integer(((modelica_integer) -1)));

  _ass2 = arrayCreate(_size, mmc_mk_integer(((modelica_integer) -1)));

  _varAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), listLength(_varLst)), omc_List_map(threadData, _eqIdcs, boxvar_intString), boxvar_Util_makeTuple);

  _eqAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), listLength(_eqLst)), omc_List_map(threadData, _varIdcs, boxvar_intString), boxvar_Util_makeTuple);

  omc_BackendDump_dumpBipartiteGraphStrongComponent2(threadData, _vars, _eqs, _m, _varAtts, _eqAtts, _OMC_LIT46);

  _resEqs = omc_ResolveLoops_reshuffling__post3__selectShuffleEqs(threadData, _me, _meT);

  _eqsInLst = omc_ResolveLoops_reshuffling__post4__resolveAndReplace(threadData, _resEqs, _eqLst, _varLst, _me, _meT);

  _daeEqs = omc_List_threadFold(threadData, _eqIdcs, _eqsInLst, boxvar_BackendEquation_setAtIndexFirst, _daeEqs);

  _daeOut = omc_BackendDAEUtil_setEqSystEqs(threadData, _dae, _daeEqs);

  tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta9 = mmc_mk_box4(4, &BackendDAE_Matching_MATCHING__desc, _ass1Sys, _ass2Sys, tmpMeta8);
  _daeOut = omc_BackendDAEUtil_setEqSystMatching(threadData, _daeOut, tmpMeta9);

  _daeOut = omc_BackendDAEUtil_getAdjacencyMatrixScalar(threadData, _daeOut, _OMC_LIT47, mmc_mk_some(_funcs), omc_BackendDAEUtil_isInitializationDAE(threadData, _shared), NULL, NULL, NULL, NULL);

  _outRunMatching = 1 /* true */;
  _return: OMC_LABEL_UNUSED
  if (out_outRunMatching) { *out_outRunMatching = _outRunMatching; }
  return _daeOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_reshuffling__post2(threadData_t *threadData, modelica_metatype _eqIdcs, modelica_metatype _varIdcs, modelica_metatype _dae, modelica_metatype _shared, modelica_metatype _ojac, modelica_metatype _jacType, modelica_metatype *out_outRunMatching)
{
  modelica_boolean _outRunMatching;
  modelica_metatype _daeOut = NULL;
  _daeOut = omc_ResolveLoops_reshuffling__post2(threadData, _eqIdcs, _varIdcs, _dae, _shared, _ojac, _jacType, &_outRunMatching);
  /* skip box _daeOut; BackendDAE.EqSystem */
  if (out_outRunMatching) { *out_outRunMatching = mmc_mk_icon(_outRunMatching); }
  return _daeOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post1(threadData_t *threadData, modelica_metatype _compIn, modelica_metatype _shared, modelica_metatype _systIn)
{
  modelica_metatype _systOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _systOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _compIn;
    {
      modelica_metatype _vIdcs = NULL;
      modelica_metatype _eqIdcs = NULL;
      modelica_metatype _jacType = NULL;
      modelica_metatype _ojac = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _vIdcs has no default value.
      // _eqIdcs has no default value.
      // _jacType has no default value.
      // _ojac has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,0,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          
          _eqIdcs = tmpMeta6;
          _vIdcs = tmpMeta7;
          _ojac = tmpMeta9;
          _jacType = tmpMeta10;
          /* Pattern matching succeeded */
          equality(_jacType, _OMC_LIT48);
          tmpMeta1 = omc_ResolveLoops_reshuffling__post2(threadData, _eqIdcs, _vIdcs, _systIn, _shared, _ojac, _jacType, NULL);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _systIn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _systOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _systOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_reshuffling__post0(threadData_t *threadData, modelica_metatype _isyst, modelica_metatype _shared)
{
  modelica_metatype _osyst = NULL;
  modelica_metatype _comps = NULL;
  modelica_metatype _syst = NULL;
  modelica_boolean _b;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _osyst has no default value.
  // _comps has no default value.
  // _syst has no default value.
  // _b has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _isyst;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 7));
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta2,1,3) == 0) MMC_THROW_INTERNAL();
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta2), 4));
  _comps = tmpMeta3;

  _osyst = omc_List_fold1(threadData, _comps, boxvar_ResolveLoops_reshuffling__post1, _shared, _isyst);
  _return: OMC_LABEL_UNUSED
  return _osyst;
}

DLLDirection
modelica_metatype omc_ResolveLoops_reshuffling__post(threadData_t *threadData, modelica_metatype _inDAE)
{
  modelica_metatype _outDAE = NULL;
  modelica_metatype _eqSystems = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outDAE has no default value.
  // _eqSystems has no default value.
  if(omc_Flags_isSet(threadData, _OMC_LIT52))
  {
    _eqSystems = omc_List_map1(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inDAE), 2))), boxvar_ResolveLoops_reshuffling__post0, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inDAE), 3))));

    tmpMeta1 = mmc_mk_box3(3, &BackendDAE_BackendDAE_DAE__desc, _eqSystems, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inDAE), 3))));
    _outDAE = tmpMeta1;
  }
  else
  {
    _outDAE = _inDAE;
  }
  _return: OMC_LABEL_UNUSED
  return _outDAE;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connectPaths(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _closingPaths)
{
  modelica_metatype _loopsOut = NULL;
  modelica_metatype _path = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _loopsOut has no default value.
  // _path has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _pathIn;
  if (listEmpty(tmpMeta1)) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_CAR(tmpMeta1);
  tmpMeta3 = MMC_CDR(tmpMeta1);
  _path = tmpMeta3;

  _path = omc_List_stripLast(threadData, _path);

  _loopsOut = omc_List_map1(threadData, _closingPaths, boxvar_listAppend, _path);
  _return: OMC_LABEL_UNUSED
  return _loopsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connect2PathsToLoops(threadData_t *threadData, modelica_metatype _pathsIn, modelica_metatype _loopsIn, modelica_metatype _restPathsIn, modelica_metatype *out_restPathsOut)
{
  modelica_metatype _pathsOut = NULL;
  modelica_metatype _restPathsOut = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathsOut has no default value.
  // _restPathsOut has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _pathsIn;
    {
      modelica_boolean _closedALoop;
      modelica_integer _startNode;
      modelica_integer _endNode;
      modelica_metatype _path = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _endPaths = NULL;
      modelica_metatype _startPaths = NULL;
      modelica_metatype _newLoops = NULL;
      modelica_metatype _loops = NULL;
      modelica_metatype _restPaths = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _closedALoop has no default value.
      // _startNode has no default value.
      // _endNode has no default value.
      // _path has no default value.
      // _rest has no default value.
      // _endPaths has no default value.
      // _startPaths has no default value.
      // _newLoops has no default value.
      // _loops has no default value.
      // _restPaths has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          tmp4 += 3; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta[0+0] = tmpMeta6;
          tmpMeta[0+1] = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_boolean tmp11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_boolean tmp14;
          modelica_metatype tmpMeta15;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_1);
          tmpMeta9 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta9)) goto tmp3_end;
          _path = tmpMeta8;
          /* Pattern matching succeeded */
          _startNode = mmc_unbox_integer(listHead(_path));

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

          _closedALoop = (_startNode == _endNode);

          tmp11 = (modelica_boolean)_closedALoop;
          if(tmp11)
          {
            tmpMeta10 = mmc_mk_cons(_path, _loopsIn);
            tmpMeta12 = tmpMeta10;
          }
          else
          {
            tmpMeta12 = _loopsIn;
          }
          _loops = tmpMeta12;

          tmp14 = (modelica_boolean)_closedALoop;
          if(tmp14)
          {
            tmpMeta15 = _restPathsIn;
          }
          else
          {
            tmpMeta13 = mmc_mk_cons(_path, _restPathsIn);
            tmpMeta15 = tmpMeta13;
          }
          _restPaths = tmpMeta15;
          tmpMeta[0+0] = _loops;
          tmpMeta[0+1] = _restPaths;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_boolean tmp18;
          modelica_metatype tmpMeta19;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta16 = MMC_CAR(tmp4_1);
          tmpMeta17 = MMC_CDR(tmp4_1);
          _path = tmpMeta16;
          _rest = tmpMeta17;
          /* Pattern matching succeeded */
          _startNode = mmc_unbox_integer(listHead(_path));

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

          /* Pattern-matching assignment */
          tmp18 = (_startNode == _endNode);
          if (1 /* true */ != tmp18) goto goto_2;

          tmpMeta19 = mmc_mk_cons(_path, _loopsIn);
          _loops = tmpMeta19;
          tmpMeta[0+0] = omc_ResolveLoops_connect2PathsToLoops(threadData, _rest, _loops, _restPathsIn, &tmpMeta[0+1]);
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_boolean tmp23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_boolean tmp26;
          modelica_metatype tmpMeta27;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta20 = MMC_CAR(tmp4_1);
          tmpMeta21 = MMC_CDR(tmp4_1);
          _path = tmpMeta20;
          _rest = tmpMeta21;
          /* Pattern matching succeeded */
          _startNode = mmc_unbox_integer(listHead(_path));

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

          _startPaths = omc_List_filter1OnTrue(threadData, _rest, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_startNode));

          _startPaths = omc_List_filter1OnTrue(threadData, _startPaths, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_endNode));

          _endPaths = omc_List_filter1OnTrue(threadData, _rest, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_endNode));

          _endPaths = omc_List_filter1OnTrue(threadData, _endPaths, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_startNode));

          _endPaths = listAppend(_startPaths, _endPaths);

          _closedALoop = (!listEmpty(_endPaths));

          tmp23 = (modelica_boolean)_closedALoop;
          if(tmp23)
          {
            tmpMeta24 = omc_ResolveLoops_connectPaths(threadData, _path, _endPaths);
          }
          else
          {
            tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta24 = tmpMeta22;
          }
          _newLoops = tmpMeta24;

          tmp26 = (modelica_boolean)_closedALoop;
          if(tmp26)
          {
            tmpMeta27 = _restPathsIn;
          }
          else
          {
            tmpMeta25 = mmc_mk_cons(_path, _restPathsIn);
            tmpMeta27 = tmpMeta25;
          }
          _restPaths = tmpMeta27;

          _loops = listAppend(_newLoops, _loopsIn);
          tmpMeta[0+0] = omc_ResolveLoops_connect2PathsToLoops(threadData, _rest, _loops, _restPaths, &tmpMeta[0+1]);
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          fputs(MMC_STRINGDATA(_OMC_LIT53),stdout);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 5) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _pathsOut = tmpMeta[0+0];
  _restPathsOut = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_restPathsOut) { *out_restPathsOut = _restPathsOut; }
  return _pathsOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_lastInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_integer _value)
{
  modelica_boolean _isEq;
  modelica_integer _last;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEq has no default value.
  // _last has no default value.
  _last = mmc_unbox_integer(omc_List_last(threadData, _lstIn));

  _isEq = (_last == _value);
  _return: OMC_LABEL_UNUSED
  return _isEq;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_lastInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype _value)
{
  modelica_integer tmp1;
  modelica_boolean _isEq;
  modelica_metatype out_isEq;
  tmp1 = mmc_unbox_integer(_value);
  _isEq = omc_ResolveLoops_lastInListIsEqual(threadData, _lstIn, tmp1);
  out_isEq = mmc_mk_icon(_isEq);
  return out_isEq;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_firstInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_integer _value)
{
  modelica_boolean _isEq;
  modelica_integer _first;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isEq has no default value.
  // _first has no default value.
  _first = mmc_unbox_integer(listHead(_lstIn));

  _isEq = (_first == _value);
  _return: OMC_LABEL_UNUSED
  return _isEq;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_firstInListIsEqual(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype _value)
{
  modelica_integer tmp1;
  modelica_boolean _isEq;
  modelica_metatype out_isEq;
  tmp1 = mmc_unbox_integer(_value);
  _isEq = omc_ResolveLoops_firstInListIsEqual(threadData, _lstIn, tmp1);
  out_isEq = mmc_mk_icon(_isEq);
  return out_isEq;
}

static modelica_metatype closure0_List_isEqualOnTrue(threadData_t *thData, modelica_metatype closure, modelica_metatype inList1, modelica_metatype inList2)
{
  modelica_fnptr inCompFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_List_isEqualOnTrue(thData, inList1, inList2, inCompFunc);
}static modelica_metatype closure1_List_isEqualOnTrue(threadData_t *thData, modelica_metatype closure, modelica_metatype inList1, modelica_metatype inList2)
{
  modelica_fnptr inCompFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_List_isEqualOnTrue(thData, inList1, inList2, inCompFunc);
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sortPathsAsChain1(threadData_t *threadData, modelica_metatype _pathsIn, modelica_integer _firstNode, modelica_integer _lastNode, modelica_metatype _sortedPathsIn)
{
  modelica_metatype _sortedPathsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sortedPathsOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_integer tmp4_2;volatile modelica_integer tmp4_3;volatile modelica_metatype tmp4_4;
    tmp4_1 = _pathsIn;
    tmp4_2 = _firstNode;
    tmp4_3 = _lastNode;
    tmp4_4 = _sortedPathsIn;
    {
      modelica_integer _startNode;
      modelica_integer _endNode;
      modelica_metatype _path = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _paths1 = NULL;
      modelica_metatype _paths2 = NULL;
      modelica_metatype _allPaths = NULL;
      modelica_metatype _sortedPaths = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _startNode has no default value.
      // _endNode has no default value.
      // _path has no default value.
      // _rest has no default value.
      // _paths1 has no default value.
      // _paths2 has no default value.
      // _allPaths has no default value.
      // _sortedPaths has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 6; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _sortedPathsIn;
          goto tmp3_done;
        }
        case 1: {
          if (-1 != tmp4_2) goto tmp3_end;
          if (-1 != tmp4_3) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _sortedPathsIn;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmp4_4)) goto tmp3_end;
          
          _path = tmpMeta6;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          _startNode = mmc_unbox_integer(listHead(_path));

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));
          tmpMeta8 = mmc_mk_cons(_path, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = omc_ResolveLoops_sortPathsAsChain1(threadData, _rest, _startNode, _endNode, tmpMeta8);
          goto tmp3_done;
        }
        case 3: {
          modelica_boolean tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          _paths1 = omc_List_filter1OnTrue(threadData, _pathsIn, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_lastNode));

          _paths2 = omc_List_filter1OnTrue(threadData, _pathsIn, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_lastNode));

          _allPaths = listAppend(_paths1, _paths2);

          /* Pattern-matching assignment */
          tmp9 = listEmpty(_allPaths);
          if (0 /* false */ != tmp9) goto goto_2;

          _path = listHead(_allPaths);

          _endNode = ((!listEmpty(_allPaths))?mmc_unbox_integer(omc_List_last(threadData, _path)):((modelica_integer) -1));

          _endNode = ((!listEmpty(_paths2))?mmc_unbox_integer(listHead(_path)):((modelica_integer) -1));

          tmpMeta10 = mmc_mk_box1(0, boxvar_intEq);
          _rest = omc_List_deleteMemberOnTrue(threadData, _path, _pathsIn, (modelica_fnptr) mmc_mk_box2(0,closure0_List_isEqualOnTrue,tmpMeta10), NULL);

          tmpMeta11 = mmc_mk_cons(_path, MMC_REFSTRUCTLIT(mmc_nil));
          _sortedPaths = listAppend(_sortedPathsIn, tmpMeta11);
          tmpMeta1 = omc_ResolveLoops_sortPathsAsChain1(threadData, _rest, _firstNode, _endNode, _sortedPaths);
          goto tmp3_done;
        }
        case 4: {
          modelica_boolean tmp12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          _paths1 = omc_List_filter1OnTrue(threadData, _pathsIn, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_firstNode));

          _paths2 = omc_List_filter1OnTrue(threadData, _pathsIn, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_firstNode));

          _allPaths = listAppend(_paths1, _paths2);

          /* Pattern-matching assignment */
          tmp12 = listEmpty(_allPaths);
          if (0 /* false */ != tmp12) goto goto_2;

          _path = listHead(_allPaths);

          _startNode = ((!listEmpty(_allPaths))?mmc_unbox_integer(omc_List_last(threadData, _path)):((modelica_integer) -1));

          _startNode = ((!listEmpty(_paths2))?mmc_unbox_integer(listHead(_path)):((modelica_integer) -1));

          tmpMeta13 = mmc_mk_box1(0, boxvar_intEq);
          _rest = omc_List_deleteMemberOnTrue(threadData, _path, _pathsIn, (modelica_fnptr) mmc_mk_box2(0,closure1_List_isEqualOnTrue,tmpMeta13), NULL);

          tmpMeta14 = mmc_mk_cons(_path, _sortedPathsIn);
          _sortedPaths = tmpMeta14;
          tmpMeta1 = omc_ResolveLoops_sortPathsAsChain1(threadData, _rest, _startNode, _lastNode, _sortedPaths);
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta15 = _pathsIn;
          if (listEmpty(tmpMeta15)) goto goto_2;
          tmpMeta16 = MMC_CAR(tmpMeta15);
          tmpMeta17 = MMC_CDR(tmpMeta15);
          _path = tmpMeta16;
          _rest = tmpMeta17;

          tmpMeta18 = mmc_mk_cons(_path, _sortedPathsIn);
          _sortedPaths = tmpMeta18;

          _startNode = mmc_unbox_integer(listHead(_path));
          tmpMeta1 = omc_ResolveLoops_sortPathsAsChain1(threadData, _rest, _startNode, _lastNode, _sortedPaths);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 6) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _sortedPathsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sortedPathsOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sortPathsAsChain1(threadData_t *threadData, modelica_metatype _pathsIn, modelica_metatype _firstNode, modelica_metatype _lastNode, modelica_metatype _sortedPathsIn)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _sortedPathsOut = NULL;
  tmp1 = mmc_unbox_integer(_firstNode);
  tmp2 = mmc_unbox_integer(_lastNode);
  _sortedPathsOut = omc_ResolveLoops_sortPathsAsChain1(threadData, _pathsIn, tmp1, tmp2, _sortedPathsIn);
  /* skip box _sortedPathsOut; list<list<#Integer>> */
  return _sortedPathsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sortPathsAsChain(threadData_t *threadData, modelica_metatype _pathsIn)
{
  modelica_metatype _pathsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathsOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _pathsIn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = omc_ResolveLoops_sortPathsAsChain1(threadData, _pathsIn, ((modelica_integer) 0), ((modelica_integer) 0), tmpMeta7);
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _pathsIn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _pathsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _pathsOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_intLstIsEqual(threadData_t *threadData, modelica_metatype _lst1, modelica_metatype _lst2)
{
  modelica_boolean _bOut;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _bOut has no default value.
  _bOut = omc_List_isEqualOnTrue(threadData, _lst1, _lst2, boxvar_intEq);
  _return: OMC_LABEL_UNUSED
  return _bOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_intLstIsEqual(threadData_t *threadData, modelica_metatype _lst1, modelica_metatype _lst2)
{
  modelica_boolean _bOut;
  modelica_metatype out_bOut;
  _bOut = omc_ResolveLoops_intLstIsEqual(threadData, _lst1, _lst2);
  out_bOut = mmc_mk_icon(_bOut);
  return out_bOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sumUp2Expressions(threadData_t *threadData, modelica_boolean _sumUp, modelica_metatype _exp1, modelica_metatype _exp2)
{
  modelica_metatype _expOut = NULL;
  modelica_metatype _op = NULL;
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_boolean tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _expOut has no default value.
  // _op has no default value.
  // _ty has no default value.
  _ty = _OMC_LIT18;

  tmp3 = (modelica_boolean)_sumUp;
  if(tmp3)
  {
    tmpMeta1 = mmc_mk_box2(3, &DAE_Operator_ADD__desc, _ty);
    tmpMeta4 = tmpMeta1;
  }
  else
  {
    tmpMeta2 = mmc_mk_box2(4, &DAE_Operator_SUB__desc, _ty);
    tmpMeta4 = tmpMeta2;
  }
  _op = tmpMeta4;

  tmpMeta5 = mmc_mk_box4(10, &DAE_Exp_BINARY__desc, _exp1, _op, _exp2);
  _expOut = tmpMeta5;

  _expOut = omc_ExpressionSimplify_simplify(threadData, _expOut, NULL);
  _return: OMC_LABEL_UNUSED
  return _expOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sumUp2Expressions(threadData_t *threadData, modelica_metatype _sumUp, modelica_metatype _exp1, modelica_metatype _exp2)
{
  modelica_integer tmp1;
  modelica_metatype _expOut = NULL;
  tmp1 = mmc_unbox_integer(_sumUp);
  _expOut = omc_ResolveLoops_sumUp2Expressions(threadData, tmp1, _exp1, _exp2);
  /* skip box _expOut; DAE.Exp */
  return _expOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_isAddOrSubExp(threadData_t *threadData, modelica_metatype _inExp, modelica_metatype _inTuple, modelica_metatype *out_outTuple)
{
  modelica_metatype _outExp = NULL;
  modelica_metatype _outTuple = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outExp has no default value.
  // _outTuple has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _inExp;
    tmp4_2 = _inTuple;
    {
      modelica_boolean _b;
      modelica_metatype _vars = NULL;
      modelica_metatype _exp1 = NULL;
      modelica_metatype _exp2 = NULL;
      modelica_metatype _cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _b has no default value.
      // _vars has no default value.
      // _exp1 has no default value.
      // _exp2 has no default value.
      // _cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 8; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 /* true */ != tmp7) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          
          _vars = tmpMeta8;
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta9;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_integer tmp11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_integer tmp16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp11 = mmc_unbox_integer(tmpMeta10);
          if (1 /* true */ != tmp11) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,2) == 0) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          _vars = tmpMeta12;
          _exp1 = tmpMeta13;
          /* Pattern matching succeeded */
          /* Pattern-matching tuple assignment, wild first pattern */
          tmpMeta17 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
          omc_ResolveLoops_isAddOrSubExp(threadData, _exp1, tmpMeta17, &tmpMeta14);
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 1));
          tmp16 = mmc_unbox_integer(tmpMeta15);
          _b = tmp16  /* pattern as ty=Boolean */;
          tmpMeta18 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta18;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta19;
          modelica_integer tmp20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp20 = mmc_unbox_integer(tmpMeta19);
          if (1 /* true */ != tmp20) goto tmp3_end;
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          
          _vars = tmpMeta21;
          /* Pattern matching succeeded */
          tmpMeta22 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta22;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta23;
          modelica_integer tmp24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_integer tmp31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_integer tmp35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp24 = mmc_unbox_integer(tmpMeta23);
          if (1 /* true */ != tmp24) goto tmp3_end;
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta27,0,1) == 0) goto tmp3_end;
          tmpMeta28 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          _vars = tmpMeta25;
          _exp1 = tmpMeta26;
          _exp2 = tmpMeta28;
          /* Pattern matching succeeded */
          /* Pattern-matching tuple assignment, wild first pattern */
          tmpMeta32 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
          omc_ResolveLoops_isAddOrSubExp(threadData, _exp1, tmpMeta32, &tmpMeta29);
          tmpMeta30 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta29), 1));
          tmp31 = mmc_unbox_integer(tmpMeta30);
          _b = tmp31  /* pattern as ty=Boolean */;

          /* Pattern-matching tuple assignment, wild first pattern */
          tmpMeta36 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          omc_ResolveLoops_isAddOrSubExp(threadData, _exp2, tmpMeta36, &tmpMeta33);
          tmpMeta34 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta33), 1));
          tmp35 = mmc_unbox_integer(tmpMeta34);
          _b = tmp35  /* pattern as ty=Boolean */;
          tmpMeta37 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta37;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta38;
          modelica_integer tmp39;
          modelica_metatype tmpMeta40;
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          modelica_metatype tmpMeta45;
          modelica_integer tmp46;
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          modelica_metatype tmpMeta49;
          modelica_integer tmp50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          tmpMeta38 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp39 = mmc_unbox_integer(tmpMeta38);
          if (1 /* true */ != tmp39) goto tmp3_end;
          tmpMeta40 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta41 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta42 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta42,1,1) == 0) goto tmp3_end;
          tmpMeta43 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          _vars = tmpMeta40;
          _exp1 = tmpMeta41;
          _exp2 = tmpMeta43;
          /* Pattern matching succeeded */
          /* Pattern-matching tuple assignment, wild first pattern */
          tmpMeta47 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
          omc_ResolveLoops_isAddOrSubExp(threadData, _exp1, tmpMeta47, &tmpMeta44);
          tmpMeta45 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta44), 1));
          tmp46 = mmc_unbox_integer(tmpMeta45);
          _b = tmp46  /* pattern as ty=Boolean */;

          /* Pattern-matching tuple assignment, wild first pattern */
          tmpMeta51 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          omc_ResolveLoops_isAddOrSubExp(threadData, _exp2, tmpMeta51, &tmpMeta48);
          tmpMeta49 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta48), 1));
          tmp50 = mmc_unbox_integer(tmpMeta49);
          _b = tmp50  /* pattern as ty=Boolean */;
          tmpMeta52 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta52;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta53;
          modelica_integer tmp54;
          modelica_metatype tmpMeta55;
          modelica_metatype tmpMeta56;
          modelica_metatype tmpMeta57;
          modelica_metatype tmpMeta58;
          modelica_metatype tmpMeta59;
          modelica_metatype tmpMeta60;
          tmpMeta53 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp54 = mmc_unbox_integer(tmpMeta53);
          if (1 /* true */ != tmp54) goto tmp3_end;
          tmpMeta55 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta56 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta56,6,2) == 0) goto tmp3_end;
          tmpMeta57 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta56), 2));
          tmpMeta58 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta58,2,1) == 0) goto tmp3_end;
          tmpMeta59 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          _vars = tmpMeta55;
          _cref = tmpMeta57;
          _exp2 = tmpMeta59;
          /* Pattern matching succeeded */
          _b = (omc_BackendVariable_isState(threadData, _cref, _vars) && omc_Expression_isConst(threadData, _exp2));
          tmpMeta60 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta60;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta61;
          modelica_integer tmp62;
          modelica_metatype tmpMeta63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          modelica_metatype tmpMeta67;
          modelica_metatype tmpMeta68;
          tmpMeta61 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp62 = mmc_unbox_integer(tmpMeta61);
          if (1 /* true */ != tmp62) goto tmp3_end;
          tmpMeta63 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta64 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta65 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta65,2,1) == 0) goto tmp3_end;
          tmpMeta66 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta66,6,2) == 0) goto tmp3_end;
          tmpMeta67 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta66), 2));
          
          _vars = tmpMeta63;
          _exp1 = tmpMeta64;
          _cref = tmpMeta67;
          /* Pattern matching succeeded */
          _b = (omc_Expression_isConst(threadData, _exp1) && omc_BackendVariable_isState(threadData, _cref, _vars));
          tmpMeta68 = mmc_mk_box2(0, mmc_mk_boolean(_b), _vars);
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta68;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta69;
          
          /* Pattern matching succeeded */
          tmpMeta69 = mmc_mk_box2(0, mmc_mk_boolean(0 /* false */), omc_Util_tuple22(threadData, _inTuple));
          tmpMeta[0+0] = _inExp;
          tmpMeta[0+1] = tmpMeta69;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _outExp = tmpMeta[0+0];
  _outTuple = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_outTuple) { *out_outTuple = _outTuple; }
  return _outExp;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_gatherCrossNodes(threadData_t *threadData, modelica_integer _idx, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _lstIn)
{
  modelica_metatype _lstOut = NULL;
  modelica_boolean _isCross;
  modelica_boolean _isNoCross;
  modelica_integer _num;
  modelica_metatype _row = NULL;
  modelica_metatype _nextNodes = NULL;
  modelica_metatype _adjNodes = NULL;
  modelica_metatype tmpMeta1;
  modelica_boolean tmp2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lstOut has no default value.
  // _isCross has no default value.
  // _isNoCross has no default value.
  // _num has no default value.
  // _row has no default value.
  // _nextNodes has no default value.
  // _adjNodes has no default value.
  _row = arrayGet(_m, _idx);

  _num = listLength(_row);

  _isCross = (_num > ((modelica_integer) 2));

  tmp2 = (modelica_boolean)_isCross;
  if(tmp2)
  {
    tmpMeta1 = mmc_mk_cons(mmc_mk_integer(_idx), _lstIn);
    tmpMeta3 = tmpMeta1;
  }
  else
  {
    tmpMeta3 = _lstIn;
  }
  _lstOut = tmpMeta3;
  _return: OMC_LABEL_UNUSED
  return _lstOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_gatherCrossNodes(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _lstIn)
{
  modelica_integer tmp1;
  modelica_metatype _lstOut = NULL;
  tmp1 = mmc_unbox_integer(_idx);
  _lstOut = omc_ResolveLoops_gatherCrossNodes(threadData, tmp1, _m, _mT, _lstIn);
  /* skip box _lstOut; list<#Integer> */
  return _lstOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getArrayEntryAndAppend(threadData_t *threadData, modelica_integer _entry, modelica_metatype _m, modelica_metatype _lstIn)
{
  modelica_metatype _lstOut = NULL;
  modelica_metatype _lst = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lstOut has no default value.
  // _lst has no default value.
  _lst = arrayGet(_m, _entry);

  _lstOut = listAppend(_lst, _lstIn);
  _return: OMC_LABEL_UNUSED
  return _lstOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getArrayEntryAndAppend(threadData_t *threadData, modelica_metatype _entry, modelica_metatype _m, modelica_metatype _lstIn)
{
  modelica_integer tmp1;
  modelica_metatype _lstOut = NULL;
  tmp1 = mmc_unbox_integer(_entry);
  _lstOut = omc_ResolveLoops_getArrayEntryAndAppend(threadData, tmp1, _m, _lstIn);
  /* skip box _lstOut; list<#Integer> */
  return _lstOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayGetIsNegative(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arrayIn)
{
  modelica_boolean _isNonZero;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isNonZero has no default value.
  _isNonZero = (mmc_unbox_integer(arrayGet(_arrayIn, _idx)) < ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _isNonZero;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayGetIsNegative(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arrayIn)
{
  modelica_integer tmp1;
  modelica_boolean _isNonZero;
  modelica_metatype out_isNonZero;
  tmp1 = mmc_unbox_integer(_idx);
  _isNonZero = omc_ResolveLoops_arrayGetIsNegative(threadData, tmp1, _arrayIn);
  out_isNonZero = mmc_mk_icon(_isNonZero);
  return out_isNonZero;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayGetIsNotPositive(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arrayIn)
{
  modelica_boolean _isNonZero;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isNonZero has no default value.
  _isNonZero = (mmc_unbox_integer(arrayGet(_arrayIn, _idx)) <= ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _isNonZero;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayGetIsNotPositive(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arrayIn)
{
  modelica_integer tmp1;
  modelica_boolean _isNonZero;
  modelica_metatype out_isNonZero;
  tmp1 = mmc_unbox_integer(_idx);
  _isNonZero = omc_ResolveLoops_arrayGetIsNotPositive(threadData, tmp1, _arrayIn);
  out_isNonZero = mmc_mk_icon(_isNonZero);
  return out_isNonZero;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_colorNodePartitions(threadData_t *threadData, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _checkNextIn, modelica_metatype _markEqs, modelica_metatype _markVars, modelica_integer _currNumberIn, modelica_metatype _partitionsIn, modelica_integer _nextIndex, modelica_metatype *out_partitionsOut)
{
  modelica_integer _currNumberOut;
  modelica_metatype _partitionsOut = NULL;
  modelica_boolean _hasChanged;
  modelica_integer _eq;
  modelica_integer _currNumber;
  modelica_integer _next_index;
  modelica_metatype _markNodes = NULL;
  modelica_metatype _rest = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _addEqs = NULL;
  modelica_metatype _eqs = NULL;
  modelica_metatype _part = NULL;
  modelica_metatype _restPart = NULL;
  modelica_metatype _partitions = NULL;
  modelica_integer tmp1_c0 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _currNumberOut has no default value.
  // _partitionsOut has no default value.
  // _hasChanged has no default value.
  // _eq has no default value.
  // _currNumber has no default value.
  // _next_index has no default value.
  // _markNodes has no default value.
  // _rest has no default value.
  // _vars has no default value.
  // _addEqs has no default value.
  // _eqs has no default value.
  // _part has no default value.
  // _restPart has no default value.
  // _partitions has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _checkNextIn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          if (0 != tmp8) goto tmp3_end;
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1_c0 = ((modelica_integer) -1) + _currNumberIn;
          tmpMeta[0+1] = _partitionsIn;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_integer tmp11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_boolean tmp19;
          modelica_metatype tmpMeta20;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta9 = MMC_CAR(tmp4_1);
          tmpMeta10 = MMC_CDR(tmp4_1);
          tmp11 = mmc_unbox_integer(tmpMeta9);
          _eq = tmp11  /* pattern as ty=Integer */;
          _rest = tmpMeta10;
          /* Pattern matching succeeded */
          if(omc_ResolveLoops_arrayGetIsNotPositive(threadData, _eq, _markEqs))
          {
            arrayUpdate(_markEqs, _eq, mmc_mk_integer(_currNumberIn));

            if(listEmpty(_partitionsIn))
            {
              tmpMeta13 = mmc_mk_cons(mmc_mk_integer(_eq), MMC_REFSTRUCTLIT(mmc_nil));
              tmpMeta12 = mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil));
              _partitions = tmpMeta12;
            }
            else
            {
              /* Pattern-matching assignment */
              tmpMeta14 = _partitionsIn;
              if (listEmpty(tmpMeta14)) goto goto_2;
              tmpMeta15 = MMC_CAR(tmpMeta14);
              tmpMeta16 = MMC_CDR(tmpMeta14);
              _part = tmpMeta15;
              _restPart = tmpMeta16;

              tmpMeta17 = mmc_mk_cons(mmc_mk_integer(_eq), _part);
              _part = tmpMeta17;

              tmpMeta18 = mmc_mk_cons(_part, _restPart);
              _partitions = tmpMeta18;
            }

            _vars = arrayGet(_m, _eq);

            /* Pattern-matching assignment */
            tmp19 = (!listEmpty(_vars));
            if (1 /* true */ != tmp19) goto goto_2;

            _vars = omc_List_filter1OnTrue(threadData, _vars, boxvar_ResolveLoops_arrayGetIsNotPositive, _markVars);

            omc_List_map2__0(threadData, _vars, boxvar_Array_updateIndexFirst, mmc_mk_integer(_currNumberIn), _markVars);

            tmpMeta20 = MMC_REFSTRUCTLIT(mmc_nil);
            _eqs = omc_List_fold1(threadData, _vars, boxvar_ResolveLoops_getArrayEntryAndAppend, _mT, tmpMeta20);

            _eqs = omc_List_filter1OnTrue(threadData, _eqs, boxvar_ResolveLoops_arrayGetIsNegative, _markEqs);

            omc_List_map2__0(threadData, _eqs, boxvar_Array_updateIndexFirst, mmc_mk_integer(((modelica_integer) 0)), _markEqs);

            _rest = listAppend(_rest, _eqs);
          }
          else
          {
            _partitions = _partitionsIn;
          }
          /* Tail recursive call */
          _checkNextIn = _rest;
          _partitionsIn = _partitions;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          modelica_integer tmp21;
          modelica_integer tmp22;
          modelica_integer tmp23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          _eq = ((modelica_integer) 0);

          _next_index = _nextIndex;

          tmp21 = _nextIndex; tmp22 = 1; tmp23 = arrayLength(_markEqs);
          if(!(((tmp22 > 0) && (tmp21 > tmp23)) || ((tmp22 < 0) && (tmp21 < tmp23))))
          {
            modelica_integer _i;
            for(_i = _nextIndex; in_range_integer(_i, tmp21, tmp23); _i += tmp22)
            {
              if((mmc_unbox_integer(arrayGet(_markEqs,_i) /* DAE.ASUB */) == ((modelica_integer) -1)))
              {
                _eq = _i;

                _next_index = ((modelica_integer) 1) + _i;

                break;
              }
            }
          }
          tmpMeta24 = mmc_mk_cons(mmc_mk_integer(_eq), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta26 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta25 = mmc_mk_cons(tmpMeta26, _partitionsIn);
          /* Tail recursive call */
          _checkNextIn = tmpMeta24;
          _currNumberIn = ((modelica_integer) 1) + _currNumberIn;
          _partitionsIn = tmpMeta25;
          _nextIndex = _next_index;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _currNumberOut = tmp1_c0;
  _partitionsOut = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_partitionsOut) { *out_partitionsOut = _partitionsOut; }
  return _currNumberOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_colorNodePartitions(threadData_t *threadData, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _checkNextIn, modelica_metatype _markEqs, modelica_metatype _markVars, modelica_metatype _currNumberIn, modelica_metatype _partitionsIn, modelica_metatype _nextIndex, modelica_metatype *out_partitionsOut)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer _currNumberOut;
  modelica_metatype out_currNumberOut;
  tmp1 = mmc_unbox_integer(_currNumberIn);
  tmp2 = mmc_unbox_integer(_nextIndex);
  _currNumberOut = omc_ResolveLoops_colorNodePartitions(threadData, _m, _mT, _checkNextIn, _markEqs, _markVars, tmp1, _partitionsIn, tmp2, out_partitionsOut);
  out_currNumberOut = mmc_mk_icon(_currNumberOut);
  /* skip box _partitionsOut; list<list<#Integer>> */
  return out_currNumberOut;
}

DLLDirection
modelica_metatype omc_ResolveLoops_partitionBipartiteGraph(threadData_t *threadData, modelica_metatype _m, modelica_metatype _mT)
{
  modelica_metatype _partitions = NULL;
  modelica_integer _numEqs;
  modelica_integer _numVars;
  modelica_metatype _markEqs = NULL;
  modelica_metatype _markVars = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _partitions has no default value.
  // _numEqs has no default value.
  // _numVars has no default value.
  // _markEqs has no default value.
  // _markVars has no default value.
  _numEqs = arrayLength(_m);

  _numVars = arrayLength(_mT);

  if(((_numEqs == ((modelica_integer) 0)) || (_numVars == ((modelica_integer) 0))))
  {
    _partitions = _OMC_LIT55;
  }
  else
  {
    _markEqs = arrayCreate(_numEqs, mmc_mk_integer(((modelica_integer) -1)));

    _markVars = arrayCreate(_numVars, mmc_mk_integer(((modelica_integer) -1)));

    tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
    omc_ResolveLoops_colorNodePartitions(threadData, _m, _mT, _OMC_LIT54, _markEqs, _markVars, ((modelica_integer) 1), tmpMeta1, ((modelica_integer) 1) ,&_partitions);
  }
  _return: OMC_LABEL_UNUSED
  return _partitions;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_listLengthIs(threadData_t *threadData, modelica_metatype _lst, modelica_integer _value)
{
  modelica_boolean _bOut;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _bOut has no default value.
  _bOut = (listLength(_lst) == _value);
  _return: OMC_LABEL_UNUSED
  return _bOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_listLengthIs(threadData_t *threadData, modelica_metatype _lst, modelica_metatype _value)
{
  modelica_integer tmp1;
  modelica_boolean _bOut;
  modelica_metatype out_bOut;
  tmp1 = mmc_unbox_integer(_value);
  _bOut = omc_ResolveLoops_listLengthIs(threadData, _lst, tmp1);
  out_bOut = mmc_mk_icon(_bOut);
  return out_bOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_expIsCref(threadData_t *threadData, modelica_metatype _expIn, modelica_metatype _crefIn, modelica_boolean *out_algSign)
{
  modelica_boolean _isInExp;
  modelica_boolean _algSign;
  modelica_boolean tmp1_c0 __attribute__((unused)) = 0;
  modelica_boolean tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isInExp has no default value.
  // _algSign has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _expIn;
    {
      modelica_real _r;
      modelica_boolean _sameCref;
      modelica_boolean _sign;
      modelica_boolean _sign1;
      modelica_boolean _sign2;
      modelica_boolean _exists;
      modelica_boolean _exists1;
      modelica_boolean _exists2;
      modelica_metatype _cref = NULL;
      modelica_metatype _exp1 = NULL;
      modelica_metatype _exp2 = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _r has no default value.
      // _sameCref has no default value.
      // _sign has no default value.
      // _sign1 has no default value.
      // _sign2 has no default value.
      // _exists has no default value.
      // _exists1 has no default value.
      // _exists2 has no default value.
      // _cref has no default value.
      // _exp1 has no default value.
      // _exp2 has no default value.
      tmp4 = 0;
      for (; tmp4 < 9; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _cref = tmpMeta6;
          /* Pattern matching succeeded */
          _sameCref = omc_ComponentReference_crefEqualNoStringCompare(threadData, _crefIn, _cref);
          tmp1_c0 = _sameCref;
          tmp1_c1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,1,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          _exp1 = tmpMeta7;
          _exp2 = tmpMeta9;
          /* Pattern matching succeeded */
          _exists1 = omc_ResolveLoops_expIsCref(threadData, _exp1, _crefIn ,&_sign1);

          _exists2 = omc_ResolveLoops_expIsCref(threadData, _exp2, _crefIn ,&_sign2);

          _sign2 = (!_sign2);

          _exists = (_exists1 || _exists2);

          _sign = (_exists1 && _sign1);

          _sign = (_exists2?_sign2:_sign);
          tmp1_c0 = _exists;
          tmp1_c1 = _sign;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,0,1) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          _exp1 = tmpMeta10;
          _exp2 = tmpMeta12;
          /* Pattern matching succeeded */
          _exists1 = omc_ResolveLoops_expIsCref(threadData, _exp1, _crefIn ,&_sign1);

          _exists2 = omc_ResolveLoops_expIsCref(threadData, _exp2, _crefIn ,&_sign2);

          _exists = (_exists1 || _exists2);

          _sign = (_exists1 && _sign1);

          _sign = (_exists2?_sign2:_sign);
          tmp1_c0 = _exists;
          tmp1_c1 = _sign;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_real tmp17;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta13,6,2) == 0) goto tmp3_end;
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,2,1) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta15,1,1) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta15), 2));
          tmp17 = mmc_unbox_real(tmpMeta16);
          _exp1 = tmpMeta13;
          _r = tmp17  /* pattern as ty=Real */;
          /* Pattern matching succeeded */
          _exists = omc_ResolveLoops_expIsCref(threadData, _exp1, _crefIn, NULL);

          _sign = (_r > 0.0);
          tmp1_c0 = _exists;
          tmp1_c1 = _sign;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_real tmp20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,3) == 0) goto tmp3_end;
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta18,1,1) == 0) goto tmp3_end;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta18), 2));
          tmp20 = mmc_unbox_real(tmpMeta19);
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta21,2,1) == 0) goto tmp3_end;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta22,6,2) == 0) goto tmp3_end;
          
          _exp1 = tmpMeta18;
          _r = tmp20  /* pattern as ty=Real */;
          /* Pattern matching succeeded */
          _exists = omc_ResolveLoops_expIsCref(threadData, _exp1, _crefIn, NULL);

          _sign = (_r > 0.0);
          tmp1_c0 = _exists;
          tmp1_c1 = _sign;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,2) == 0) goto tmp3_end;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta23,5,1) == 0) goto tmp3_end;
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          _exp1 = tmpMeta24;
          /* Pattern matching succeeded */
          _exists = omc_ResolveLoops_expIsCref(threadData, _exp1, _crefIn ,&_sign);

          _sign = (!_sign);
          tmp1_c0 = _exists;
          tmp1_c1 = _sign;
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1_c0 = 0 /* false */;
          tmp1_c1 = 0 /* false */;
          goto tmp3_done;
        }
        case 7: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1_c0 = 0 /* false */;
          tmp1_c1 = 0 /* false */;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          
          /* Pattern matching succeeded */
          tmpMeta25 = stringAppend(_OMC_LIT56,omc_ExpressionDump_printExpStr(threadData, _expIn));
          tmpMeta26 = stringAppend(tmpMeta25,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta26),stdout);
          tmp1_c0 = 0 /* false */;
          tmp1_c1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _isInExp = tmp1_c0;
  _algSign = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_algSign) { *out_algSign = _algSign; }
  return _isInExp;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_expIsCref(threadData_t *threadData, modelica_metatype _expIn, modelica_metatype _crefIn, modelica_metatype *out_algSign)
{
  modelica_boolean _algSign;
  modelica_boolean _isInExp;
  modelica_metatype out_isInExp;
  _isInExp = omc_ResolveLoops_expIsCref(threadData, _expIn, _crefIn, &_algSign);
  out_isInExp = mmc_mk_icon(_isInExp);
  if (out_algSign) { *out_algSign = mmc_mk_icon(_algSign); }
  return out_isInExp;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_CRefIsPosOnRHS(threadData_t *threadData, modelica_metatype _crefIn, modelica_metatype _eqIn)
{
  modelica_boolean _isPos;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isPos has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _eqIn;
    {
      modelica_boolean _exists1;
      modelica_boolean _sign1;
      modelica_boolean _sign2;
      modelica_metatype _e1 = NULL;
      modelica_metatype _e2 = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _exists1 has no default value.
      // _sign1 has no default value.
      // _sign2 has no default value.
      // _e1 has no default value.
      // _e2 has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _e1 = tmpMeta6;
          _e2 = tmpMeta7;
          /* Pattern matching succeeded */
          _exists1 = omc_ResolveLoops_expIsCref(threadData, _e1, _crefIn ,&_sign1);

          omc_ResolveLoops_expIsCref(threadData, _e2, _crefIn ,&_sign2);
          tmp1 = (_exists1?(!_sign1):_sign2);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta8 = stringAppend(_OMC_LIT57,omc_BackendDump_equationString(threadData, _eqIn));
          tmpMeta9 = stringAppend(tmpMeta8,_OMC_LIT2);
          fputs(MMC_STRINGDATA(tmpMeta9),stdout);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _isPos = tmp1;
  _return: OMC_LABEL_UNUSED
  return _isPos;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_CRefIsPosOnRHS(threadData_t *threadData, modelica_metatype _crefIn, modelica_metatype _eqIn)
{
  modelica_boolean _isPos;
  modelica_metatype out_isPos;
  _isPos = omc_ResolveLoops_CRefIsPosOnRHS(threadData, _crefIn, _eqIn);
  out_isPos = mmc_mk_icon(_isPos);
  return out_isPos;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_simplifyZeroAssignment(threadData_t *threadData, modelica_metatype _eIn)
{
  modelica_metatype _eOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eOut has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eIn;
    {
      modelica_metatype _e = NULL;
      modelica_metatype _source = NULL;
      modelica_metatype _attr = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _e has no default value.
      // _source has no default value.
      // _attr has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_real tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,1) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          tmp8 = mmc_unbox_real(tmpMeta7);
          if (0.0 != tmp8) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,7,3) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta10,1,1) == 0) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,2,1) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta12,6,2) == 0) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          _e = tmpMeta12;
          _source = tmpMeta13;
          _attr = tmpMeta14;
          /* Pattern matching succeeded */
          tmpMeta15 = mmc_mk_box5(3, &BackendDAE_Equation_EQUATION__desc, _OMC_LIT8, _e, _source, _attr);
          tmpMeta1 = tmpMeta15;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_real tmp22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta16,7,3) == 0) goto tmp3_end;
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta16), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta17,1,1) == 0) goto tmp3_end;
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta16), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta18,2,1) == 0) goto tmp3_end;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta16), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta19,6,2) == 0) goto tmp3_end;
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta20,1,1) == 0) goto tmp3_end;
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta20), 2));
          tmp22 = mmc_unbox_real(tmpMeta21);
          if (0.0 != tmp22) goto tmp3_end;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 5));
          _e = tmpMeta19;
          _source = tmpMeta23;
          _attr = tmpMeta24;
          /* Pattern matching succeeded */
          tmpMeta25 = mmc_mk_box5(3, &BackendDAE_Equation_EQUATION__desc, _OMC_LIT8, _e, _source, _attr);
          tmpMeta1 = tmpMeta25;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eIn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_sumUp2Equations(threadData_t *threadData, modelica_boolean _sumUp, modelica_metatype _eq1, modelica_metatype _eq2)
{
  modelica_metatype _eqOut = NULL;
  modelica_metatype _exp1 = NULL;
  modelica_metatype _exp2 = NULL;
  modelica_metatype _exp3 = NULL;
  modelica_metatype _exp4 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqOut has no default value.
  // _exp1 has no default value.
  // _exp2 has no default value.
  // _exp3 has no default value.
  // _exp4 has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _eq1;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta1,0,4) == 0) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  _exp1 = tmpMeta2;
  _exp2 = tmpMeta3;

  /* Pattern-matching assignment */
  tmpMeta4 = _eq2;
  if (mmc__uniontype__metarecord__typedef__equal(tmpMeta4,0,4) == 0) MMC_THROW_INTERNAL();
  tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 2));
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta4), 3));
  _exp3 = tmpMeta5;
  _exp4 = tmpMeta6;

  _exp1 = omc_ResolveLoops_sumUp2Expressions(threadData, _sumUp, _exp1, _exp3);

  _exp2 = omc_ResolveLoops_sumUp2Expressions(threadData, _sumUp, _exp2, _exp4);

  _exp2 = omc_ResolveLoops_sumUp2Expressions(threadData, 0 /* false */, _exp2, _exp1);

  _exp2 = omc_ExpressionSimplify_simplify(threadData, _exp2, NULL);

  _exp1 = omc_Expression_createZeroExpression(threadData, omc_Expression_typeof(threadData, _exp2));

  tmpMeta7 = mmc_mk_box5(3, &BackendDAE_Equation_EQUATION__desc, _exp1, _exp2, _OMC_LIT31, _OMC_LIT34);
  _eqOut = tmpMeta7;

  _eqOut = omc_ResolveLoops_simplifyZeroAssignment(threadData, _eqOut);
  _return: OMC_LABEL_UNUSED
  return _eqOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_sumUp2Equations(threadData_t *threadData, modelica_metatype _sumUp, modelica_metatype _eq1, modelica_metatype _eq2)
{
  modelica_integer tmp1;
  modelica_metatype _eqOut = NULL;
  tmp1 = mmc_unbox_integer(_sumUp);
  _eqOut = omc_ResolveLoops_sumUp2Equations(threadData, tmp1, _eq1, _eq2);
  /* skip box _eqOut; BackendDAE.Equation */
  return _eqOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_updateTripleLoop(threadData_t *threadData, modelica_metatype __omcQ_24in_5FloopFull, modelica_metatype _tplIn)
{
  modelica_metatype _loopFull = NULL;
  modelica_metatype _map = NULL;
  modelica_metatype _mapIndices = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _loopFull = __omcQ_24in_5FloopFull;
  // _map has no default value.
  // _mapIndices has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _tplIn;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  _mapIndices = tmpMeta2;
  _map = tmpMeta3;

  {
    modelica_metatype _i;
    for (tmpMeta4 = _mapIndices; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
    {
      _i = MMC_CAR(tmpMeta4);
      _loopFull = listAppend(arrayGet(_map, mmc_unbox_integer(_i)), _loopFull);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _loopFull;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_evaluateTripleLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn)
{
  modelica_boolean _resolve;
  modelica_boolean _r1;
  modelica_boolean _r2;
  modelica_integer _n;
  modelica_integer _numInLoop;
  modelica_integer _numOutLoop;
  modelica_metatype _m = NULL;
  modelica_metatype _map = NULL;
  modelica_metatype _mapIndices = NULL;
  modelica_metatype _loopEqs = NULL;
  modelica_metatype _nonLoopEqs = NULL;
  modelica_metatype _chk = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _dup = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _eqVars = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _resolve = 1 /* true */;
  // _r1 has no default value.
  // _r2 has no default value.
  // _n has no default value.
  _numInLoop = ((modelica_integer) 0);
  _numOutLoop = ((modelica_integer) 0);
  // _m has no default value.
  // _map has no default value.
  // _mapIndices has no default value.
  // _loopEqs has no default value.
  // _nonLoopEqs has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _chk = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _dup = tmpMeta2;
  // _eqVars has no default value.
  if((!(omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 3))))
  {
    /* Pattern-matching assignment */
    tmpMeta3 = _tplIn;
    tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 1));
    tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 2));
    tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 3));
    _m = tmpMeta4;
    _mapIndices = tmpMeta5;
    _map = tmpMeta6;

    {
      modelica_metatype _j;
      for (tmpMeta7 = _loopIn; !listEmpty(tmpMeta7); tmpMeta7=MMC_CDR(tmpMeta7))
      {
        _j = MMC_CAR(tmpMeta7);
        _n = omc_ResolveLoops_countDoubleEntriesInLst(threadData, arrayGet(_m, mmc_unbox_integer(_j)), _chk, _dup ,&_chk ,&_dup);

        _numInLoop = _numInLoop + _n;
      }
    }

    {
      modelica_metatype _i;
      for (tmpMeta9 = _mapIndices; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
      {
        _i = MMC_CAR(tmpMeta9);
        {
          modelica_metatype _j;
          for (tmpMeta10 = arrayGet(_map, mmc_unbox_integer(_i)); !listEmpty(tmpMeta10); tmpMeta10=MMC_CDR(tmpMeta10))
          {
            _j = MMC_CAR(tmpMeta10);
            _n = omc_ResolveLoops_countDoubleEntriesInLst(threadData, arrayGet(_m, mmc_unbox_integer(_j)), _chk, _dup ,&_chk ,&_dup);

            _numInLoop = _numInLoop + _n;
          }
        }
      }
    }

    _numOutLoop = listLength(_chk) - listLength(_dup);

    _r1 = ((_numInLoop >= ((modelica_integer) -1) + _numOutLoop) && (_numInLoop <= ((modelica_integer) 10)));

    _r2 = (_numInLoop >= ((modelica_integer) -2) + _numOutLoop);

    _r1 = ((omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 1))?_r1:0 /* false */);

    _resolve = ((omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 2))?_r2:_r1);
  }
  _return: OMC_LABEL_UNUSED
  return _resolve;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_evaluateTripleLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn)
{
  modelica_boolean _resolve;
  modelica_metatype out_resolve;
  _resolve = omc_ResolveLoops_evaluateTripleLoop(threadData, _loopIn, _tplIn);
  out_resolve = mmc_mk_icon(_resolve);
  return out_resolve;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_evaluateLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn)
{
  modelica_boolean _resolve;
  modelica_boolean _r1;
  modelica_boolean _r2;
  modelica_integer _numInLoop;
  modelica_integer _numOutLoop;
  modelica_metatype _nonLoopEqs = NULL;
  modelica_metatype _loopEqs = NULL;
  modelica_metatype _eqCrossLst = NULL;
  modelica_metatype _chk = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _dup = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _eqVars = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _resolve = 1 /* true */;
  // _r1 has no default value.
  // _r2 has no default value.
  // _numInLoop has no default value.
  // _numOutLoop has no default value.
  // _nonLoopEqs has no default value.
  // _loopEqs has no default value.
  // _eqCrossLst has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _chk = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _dup = tmpMeta2;
  // _eqVars has no default value.
  // _m has no default value.
  if((!(omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 3))))
  {
    /* Pattern-matching assignment */
    tmpMeta3 = _tplIn;
    tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 1));
    tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta3), 3));
    _m = tmpMeta4;
    _eqCrossLst = tmpMeta5;

    _eqVars = omc_List_map1(threadData, _loopIn, boxvar_Array_getIndexFirst, _m);

    _numInLoop = omc_ResolveLoops_countDoubleEntriesInLstLst(threadData, _eqVars, _chk, _dup ,&_chk ,&_dup);

    _numOutLoop = listLength(_chk) - listLength(_dup);

    _r1 = ((_numInLoop >= ((modelica_integer) -1) + _numOutLoop) && (_numInLoop <= ((modelica_integer) 6)));

    _r2 = (_numInLoop >= ((modelica_integer) -2) + _numOutLoop);

    _r1 = ((omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 1))?_r1:0 /* false */);

    _resolve = ((omc_Flags_getConfigInt(threadData, _OMC_LIT62) == ((modelica_integer) 2))?_r2:_r1);
  }
  _return: OMC_LABEL_UNUSED
  return _resolve;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_evaluateLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _tplIn)
{
  modelica_boolean _resolve;
  modelica_metatype out_resolve;
  _resolve = omc_ResolveLoops_evaluateLoop(threadData, _loopIn, _tplIn);
  out_resolve = mmc_mk_icon(_resolve);
  return out_resolve;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_priorizeEqsWithVarCrosses2(threadData_t *threadData, modelica_integer _eq, modelica_metatype _mIn, modelica_metatype _varCrossLst, modelica_metatype _priorities)
{
  modelica_boolean _b0;
  modelica_boolean _b1;
  modelica_boolean _b2;
  modelica_metatype _eqVars = NULL;
  modelica_metatype _crossVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b0 has no default value.
  // _b1 has no default value.
  // _b2 has no default value.
  // _eqVars has no default value.
  // _crossVars has no default value.
  _eqVars = arrayGet(_mIn, _eq);

  _crossVars = omc_List_intersectionOnTrue(threadData, _eqVars, _varCrossLst, boxvar_intEq);

  if(listEmpty(_crossVars))
  {
    tmpMeta1 = mmc_mk_cons(mmc_mk_integer(_eq), MMC_REFSTRUCTLIT(mmc_nil));
    omc_ResolveLoops_arrayGetAppendLst(threadData, ((modelica_integer) 1), tmpMeta1, _priorities);
  }
  else
  {
    if(omc_List_hasOneElement(threadData, _crossVars))
    {
      tmpMeta2 = mmc_mk_cons(mmc_mk_integer(_eq), MMC_REFSTRUCTLIT(mmc_nil));
      omc_ResolveLoops_arrayGetAppendLst(threadData, ((modelica_integer) 2), tmpMeta2, _priorities);
    }
    else
    {
      tmpMeta3 = mmc_mk_cons(mmc_mk_integer(_eq), MMC_REFSTRUCTLIT(mmc_nil));
      omc_ResolveLoops_arrayGetAppendLst(threadData, ((modelica_integer) 3), tmpMeta3, _priorities);
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_priorizeEqsWithVarCrosses2(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _mIn, modelica_metatype _varCrossLst, modelica_metatype _priorities)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_eq);
  omc_ResolveLoops_priorizeEqsWithVarCrosses2(threadData, tmp1, _mIn, _varCrossLst, _priorities);
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_priorizeEqsWithVarCrosses(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _mIn, modelica_metatype _varCrossLst)
{
  modelica_metatype _eqsOut = NULL;
  modelica_metatype _priorities = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqsOut has no default value.
  // _priorities has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _priorities = arrayCreate(((modelica_integer) 3), tmpMeta1);

  {
    modelica_metatype _eq;
    for (tmpMeta2 = _eqsIn; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _eq = MMC_CAR(tmpMeta2);
      omc_ResolveLoops_priorizeEqsWithVarCrosses2(threadData, mmc_unbox_integer(_eq), _mIn, _varCrossLst, _priorities);
    }
  }

  _eqsOut = omc_List_flatten(threadData, arrayList(_priorities));
  _return: OMC_LABEL_UNUSED
  return _eqsOut;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_replaceContractedNodes2(threadData_t *threadData, modelica_integer _entryIn, modelica_integer _nodeIn, modelica_metatype _replNodes)
{
  modelica_integer _entryOut;
  modelica_boolean _repl;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _entryOut has no default value.
  // _repl has no default value.
  _repl = omc_List_isMemberOnTrue(threadData, mmc_mk_integer(_entryIn), _replNodes, boxvar_intEq);

  _entryOut = (_repl?_nodeIn:_entryIn);
  _return: OMC_LABEL_UNUSED
  return _entryOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_replaceContractedNodes2(threadData_t *threadData, modelica_metatype _entryIn, modelica_metatype _nodeIn, modelica_metatype _replNodes)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer _entryOut;
  modelica_metatype out_entryOut;
  tmp1 = mmc_unbox_integer(_entryIn);
  tmp2 = mmc_unbox_integer(_nodeIn);
  _entryOut = omc_ResolveLoops_replaceContractedNodes2(threadData, tmp1, tmp2, _replNodes);
  out_entryOut = mmc_mk_icon(_entryOut);
  return out_entryOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_replaceContractedNodes(threadData_t *threadData, modelica_metatype _pathIn, modelica_integer _nodeIn, modelica_metatype _replNodes)
{
  modelica_metatype _pathOut = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathOut has no default value.
  _pathOut = omc_List_map2(threadData, _pathIn, boxvar_ResolveLoops_replaceContractedNodes2, mmc_mk_integer(_nodeIn), _replNodes);
  _return: OMC_LABEL_UNUSED
  return _pathOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_replaceContractedNodes(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _nodeIn, modelica_metatype _replNodes)
{
  modelica_integer tmp1;
  modelica_metatype _pathOut = NULL;
  tmp1 = mmc_unbox_integer(_nodeIn);
  _pathOut = omc_ResolveLoops_replaceContractedNodes(threadData, _pathIn, tmp1, _replNodes);
  /* skip box _pathOut; list<#Integer> */
  return _pathOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_cons1(threadData_t *threadData, modelica_integer _elem, modelica_metatype _lst)
{
  modelica_metatype _outLst = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outLst has no default value.
  tmpMeta1 = mmc_mk_cons(mmc_mk_integer(_elem), _lst);
  _outLst = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outLst;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_cons1(threadData_t *threadData, modelica_metatype _elem, modelica_metatype _lst)
{
  modelica_integer tmp1;
  modelica_metatype _outLst = NULL;
  tmp1 = mmc_unbox_integer(_elem);
  _outLst = omc_ResolveLoops_cons1(threadData, tmp1, _lst);
  /* skip box _outLst; list<#Integer> */
  return _outLst;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getPathTillNextCrossEq(threadData_t *threadData, modelica_metatype _checkEqCrossNodes, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _allEqCrossNodes, modelica_metatype _unfinPathsIn, modelica_metatype _eqPathsIn)
{
  modelica_metatype _eqPathsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqPathsOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _checkEqCrossNodes;
    tmp4_2 = _unfinPathsIn;
    {
      modelica_integer _crossEq;
      modelica_integer _lastEq;
      modelica_integer _prevEq;
      modelica_metatype _adjVars = NULL;
      modelica_metatype _nextEqs = NULL;
      modelica_metatype _endEqs = NULL;
      modelica_metatype _unfinEqs = NULL;
      modelica_metatype _restCrossNodes = NULL;
      modelica_metatype _pathStart = NULL;
      modelica_metatype _paths = NULL;
      modelica_metatype _adjEqs = NULL;
      modelica_metatype _unfinPaths = NULL;
      modelica_metatype _restUnfinPaths = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _crossEq has no default value.
      // _lastEq has no default value.
      // _prevEq has no default value.
      // _adjVars has no default value.
      // _nextEqs has no default value.
      // _endEqs has no default value.
      // _unfinEqs has no default value.
      // _restCrossNodes has no default value.
      // _pathStart has no default value.
      // _paths has no default value.
      // _adjEqs has no default value.
      // _unfinPaths has no default value.
      // _restUnfinPaths has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          _crossEq = tmp8  /* pattern as ty=Integer */;
          _restCrossNodes = tmpMeta7;
          tmp4 += 2; /* Pattern matching succeeded; we may skip some cases if we fail */
          _adjVars = arrayGet(_mIn, _crossEq);

          _adjEqs = omc_List_map1(threadData, _adjVars, boxvar_Array_getIndexFirst, _mTIn);

          {
            modelica_metatype __omcQ_24tmpVar7;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_metatype __omcQ_24tmpVar6;
            modelica_integer tmp12;
            modelica_metatype _eq_loopVar = 0;
            modelica_metatype _eq;
            _eq_loopVar = _adjEqs;
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar7 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar7;
            while(1) {
              tmp12 = 1;
              if (!listEmpty(_eq_loopVar)) {
                _eq = MMC_CAR(_eq_loopVar);
                _eq_loopVar = MMC_CDR(_eq_loopVar);
                tmp12--;
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar6 = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_crossEq), _eq, boxvar_intEq, NULL);
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar6,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar7;
          }
          _adjEqs = tmpMeta9;

          _adjEqs = omc_List_filterOnFalse(threadData, _adjEqs, boxvar_listEmpty);

          _nextEqs = omc_List_flatten(threadData, _adjEqs);

          _endEqs = omc_List_intersection1OnTrue(threadData, _nextEqs, _allEqCrossNodes, boxvar_intEq ,&_unfinEqs ,NULL);

          tmpMeta13 = mmc_mk_cons(mmc_mk_integer(_crossEq), MMC_REFSTRUCTLIT(mmc_nil));
          _paths = omc_List_map1(threadData, _endEqs, boxvar_ResolveLoops_cons1, tmpMeta13);

          _paths = listAppend(_paths, _eqPathsIn);

          tmpMeta14 = mmc_mk_cons(mmc_mk_integer(_crossEq), MMC_REFSTRUCTLIT(mmc_nil));
          _unfinPaths = omc_List_map1(threadData, _unfinEqs, boxvar_ResolveLoops_cons1, tmpMeta14);

          _unfinPaths = listAppend(_unfinPaths, _unfinPathsIn);
          tmpMeta1 = omc_ResolveLoops_getPathTillNextCrossEq(threadData, _restCrossNodes, _mIn, _mTIn, _allEqCrossNodes, _unfinPaths, _paths);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta15 = MMC_CAR(tmp4_2);
          tmpMeta16 = MMC_CDR(tmp4_2);
          
          _pathStart = tmpMeta15;
          _restUnfinPaths = tmpMeta16;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _lastEq = mmc_unbox_integer(listHead(_pathStart));

          _prevEq = mmc_unbox_integer(omc_List_second(threadData, _pathStart));

          _adjVars = arrayGet(_mIn, _lastEq);

          _adjEqs = omc_List_map1(threadData, _adjVars, boxvar_Array_getIndexFirst, _mTIn);

          {
            modelica_metatype __omcQ_24tmpVar9;
            modelica_metatype* tmp18;
            modelica_metatype tmpMeta19;
            modelica_metatype __omcQ_24tmpVar8;
            modelica_integer tmp20;
            modelica_metatype _eq_loopVar = 0;
            modelica_metatype _eq;
            _eq_loopVar = _adjEqs;
            tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar9 = tmpMeta19; /* defaultValue */
            tmp18 = &__omcQ_24tmpVar9;
            while(1) {
              tmp20 = 1;
              if (!listEmpty(_eq_loopVar)) {
                _eq = MMC_CAR(_eq_loopVar);
                _eq_loopVar = MMC_CDR(_eq_loopVar);
                tmp20--;
              }
              if (tmp20 == 0) {
                __omcQ_24tmpVar8 = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_lastEq), _eq, boxvar_intEq, NULL);
                *tmp18 = mmc_mk_cons(__omcQ_24tmpVar8,0);
                tmp18 = &MMC_CDR(*tmp18);
              } else if (tmp20 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp18 = mmc_mk_nil();
            tmpMeta17 = __omcQ_24tmpVar9;
          }
          _adjEqs = tmpMeta17;

          _adjEqs = omc_List_filterOnFalse(threadData, _adjEqs, boxvar_listEmpty);

          _nextEqs = omc_List_map(threadData, _adjEqs, boxvar_listHead);

          _nextEqs = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_prevEq), _nextEqs, boxvar_intEq, NULL);

          _endEqs = omc_List_intersection1OnTrue(threadData, _nextEqs, _allEqCrossNodes, boxvar_intEq ,&_unfinEqs ,NULL);

          _paths = omc_List_map1(threadData, _endEqs, boxvar_ResolveLoops_cons1, _pathStart);

          _paths = listAppend(_paths, _eqPathsIn);

          _unfinPaths = omc_List_map1(threadData, _unfinEqs, boxvar_ResolveLoops_cons1, _pathStart);

          _unfinPaths = listAppend(_unfinPaths, _restUnfinPaths);
          tmpMeta1 = omc_ResolveLoops_getPathTillNextCrossEq(threadData, _checkEqCrossNodes, _mIn, _mTIn, _allEqCrossNodes, _unfinPaths, _paths);
          goto tmp3_done;
        }
        case 2: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _eqPathsIn;
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          omc_Error_addInternalError(threadData, _OMC_LIT63, _OMC_LIT65);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 4) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _eqPathsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqPathsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_doubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn)
{
  modelica_metatype _doubleLst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _checkLst = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _doubleLst = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _checkLst = tmpMeta2;
  {
    modelica_metatype _i;
    for (tmpMeta3 = _lstIn; !listEmpty(tmpMeta3); tmpMeta3=MMC_CDR(tmpMeta3))
    {
      _i = MMC_CAR(tmpMeta3);
      if(listMember(_i, _checkLst))
      {
        tmpMeta4 = mmc_mk_cons(_i, _doubleLst);
        _doubleLst = tmpMeta4;
      }
      else
      {
        tmpMeta5 = mmc_mk_cons(_i, _checkLst);
        _checkLst = tmpMeta5;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _doubleLst;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_countDoubleEntriesInLstLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst)
{
  modelica_integer _num;
  modelica_metatype _checkLst = NULL;
  modelica_metatype _dupLst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _num = ((modelica_integer) 0);
  _checkLst = __omcQ_24in_5FcheckLst;
  _dupLst = __omcQ_24in_5FdupLst;
  {
    modelica_metatype _lst;
    for (tmpMeta1 = _lstIn; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _lst = MMC_CAR(tmpMeta1);
      {
        modelica_metatype _elem;
        for (tmpMeta2 = _lst; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
        {
          _elem = MMC_CAR(tmpMeta2);
          if(listMember(_elem, _checkLst))
          {
            _num = ((modelica_integer) 1) + _num;

            if((!listMember(_elem, _dupLst)))
            {
              tmpMeta3 = mmc_mk_cons(_elem, _dupLst);
              _dupLst = tmpMeta3;
            }
          }
          else
          {
            tmpMeta4 = mmc_mk_cons(_elem, _checkLst);
            _checkLst = tmpMeta4;
          }
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_checkLst) { *out_checkLst = _checkLst; }
  if (out_dupLst) { *out_dupLst = _dupLst; }
  return _num;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_countDoubleEntriesInLstLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst)
{
  modelica_integer _num;
  modelica_metatype out_num;
  _num = omc_ResolveLoops_countDoubleEntriesInLstLst(threadData, _lstIn, __omcQ_24in_5FcheckLst, __omcQ_24in_5FdupLst, out_checkLst, out_dupLst);
  out_num = mmc_mk_icon(_num);
  /* skip box _checkLst; list<#Integer> */
  /* skip box _dupLst; list<#Integer> */
  return out_num;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_ResolveLoops_countDoubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst)
{
  modelica_integer _num;
  modelica_metatype _checkLst = NULL;
  modelica_metatype _dupLst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _num = ((modelica_integer) 0);
  _checkLst = __omcQ_24in_5FcheckLst;
  _dupLst = __omcQ_24in_5FdupLst;
  {
    modelica_metatype _elem;
    for (tmpMeta1 = _lstIn; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _elem = MMC_CAR(tmpMeta1);
      if(listMember(_elem, _checkLst))
      {
        _num = ((modelica_integer) 1) + _num;

        if((!listMember(_elem, _dupLst)))
        {
          tmpMeta2 = mmc_mk_cons(_elem, _dupLst);
          _dupLst = tmpMeta2;
        }
      }
      else
      {
        tmpMeta3 = mmc_mk_cons(_elem, _checkLst);
        _checkLst = tmpMeta3;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_checkLst) { *out_checkLst = _checkLst; }
  if (out_dupLst) { *out_dupLst = _dupLst; }
  return _num;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_countDoubleEntriesInLst(threadData_t *threadData, modelica_metatype _lstIn, modelica_metatype __omcQ_24in_5FcheckLst, modelica_metatype __omcQ_24in_5FdupLst, modelica_metatype *out_checkLst, modelica_metatype *out_dupLst)
{
  modelica_integer _num;
  modelica_metatype out_num;
  _num = omc_ResolveLoops_countDoubleEntriesInLst(threadData, _lstIn, __omcQ_24in_5FcheckLst, __omcQ_24in_5FdupLst, out_checkLst, out_dupLst);
  out_num = mmc_mk_icon(_num);
  /* skip box _checkLst; list<#Integer> */
  /* skip box _dupLst; list<#Integer> */
  return out_num;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_findPathByEnds(threadData_t *threadData, modelica_metatype _pathLstIn, modelica_integer _startNodeIn, modelica_integer _endNodeIn)
{
  modelica_metatype _pathOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _pathLstIn;
    {
      modelica_boolean _b1;
      modelica_boolean _b2;
      modelica_integer _startNode;
      modelica_integer _endNode;
      modelica_metatype _path = NULL;
      modelica_metatype _pathLst = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _b1 has no default value.
      // _b2 has no default value.
      // _startNode has no default value.
      // _endNode has no default value.
      // _path has no default value.
      // _pathLst has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _path = tmpMeta6;
          _pathLst = tmpMeta7;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _startNode = mmc_unbox_integer(listHead(_path));

          _b1 = (_startNode == _endNodeIn);

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

          _b2 = (_endNode == _startNodeIn);
          tmpMeta1 = ((!(_b1 && _b2))?omc_ResolveLoops_findPathByEnds(threadData, _pathLst, _startNodeIn, _endNodeIn):_path);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          omc_Error_addInternalError(threadData, _OMC_LIT66, _OMC_LIT67);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _pathOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _pathOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_findPathByEnds(threadData_t *threadData, modelica_metatype _pathLstIn, modelica_metatype _startNodeIn, modelica_metatype _endNodeIn)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _pathOut = NULL;
  tmp1 = mmc_unbox_integer(_startNodeIn);
  tmp2 = mmc_unbox_integer(_endNodeIn);
  _pathOut = omc_ResolveLoops_findPathByEnds(threadData, _pathLstIn, tmp1, tmp2);
  /* skip box _pathOut; list<#Integer> */
  return _pathOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_closePathDirectly(threadData_t *threadData, modelica_metatype _pathIn, modelica_metatype _pathLstIn)
{
  modelica_metatype _pathOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathOut has no default value.
  { /* matchcontinue expression */
    {
      modelica_boolean _closed;
      modelica_integer _startNode;
      modelica_integer _endNode;
      modelica_metatype _path = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _closed has no default value.
      // _startNode has no default value.
      // _endNode has no default value.
      // _path has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_boolean tmp6;
          /* Pattern matching succeeded */
          _startNode = mmc_unbox_integer(listHead(_pathIn));

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _pathIn));

          /* Pattern-matching assignment */
          tmp6 = (_startNode == _endNode);
          if (1 /* true */ != tmp6) goto goto_2;
          tmpMeta1 = _pathIn;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_integer tmp10;
          modelica_metatype tmpMeta11;
          modelica_boolean tmp12;
          modelica_metatype tmpMeta13;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta7 = _pathIn;
          if (listEmpty(tmpMeta7)) goto goto_2;
          tmpMeta8 = MMC_CAR(tmpMeta7);
          tmpMeta9 = MMC_CDR(tmpMeta7);
          tmp10 = mmc_unbox_integer(tmpMeta8);
          _startNode = tmp10  /* pattern as ty=Integer */;

          _endNode = mmc_unbox_integer(omc_List_last(threadData, _pathIn));

          _path = omc_ResolveLoops_findPathByEnds(threadData, _pathLstIn, _startNode, _endNode);

          _closed = (!listEmpty(_path));

          tmp12 = (modelica_boolean)_closed;
          if(tmp12)
          {
            tmpMeta13 = _path;
          }
          else
          {
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta13 = tmpMeta11;
          }
          _path = tmpMeta13;

          _path = listAppend(_pathIn, _path);
          tmpMeta1 = omc_List_unique(threadData, _path);
          goto tmp3_done;
        }
        case 2: {
          /* Pattern matching succeeded */
          omc_Error_addInternalError(threadData, _OMC_LIT68, _OMC_LIT69);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 3) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _pathOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _pathOut;
}

DLLDirection
modelica_metatype omc_ResolveLoops_sortLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _sortLoopIn)
{
  modelica_metatype _sortLoopOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sortLoopOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _loopIn;
    tmp4_2 = _sortLoopIn;
    {
      modelica_integer _start;
      modelica_integer _next;
      modelica_metatype _rest = NULL;
      modelica_metatype _vars = NULL;
      modelica_metatype _eqs = NULL;
      modelica_metatype _varEqs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _start has no default value.
      // _next has no default value.
      // _rest has no default value.
      // _vars has no default value.
      // _eqs has no default value.
      // _varEqs has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = listReverse(_sortLoopIn);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_2);
          tmpMeta7 = MMC_CDR(tmp4_2);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          
          _start = tmp8  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _vars = arrayGet(_m, _start);

          _varEqs = omc_List_map1(threadData, _vars, boxvar_Array_getIndexFirst, _mT);

          _eqs = omc_List_flatten(threadData, _varEqs);

          _eqs = omc_List_unique(threadData, _eqs);

          _eqs = omc_List_intersectionOnTrue(threadData, _eqs, _loopIn, boxvar_intEq);

          if(listEmpty(_eqs))
          {
            _next = mmc_unbox_integer(listHead(_loopIn));
          }
          else
          {
            _next = mmc_unbox_integer(listHead(_eqs));
          }

          _rest = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_next), _loopIn, boxvar_intEq, NULL);
          tmpMeta9 = mmc_mk_cons(mmc_mk_integer(_next), _sortLoopIn);
          tmpMeta1 = omc_ResolveLoops_sortLoop(threadData, _rest, _m, _mT, tmpMeta9);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _sortLoopOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sortLoopOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_varSign(threadData_t *threadData, modelica_integer _index, modelica_metatype _varMap, modelica_metatype _daeVarsIn, modelica_metatype _eq1, modelica_metatype _eq2)
{
  modelica_boolean _algSign;
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _algSign has no default value.
  _cref = omc_ResolveLoops_crefFromIndex(threadData, _index, _varMap, _daeVarsIn);
  _algSign = (!omc_ResolveLoops_CRefIsPosOnRHS(threadData, _cref, _eq1) != !omc_ResolveLoops_CRefIsPosOnRHS(threadData, _cref, _eq2));
  _return: OMC_LABEL_UNUSED
  return _algSign;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_varSign(threadData_t *threadData, modelica_metatype _index, modelica_metatype _varMap, modelica_metatype _daeVarsIn, modelica_metatype _eq1, modelica_metatype _eq2)
{
  modelica_integer tmp1;
  modelica_boolean _algSign;
  modelica_metatype out_algSign;
  tmp1 = mmc_unbox_integer(_index);
  _algSign = omc_ResolveLoops_varSign(threadData, tmp1, _varMap, _daeVarsIn, _eq1, _eq2);
  out_algSign = mmc_mk_icon(_algSign);
  return out_algSign;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_crefFromIndex(threadData_t *threadData, modelica_integer _varIdx, modelica_metatype _varMap, modelica_metatype _daeVarsIn)
{
  modelica_metatype _cref = NULL;
  modelica_integer _daeVarIdx;
  modelica_metatype _var = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _cref has no default value.
  // _daeVarIdx has no default value.
  // _var has no default value.
  _daeVarIdx = mmc_unbox_integer(arrayGet(_varMap, _varIdx));

  _var = omc_BackendVariable_getVarAt(threadData, _daeVarsIn, _daeVarIdx);

  _cref = omc_BackendVariable_varCref(threadData, _var);
  _return: OMC_LABEL_UNUSED
  return _cref;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_crefFromIndex(threadData_t *threadData, modelica_metatype _varIdx, modelica_metatype _varMap, modelica_metatype _daeVarsIn)
{
  modelica_integer tmp1;
  modelica_metatype _cref = NULL;
  tmp1 = mmc_unbox_integer(_varIdx);
  _cref = omc_ResolveLoops_crefFromIndex(threadData, tmp1, _varMap, _daeVarsIn);
  /* skip box _cref; DAE.ComponentRef */
  return _cref;
}

static modelica_metatype closure2_ResolveLoops_varSign(threadData_t *thData, modelica_metatype closure, modelica_metatype index)
{
  modelica_metatype varMap = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype daeVarsIn = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  modelica_metatype eq1 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),3));
  modelica_metatype eq2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),4));
  return boxptr_ResolveLoops_varSign(thData, index, varMap, daeVarsIn, eq1, eq2);
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveClosedLoop2(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _loopIn, modelica_metatype _m, modelica_metatype __omcQ_24in_5Fm_5Frow, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype *out_m_row)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _m_row = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  _m_row = __omcQ_24in_5Fm_5Frow;
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _loopIn;
    {
      modelica_boolean _algSign;
      modelica_integer _eqIdx2;
      modelica_metatype _adjVars = NULL;
      modelica_metatype _adjVars1 = NULL;
      modelica_metatype _adjVars2 = NULL;
      modelica_metatype _restLoop = NULL;
      modelica_metatype _posVars = NULL;
      modelica_metatype _negVars = NULL;
      modelica_metatype _adjCrefs = NULL;
      modelica_metatype _eq2 = NULL;
      modelica_metatype _eq3 = NULL;
      modelica_metatype _resolvedEq = NULL;
      modelica_metatype _replacements = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _algSign has no default value.
      // _eqIdx2 has no default value.
      // _adjVars has no default value.
      // _adjVars1 has no default value.
      // _adjVars2 has no default value.
      // _restLoop has no default value.
      // _posVars has no default value.
      // _negVars has no default value.
      // _adjCrefs has no default value.
      // _eq2 has no default value.
      // _eq3 has no default value.
      // _resolvedEq has no default value.
      // _replacements has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _eq;
          tmpMeta[0+1] = _m_row;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_integer tmp12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_1);
          tmpMeta9 = MMC_CDR(tmp4_1);
          if (listEmpty(tmpMeta9)) goto tmp3_end;
          tmpMeta10 = MMC_CAR(tmpMeta9);
          tmpMeta11 = MMC_CDR(tmpMeta9);
          tmp12 = mmc_unbox_integer(tmpMeta10);
          _eqIdx2 = tmp12  /* pattern as ty=Integer */;
          _restLoop = tmpMeta11;
          /* Pattern matching succeeded */
          _eq2 = omc_BackendEquation_get(threadData, _daeEqsIn, mmc_unbox_integer(arrayGet(_eqMap, _eqIdx2)));

          _adjVars1 = _m_row;

          _adjVars2 = arrayGet(_m, _eqIdx2);

          _adjVars = omc_List_intersection1OnTrue(threadData, _adjVars1, _adjVars2, boxvar_intEq ,&_adjVars1 ,&_adjVars2);

          tmpMeta13 = mmc_mk_box4(0, _varMap, _daeVarsIn, _eq, _eq2);
          _posVars = omc_List_splitOnTrue(threadData, _adjVars, (modelica_fnptr) mmc_mk_box2(0,closure2_ResolveLoops_varSign,tmpMeta13) ,&_negVars);

          _algSign = (listLength(_posVars) > listLength(_negVars));

          {
            modelica_metatype __omcQ_24tmpVar11;
            modelica_metatype* tmp15;
            modelica_metatype tmpMeta16;
            modelica_metatype __omcQ_24tmpVar10;
            modelica_integer tmp17;
            modelica_metatype _idx_loopVar = 0;
            modelica_metatype _idx;
            _idx_loopVar = (_algSign?_posVars:_negVars);
            tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar11 = tmpMeta16; /* defaultValue */
            tmp15 = &__omcQ_24tmpVar11;
            while(1) {
              tmp17 = 1;
              if (!listEmpty(_idx_loopVar)) {
                _idx = MMC_CAR(_idx_loopVar);
                _idx_loopVar = MMC_CDR(_idx_loopVar);
                tmp17--;
              }
              if (tmp17 == 0) {
                __omcQ_24tmpVar10 = omc_ResolveLoops_crefFromIndex(threadData, mmc_unbox_integer(_idx), _varMap, _daeVarsIn);
                *tmp15 = mmc_mk_cons(__omcQ_24tmpVar10,0);
                tmp15 = &MMC_CDR(*tmp15);
              } else if (tmp17 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp15 = mmc_mk_nil();
            tmpMeta14 = __omcQ_24tmpVar11;
          }
          _adjCrefs = tmpMeta14;

          tmpMeta18 = mmc_mk_cons(_adjVars1, mmc_mk_cons(_adjVars2, mmc_mk_cons((_algSign?_negVars:_posVars), MMC_REFSTRUCTLIT(mmc_nil))));
          _m_row = omc_List_flatten(threadData, tmpMeta18);

          _replacements = omc_BackendVarTransform_emptyReplacementsSized(threadData, listLength(_adjCrefs));

          {
            modelica_metatype __omcQ_24tmpVar13;
            modelica_metatype* tmp20;
            modelica_metatype tmpMeta21;
            modelica_metatype __omcQ_24tmpVar12;
            modelica_integer tmp22;
            modelica_metatype _c_loopVar = 0;
            modelica_metatype _c;
            _c_loopVar = _adjCrefs;
            tmpMeta21 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar13 = tmpMeta21; /* defaultValue */
            tmp20 = &__omcQ_24tmpVar13;
            while(1) {
              tmp22 = 1;
              if (!listEmpty(_c_loopVar)) {
                _c = MMC_CAR(_c_loopVar);
                _c_loopVar = MMC_CDR(_c_loopVar);
                tmp22--;
              }
              if (tmp22 == 0) {
                __omcQ_24tmpVar12 = omc_Expression_createZeroExpression(threadData, omc_ComponentReference_crefTypeFull(threadData, _c));
                *tmp20 = mmc_mk_cons(__omcQ_24tmpVar12,0);
                tmp20 = &MMC_CDR(*tmp20);
              } else if (tmp22 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp20 = mmc_mk_nil();
            tmpMeta19 = __omcQ_24tmpVar13;
          }
          _replacements = omc_BackendVarTransform_addReplacements(threadData, _replacements, _adjCrefs, tmpMeta19, mmc_mk_none());

          /* Pattern-matching tuple assignment */
          tmpMeta23 = mmc_mk_cons(_eq, mmc_mk_cons(_eq2, MMC_REFSTRUCTLIT(mmc_nil)));
          tmpMeta24 = omc_BackendVarTransform_replaceEquations(threadData, tmpMeta23, _replacements, mmc_mk_none(), NULL);
          if (listEmpty(tmpMeta24)) goto goto_2;
          tmpMeta25 = MMC_CAR(tmpMeta24);
          tmpMeta26 = MMC_CDR(tmpMeta24);
          if (listEmpty(tmpMeta26)) goto goto_2;
          tmpMeta27 = MMC_CAR(tmpMeta26);
          tmpMeta28 = MMC_CDR(tmpMeta26);
          if (!listEmpty(tmpMeta28)) goto goto_2;
          _resolvedEq = tmpMeta25;
          _eq3 = tmpMeta27;

          _resolvedEq = omc_ResolveLoops_sumUp2Equations(threadData, _algSign, _resolvedEq, _eq3);

          if(omc_Flags_isSet(threadData, _OMC_LIT76))
          {
            tmpMeta29 = stringAppend(_OMC_LIT70,omc_BackendDump_equationString(threadData, _eq));
            tmpMeta30 = stringAppend(tmpMeta29,_OMC_LIT2);
            tmpMeta31 = stringAppend(tmpMeta30,omc_BackendDump_equationString(threadData, _eq2));
            tmpMeta32 = stringAppend(tmpMeta31,_OMC_LIT2);
            fputs(MMC_STRINGDATA(tmpMeta32),stdout);

            tmpMeta33 = stringAppend(_OMC_LIT71,omc_BackendDump_equationString(threadData, _resolvedEq));
            tmpMeta34 = stringAppend(tmpMeta33,_OMC_LIT72);
            fputs(MMC_STRINGDATA(tmpMeta34),stdout);
          }
          tmpMeta35 = mmc_mk_cons(mmc_mk_integer(_eqIdx2), _restLoop);
          /* Tail recursive call */
          __omcQ_24in_5Feq = _resolvedEq;
          _loopIn = tmpMeta35;
          __omcQ_24in_5Fm_5Frow = _m_row;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta[0+0];
  _m_row = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_m_row) { *out_m_row = _m_row; }
  return _eq;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveClosedLoop(threadData_t *threadData, modelica_metatype _loopIn, modelica_metatype _m, modelica_metatype _mT, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype *out_m_row)
{
  modelica_metatype _eqOut = NULL;
  modelica_metatype _m_row = NULL;
  modelica_integer _startEqIdx;
  modelica_integer _startEqDaeIdx;
  modelica_metatype _loop1 = NULL;
  modelica_metatype _restLoop = NULL;
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqOut has no default value.
  // _m_row has no default value.
  // _startEqIdx has no default value.
  // _startEqDaeIdx has no default value.
  // _loop1 has no default value.
  // _restLoop has no default value.
  // _eq has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _loopIn;
  if (listEmpty(tmpMeta1)) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_CAR(tmpMeta1);
  tmpMeta3 = MMC_CDR(tmpMeta1);
  tmp4 = mmc_unbox_integer(tmpMeta2);
  _startEqIdx = tmp4  /* pattern as ty=Integer */;
  _restLoop = tmpMeta3;

  _startEqDaeIdx = mmc_unbox_integer(arrayGet(_eqMap, _startEqIdx));

  tmpMeta5 = mmc_mk_cons(mmc_mk_integer(_startEqIdx), MMC_REFSTRUCTLIT(mmc_nil));
  _loop1 = omc_ResolveLoops_sortLoop(threadData, _restLoop, _m, _mT, tmpMeta5);

  if((omc_Flags_isSet(threadData, _OMC_LIT76) && (listLength(_loop1) > ((modelica_integer) 1))))
  {
    tmpMeta6 = stringAppend(_OMC_LIT77,omc_List_toString(threadData, _loop1, boxvar_intString, _OMC_LIT28, _OMC_LIT78, _OMC_LIT79, _OMC_LIT80, 1 /* true */, ((modelica_integer) 0)));
    tmpMeta7 = stringAppend(tmpMeta6,_OMC_LIT2);
    fputs(MMC_STRINGDATA(tmpMeta7),stdout);
  }

  _eq = omc_BackendEquation_get(threadData, _daeEqsIn, _startEqDaeIdx);

  _eqOut = omc_ResolveLoops_resolveClosedLoop2(threadData, _eq, _loop1, _m, arrayGet(_m, _startEqIdx), _eqMap, _varMap, _daeEqsIn, _daeVarsIn ,&_m_row);
  _return: OMC_LABEL_UNUSED
  if (out_m_row) { *out_m_row = _m_row; }
  return _eqOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getEqNodesForVarLoop(threadData_t *threadData, modelica_metatype _varIdcs, modelica_metatype _mTIn)
{
  modelica_metatype _eqIdcs = NULL;
  modelica_metatype _varEqLst = NULL;
  modelica_metatype _eqLst = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqIdcs has no default value.
  // _varEqLst has no default value.
  // _eqLst has no default value.
  _varEqLst = omc_List_map1(threadData, _varIdcs, boxvar_Array_getIndexFirst, _mTIn);

  _eqLst = omc_List_flatten(threadData, _varEqLst);

  _eqIdcs = omc_ResolveLoops_doubleEntriesInLst(threadData, _eqLst);
  _return: OMC_LABEL_UNUSED
  return _eqIdcs;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getTriples(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype _minAdj, modelica_metatype *out_allPaths)
{
  modelica_metatype _tripleLoops = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _allPaths = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _path1 = NULL;
  modelica_metatype _path2 = NULL;
  modelica_metatype _path3 = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _tripleLoops = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _allPaths = tmpMeta2;
  // _path1 has no default value.
  // _path2 has no default value.
  // _path3 has no default value.
  {
    modelica_metatype _c0;
    for (tmpMeta3 = _crossNodes; !listEmpty(tmpMeta3); tmpMeta3=MMC_CDR(tmpMeta3))
    {
      _c0 = MMC_CAR(tmpMeta3);
      _path1 = arrayGet(_minAdj, mmc_unbox_integer(_c0));

      {
        modelica_metatype _c1;
        for (tmpMeta4 = _path1; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
        {
          _c1 = MMC_CAR(tmpMeta4);
          if((mmc_unbox_integer(_c1) > mmc_unbox_integer(_c0)))
          {
            _path2 = arrayGet(_minAdj, mmc_unbox_integer(_c1));

            {
              modelica_metatype _c2;
              for (tmpMeta5 = _path2; !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
              {
                _c2 = MMC_CAR(tmpMeta5);
                if((mmc_unbox_integer(_c2) > mmc_unbox_integer(_c1)))
                {
                  _path3 = arrayGet(_minAdj, mmc_unbox_integer(_c2));

                  if(omc_ResolveLoops_listContains(threadData, _path3, mmc_unbox_integer(_c0)))
                  {
                    tmpMeta7 = mmc_mk_cons(_c0, mmc_mk_cons(_c1, mmc_mk_cons(_c2, MMC_REFSTRUCTLIT(mmc_nil))));
                    tmpMeta6 = mmc_mk_cons(tmpMeta7, _tripleLoops);
                    _tripleLoops = tmpMeta6;

                    tmpMeta9 = mmc_mk_cons(_c1, mmc_mk_cons(_c2, MMC_REFSTRUCTLIT(mmc_nil)));
                    tmpMeta8 = mmc_mk_cons(tmpMeta9, _allPaths);
                    _allPaths = tmpMeta8;

                    tmpMeta11 = mmc_mk_cons(_c0, mmc_mk_cons(_c2, MMC_REFSTRUCTLIT(mmc_nil)));
                    tmpMeta10 = mmc_mk_cons(tmpMeta11, _allPaths);
                    _allPaths = tmpMeta10;

                    tmpMeta13 = mmc_mk_cons(_c0, mmc_mk_cons(_c1, MMC_REFSTRUCTLIT(mmc_nil)));
                    tmpMeta12 = mmc_mk_cons(tmpMeta13, _allPaths);
                    _allPaths = tmpMeta12;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_allPaths) { *out_allPaths = _allPaths; }
  return _tripleLoops;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getDoubles(threadData_t *threadData, modelica_metatype _elemLstIn, modelica_metatype _lstIn)
{
  modelica_metatype _lstOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lstOut has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _elemLstIn;
    {
      modelica_metatype _elem = NULL;
      modelica_metatype _lst = NULL;
      modelica_metatype _elemLst = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _elem has no default value.
      // _lst has no default value.
      // _elemLst has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _lstIn;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _elem = tmpMeta6;
          _elemLst = tmpMeta7;
          /* Pattern matching succeeded */
          if(listMember(_elem, _elemLst))
          {
            tmpMeta8 = mmc_mk_cons(_elem, _lstIn);
            _lst = omc_ResolveLoops_getDoubles(threadData, _elemLst, tmpMeta8);
          }
          else
          {
            _lst = omc_ResolveLoops_getDoubles(threadData, _elemLst, _lstIn);
          }
          tmpMeta1 = _lst;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _lstOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _lstOut;
}

static modelica_metatype closure3_List_isEqualOnTrue(threadData_t *thData, modelica_metatype closure, modelica_metatype inList1, modelica_metatype inList2)
{
  modelica_fnptr inCompFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_List_isEqualOnTrue(thData, inList1, inList2, inCompFunc);
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getReverseDoubles(threadData_t *threadData, modelica_metatype _elem, modelica_metatype _elemLst, modelica_metatype _foldLstIn)
{
  modelica_metatype _foldLstOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _foldLstOut has no default value.
  { /* matchcontinue expression */
    {
      modelica_metatype _elemR = NULL;
      modelica_metatype _foldLst = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _elemR has no default value.
      // _foldLst has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          /* Pattern matching succeeded */
          _elemR = listReverse(_elem);

          _elemR = omc_List_getMember(threadData, _elemR, _elemLst);

          tmpMeta6 = mmc_mk_box1(0, boxvar_intEq);
          _foldLst = omc_List_deleteMemberOnTrue(threadData, _elem, _foldLstIn, (modelica_fnptr) mmc_mk_box2(0,closure3_List_isEqualOnTrue,tmpMeta6), NULL);
          tmpMeta7 = mmc_mk_cons(_elemR, _foldLst);
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          tmpMeta1 = _foldLstIn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _foldLstOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _foldLstOut;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_arrayGetAppendLst(threadData_t *threadData, modelica_integer _idx, modelica_metatype _appLst, modelica_metatype _arrIn)
{
  modelica_metatype _entry = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _entry has no default value.
  _entry = arrayGet(_arrIn, _idx);

  arrayUpdate(_arrIn, _idx, listAppend(_entry, _appLst));
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_arrayGetAppendLst(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _appLst, modelica_metatype _arrIn)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_idx);
  omc_ResolveLoops_arrayGetAppendLst(threadData, tmp1, _appLst, _arrIn);
  return;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_arrayGetDeleteInLst(threadData_t *threadData, modelica_integer _idx, modelica_metatype _delEntries, modelica_metatype _arrIn)
{
  modelica_metatype _entry = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _entry has no default value.
  _entry = arrayGet(_arrIn, _idx);

  omc_List_intersection1OnTrue(threadData, _entry, _delEntries, boxvar_intEq ,&_entry ,NULL);

  arrayUpdate(_arrIn, _idx, _entry);
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_arrayGetDeleteInLst(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _delEntries, modelica_metatype _arrIn)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_idx);
  omc_ResolveLoops_arrayGetDeleteInLst(threadData, tmp1, _delEntries, _arrIn);
  return;
}

PROTECTED_FUNCTION_STATIC void omc_ResolveLoops_markDeadEndsInBipartiteGraph(threadData_t *threadData, modelica_integer _varIdx, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _deadEndEqs, modelica_metatype _deadEndVars)
{
  modelica_integer _eqIdx;
  modelica_integer _nextVarIdx;
  modelica_metatype _adjEqs = NULL;
  modelica_metatype _adjVars = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqIdx has no default value.
  // _nextVarIdx has no default value.
  // _adjEqs has no default value.
  // _adjVars has no default value.
  _adjEqs = arrayGet(_mTIn, _varIdx);

  _adjEqs = omc_List_filter1OnTrue(threadData, _adjEqs, boxvar_ResolveLoops_arrayIsZeroAt, _deadEndEqs);

  if((listLength(_adjEqs) == ((modelica_integer) 1)))
  {
    _eqIdx = mmc_unbox_integer(listHead(_adjEqs));

    arrayUpdate(_deadEndVars, _varIdx, mmc_mk_integer(((modelica_integer) 1)));

    _adjVars = arrayGet(_mIn, _eqIdx);

    _adjVars = omc_List_filter1OnTrue(threadData, _adjVars, boxvar_ResolveLoops_arrayIsZeroAt, _deadEndVars);

    if((listLength(_adjVars) == ((modelica_integer) 1)))
    {
      _nextVarIdx = mmc_unbox_integer(listHead(_adjVars));

      arrayUpdate(_deadEndEqs, _eqIdx, mmc_mk_integer(((modelica_integer) 1)));

      /* Tail recursive call */
      _varIdx = _nextVarIdx;
      goto _tailrecursive;
      /* TODO: Make sure any eventual dead code below is never generated */
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}
PROTECTED_FUNCTION_STATIC void boxptr_ResolveLoops_markDeadEndsInBipartiteGraph(threadData_t *threadData, modelica_metatype _varIdx, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _deadEndEqs, modelica_metatype _deadEndVars)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_varIdx);
  omc_ResolveLoops_markDeadEndsInBipartiteGraph(threadData, tmp1, _mIn, _mTIn, _deadEndEqs, _deadEndVars);
  return;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayIsZeroAt(threadData_t *threadData, modelica_integer _pos, modelica_metatype _arr)
{
  modelica_boolean _isZero;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _isZero has no default value.
  _isZero = (((modelica_integer) 0) == mmc_unbox_integer(arrayGet(_arr,_pos) /* DAE.ASUB */));
  _return: OMC_LABEL_UNUSED
  return _isZero;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayIsZeroAt(threadData_t *threadData, modelica_metatype _pos, modelica_metatype _arr)
{
  modelica_integer tmp1;
  modelica_boolean _isZero;
  modelica_metatype out_isZero;
  tmp1 = mmc_unbox_integer(_pos);
  _isZero = omc_ResolveLoops_arrayIsZeroAt(threadData, tmp1, _arr);
  out_isZero = mmc_mk_icon(_isZero);
  return out_isZero;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_eqIsConst(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,1,1) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,6,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,4) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,6,2) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,1,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_eqIsConst(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_ResolveLoops_eqIsConst(threadData, _eq);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__resolveAndReplace(threadData_t *threadData, modelica_metatype _loopsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqsIn, modelica_metatype _daeVarsIn, modelica_metatype _replEqsIn, modelica_metatype *out_replEqsOut)
{
  modelica_metatype _daeEqsOut = NULL;
  modelica_metatype _replEqsOut = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _daeEqsOut has no default value.
  // _replEqsOut has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
    tmp4_1 = _loopsIn;
    tmp4_2 = _eqCrossLstIn;
    tmp4_3 = _varCrossLstIn;
    {
      modelica_integer _pos;
      modelica_integer _eq1;
      modelica_integer _eq2;
      modelica_metatype _loop1 = NULL;
      modelica_metatype _eqs = NULL;
      modelica_metatype _vars = NULL;
      modelica_metatype _crossEqs = NULL;
      modelica_metatype _crossVars = NULL;
      modelica_metatype _replEqs = NULL;
      modelica_metatype _loopVars = NULL;
      modelica_metatype _adjVars = NULL;
      modelica_metatype _m_row = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _eqVars = NULL;
      modelica_metatype _resolvedEq = NULL;
      modelica_metatype _daeEqs = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _pos has no default value.
      // _eq1 has no default value.
      // _eq2 has no default value.
      // _loop1 has no default value.
      // _eqs has no default value.
      // _vars has no default value.
      // _crossEqs has no default value.
      // _crossVars has no default value.
      // _replEqs has no default value.
      // _loopVars has no default value.
      // _adjVars has no default value.
      // _m_row has no default value.
      // _rest has no default value.
      // _eqVars has no default value.
      // _resolvedEq has no default value.
      // _daeEqs has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _daeEqsIn;
          tmpMeta[0+1] = _replEqsIn;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_2);
          tmpMeta9 = MMC_CDR(tmp4_2);
          if (!listEmpty(tmp4_3)) goto tmp3_end;
          _loop1 = tmpMeta6;
          _rest = tmpMeta7;
          _crossEqs = tmpMeta9;
          /* Pattern matching succeeded */
          _loop1 = omc_List_unique(threadData, _loop1);

          _resolvedEq = omc_ResolveLoops_resolveClosedLoop(threadData, _loop1, _mIn, _mTIn, _eqMap, _varMap, _daeEqsIn, _daeVarsIn ,&_m_row);

          _crossEqs = omc_List_intersection1OnTrue(threadData, _loop1, _eqCrossLstIn, boxvar_intEq ,&_eqs ,NULL);

          _replEqs = omc_List_intersectionOnTrue(threadData, _replEqsIn, _loop1, boxvar_intEq);

          if((!listEmpty(_eqs)))
          {
            _pos = mmc_unbox_integer(listHead(_eqs));
          }
          else
          {
            if((!listEmpty(_replEqs)))
            {
              _pos = mmc_unbox_integer(listHead(_replEqs));
            }
            else
            {
              if((!listEmpty(_crossEqs)))
              {
                _pos = mmc_unbox_integer(listHead(_crossEqs));
              }
              else
              {
                _pos = ((modelica_integer) -1);
              }
            }
          }

          _eqs = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_pos), _loop1, boxvar_intEq, NULL);

          _eqVars = omc_List_map1(threadData, _loop1, boxvar_Array_getIndexFirst, _mIn);

          _vars = omc_List_flatten(threadData, _eqVars);

          _loopVars = omc_ResolveLoops_doubleEntriesInLst(threadData, _vars);

          omc_List_intersection1OnTrue(threadData, _vars, _loopVars, boxvar_intEq ,&_adjVars ,NULL);

          tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _loopVars, boxvar_Array_updateIndexFirst, tmpMeta10, _mTIn);

          omc_List_map2__0(threadData, _adjVars, boxvar_ResolveLoops_arrayGetDeleteInLst, _loop1, _mTIn);

          tmpMeta11 = mmc_mk_cons(mmc_mk_integer(_pos), MMC_REFSTRUCTLIT(mmc_nil));
          omc_List_map2__0(threadData, _adjVars, boxvar_ResolveLoops_arrayGetAppendLst, tmpMeta11, _mTIn);

          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _loop1, boxvar_Array_updateIndexFirst, tmpMeta12, _mIn);

          arrayUpdate(_mIn, _pos, _adjVars);

          _rest = omc_List_map2(threadData, _rest, boxvar_ResolveLoops_replaceContractedNodes, mmc_mk_integer(_pos), _eqs);

          _rest = omc_List_unique(threadData, _rest);

          tmpMeta13 = mmc_mk_cons(mmc_mk_integer(_pos), _replEqsIn);
          _replEqs = tmpMeta13;

          arrayUpdate(_mIn, _pos, _m_row);

          _pos = mmc_unbox_integer(arrayGet(_eqMap, _pos));

          _daeEqs = omc_BackendEquation_setAtIndex(threadData, _daeEqsIn, _pos, _resolvedEq);
          /* Tail recursive call */
          _loopsIn = _rest;
          _daeEqsIn = _daeEqs;
          _replEqsIn = _replEqs;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta14 = MMC_CAR(tmp4_1);
          tmpMeta15 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          if (listEmpty(tmp4_3)) goto tmp3_end;
          tmpMeta16 = MMC_CAR(tmp4_3);
          tmpMeta17 = MMC_CDR(tmp4_3);
          _loop1 = tmpMeta14;
          _rest = tmpMeta15;
          _crossVars = tmpMeta17;
          /* Pattern matching succeeded */
          _loop1 = omc_List_unique(threadData, _loop1);

          _resolvedEq = omc_ResolveLoops_resolveClosedLoop(threadData, _loop1, _mIn, _mTIn, _eqMap, _varMap, _daeEqsIn, _daeVarsIn ,&_m_row);

          _replEqs = omc_List_intersection1OnTrue(threadData, _replEqsIn, _loop1, boxvar_intEq ,NULL ,&_eqs);

          _eqs = omc_ResolveLoops_priorizeEqsWithVarCrosses(threadData, _eqs, _mIn, _varCrossLstIn);

          _pos = ((!listEmpty(_replEqs))?mmc_unbox_integer(listHead(_replEqs)):((modelica_integer) -1));

          _pos = ((!listEmpty(_eqs))?mmc_unbox_integer(listHead(_eqs)):_pos);

          _eqs = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_pos), _loop1, boxvar_intEq, NULL);

          _eqVars = omc_List_map1(threadData, _loop1, boxvar_Array_getIndexFirst, _mIn);

          _vars = omc_List_flatten(threadData, _eqVars);

          _loopVars = omc_ResolveLoops_doubleEntriesInLst(threadData, _vars);

          _crossVars = omc_List_intersection1OnTrue(threadData, _loopVars, _varCrossLstIn, boxvar_intEq ,&_loopVars ,NULL);

          omc_List_intersection1OnTrue(threadData, _vars, _loopVars, boxvar_intEq ,&_adjVars ,NULL);

          _adjVars = listAppend(_crossVars, _adjVars);

          _adjVars = omc_List_unique(threadData, _adjVars);

          tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _loopVars, boxvar_Array_updateIndexFirst, tmpMeta18, _mTIn);

          omc_List_map2__0(threadData, _adjVars, boxvar_ResolveLoops_arrayGetDeleteInLst, _loop1, _mTIn);

          tmpMeta19 = mmc_mk_cons(mmc_mk_integer(_pos), MMC_REFSTRUCTLIT(mmc_nil));
          omc_List_map2__0(threadData, _adjVars, boxvar_ResolveLoops_arrayGetAppendLst, tmpMeta19, _mTIn);

          tmpMeta20 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _loop1, boxvar_Array_updateIndexFirst, tmpMeta20, _mIn);

          arrayUpdate(_mIn, _pos, _adjVars);

          _rest = omc_List_map2(threadData, _rest, boxvar_ResolveLoops_replaceContractedNodes, mmc_mk_integer(_pos), _eqs);

          _rest = omc_List_unique(threadData, _rest);

          tmpMeta21 = mmc_mk_cons(mmc_mk_integer(_pos), _replEqsIn);
          _replEqs = tmpMeta21;

          arrayUpdate(_mIn, _pos, _m_row);

          _pos = mmc_unbox_integer(arrayGet(_eqMap, _pos));

          _daeEqs = omc_BackendEquation_setAtIndex(threadData, _daeEqsIn, _pos, _resolvedEq);
          /* Tail recursive call */
          _loopsIn = _rest;
          _daeEqsIn = _daeEqs;
          _replEqsIn = _replEqs;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_integer tmp27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta22 = MMC_CAR(tmp4_1);
          tmpMeta23 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          if (!listEmpty(tmp4_3)) goto tmp3_end;
          _loop1 = tmpMeta22;
          _rest = tmpMeta23;
          /* Pattern matching succeeded */
          _loop1 = omc_List_unique(threadData, _loop1);

          _resolvedEq = omc_ResolveLoops_resolveClosedLoop(threadData, _loop1, _mIn, _mTIn, _eqMap, _varMap, _daeEqsIn, _daeVarsIn ,&_m_row);

          omc_List_intersection1OnTrue(threadData, _loop1, _replEqsIn, boxvar_intEq ,&_crossEqs ,NULL);

          /* Pattern-matching assignment */
          tmpMeta24 = _crossEqs;
          if (listEmpty(tmpMeta24)) goto goto_2;
          tmpMeta25 = MMC_CAR(tmpMeta24);
          tmpMeta26 = MMC_CDR(tmpMeta24);
          tmp27 = mmc_unbox_integer(tmpMeta25);
          _pos = tmp27  /* pattern as ty=Integer */;

          _eqVars = omc_List_map1(threadData, _loop1, boxvar_Array_getIndexFirst, _mIn);

          _vars = omc_List_flatten(threadData, _eqVars);

          tmpMeta28 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _loop1, boxvar_Array_updateIndexFirst, tmpMeta28, _mIn);

          tmpMeta29 = MMC_REFSTRUCTLIT(mmc_nil);
          omc_List_map2__0(threadData, _vars, boxvar_Array_updateIndexFirst, tmpMeta29, _mTIn);

          tmpMeta30 = mmc_mk_cons(mmc_mk_integer(_pos), _replEqsIn);
          _replEqs = tmpMeta30;

          arrayUpdate(_mIn, _pos, _m_row);

          _pos = mmc_unbox_integer(arrayGet(_eqMap, _pos));

          _daeEqs = omc_BackendEquation_setAtIndex(threadData, _daeEqsIn, _pos, _resolvedEq);
          /* Tail recursive call */
          _loopsIn = _rest;
          _daeEqsIn = _daeEqs;
          _replEqsIn = _replEqs;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_boolean tmp37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_integer tmp41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_integer tmp44;
          modelica_metatype tmpMeta45;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta31 = MMC_CAR(tmp4_1);
          tmpMeta32 = MMC_CDR(tmp4_1);
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta33 = MMC_CAR(tmp4_2);
          tmpMeta34 = MMC_CDR(tmp4_2);
          if (listEmpty(tmp4_3)) goto tmp3_end;
          tmpMeta35 = MMC_CAR(tmp4_3);
          tmpMeta36 = MMC_CDR(tmp4_3);
          _loop1 = tmpMeta31;
          _rest = tmpMeta32;
          /* Pattern matching succeeded */
          _loop1 = omc_List_unique(threadData, _loop1);

          /* Pattern-matching assignment */
          tmp37 = (listLength(_loop1) == ((modelica_integer) 2));
          if (1 /* true */ != tmp37) goto goto_2;

          _resolvedEq = omc_ResolveLoops_resolveClosedLoop(threadData, _loop1, _mIn, _mTIn, _eqMap, _varMap, _daeEqsIn, _daeVarsIn ,&_m_row);

          if(omc_ResolveLoops_eqIsConst(threadData, _resolvedEq))
          {
            /* Pattern-matching assignment */
            tmpMeta38 = _loop1;
            if (listEmpty(tmpMeta38)) goto goto_2;
            tmpMeta39 = MMC_CAR(tmpMeta38);
            tmpMeta40 = MMC_CDR(tmpMeta38);
            tmp41 = mmc_unbox_integer(tmpMeta39);
            if (listEmpty(tmpMeta40)) goto goto_2;
            tmpMeta42 = MMC_CAR(tmpMeta40);
            tmpMeta43 = MMC_CDR(tmpMeta40);
            tmp44 = mmc_unbox_integer(tmpMeta42);
            if (!listEmpty(tmpMeta43)) goto goto_2;
            _eq1 = tmp41  /* pattern as ty=Integer */;
            _eq2 = tmp44  /* pattern as ty=Integer */;

            if((listLength(omc_BackendEquation_equationVars(threadData, omc_BackendEquation_get(threadData, _daeEqsIn, mmc_unbox_integer(arrayGet(_eqMap, _eq1))), _daeVarsIn)) >= listLength(omc_BackendEquation_equationVars(threadData, omc_BackendEquation_get(threadData, _daeEqsIn, mmc_unbox_integer(arrayGet(_eqMap, _eq2))), _daeVarsIn))))
            {
              _pos = _eq1;
            }
            else
            {
              _pos = _eq2;
            }

            tmpMeta45 = mmc_mk_cons(mmc_mk_integer(_pos), _replEqsIn);
            _replEqs = tmpMeta45;

            arrayUpdate(_mIn, _pos, _m_row);

            _pos = mmc_unbox_integer(arrayGet(_eqMap, _pos));

            _daeEqs = omc_BackendEquation_setAtIndex(threadData, _daeEqsIn, _pos, _resolvedEq);
          }
          else
          {
            _replEqs = _replEqsIn;

            _daeEqs = _daeEqsIn;
          }
          /* Tail recursive call */
          _loopsIn = _rest;
          _daeEqsIn = _daeEqs;
          _replEqsIn = _replEqs;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _daeEqsOut = tmpMeta[0+0];
  _replEqsOut = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_replEqsOut) { *out_replEqsOut = _replEqsOut; }
  return _daeEqsOut;
}

static modelica_metatype closure4_List_isEqualOnTrue(threadData_t *thData, modelica_metatype closure, modelica_metatype inList1, modelica_metatype inList2)
{
  modelica_fnptr inCompFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_List_isEqualOnTrue(thData, inList1, inList2, inCompFunc);
}static modelica_metatype closure5_List_isEqualOnTrue(threadData_t *thData, modelica_metatype closure, modelica_metatype inList1, modelica_metatype inList2)
{
  modelica_fnptr inCompFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_List_isEqualOnTrue(thData, inList1, inList2, inCompFunc);
}
PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_connectPathsToOneLoop(threadData_t *threadData, modelica_metatype _allPathsIn, modelica_metatype _loopIn)
{
  modelica_metatype _loopOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _loopOut has no default value.
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;volatile modelica_metatype tmp4_2;
    tmp4_1 = _allPathsIn;
    tmp4_2 = _loopIn;
    {
      modelica_integer _startNode;
      modelica_integer _endNode;
      modelica_metatype _path = NULL;
      modelica_metatype _nextPath = NULL;
      modelica_metatype _restPath = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _nextPaths1 = NULL;
      modelica_metatype _nextPaths2 = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _startNode has no default value.
      // _endNode has no default value.
      // _path has no default value.
      // _nextPath has no default value.
      // _restPath has no default value.
      // _rest has no default value.
      // _nextPaths1 has no default value.
      // _nextPaths2 has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_boolean tmp9;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_2);
          tmpMeta7 = MMC_CDR(tmp4_2);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          
          _startNode = tmp8  /* pattern as ty=Integer */;
          _path = tmpMeta7;
          /* Pattern matching succeeded */
          _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

          /* Pattern-matching assignment */
          tmp9 = (_startNode == _endNode);
          if (1 /* true */ != tmp9) goto goto_2;
          tmpMeta1 = _path;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_integer tmp12;
          modelica_metatype tmpMeta13;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta10 = MMC_CAR(tmp4_2);
          tmpMeta11 = MMC_CDR(tmp4_2);
          tmp12 = mmc_unbox_integer(tmpMeta10);
          
          _startNode = tmp12  /* pattern as ty=Integer */;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          _nextPaths1 = omc_List_filter1OnTrue(threadData, _allPathsIn, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_startNode));

          _nextPaths2 = omc_List_filter1OnTrue(threadData, _allPathsIn, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_startNode));

          _nextPaths2 = listAppend(_nextPaths1, _nextPaths2);

          _nextPath = listHead(_nextPaths2);

          tmpMeta13 = mmc_mk_box1(0, boxvar_intEq);
          _rest = omc_List_deleteMemberOnTrue(threadData, _nextPath, _allPathsIn, (modelica_fnptr) mmc_mk_box2(0,closure4_List_isEqualOnTrue,tmpMeta13), NULL);

          _nextPath = omc_List_deleteMemberOnTrue(threadData, mmc_mk_integer(_startNode), _nextPath, boxvar_intEq, NULL);

          _path = listAppend(_nextPath, _loopIn);
          tmpMeta1 = omc_ResolveLoops_connectPathsToOneLoop(threadData, _rest, _path);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_integer tmp19;
          modelica_metatype tmpMeta20;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta14 = MMC_CAR(tmp4_1);
          tmpMeta15 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          _path = tmpMeta14;
          _rest = tmpMeta15;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta16 = _path;
          if (listEmpty(tmpMeta16)) goto goto_2;
          tmpMeta17 = MMC_CAR(tmpMeta16);
          tmpMeta18 = MMC_CDR(tmpMeta16);
          tmp19 = mmc_unbox_integer(tmpMeta17);
          _startNode = tmp19  /* pattern as ty=Integer */;
          _restPath = tmpMeta18;

          _nextPaths1 = omc_List_filter1OnTrue(threadData, _rest, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_startNode));

          _nextPaths2 = omc_List_filter1OnTrue(threadData, _rest, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_startNode));

          _nextPaths2 = listAppend(_nextPaths1, _nextPaths2);

          _nextPath = listHead(_nextPaths2);

          tmpMeta20 = mmc_mk_box1(0, boxvar_intEq);
          _rest = omc_List_deleteMemberOnTrue(threadData, _nextPath, _rest, (modelica_fnptr) mmc_mk_box2(0,closure5_List_isEqualOnTrue,tmpMeta20), NULL);

          _path = listAppend(_nextPath, _restPath);
          tmpMeta1 = omc_ResolveLoops_connectPathsToOneLoop(threadData, _rest, _path);
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta21;
          
          /* Pattern matching succeeded */
          tmpMeta21 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta21;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 4) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _loopOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _loopOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_connectsLoops(threadData_t *threadData, modelica_metatype _path, modelica_metatype _allLoops)
{
  modelica_boolean _connected;
  modelica_boolean _b1;
  modelica_boolean _b2;
  modelica_integer _startNode;
  modelica_integer _endNode;
  modelica_metatype _loops1 = NULL;
  modelica_metatype _loops2 = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _connected has no default value.
  // _b1 has no default value.
  // _b2 has no default value.
  // _startNode has no default value.
  // _endNode has no default value.
  // _loops1 has no default value.
  // _loops2 has no default value.
  _startNode = mmc_unbox_integer(listHead(_path));

  _endNode = mmc_unbox_integer(omc_List_last(threadData, _path));

  _loops1 = omc_List_filter1OnTrue(threadData, _allLoops, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_startNode));

  _loops2 = omc_List_filter1OnTrue(threadData, _allLoops, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_startNode));

  _b1 = ((!listEmpty(_loops1)) || (!listEmpty(_loops2)));

  _loops1 = omc_List_filter1OnTrue(threadData, _allLoops, boxvar_ResolveLoops_firstInListIsEqual, mmc_mk_integer(_endNode));

  _loops2 = omc_List_filter1OnTrue(threadData, _allLoops, boxvar_ResolveLoops_lastInListIsEqual, mmc_mk_integer(_endNode));

  _b2 = ((!listEmpty(_loops1)) || (!listEmpty(_loops2)));

  _connected = (_b1 && _b2);
  _return: OMC_LABEL_UNUSED
  return _connected;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_connectsLoops(threadData_t *threadData, modelica_metatype _path, modelica_metatype _allLoops)
{
  modelica_boolean _connected;
  modelica_metatype out_connected;
  _connected = omc_ResolveLoops_connectsLoops(threadData, _path, _allLoops);
  out_connected = mmc_mk_icon(_connected);
  return out_connected;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData_t *threadData, modelica_metatype _eqCrossLstIn, modelica_metatype _eqCrossSet, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _pathsIn, modelica_boolean _findExactlyOneLoop)
{
  modelica_metatype _pathsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _pathsOut has no default value.
  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _eqCrossLstIn;
    {
      modelica_integer _crossEq;
      modelica_integer _adjVar;
      modelica_integer _adjEq;
      modelica_metatype _rest = NULL;
      modelica_metatype _adjVars = NULL;
      modelica_metatype _newPath = NULL;
      modelica_metatype _paths = NULL;
      modelica_metatype tmpMeta3;
      volatile mmc_switch_type tmp5;
      int tmp6;
      // _crossEq has no default value.
      // _adjVar has no default value.
      // _adjEq has no default value.
      // _rest has no default value.
      // _adjVars has no default value.
      // _newPath has no default value.
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      _paths = tmpMeta3;
      tmp5 = 0;
      for (; tmp5 < 2; tmp5++) {
        switch (MMC_SWITCH_CAST(tmp5)) {
        case 0: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (listEmpty(tmp5_1)) goto tmp4_end;
          tmpMeta7 = MMC_CAR(tmp5_1);
          tmpMeta8 = MMC_CDR(tmp5_1);
          tmp9 = mmc_unbox_integer(tmpMeta7);
          _crossEq = tmp9  /* pattern as ty=Integer */;
          _rest = tmpMeta8;
          /* Pattern matching succeeded */
          _adjVars = arrayGet(_mIn, _crossEq);

          {
            modelica_metatype _adjVar;
            for (tmpMeta10 = _adjVars; !listEmpty(tmpMeta10); tmpMeta10=MMC_CDR(tmpMeta10))
            {
              _adjVar = MMC_CAR(tmpMeta10);
              {
                modelica_metatype _adjEq;
                for (tmpMeta11 = arrayGet(_mTIn, mmc_unbox_integer(_adjVar)); !listEmpty(tmpMeta11); tmpMeta11=MMC_CDR(tmpMeta11))
                {
                  _adjEq = MMC_CAR(tmpMeta11);
                  if(((mmc_unbox_integer(_adjEq) > _crossEq)?(!omc_AvlSetInt_hasKey(threadData, _eqCrossSet, mmc_unbox_integer(_adjEq))):1 /* true */))
                  {
                    continue;
                  }

                  if(omc_ResolveLoops_hasSameIntSortedExcept(threadData, _adjVars, arrayGet(_mIn, mmc_unbox_integer(_adjEq)), mmc_unbox_integer(_adjVar)))
                  {
                    tmpMeta12 = mmc_mk_cons(_adjEq, mmc_mk_cons(mmc_mk_integer(_crossEq), MMC_REFSTRUCTLIT(mmc_nil)));
                    _newPath = tmpMeta12;

                    _paths = omc_List_unionElt(threadData, _newPath, _paths);

                    if((_findExactlyOneLoop?(!listEmpty(_pathsIn)):0 /* false */))
                    {
                      goto goto_2;
                    }
                  }
                }
              }
            }
          }
          /* Tail recursive call */
          _eqCrossLstIn = _rest;
          _pathsIn = listAppend(_paths, _pathsIn);
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp4_done;
        }
        case 1: {
          if (!listEmpty(tmp5_1)) goto tmp4_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _pathsIn;
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _pathsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _pathsOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData_t *threadData, modelica_metatype _eqCrossLstIn, modelica_metatype _eqCrossSet, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _pathsIn, modelica_metatype _findExactlyOneLoop)
{
  modelica_integer tmp1;
  modelica_metatype _pathsOut = NULL;
  tmp1 = mmc_unbox_integer(_findExactlyOneLoop);
  _pathsOut = omc_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData, _eqCrossLstIn, _eqCrossSet, _mIn, _mTIn, _pathsIn, tmp1);
  /* skip box _pathsOut; list<list<#Integer>> */
  return _pathsOut;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_hasSameIntSortedExcept(threadData_t *threadData, modelica_metatype _inList1, modelica_metatype _inList2, modelica_integer _excl)
{
  modelica_boolean _rv;
  modelica_integer _i1;
  modelica_integer _i2;
  modelica_metatype _l1 = NULL;
  modelica_metatype _l2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_integer tmp4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_integer tmp8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_integer tmp12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_integer tmp16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_integer tmp20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_integer tmp24;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _rv = 0 /* false */;
  // _i1 has no default value.
  // _i2 has no default value.
  _l1 = _inList1;
  _l2 = _inList2;
  if((listEmpty(_inList1) || listEmpty(_inList2)))
  {
    goto _return;
  }

  /* Pattern-matching assignment */
  tmpMeta1 = _l1;
  if (listEmpty(tmpMeta1)) MMC_THROW_INTERNAL();
  tmpMeta2 = MMC_CAR(tmpMeta1);
  tmpMeta3 = MMC_CDR(tmpMeta1);
  tmp4 = mmc_unbox_integer(tmpMeta2);
  _i1 = tmp4  /* pattern as ty=Integer */;
  _l1 = tmpMeta3;

  /* Pattern-matching assignment */
  tmpMeta5 = _l2;
  if (listEmpty(tmpMeta5)) MMC_THROW_INTERNAL();
  tmpMeta6 = MMC_CAR(tmpMeta5);
  tmpMeta7 = MMC_CDR(tmpMeta5);
  tmp8 = mmc_unbox_integer(tmpMeta6);
  _i2 = tmp8  /* pattern as ty=Integer */;
  _l2 = tmpMeta7;

  while(1)
  {
    if(!1 /* true */) break;
    if((_i1 > _i2))
    {
      if(listEmpty(_l2))
      {
        goto _return;
      }

      /* Pattern-matching assignment */
      tmpMeta9 = _l2;
      if (listEmpty(tmpMeta9)) MMC_THROW_INTERNAL();
      tmpMeta10 = MMC_CAR(tmpMeta9);
      tmpMeta11 = MMC_CDR(tmpMeta9);
      tmp12 = mmc_unbox_integer(tmpMeta10);
      _i2 = tmp12  /* pattern as ty=Integer */;
      _l2 = tmpMeta11;
    }
    else
    {
      if((_i1 < _i2))
      {
        if(listEmpty(_l1))
        {
          goto _return;
        }

        /* Pattern-matching assignment */
        tmpMeta13 = _l1;
        if (listEmpty(tmpMeta13)) MMC_THROW_INTERNAL();
        tmpMeta14 = MMC_CAR(tmpMeta13);
        tmpMeta15 = MMC_CDR(tmpMeta13);
        tmp16 = mmc_unbox_integer(tmpMeta14);
        _i1 = tmp16  /* pattern as ty=Integer */;
        _l1 = tmpMeta15;
      }
      else
      {
        if((_i1 != _excl))
        {
          _rv = 1 /* true */;

          goto _return;
        }

        if((listEmpty(_l1) || listEmpty(_l2)))
        {
          goto _return;
        }

        /* Pattern-matching assignment */
        tmpMeta17 = _l1;
        if (listEmpty(tmpMeta17)) MMC_THROW_INTERNAL();
        tmpMeta18 = MMC_CAR(tmpMeta17);
        tmpMeta19 = MMC_CDR(tmpMeta17);
        tmp20 = mmc_unbox_integer(tmpMeta18);
        _i1 = tmp20  /* pattern as ty=Integer */;
        _l1 = tmpMeta19;

        /* Pattern-matching assignment */
        tmpMeta21 = _l2;
        if (listEmpty(tmpMeta21)) MMC_THROW_INTERNAL();
        tmpMeta22 = MMC_CAR(tmpMeta21);
        tmpMeta23 = MMC_CDR(tmpMeta21);
        tmp24 = mmc_unbox_integer(tmpMeta22);
        _i2 = tmp24  /* pattern as ty=Integer */;
        _l2 = tmpMeta23;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _rv;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_hasSameIntSortedExcept(threadData_t *threadData, modelica_metatype _inList1, modelica_metatype _inList2, modelica_metatype _excl)
{
  modelica_integer tmp1;
  modelica_boolean _rv;
  modelica_metatype out_rv;
  tmp1 = mmc_unbox_integer(_excl);
  _rv = omc_ResolveLoops_hasSameIntSortedExcept(threadData, _inList1, _inList2, tmp1);
  out_rv = mmc_mk_icon(_rv);
  return out_rv;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_listContains(threadData_t *threadData, modelica_metatype _lst, modelica_integer _int)
{
  modelica_boolean _res;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _res = 0 /* false */;
  {
    modelica_metatype _i;
    for (tmpMeta1 = _lst; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _i = MMC_CAR(tmpMeta1);
      if((mmc_unbox_integer(_i) == _int))
      {
        _res = 1 /* true */;

        goto _return;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _res;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_listContains(threadData_t *threadData, modelica_metatype _lst, modelica_metatype _int)
{
  modelica_integer tmp1;
  modelica_boolean _res;
  modelica_metatype out_res;
  tmp1 = mmc_unbox_integer(_int);
  _res = omc_ResolveLoops_listContains(threadData, _lst, tmp1);
  out_res = mmc_mk_icon(_res);
  return out_res;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_pathContainsNode(threadData_t *threadData, modelica_integer _node, modelica_metatype _inPath)
{
  modelica_boolean _c;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _c has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inPath;
    {
      modelica_integer _n;
      modelica_metatype _rest = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _n has no default value.
      // _rest has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmp8 = mmc_unbox_integer(tmpMeta6);
          _n = tmp8  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_n == _node)) goto tmp3_end;
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta9 = MMC_CAR(tmp4_1);
          tmpMeta10 = MMC_CDR(tmp4_1);
          _rest = tmpMeta10;
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _inPath = _rest;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _c = tmp1;
  _return: OMC_LABEL_UNUSED
  return _c;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_pathContainsNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _inPath)
{
  modelica_integer tmp1;
  modelica_boolean _c;
  modelica_metatype out_c;
  tmp1 = mmc_unbox_integer(_node);
  _c = omc_ResolveLoops_pathContainsNode(threadData, tmp1, _inPath);
  out_c = mmc_mk_icon(_c);
  return out_c;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_removeNode(threadData_t *threadData, modelica_integer _node, modelica_metatype _inPaths, modelica_metatype __omcQ_24in_5FaccPaths)
{
  modelica_metatype _accPaths = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _accPaths = __omcQ_24in_5FaccPaths;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _inPaths;
    {
      modelica_metatype _path = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _acc = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _path has no default value.
      // _rest has no default value.
      // _acc has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _path = tmpMeta6;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          if((!omc_ResolveLoops_pathContainsNode(threadData, _node, _path)))
          {
            tmpMeta8 = mmc_mk_cons(_path, _accPaths);
            _acc = tmpMeta8;
          }
          else
          {
            _acc = _accPaths;
          }
          /* Tail recursive call */
          _inPaths = _rest;
          __omcQ_24in_5FaccPaths = _acc;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _accPaths;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _accPaths = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _accPaths;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_removeNode(threadData_t *threadData, modelica_metatype _node, modelica_metatype _inPaths, modelica_metatype __omcQ_24in_5FaccPaths)
{
  modelica_integer tmp1;
  modelica_metatype _accPaths = NULL;
  tmp1 = mmc_unbox_integer(_node);
  _accPaths = omc_ResolveLoops_removeNode(threadData, tmp1, _inPaths, __omcQ_24in_5FaccPaths);
  /* skip box _accPaths; list<list<#Integer>> */
  return _accPaths;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_removeEqualPaths(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype __omcQ_24in_5FminAdj, modelica_metatype __omcQ_24in_5FuniquePaths, modelica_metatype __omcQ_24in_5FmapIndices, modelica_metatype __omcQ_24in_5Fmap, modelica_metatype __omcQ_24in_5FaccCrossNodes, modelica_metatype *out_uniquePaths, modelica_metatype *out_mapIndices, modelica_metatype *out_map, modelica_metatype *out_accCrossNodes)
{
  modelica_metatype _minAdj = NULL;
  modelica_metatype _uniquePaths = NULL;
  modelica_metatype _mapIndices = NULL;
  modelica_metatype _map = NULL;
  modelica_metatype _accCrossNodes = NULL;
  modelica_metatype tmpMeta[5] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _minAdj = __omcQ_24in_5FminAdj;
  _uniquePaths = __omcQ_24in_5FuniquePaths;
  _mapIndices = __omcQ_24in_5FmapIndices;
  _map = __omcQ_24in_5Fmap;
  _accCrossNodes = __omcQ_24in_5FaccCrossNodes;
  
  
  
  
  
  { /* match expression */
    modelica_metatype tmp6_1;
    tmp6_1 = _crossNodes;
    {
      modelica_integer _cn1;
      modelica_metatype _rest = NULL;
      modelica_metatype _assigned = NULL;
      modelica_metatype tmpMeta3;
      modelica_metatype _unassigned = NULL;
      modelica_metatype tmpMeta4;
      volatile mmc_switch_type tmp6;
      int tmp7;
      // _cn1 has no default value.
      // _rest has no default value.
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      _assigned = tmpMeta3;
      tmpMeta4 = MMC_REFSTRUCTLIT(mmc_nil);
      _unassigned = tmpMeta4;
      tmp6 = 0;
      for (; tmp6 < 2; tmp6++) {
        switch (MMC_SWITCH_CAST(tmp6)) {
        case 0: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_integer tmp10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          if (listEmpty(tmp6_1)) goto tmp5_end;
          tmpMeta8 = MMC_CAR(tmp6_1);
          tmpMeta9 = MMC_CDR(tmp6_1);
          tmp10 = mmc_unbox_integer(tmpMeta8);
          _cn1 = tmp10  /* pattern as ty=Integer */;
          _rest = tmpMeta9;
          /* Pattern matching succeeded */
          if((!listMember(mmc_mk_integer(_cn1), _accCrossNodes)))
          {
            tmpMeta11 = mmc_mk_cons(mmc_mk_integer(_cn1), _accCrossNodes);
            _accCrossNodes = tmpMeta11;
          }

          {
            modelica_metatype _cn2;
            for (tmpMeta12 = _rest; !listEmpty(tmpMeta12); tmpMeta12=MMC_CDR(tmpMeta12))
            {
              _cn2 = MMC_CAR(tmpMeta12);
              if(omc_HpcOmTaskGraph_equalLists(threadData, arrayGet(_minAdj, _cn1), arrayGet(_minAdj, mmc_unbox_integer(_cn2))))
              {
                tmpMeta13 = mmc_mk_cons(_cn2, _assigned);
                _assigned = tmpMeta13;

                tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
                arrayUpdate(_minAdj, mmc_unbox_integer(_cn2), tmpMeta14);

                tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
                _uniquePaths = omc_ResolveLoops_removeNode(threadData, mmc_unbox_integer(_cn2), _uniquePaths, tmpMeta15);
              }
              else
              {
                tmpMeta16 = mmc_mk_cons(_cn2, _unassigned);
                _unassigned = tmpMeta16;

                if((!listMember(_cn2, _accCrossNodes)))
                {
                  tmpMeta17 = mmc_mk_cons(_cn2, _accCrossNodes);
                  _accCrossNodes = tmpMeta17;
                }
              }
            }
          }

          if((!listEmpty(_assigned)))
          {
            tmpMeta19 = mmc_mk_cons(mmc_mk_integer(_cn1), _mapIndices);
            _mapIndices = tmpMeta19;

            _map = omc_Array_appendToElement(threadData, _cn1, _assigned, _map);
          }
          /* Tail recursive call */
          _crossNodes = _unassigned;
          __omcQ_24in_5FminAdj = _minAdj;
          __omcQ_24in_5FuniquePaths = _uniquePaths;
          __omcQ_24in_5FmapIndices = _mapIndices;
          __omcQ_24in_5Fmap = _map;
          __omcQ_24in_5FaccCrossNodes = _accCrossNodes;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp5_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _minAdj;
          tmpMeta[0+1] = _uniquePaths;
          tmpMeta[0+2] = _mapIndices;
          tmpMeta[0+3] = _map;
          tmpMeta[0+4] = _accCrossNodes;
          goto tmp5_done;
        }
        }
        goto tmp5_end;
        tmp5_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp5_done;
      tmp5_done:;
    }
  }
  _minAdj = tmpMeta[0+0];
  _uniquePaths = tmpMeta[0+1];
  _mapIndices = tmpMeta[0+2];
  _map = tmpMeta[0+3];
  _accCrossNodes = tmpMeta[0+4];
  _return: OMC_LABEL_UNUSED
  if (out_uniquePaths) { *out_uniquePaths = _uniquePaths; }
  if (out_mapIndices) { *out_mapIndices = _mapIndices; }
  if (out_map) { *out_map = _map; }
  if (out_accCrossNodes) { *out_accCrossNodes = _accCrossNodes; }
  return _minAdj;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getMinimalAdjacencyMatrix(threadData_t *threadData, modelica_metatype _crossNodes, modelica_metatype _uniquePaths)
{
  modelica_metatype _minAdj = NULL;
  modelica_integer tmp1;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _minAdj has no default value.
  {
    modelica_integer __omcQ_24tmpVar15;
    modelica_integer __omcQ_24tmpVar14;
    modelica_integer tmp2;
    modelica_metatype _cn_loopVar = 0;
    modelica_metatype _cn;
    _cn_loopVar = _crossNodes;
    __omcQ_24tmpVar15 = ((modelica_integer) -4611686018427387903); /* defaultValue */
    while(1) {
      tmp2 = 1;
      if (!listEmpty(_cn_loopVar)) {
        _cn = MMC_CAR(_cn_loopVar);
        _cn_loopVar = MMC_CDR(_cn_loopVar);
        tmp2--;
      }
      if (tmp2 == 0) {
        __omcQ_24tmpVar14 = mmc_unbox_integer(_cn);
        __omcQ_24tmpVar15 = modelica_integer_max((modelica_integer)(__omcQ_24tmpVar14),(modelica_integer)(__omcQ_24tmpVar15));
      } else if (tmp2 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp1 = __omcQ_24tmpVar15;
  }
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _minAdj = arrayCreate(tmp1, tmpMeta3);

  {
    modelica_metatype _path;
    for (tmpMeta4 = _uniquePaths; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
    {
      _path = MMC_CAR(tmpMeta4);
      { /* match expression */
        modelica_metatype tmp7_1;
        tmp7_1 = _path;
        {
          modelica_integer _a;
          modelica_integer _b;
          volatile mmc_switch_type tmp7;
          int tmp8;
          // _a has no default value.
          // _b has no default value.
          tmp7 = 0;
          for (; tmp7 < 2; tmp7++) {
            switch (MMC_SWITCH_CAST(tmp7)) {
            case 0: {
              modelica_metatype tmpMeta9;
              modelica_metatype tmpMeta10;
              modelica_integer tmp11;
              modelica_metatype tmpMeta12;
              modelica_metatype tmpMeta13;
              modelica_integer tmp14;
              if (listEmpty(tmp7_1)) goto tmp6_end;
              tmpMeta9 = MMC_CAR(tmp7_1);
              tmpMeta10 = MMC_CDR(tmp7_1);
              tmp11 = mmc_unbox_integer(tmpMeta9);
              if (listEmpty(tmpMeta10)) goto tmp6_end;
              tmpMeta12 = MMC_CAR(tmpMeta10);
              tmpMeta13 = MMC_CDR(tmpMeta10);
              tmp14 = mmc_unbox_integer(tmpMeta12);
              if (!listEmpty(tmpMeta13)) goto tmp6_end;
              _a = tmp11  /* pattern as ty=Integer */;
              _b = tmp14  /* pattern as ty=Integer */;
              /* Pattern matching succeeded */
              _minAdj = omc_Array_consToElement(threadData, _a, mmc_mk_integer(_b), _minAdj);

              _minAdj = omc_Array_consToElement(threadData, _b, mmc_mk_integer(_a), _minAdj);
              goto tmp6_done;
            }
            case 1: {
              
              /* Pattern matching succeeded */
              goto tmp6_done;
            }
            }
            goto tmp6_end;
            tmp6_end: ;
          }
          goto goto_5;
          goto_5:;
          MMC_THROW_INTERNAL();
          goto tmp6_done;
          tmp6_done:;
        }
      }
      ;
    }
  }

  {
    modelica_metatype _cn;
    for (tmpMeta16 = _crossNodes; !listEmpty(tmpMeta16); tmpMeta16=MMC_CDR(tmpMeta16))
    {
      _cn = MMC_CAR(tmpMeta16);
      arrayUpdate(_minAdj, mmc_unbox_integer(_cn), omc_List_sort(threadData, arrayGet(_minAdj, mmc_unbox_integer(_cn)), boxvar_intGt));
    }
  }
  _return: OMC_LABEL_UNUSED
  return _minAdj;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_findEqualPathStructure(threadData_t *threadData, modelica_metatype __omcQ_24in_5FcrossNodes, modelica_metatype __omcQ_24in_5FuniquePaths, modelica_metatype *out_uniquePaths, modelica_metatype *out_mapping, modelica_metatype *out_minAdj)
{
  modelica_metatype _crossNodes = NULL;
  modelica_metatype _uniquePaths = NULL;
  modelica_metatype _mapping = NULL;
  modelica_metatype _minAdj = NULL;
  modelica_metatype _mapIndices = NULL;
  modelica_metatype _map = NULL;
  modelica_metatype tmpMeta1;
  modelica_integer tmp2;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _crossNodes = __omcQ_24in_5FcrossNodes;
  _uniquePaths = __omcQ_24in_5FuniquePaths;
  // _mapping has no default value.
  // _minAdj has no default value.
  // _mapIndices has no default value.
  // _map has no default value.
  _minAdj = omc_ResolveLoops_getMinimalAdjacencyMatrix(threadData, _crossNodes, _uniquePaths);

  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  {
    modelica_integer __omcQ_24tmpVar17;
    modelica_integer __omcQ_24tmpVar16;
    modelica_integer tmp3;
    modelica_metatype _cn_loopVar = 0;
    modelica_metatype _cn;
    _cn_loopVar = _crossNodes;
    __omcQ_24tmpVar17 = ((modelica_integer) -4611686018427387903); /* defaultValue */
    while(1) {
      tmp3 = 1;
      if (!listEmpty(_cn_loopVar)) {
        _cn = MMC_CAR(_cn_loopVar);
        _cn_loopVar = MMC_CDR(_cn_loopVar);
        tmp3--;
      }
      if (tmp3 == 0) {
        __omcQ_24tmpVar16 = mmc_unbox_integer(_cn);
        __omcQ_24tmpVar17 = modelica_integer_max((modelica_integer)(__omcQ_24tmpVar16),(modelica_integer)(__omcQ_24tmpVar17));
      } else if (tmp3 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp2 = __omcQ_24tmpVar17;
  }
  tmpMeta4 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
  _minAdj = omc_ResolveLoops_removeEqualPaths(threadData, _crossNodes, _minAdj, _uniquePaths, tmpMeta1, arrayCreate(tmp2, tmpMeta4), tmpMeta5 ,&_uniquePaths ,&_mapIndices ,&_map ,&_crossNodes);

  tmpMeta6 = mmc_mk_box2(0, _mapIndices, _map);
  _mapping = tmpMeta6;
  _return: OMC_LABEL_UNUSED
  if (out_uniquePaths) { *out_uniquePaths = _uniquePaths; }
  if (out_mapping) { *out_mapping = _mapping; }
  if (out_minAdj) { *out_minAdj = _minAdj; }
  return _crossNodes;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__findLoops2(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_boolean _findExactlyOneLoop, modelica_metatype *out_structureMapping)
{
  modelica_metatype _loopsOut = NULL;
  modelica_metatype _structureMapping = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _loopsOut has no default value.
  // _structureMapping has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _eqCrossLstIn;
    tmp4_2 = _varCrossLstIn;
    {
      modelica_boolean _isNoSingleLoop;
      modelica_metatype _eqCrossLst = NULL;
      modelica_metatype _subLoop = NULL;
      modelica_metatype _mapIndices = NULL;
      modelica_metatype _paths = NULL;
      modelica_metatype _allPaths = NULL;
      modelica_metatype _simpleLoops = NULL;
      modelica_metatype _tripleLoops = NULL;
      modelica_metatype _paths0 = NULL;
      modelica_metatype _paths1 = NULL;
      modelica_metatype _closedPaths = NULL;
      modelica_metatype _loopConnectors = NULL;
      modelica_metatype _connectedPaths = NULL;
      modelica_metatype _eqCrossSet = NULL;
      modelica_metatype _minAdj = NULL;
      modelica_metatype _map = NULL;
      modelica_metatype _mapping = NULL;
      modelica_metatype _optTripleMapping = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _isNoSingleLoop has no default value.
      // _eqCrossLst has no default value.
      // _subLoop has no default value.
      // _mapIndices has no default value.
      // _paths has no default value.
      // _allPaths has no default value.
      // _simpleLoops has no default value.
      // _tripleLoops has no default value.
      // _paths0 has no default value.
      // _paths1 has no default value.
      // _closedPaths has no default value.
      // _loopConnectors has no default value.
      // _connectedPaths has no default value.
      // _eqCrossSet has no default value.
      // _minAdj has no default value.
      // _map has no default value.
      // _mapping has no default value.
      // _optTripleMapping has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_boolean tmp20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
          _allPaths = omc_ResolveLoops_getPathTillNextCrossEq(threadData, _eqCrossLstIn, _mIn, _mTIn, _eqCrossLstIn, tmpMeta8, tmpMeta9);

          _allPaths = omc_List_sort(threadData, _allPaths, boxvar_List_listIsLonger);

          tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
          _paths1 = omc_List_fold1(threadData, _allPaths, boxvar_ResolveLoops_getReverseDoubles, _allPaths, tmpMeta10);

          tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
          _simpleLoops = omc_ResolveLoops_getDoubles(threadData, _paths1, tmpMeta11);

          omc_List_intersection1OnTrue(threadData, _paths1, _simpleLoops, boxvar_ResolveLoops_intLstIsEqual ,&_paths ,NULL);

          if(listEmpty(_simpleLoops))
          {
            _eqCrossLst = omc_ResolveLoops_findEqualPathStructure(threadData, _eqCrossLstIn, _paths1 ,&_paths1 ,&_mapping ,&_minAdj);

            /* Pattern-matching assignment */
            tmpMeta12 = _mapping;
            tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 1));
            tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 2));
            _mapIndices = tmpMeta13;
            _map = tmpMeta14;

            _tripleLoops = omc_ResolveLoops_getTriples(threadData, _eqCrossLst, _minAdj ,&_paths0);

            tmpMeta15 = mmc_mk_box3(0, _mapIndices, _map, _tripleLoops);
            _optTripleMapping = mmc_mk_some(tmpMeta15);
          }
          else
          {
            _optTripleMapping = mmc_mk_none();

            _paths0 = omc_List_sort(threadData, _paths, boxvar_List_listIsLonger);

            tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta17 = MMC_REFSTRUCTLIT(mmc_nil);
            _connectedPaths = omc_ResolveLoops_connect2PathsToLoops(threadData, _paths0, tmpMeta16, tmpMeta17 ,&_loopConnectors);

            _loopConnectors = omc_List_filter1OnTrue(threadData, _loopConnectors, boxvar_ResolveLoops_connectsLoops, _simpleLoops);

            _simpleLoops = listAppend(_simpleLoops, _loopConnectors);

            tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
            _subLoop = omc_ResolveLoops_connectPathsToOneLoop(threadData, _simpleLoops, tmpMeta18);

            _isNoSingleLoop = listEmpty(_subLoop);

            tmp20 = (modelica_boolean)_isNoSingleLoop;
            if(tmp20)
            {
              tmpMeta21 = _simpleLoops;
            }
            else
            {
              tmpMeta19 = mmc_mk_cons(_subLoop, MMC_REFSTRUCTLIT(mmc_nil));
              tmpMeta21 = tmpMeta19;
            }
            _simpleLoops = tmpMeta21;

            _paths0 = listAppend(_simpleLoops, _connectedPaths);

            _paths0 = omc_ResolveLoops_sortPathsAsChain(threadData, _paths0);

            if(_findExactlyOneLoop)
            {
              if((!listEmpty(_paths0)))
              {
                /* Pattern-matching assignment */
                tmpMeta22 = _paths0;
                if (listEmpty(tmpMeta22)) goto goto_2;
                tmpMeta23 = MMC_CAR(tmpMeta22);
                tmpMeta24 = MMC_CDR(tmpMeta22);
                if (!listEmpty(tmpMeta24)) goto goto_2;
              }
            }
          }
          tmpMeta[0+0] = _paths0;
          tmpMeta[0+1] = _optTripleMapping;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta25 = MMC_CAR(tmp4_2);
          tmpMeta26 = MMC_CDR(tmp4_2);
          /* Pattern matching succeeded */
          tmpMeta27 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta28 = MMC_REFSTRUCTLIT(mmc_nil);
          _paths = omc_ResolveLoops_getPathTillNextCrossEq(threadData, _varCrossLstIn, _mTIn, _mIn, _varCrossLstIn, tmpMeta27, tmpMeta28);

          _paths = omc_List_sort(threadData, _paths, boxvar_List_listIsLonger);

          _paths = listReverse(_paths);

          _paths0 = omc_List_extract1OnTrue(threadData, _paths, boxvar_ResolveLoops_listLengthIs, mmc_mk_integer(listLength(omc_List_last(threadData, _paths))) ,&_paths1);

          _paths1 = (listEmpty(_paths1)?_paths0:_paths1);

          _closedPaths = omc_List_map1(threadData, _paths1, boxvar_ResolveLoops_closePathDirectly, _paths0);

          tmpMeta29 = MMC_REFSTRUCTLIT(mmc_nil);
          _closedPaths = omc_List_fold1(threadData, _closedPaths, boxvar_ResolveLoops_getReverseDoubles, _closedPaths, tmpMeta29);

          _closedPaths = omc_List_map(threadData, _closedPaths, boxvar_List_unique);

          _closedPaths = omc_List_map1(threadData, _closedPaths, boxvar_ResolveLoops_getEqNodesForVarLoop, _mTIn);

          if(_findExactlyOneLoop)
          {
            if((!listEmpty(_closedPaths)))
            {
              /* Pattern-matching assignment */
              tmpMeta30 = _closedPaths;
              if (listEmpty(tmpMeta30)) goto goto_2;
              tmpMeta31 = MMC_CAR(tmpMeta30);
              tmpMeta32 = MMC_CDR(tmpMeta30);
              if (!listEmpty(tmpMeta32)) goto goto_2;
            }
          }
          tmpMeta[0+0] = _closedPaths;
          tmpMeta[0+1] = mmc_mk_none();
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          _subLoop = _eqsIn;

          {
            modelica_metatype _e;
            for (tmpMeta33 = _eqsIn; !listEmpty(tmpMeta33); tmpMeta33=MMC_CDR(tmpMeta33))
            {
              _e = MMC_CAR(tmpMeta33);
              if(listEmpty(arrayGet(_mIn,mmc_unbox_integer(_e)) /* DAE.ASUB */))
              {
                tmpMeta34 = MMC_REFSTRUCTLIT(mmc_nil);
                _subLoop = tmpMeta34;

                break;
              }
            }
          }
          tmpMeta36 = mmc_mk_cons(_subLoop, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta[0+0] = tmpMeta36;
          tmpMeta[0+1] = mmc_mk_none();
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_integer tmp41;
          modelica_integer tmp42;
          modelica_integer tmp43;
          modelica_integer tmp44;
          modelica_integer tmp45;
          modelica_integer tmp46;
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta37 = MMC_CAR(tmp4_1);
          tmpMeta38 = MMC_CDR(tmp4_1);
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta39 = MMC_CAR(tmp4_2);
          tmpMeta40 = MMC_CDR(tmp4_2);
          /* Pattern matching succeeded */
          tmp41 = ((modelica_integer) 1); tmp42 = 1; tmp43 = arrayLength(_mIn);
          if(!(((tmp42 > 0) && (tmp41 > tmp43)) || ((tmp42 < 0) && (tmp41 < tmp43))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp41, tmp43); _i += tmp42)
            {
              arrayUpdate(_mIn, _i, omc_List_heapSortIntList(threadData, arrayGet(_mIn,_i) /* DAE.ASUB */));
            }
          }

          tmp44 = ((modelica_integer) 1); tmp45 = 1; tmp46 = arrayLength(_mTIn);
          if(!(((tmp45 > 0) && (tmp44 > tmp46)) || ((tmp45 < 0) && (tmp44 < tmp46))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp44, tmp46); _i += tmp45)
            {
              arrayUpdate(_mTIn, _i, omc_List_heapSortIntList(threadData, arrayGet(_mTIn,_i) /* DAE.ASUB */));
            }
          }

          _eqCrossSet = omc_AvlSetInt_addList(threadData, _OMC_LIT81, _eqCrossLstIn);

          tmpMeta47 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta48 = MMC_REFSTRUCTLIT(mmc_nil);
          _paths = omc_ResolveLoops_getShortPathsBetweenEqCrossNodes(threadData, omc_AvlSetInt_listKeysReverse(threadData, _eqCrossSet, tmpMeta47), _eqCrossSet, _mIn, _mTIn, tmpMeta48, _findExactlyOneLoop);
          tmpMeta[0+0] = _paths;
          tmpMeta[0+1] = mmc_mk_none();
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          omc_Error_addInternalError(threadData, _OMC_LIT82, _OMC_LIT83);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _loopsOut = tmpMeta[0+0];
  _structureMapping = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_structureMapping) { *out_structureMapping = _structureMapping; }
  return _loopsOut;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_resolveLoops__findLoops2(threadData_t *threadData, modelica_metatype _eqsIn, modelica_metatype _eqCrossLstIn, modelica_metatype _varCrossLstIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _findExactlyOneLoop, modelica_metatype *out_structureMapping)
{
  modelica_integer tmp1;
  modelica_metatype _loopsOut = NULL;
  tmp1 = mmc_unbox_integer(_findExactlyOneLoop);
  _loopsOut = omc_ResolveLoops_resolveLoops__findLoops2(threadData, _eqsIn, _eqCrossLstIn, _varCrossLstIn, _mIn, _mTIn, tmp1, out_structureMapping);
  /* skip box _loopsOut; list<list<#Integer>> */
  /* skip box _structureMapping; Option<tuple<list<#Integer>, array<list<#Integer>>, list<list<#Integer>>>> */
  return _loopsOut;
}

DLLDirection
modelica_metatype omc_ResolveLoops_resolveLoops__findLoops(threadData_t *threadData, modelica_metatype _partitionsIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_boolean _findExactlyOneLoop, modelica_metatype *out_crossEqsOut, modelica_metatype *out_crossVarsOut, modelica_metatype *out_optStructureMapping)
{
  jmp_buf *old_mmc_jumper = threadData->mmc_jumper;
  modelica_metatype _loopsOut = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _crossEqsOut = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _crossVarsOut = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype _optStructureMapping = NULL;
  modelica_metatype _loops = NULL;
  modelica_metatype _eqVars = NULL;
  modelica_metatype _eqCrossLst = NULL;
  modelica_metatype _varCrossLst = NULL;
  modelica_metatype _partitionVars = NULL;
  modelica_metatype _set = NULL;
  modelica_metatype _structureMapping = NULL;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta14;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _loopsOut = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _crossEqsOut = tmpMeta2;
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _crossVarsOut = tmpMeta3;
  _optStructureMapping = mmc_mk_none();
  // _loops has no default value.
  // _eqVars has no default value.
  // _eqCrossLst has no default value.
  // _varCrossLst has no default value.
  // _partitionVars has no default value.
  // _set has no default value.
  // _structureMapping has no default value.
  {
    modelica_metatype _partition;
    for (tmpMeta4 = _partitionsIn; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
    {
      _partition = MMC_CAR(tmpMeta4);
      { /* matchcontinue expression */
        {
          volatile mmc_switch_type tmp7;
          int tmp8;
          tmp7 = 0;
          MMC_TRY_INTERNAL(mmc_jumper)
          tmp6_top:
          threadData->mmc_jumper = &new_mmc_jumper;
          for (; tmp7 < 2; tmp7++) {
            switch (MMC_SWITCH_CAST(tmp7)) {
            case 0: {
              modelica_metatype tmpMeta9;
              modelica_metatype tmpMeta10;
              modelica_metatype tmpMeta11;
              modelica_metatype tmpMeta12;
              modelica_metatype tmpMeta13;
              /* Pattern matching succeeded */
              _eqVars = omc_List_map1(threadData, _partition, boxvar_Array_getIndexFirst, _mIn);

              _set = _OMC_LIT81;

              {
                modelica_metatype _vars;
                for (tmpMeta9 = _eqVars; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
                {
                  _vars = MMC_CAR(tmpMeta9);
                  _set = omc_AvlSetInt_addList(threadData, _set, _vars);
                }
              }

              tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
              _partitionVars = omc_AvlSetInt_listKeys(threadData, _set, tmpMeta11);

              tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
              _eqCrossLst = omc_List_fold2(threadData, _partition, boxvar_ResolveLoops_gatherCrossNodes, _mIn, _mTIn, tmpMeta12);

              tmpMeta13 = MMC_REFSTRUCTLIT(mmc_nil);
              _varCrossLst = omc_List_fold2(threadData, _partitionVars, boxvar_ResolveLoops_gatherCrossNodes, _mTIn, _mIn, tmpMeta13);

              _loops = omc_ResolveLoops_resolveLoops__findLoops2(threadData, _partition, _eqCrossLst, _varCrossLst, _mIn, _mTIn, _findExactlyOneLoop ,&_optStructureMapping);

              if((_findExactlyOneLoop?((!listEmpty(_loops)) && (!listEmpty(_loopsOut))):0 /* false */))
              {
                goto goto_5;
              }

              _loopsOut = listAppend(_loops, _loopsOut);

              if(isPresent(_crossEqsOut))
              {
                _crossEqsOut = listAppend(_eqCrossLst, _crossEqsOut);
              }

              if(isPresent(_crossVarsOut))
              {
                _crossVarsOut = listAppend(_varCrossLst, _crossVarsOut);
              }
              goto tmp6_done;
            }
            case 1: {
              /* Pattern matching succeeded */
              goto _return;
              goto tmp6_done;
            }
            }
            goto tmp6_end;
            tmp6_end: ;
          }
          goto goto_5;
          tmp6_done:
          (void)tmp7;
          MMC_RESTORE_INTERNAL(mmc_jumper);
          goto tmp6_done2;
          goto_5:;
          MMC_CATCH_INTERNAL(mmc_jumper);
          if (++tmp7 < 2) {
            goto tmp6_top;
          }
          MMC_THROW_INTERNAL();
          tmp6_done2:;
        }
      }
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_crossEqsOut) { *out_crossEqsOut = _crossEqsOut; }
  if (out_crossVarsOut) { *out_crossVarsOut = _crossVarsOut; }
  if (out_optStructureMapping) { *out_optStructureMapping = _optStructureMapping; }
  threadData->mmc_jumper = old_mmc_jumper;
  return _loopsOut;
}
modelica_metatype boxptr_ResolveLoops_resolveLoops__findLoops(threadData_t *threadData, modelica_metatype _partitionsIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _findExactlyOneLoop, modelica_metatype *out_crossEqsOut, modelica_metatype *out_crossVarsOut, modelica_metatype *out_optStructureMapping)
{
  modelica_integer tmp1;
  modelica_metatype _loopsOut = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_findExactlyOneLoop);
  _loopsOut = omc_ResolveLoops_resolveLoops__findLoops(threadData, _partitionsIn, _mIn, _mTIn, tmp1, out_crossEqsOut, out_crossVarsOut, out_optStructureMapping);
  /* skip box _loopsOut; list<list<#Integer>> */
  /* skip box _crossEqsOut; list<#Integer> */
  /* skip box _crossVarsOut; list<#Integer> */
  /* skip box _optStructureMapping; Option<tuple<list<#Integer>, array<list<#Integer>>, list<list<#Integer>>>> */
  return _loopsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getSimpleEquationVariables(threadData_t *threadData, modelica_metatype _markLinEqVars, modelica_metatype _vars, modelica_metatype *out_varMapArr)
{
  modelica_metatype _simpVars = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _varMapArr = NULL;
  modelica_integer _varIdx;
  modelica_metatype _varMap = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _simpVars = tmpMeta1;
  // _varMapArr has no default value.
  // _varIdx has no default value.
  // _varMap has no default value.
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _varMap = tmpMeta2;

  tmp5 = ((modelica_integer) 1); tmp6 = 1; tmp7 = arrayLength(_markLinEqVars);
  if(!(((tmp6 > 0) && (tmp5 > tmp7)) || ((tmp6 < 0) && (tmp5 < tmp7))))
  {
    modelica_integer _varIdx;
    for(_varIdx = ((modelica_integer) 1); in_range_integer(_varIdx, tmp5, tmp7); _varIdx += tmp6)
    {
      if((mmc_unbox_integer(arrayGet(_markLinEqVars,_varIdx) /* DAE.ASUB */) > ((modelica_integer) 0)))
      {
        tmpMeta3 = mmc_mk_cons(mmc_mk_integer(_varIdx), _varMap);
        _varMap = tmpMeta3;

        tmpMeta4 = mmc_mk_cons(omc_BackendVariable_getVarAt(threadData, _vars, _varIdx), _simpVars);
        _simpVars = tmpMeta4;
      }
    }
  }

  _varMapArr = listArray(_varMap);
  _return: OMC_LABEL_UNUSED
  if (out_varMapArr) { *out_varMapArr = _varMapArr; }
  return _simpVars;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_getSimpleEquations(threadData_t *threadData, modelica_metatype _inEq, modelica_metatype _inTpl, modelica_metatype *out_outTpl)
{
  modelica_metatype _outEq = NULL;
  modelica_metatype _outTpl = NULL;
  modelica_boolean _isSimple;
  modelica_integer _idx;
  modelica_metatype _eq = NULL;
  modelica_metatype _m = NULL;
  modelica_metatype _vars = NULL;
  modelica_metatype _markLinEqVars = NULL;
  modelica_metatype _eqLst = NULL;
  modelica_metatype _idxMap = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_integer tmp11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _outEq = _inEq;
  // _outTpl has no default value.
  // _isSimple has no default value.
  // _idx has no default value.
  // _eq has no default value.
  // _m has no default value.
  // _vars has no default value.
  // _markLinEqVars has no default value.
  // _eqLst has no default value.
  // _idxMap has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _inTpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  tmpMeta4 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 3));
  tmp5 = mmc_unbox_integer(tmpMeta4);
  tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 4));
  tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 5));
  tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 6));
  _eqLst = tmpMeta2;
  _idxMap = tmpMeta3;
  _idx = tmp5  /* pattern as ty=Integer */;
  _vars = tmpMeta6;
  _markLinEqVars = tmpMeta7;
  _m = tmpMeta8;

  if((omc_BackendEquation_isEquation(threadData, _inEq) && (!omc_ResolveLoops_eqIsConst(threadData, _inEq))))
  {
    /* Pattern-matching tuple assignment */
    tmpMeta12 = mmc_mk_box2(0, mmc_mk_boolean(1 /* true */), _vars);
    tmpMeta13 = omc_BackendEquation_traverseExpsOfEquation(threadData, _inEq, boxvar_ResolveLoops_isAddOrSubExp, tmpMeta12, &tmpMeta9);
    _eq = tmpMeta13;
    tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 1));
    tmp11 = mmc_unbox_integer(tmpMeta10);
    _isSimple = tmp11  /* pattern as ty=Boolean */;

    if(_isSimple)
    {
      tmpMeta14 = mmc_mk_cons(_eq, _eqLst);
      _eqLst = tmpMeta14;

      tmpMeta15 = mmc_mk_cons(mmc_mk_integer(_idx), _idxMap);
      _idxMap = tmpMeta15;

      {
        modelica_metatype _varIdx;
        for (tmpMeta16 = arrayGet(_m,_idx) /* DAE.ASUB */; !listEmpty(tmpMeta16); tmpMeta16=MMC_CDR(tmpMeta16))
        {
          _varIdx = MMC_CAR(tmpMeta16);
          arrayUpdate(_markLinEqVars, labs(mmc_unbox_integer(_varIdx)), mmc_mk_integer(((modelica_integer) 1)));
        }
      }
    }
  }

  tmpMeta18 = mmc_mk_box6(0, _eqLst, _idxMap, mmc_mk_integer(((modelica_integer) 1) + _idx), _vars, _markLinEqVars, _m);
  _outTpl = tmpMeta18;
  _return: OMC_LABEL_UNUSED
  if (out_outTpl) { *out_outTpl = _outTpl; }
  return _outEq;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_ResolveLoops_arrayEntryLengthIs(threadData_t *threadData, modelica_integer _idx, modelica_metatype _arr, modelica_integer _len)
{
  modelica_boolean _eqLen;
  modelica_metatype _entry = NULL;
  modelica_integer _len1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqLen has no default value.
  // _entry has no default value.
  // _len1 has no default value.
  _entry = arrayGet(_arr, _idx);

  _len1 = listLength(_entry);

  _eqLen = (_len == _len1);
  _return: OMC_LABEL_UNUSED
  return _eqLen;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_arrayEntryLengthIs(threadData_t *threadData, modelica_metatype _idx, modelica_metatype _arr, modelica_metatype _len)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_boolean _eqLen;
  modelica_metatype out_eqLen;
  tmp1 = mmc_unbox_integer(_idx);
  tmp2 = mmc_unbox_integer(_len);
  _eqLen = omc_ResolveLoops_arrayEntryLengthIs(threadData, tmp1, _arr, tmp2);
  out_eqLen = mmc_mk_icon(_eqLen);
  return out_eqLen;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__cutNodes(threadData_t *threadData, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype *out_deadEndEqsMark)
{
  modelica_metatype _deadEndVarsMark = NULL;
  modelica_metatype _deadEndEqsMark = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _deadEndVarsMark has no default value.
  // _deadEndEqsMark has no default value.
  
  
  { /* matchcontinue expression */
    {
      modelica_integer _numVars;
      modelica_integer _numEqs;
      modelica_integer _idx;
      modelica_metatype _loopVars = NULL;
      modelica_metatype _loopEqs = NULL;
      modelica_metatype _nonLoopVars = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _numVars has no default value.
      // _numEqs has no default value.
      // _idx has no default value.
      // _loopVars has no default value.
      // _loopEqs has no default value.
      // _nonLoopVars has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          /* Pattern matching succeeded */
          _numVars = arrayLength(_mTIn);

          _numEqs = arrayLength(_mIn);

          _nonLoopVars = omc_List_filter2OnTrue(threadData, omc_List_intRange(threadData, _numVars), boxvar_ResolveLoops_arrayEntryLengthIs, _mTIn, mmc_mk_integer(((modelica_integer) 1)));

          _deadEndVarsMark = arrayCreate(_numVars, mmc_mk_integer(((modelica_integer) 0)));

          _deadEndEqsMark = arrayCreate(_numVars, mmc_mk_integer(((modelica_integer) 0)));

          {
            modelica_metatype _idx;
            for (tmpMeta6 = _nonLoopVars; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _idx = MMC_CAR(tmpMeta6);
              arrayUpdate(_deadEndVarsMark, mmc_unbox_integer(_idx), mmc_mk_integer(((modelica_integer) 1)));
            }
          }

          {
            modelica_metatype _idx;
            for (tmpMeta8 = _nonLoopVars; !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
            {
              _idx = MMC_CAR(tmpMeta8);
              omc_ResolveLoops_markDeadEndsInBipartiteGraph(threadData, mmc_unbox_integer(_idx), _mIn, _mTIn, _deadEndEqsMark, _deadEndVarsMark);
            }
          }

          _idx = ((modelica_integer) 1);

          while(1)
          {
            if(!(_idx <= _numVars)) break;
            if((mmc_unbox_integer(arrayGet(_deadEndVarsMark, _idx)) == ((modelica_integer) 1)))
            {
              tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
              arrayUpdate(_mTIn, _idx, tmpMeta10);
            }
            else
            {
              _loopEqs = arrayGet(_mTIn, _idx);

              _loopEqs = omc_List_filter1OnTrue(threadData, _loopEqs, boxvar_ResolveLoops_arrayIsZeroAt, _deadEndEqsMark);

              arrayUpdate(_mTIn, _idx, _loopEqs);
            }

            _idx = ((modelica_integer) 1) + _idx;
          }

          _idx = ((modelica_integer) 1);

          while(1)
          {
            if(!(_idx <= _numEqs)) break;
            if((mmc_unbox_integer(arrayGet(_deadEndEqsMark, _idx)) == ((modelica_integer) 1)))
            {
              tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
              arrayUpdate(_mIn, _idx, tmpMeta11);
            }
            else
            {
              _loopVars = arrayGet(_mIn, _idx);

              _loopVars = omc_List_filter1OnTrue(threadData, _loopVars, boxvar_ResolveLoops_arrayIsZeroAt, _deadEndVarsMark);

              arrayUpdate(_mIn, _idx, _loopVars);
            }

            _idx = ((modelica_integer) 1) + _idx;
          }
          tmpMeta[0+0] = _deadEndVarsMark;
          tmpMeta[0+1] = _deadEndEqsMark;
          goto tmp3_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          omc_Error_addInternalError(threadData, _OMC_LIT84, _OMC_LIT85);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _deadEndVarsMark = tmpMeta[0+0];
  _deadEndEqsMark = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_deadEndEqsMark) { *out_deadEndEqsMark = _deadEndEqsMark; }
  return _deadEndVarsMark;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__resolvePartitions(threadData_t *threadData, modelica_metatype _partitionsIn, modelica_metatype _mIn, modelica_metatype _mTIn, modelica_metatype _m_uncut, modelica_metatype _mT_uncut, modelica_metatype _eqMap, modelica_metatype _varMap, modelica_metatype _daeEqs, modelica_metatype _daeVars, modelica_metatype _nonLoopEqMark)
{
  modelica_metatype _daeEqsOut = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _daeEqsOut has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _partitionsIn;
    {
      modelica_metatype _optStructureMapping = NULL;
      modelica_metatype _partition = NULL;
      modelica_metatype _eqCrossLst = NULL;
      modelica_metatype _varCrossLst = NULL;
      modelica_metatype _mapIndices = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _loops = NULL;
      modelica_metatype _eqs = NULL;
      modelica_metatype _map = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _optStructureMapping has no default value.
      // _partition has no default value.
      // _eqCrossLst has no default value.
      // _varCrossLst has no default value.
      // _mapIndices has no default value.
      // _rest has no default value.
      // _loops has no default value.
      // _eqs has no default value.
      // _map has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          _partition = tmpMeta6;
          _rest = tmpMeta7;
          /* Pattern matching succeeded */
          _partition = omc_List_filter1OnTrue(threadData, _partition, boxvar_ResolveLoops_arrayIsZeroAt, _nonLoopEqMark);

          if(listEmpty(_partition))
          {
            _eqs = omc_ResolveLoops_resolveLoops__resolvePartitions(threadData, _rest, _mIn, _mTIn, _m_uncut, _mT_uncut, _eqMap, _varMap, _daeEqs, _daeVars, _nonLoopEqMark);
          }
          else
          {
            tmpMeta8 = mmc_mk_cons(_partition, MMC_REFSTRUCTLIT(mmc_nil));
            _loops = omc_ResolveLoops_resolveLoops__findLoops(threadData, tmpMeta8, _mIn, _mTIn, 0 /* false */ ,&_eqCrossLst ,&_varCrossLst ,&_optStructureMapping);

            if(isSome(_optStructureMapping))
            {
              /* Pattern-matching assignment */
              tmpMeta9 = _optStructureMapping;
              if (optionNone(tmpMeta9)) goto goto_2;
              tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 1));
              tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 1));
              tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 2));
              tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 3));
              _mapIndices = tmpMeta11;
              _map = tmpMeta12;
              _loops = tmpMeta13;

              tmpMeta14 = mmc_mk_box3(0, _m_uncut, _mapIndices, _map);
              _loops = omc_List_filter1OnTrueAndUpdate(threadData, _loops, boxvar_ResolveLoops_evaluateTripleLoop, boxvar_ResolveLoops_updateTripleLoop, tmpMeta14);
            }
            else
            {
              _loops = omc_List_filterOnFalse(threadData, _loops, boxvar_listEmpty);

              tmpMeta15 = mmc_mk_box3(0, _m_uncut, _mT_uncut, _eqCrossLst);
              _loops = omc_List_filter1OnTrue(threadData, _loops, boxvar_ResolveLoops_evaluateLoop, tmpMeta15);
            }

            tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
            _eqs = omc_ResolveLoops_resolveLoops__resolveAndReplace(threadData, _loops, _eqCrossLst, _varCrossLst, _mIn, _mTIn, _eqMap, _varMap, _daeEqs, _daeVars, tmpMeta16, NULL);

            _eqs = omc_ResolveLoops_resolveLoops__resolvePartitions(threadData, _rest, _mIn, _mTIn, _m_uncut, _mT_uncut, _eqMap, _varMap, _eqs, _daeVars, _nonLoopEqMark);
          }
          tmpMeta1 = _eqs;
          goto tmp3_done;
        }
        case 1: {
          if (!listEmpty(tmp4_1)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _daeEqs;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _daeEqsOut = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _daeEqsOut;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_ResolveLoops_resolveLoops__main(threadData_t *threadData, modelica_metatype _inEqSys, modelica_metatype _inShared, modelica_integer _inSysIdx, modelica_metatype *out_outShared, modelica_integer *out_outSysIdx)
{
  modelica_metatype _outEqSys = NULL;
  modelica_metatype _outShared = NULL;
  modelica_integer _outSysIdx;
  modelica_integer tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outEqSys has no default value.
  _outShared = _inShared;
  // _outSysIdx has no default value.
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _inEqSys;
    {
      modelica_integer _numSimpEqs;
      modelica_integer _numVars;
      modelica_metatype _eqMapArr = NULL;
      modelica_metatype _varMapArr = NULL;
      modelica_metatype _nonLoopEqMark = NULL;
      modelica_metatype _markLinEqVars = NULL;
      modelica_metatype _eqMapping = NULL;
      modelica_metatype _partitions = NULL;
      modelica_metatype _varAtts = NULL;
      modelica_metatype _eqAtts = NULL;
      modelica_metatype _vars = NULL;
      modelica_metatype _simpVars = NULL;
      modelica_metatype _eqs = NULL;
      modelica_metatype _simpEqs = NULL;
      modelica_metatype _syst = NULL;
      modelica_metatype _m = NULL;
      modelica_metatype _mT = NULL;
      modelica_metatype _m_cut = NULL;
      modelica_metatype _mT_cut = NULL;
      modelica_metatype _m_after = NULL;
      modelica_metatype _simpEqLst = NULL;
      modelica_metatype _simpVarLst = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _numSimpEqs has no default value.
      // _numVars has no default value.
      // _eqMapArr has no default value.
      // _varMapArr has no default value.
      // _nonLoopEqMark has no default value.
      // _markLinEqVars has no default value.
      // _eqMapping has no default value.
      // _partitions has no default value.
      // _varAtts has no default value.
      // _eqAtts has no default value.
      // _vars has no default value.
      // _simpVars has no default value.
      // _eqs has no default value.
      // _simpEqs has no default value.
      // _syst has no default value.
      // _m has no default value.
      // _mT has no default value.
      // _m_cut has no default value.
      // _mT_cut has no default value.
      // _m_after has no default value.
      // _simpEqLst has no default value.
      // _simpVarLst has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _syst = tmp4_1;
          _vars = tmpMeta6;
          _eqs = tmpMeta7;
          /* Pattern matching succeeded */
          _m = omc_BackendDAEUtil_adjacencyMatrix(threadData, _syst, _OMC_LIT86, mmc_mk_none(), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared), NULL);

          if(omc_Flags_isSet(threadData, _OMC_LIT76))
          {
            tmpMeta8 = stringAppend(_OMC_LIT87,intString(_inSysIdx));
            omc_BackendDump_dumpBipartiteGraphEqSystem(threadData, _syst, _inShared, tmpMeta8);
          }

          _markLinEqVars = arrayCreate(omc_BackendVariable_varsSize(threadData, _vars), mmc_mk_integer(((modelica_integer) -1)));

          /* Pattern-matching assignment */
          tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta11 = mmc_mk_box6(0, tmpMeta9, tmpMeta10, mmc_mk_integer(((modelica_integer) 1)), _vars, _markLinEqVars, _m);
          tmpMeta12 = omc_BackendEquation_traverseEquationArray(threadData, _eqs, boxvar_ResolveLoops_getSimpleEquations, tmpMeta11);
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 1));
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 2));
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 5));
          _simpEqLst = tmpMeta13;
          _eqMapping = tmpMeta14;
          _markLinEqVars = tmpMeta15;

          _eqMapArr = listArray(_eqMapping);

          _simpVarLst = omc_ResolveLoops_getSimpleEquationVariables(threadData, _markLinEqVars, _vars ,&_varMapArr);

          _simpEqs = omc_BackendEquation_listEquation(threadData, _simpEqLst);

          _simpVars = omc_BackendVariable_listVar1(threadData, _simpVarLst);

          _numSimpEqs = listLength(_simpEqLst);

          _numVars = listLength(_simpVarLst);

          _m = omc_BackendDAEUtil_adjacencyMatrixDispatch(threadData, _simpVars, _simpEqs, _OMC_LIT86, mmc_mk_none(), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared) ,&_mT);

          if(omc_Flags_isSet(threadData, _OMC_LIT76))
          {
            _varAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numVars), omc_List_fill(threadData, _OMC_LIT28, _numVars), boxvar_Util_makeTuple);

            _eqAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numSimpEqs), omc_List_fill(threadData, _OMC_LIT28, _numSimpEqs), boxvar_Util_makeTuple);

            tmpMeta16 = stringAppend(_OMC_LIT88,intString(_inSysIdx));
            omc_BackendDump_dumpBipartiteGraphStrongComponent2(threadData, _simpVars, _simpEqs, _m, _varAtts, _eqAtts, tmpMeta16);
          }

          _partitions = omc_ResolveLoops_partitionBipartiteGraph(threadData, _m, _mT);

          _partitions = omc_List_filterOnTrue(threadData, _partitions, boxvar_List_hasSeveralElements);

          _m_cut = arrayCopy(_m);

          _mT_cut = arrayCopy(_mT);

          omc_ResolveLoops_resolveLoops__cutNodes(threadData, _m_cut, _mT_cut ,&_nonLoopEqMark);

          if(omc_Flags_isSet(threadData, _OMC_LIT76))
          {
            _varAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numVars), omc_List_fill(threadData, _OMC_LIT28, _numVars), boxvar_Util_makeTuple);

            _eqAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numSimpEqs), omc_List_fill(threadData, _OMC_LIT28, _numSimpEqs), boxvar_Util_makeTuple);

            tmpMeta17 = stringAppend(_OMC_LIT89,intString(_inSysIdx));
            omc_BackendDump_dumpBipartiteGraphStrongComponent2(threadData, _simpVars, _simpEqs, _m_cut, _varAtts, _eqAtts, tmpMeta17);
          }

          _eqs = omc_ResolveLoops_resolveLoops__resolvePartitions(threadData, _partitions, _m_cut, _mT_cut, _m, _mT, _eqMapArr, _varMapArr, _eqs, _vars, _nonLoopEqMark);

          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_syst), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[3] = _eqs;
          _syst = tmpMeta18;

          if(omc_Flags_isSet(threadData, _OMC_LIT76))
          {
            _simpEqLst = omc_BackendEquation_getList(threadData, _eqMapping, _eqs);

            _simpEqs = omc_BackendEquation_listEquation(threadData, _simpEqLst);

            _numSimpEqs = listLength(_simpEqLst);

            _numVars = listLength(_simpVarLst);

            _m_after = omc_BackendDAEUtil_adjacencyMatrixDispatch(threadData, _simpVars, _simpEqs, _OMC_LIT86, mmc_mk_none(), omc_BackendDAEUtil_isInitializationDAE(threadData, _inShared), NULL);

            _varAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numVars), omc_List_fill(threadData, _OMC_LIT28, _numVars), boxvar_Util_makeTuple);

            _eqAtts = omc_List_threadMap(threadData, omc_List_fill(threadData, mmc_mk_boolean(0 /* false */), _numSimpEqs), omc_List_fill(threadData, _OMC_LIT28, _numSimpEqs), boxvar_Util_makeTuple);

            tmpMeta19 = stringAppend(_OMC_LIT90,intString(_inSysIdx));
            omc_BackendDump_dumpBipartiteGraphStrongComponent2(threadData, _simpVars, _simpEqs, _m_after, _varAtts, _eqAtts, tmpMeta19);
          }

          _syst = omc_BackendDAEUtil_clearEqSyst(threadData, _syst);
          tmpMeta[0+0] = _syst;
          tmp1_c1 = ((modelica_integer) 1) + _inSysIdx;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _inEqSys;
          tmp1_c1 = ((modelica_integer) 1) + _inSysIdx;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 2) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _outEqSys = tmpMeta[0+0];
  _outSysIdx = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_outShared) { *out_outShared = _outShared; }
  if (out_outSysIdx) { *out_outSysIdx = _outSysIdx; }
  return _outEqSys;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_ResolveLoops_resolveLoops__main(threadData_t *threadData, modelica_metatype _inEqSys, modelica_metatype _inShared, modelica_metatype _inSysIdx, modelica_metatype *out_outShared, modelica_metatype *out_outSysIdx)
{
  modelica_integer tmp1;
  modelica_integer _outSysIdx;
  modelica_metatype _outEqSys = NULL;
  tmp1 = mmc_unbox_integer(_inSysIdx);
  _outEqSys = omc_ResolveLoops_resolveLoops__main(threadData, _inEqSys, _inShared, tmp1, out_outShared, &_outSysIdx);
  /* skip box _outEqSys; BackendDAE.EqSystem */
  /* skip box _outShared; BackendDAE.Shared */
  if (out_outSysIdx) { *out_outSysIdx = mmc_mk_icon(_outSysIdx); }
  return _outEqSys;
}

DLLDirection
modelica_metatype omc_ResolveLoops_resolveLoops(threadData_t *threadData, modelica_metatype _inDAE)
{
  modelica_metatype _outDAE = NULL;
  modelica_metatype _eqSysts = NULL;
  modelica_metatype _shared = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _outDAE has no default value.
  // _eqSysts has no default value.
  // _shared has no default value.
  _eqSysts = omc_List_mapFold2(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inDAE), 2))), boxvar_ResolveLoops_resolveLoops__main, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_inDAE), 3))), mmc_mk_integer(((modelica_integer) 1)) ,&_shared ,NULL);

  tmpMeta1 = mmc_mk_box3(3, &BackendDAE_BackendDAE_DAE__desc, _eqSysts, _shared);
  _outDAE = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _outDAE;
}

