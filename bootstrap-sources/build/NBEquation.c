#include "omc_simulation_settings.h"
#include "NBEquation.h"
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT0,1,5) {&ErrorTypes_MessageType_TRANSLATION__desc,}};
#define _OMC_LIT0 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT0)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT1,1,4) {&ErrorTypes_Severity_ERROR__desc,}};
#define _OMC_LIT1 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "Internal error %s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,17,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT2}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT4,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(63)),_OMC_LIT0,_OMC_LIT1,_OMC_LIT3}};
#define _OMC_LIT4 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data "NBEquation.typeList failed for\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,31,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data ""
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,0,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data "NBEquation.EqData.compress failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,34,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,2,1) {_OMC_LIT7,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "NBEquation.EqData.removeList failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,36,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,2,1) {_OMC_LIT9,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "SIM"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,3,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "NBEquation.EqData.addUntypedList failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,40,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT13,2,1) {_OMC_LIT12,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT13 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "NBEquation.EqData.addTypedList failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,38,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT15,2,1) {_OMC_LIT14,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT15 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT15)
#define _OMC_LIT16_data "NBEquation.EqData.getEquations failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT16,38,_OMC_LIT16_data);
#define _OMC_LIT16 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,2,1) {_OMC_LIT16,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data "NBEquation.EqData.getUniqueIndex failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,40,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT19,2,1) {_OMC_LIT18,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT19 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT19)
#define _OMC_LIT20_data "Equation Data Simulation (scalar simulation equations: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT20,55,_OMC_LIT20_data);
#define _OMC_LIT20 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT20)
#define _OMC_LIT21_data ")"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT21,1,_OMC_LIT21_data);
#define _OMC_LIT21 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT21)
#define _OMC_LIT22_data "\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT22,1,_OMC_LIT22_data);
#define _OMC_LIT22 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "Continuous"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,10,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
#define _OMC_LIT24_data "Clocked"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT24,7,_OMC_LIT24_data);
#define _OMC_LIT24 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "Discrete"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,8,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
#define _OMC_LIT26_data "(Exclusively) Initial"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT26,21,_OMC_LIT26_data);
#define _OMC_LIT26 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT26)
#define _OMC_LIT27_data "Auxiliary"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT27,9,_OMC_LIT27_data);
#define _OMC_LIT27 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "Removed"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,7,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
#define _OMC_LIT29_data "Simulation"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT29,10,_OMC_LIT29_data);
#define _OMC_LIT29 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT29)
#define _OMC_LIT30_data "Residual"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT30,8,_OMC_LIT30_data);
#define _OMC_LIT30 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT30)
#define _OMC_LIT31_data "Inner"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT31,5,_OMC_LIT31_data);
#define _OMC_LIT31 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT31)
#define _OMC_LIT32_data "Jacobian"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT32,8,_OMC_LIT32_data);
#define _OMC_LIT32 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data "Result Equation"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,15,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
#define _OMC_LIT34_data "Temporary Inner"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT34,15,_OMC_LIT34_data);
#define _OMC_LIT34 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT34)
#define _OMC_LIT35_data "Hessian"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT35,7,_OMC_LIT35_data);
#define _OMC_LIT35 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "Empty equation Data!\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,21,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
#define _OMC_LIT37_data "NBEquation.EqData.toString failed!\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT37,35,_OMC_LIT37_data);
#define _OMC_LIT37 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT37)
#define _OMC_LIT38_data "NBEquation.EquationPointers.getEqnByName failed because the equation with the name "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT38,83,_OMC_LIT38_data);
#define _OMC_LIT38 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT38)
#define _OMC_LIT39_data " has already been deleted."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT39,26,_OMC_LIT39_data);
#define _OMC_LIT39 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT39)
#define _OMC_LIT40_data "NBEquation.EquationPointers.getEqnByName failed because there is no equation with the name "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT40,91,_OMC_LIT40_data);
#define _OMC_LIT40 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data "."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,1,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT42,1,11) {&NBEquation_Equation_DUMMY__EQUATION__desc,}};
#define _OMC_LIT42 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT42)
#define _OMC_LIT43_data "debugFollowEquations"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT43,20,_OMC_LIT43_data);
#define _OMC_LIT43 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT43)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT44,1,4) {&Flags_FlagVisibility_EXTERNAL__desc,}};
#define _OMC_LIT44 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT44)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT45,2,9) {&Flags_FlagData_STRING__LIST__FLAG__desc,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT45 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT45)
#define _OMC_LIT46_data "Takes a list of equation names and prints the corresponding equations after each stage of the backend process."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT46,110,_OMC_LIT46_data);
#define _OMC_LIT46 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT46)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT47,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT46}};
#define _OMC_LIT47 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT47)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT48,8,3) {&Flags_ConfigFlag_CONFIG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(155)),_OMC_LIT43,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT44,_OMC_LIT45,MMC_REFSTRUCTLIT(mmc_none),_OMC_LIT47}};
#define _OMC_LIT48 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT48)
#define _OMC_LIT49_data "[debugFollowEquations] The equation:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT49,37,_OMC_LIT49_data);
#define _OMC_LIT49 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT49)
#define _OMC_LIT50_data "\nGets replaced by:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT50,19,_OMC_LIT50_data);
#define _OMC_LIT50 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT50)
#define _OMC_LIT51_data "Filtered "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT51,9,_OMC_LIT51_data);
#define _OMC_LIT51 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT51)
#define _OMC_LIT52_data " Equations ("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT52,12,_OMC_LIT52_data);
#define _OMC_LIT52 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT52)
#define _OMC_LIT53_data "/"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT53,1,_OMC_LIT53_data);
#define _OMC_LIT53 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT53)
#define _OMC_LIT54_data "("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT54,1,_OMC_LIT54_data);
#define _OMC_LIT54 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT54)
#define _OMC_LIT55_data "|"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT55,1,_OMC_LIT55_data);
#define _OMC_LIT55 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT55)
#define _OMC_LIT56_data " "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT56,1,_OMC_LIT56_data);
#define _OMC_LIT56 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT56)
#define _OMC_LIT57_data "[CONT"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT57,5,_OMC_LIT57_data);
#define _OMC_LIT57 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT57)
#define _OMC_LIT58_data "[CLCK"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT58,5,_OMC_LIT58_data);
#define _OMC_LIT58 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT58)
#define _OMC_LIT59_data "[DISC"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT59,5,_OMC_LIT59_data);
#define _OMC_LIT59 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT59)
#define _OMC_LIT60_data "[EMTY"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT60,5,_OMC_LIT60_data);
#define _OMC_LIT60 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT60)
#define _OMC_LIT61_data "[UKWN"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT61,5,_OMC_LIT61_data);
#define _OMC_LIT61 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT61)
#define _OMC_LIT62_data "[INI]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT62,5,_OMC_LIT62_data);
#define _OMC_LIT62 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT62)
#define _OMC_LIT63_data "[DAE]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT63,5,_OMC_LIT63_data);
#define _OMC_LIT63 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT63)
#define _OMC_LIT64_data "]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT64,1,_OMC_LIT64_data);
#define _OMC_LIT64 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT64)
#define _OMC_LIT65_data ")]"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT65,2,_OMC_LIT65_data);
#define _OMC_LIT65 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT65)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT66,1,5) {&BackendDAE_EquationKind_INITIAL__EQUATION__desc,}};
#define _OMC_LIT66 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT66)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT67,1,4) {&BackendDAE_EquationKind_DYNAMIC__EQUATION__desc,}};
#define _OMC_LIT67 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT67)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT68,1,7) {&BackendDAE_EquationKind_DISCRETE__EQUATION__desc,}};
#define _OMC_LIT68 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT68)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT69,1,8) {&BackendDAE_EquationKind_AUX__EQUATION__desc,}};
#define _OMC_LIT69 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT69)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT70,1,9) {&BackendDAE_EquationKind_UNKNOWN__EQUATION__KIND__desc,}};
#define _OMC_LIT70 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT70)
#define _OMC_LIT71_data "NBEquation.convertEquationKind failed because the non-clock equation kind "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT71,74,_OMC_LIT71_data);
#define _OMC_LIT71 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT71)
#define _OMC_LIT72_data " has a clock index."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT72,19,_OMC_LIT72_data);
#define _OMC_LIT72 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT72)
#define _OMC_LIT73_data "NBEquation.convertEquationKind failed because no clock index was provided for clocked equation."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT73,95,_OMC_LIT73_data);
#define _OMC_LIT73 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT73)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT74,2,1) {_OMC_LIT73,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT74 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT74)
#define _OMC_LIT75_data "NBEquation.convertEquationKind for an unknown reason."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT75,53,_OMC_LIT75_data);
#define _OMC_LIT75 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT75)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT76,2,1) {_OMC_LIT75,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT76 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT76)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT77,5,3) {&NBEvaluation_Stages_STAGES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */))}};
#define _OMC_LIT77 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT77)
#define _OMC_LIT78_data "NBEquation.EquationAttributes.getResidualVar failed because of missing residualVar!"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT78,83,_OMC_LIT78_data);
#define _OMC_LIT78 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT78)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT79,2,1) {_OMC_LIT78,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT79 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT79)
#define _OMC_LIT80_data "NBEquation.WhenStatement.convert failed because of unrecognized statement: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT80,75,_OMC_LIT80_data);
#define _OMC_LIT80 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT80)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT81,1,18) {&NFType_ANY__desc,}};
#define _OMC_LIT81 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT81)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT82,1,5) {&NBEquation_Iterator_EMPTY__desc,}};
#define _OMC_LIT82 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT82)
#define _OMC_LIT83_data "NBEquation.WhenStatement.toStatement failed because of unrecognized statement: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT83,79,_OMC_LIT83_data);
#define _OMC_LIT83 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT83)
#define _OMC_LIT84_data " := "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT84,4,_OMC_LIT84_data);
#define _OMC_LIT84 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT84)
#define _OMC_LIT85_data "reinit("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT85,7,_OMC_LIT85_data);
#define _OMC_LIT85 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT85)
#define _OMC_LIT86_data ", "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT86,2,_OMC_LIT86_data);
#define _OMC_LIT86 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT86)
#define _OMC_LIT87_data "assert("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT87,7,_OMC_LIT87_data);
#define _OMC_LIT87 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT87)
#define _OMC_LIT88_data "terminate("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT88,10,_OMC_LIT88_data);
#define _OMC_LIT88 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT88)
#define _OMC_LIT89_data "NBEquation.WhenStatement.toString"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT89,33,_OMC_LIT89_data);
#define _OMC_LIT89 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT89)
#define _OMC_LIT90_data " failed."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT90,8,_OMC_LIT90_data);
#define _OMC_LIT90 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT90)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT91,1,6) {&NFType_BOOLEAN__desc,}};
#define _OMC_LIT91 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT91)
#define _OMC_LIT92_data "/home/adrpo33/OpenModelica/OMCompiler/Compiler/NBackEnd/Classes/NBEquation.mo"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT92,77,_OMC_LIT92_data);
#define _OMC_LIT92 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT92)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT93_6,1.758197185e9);
#define _OMC_LIT93_6 MMC_REFREALLIT(_OMC_LIT_STRUCT93_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT93,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3538)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3538)),MMC_IMMEDIATE(MMC_TAGFIXNUM(70)),_OMC_LIT93_6}};
#define _OMC_LIT93 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT93)
#define _OMC_LIT94_data "NBEquation.WhenEquationBody.collectForSplit failed because lhs of statement is not a cref: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT94,91,_OMC_LIT94_data);
#define _OMC_LIT94 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT94)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT95_6,1.758197185e9);
#define _OMC_LIT95_6 MMC_REFREALLIT(_OMC_LIT_STRUCT95_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT95,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3481)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3483)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),_OMC_LIT95_6}};
#define _OMC_LIT95 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT95)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT96,1,3) {&NFType_INTEGER__desc,}};
#define _OMC_LIT96 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT96)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT97,2,33) {&NFExpression_EMPTY__desc,_OMC_LIT96}};
#define _OMC_LIT97 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT97)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT98_6,1.758197185e9);
#define _OMC_LIT98_6 MMC_REFREALLIT(_OMC_LIT_STRUCT98_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT98,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3332)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(3332)),MMC_IMMEDIATE(MMC_TAGFIXNUM(69)),_OMC_LIT98_6}};
#define _OMC_LIT98 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT98)
#define _OMC_LIT99_data "NBEquation.WhenEquationBody.split failed because when partition for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT99,69,_OMC_LIT99_data);
#define _OMC_LIT99 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT99)
#define _OMC_LIT100_data " could not be recovered."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT100,24,_OMC_LIT100_data);
#define _OMC_LIT100 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT100)
#define _OMC_LIT101_data "initial"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT101,7,_OMC_LIT101_data);
#define _OMC_LIT101 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT101)
#define _OMC_LIT102_data "NBEquation.WhenEquationBody.getBodyAttributes.getConditions failed for condition: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT102,82,_OMC_LIT102_data);
#define _OMC_LIT102 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT102)
#define _OMC_LIT103_data "NBEquation.WhenEquationBody.getType failed because of not properly split up when equation body: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT103,96,_OMC_LIT103_data);
#define _OMC_LIT103 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT103)
#define _OMC_LIT104_data "when "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT104,5,_OMC_LIT104_data);
#define _OMC_LIT104 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT104)
#define _OMC_LIT105_data " then\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT105,6,_OMC_LIT105_data);
#define _OMC_LIT105 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT105)
#define _OMC_LIT106_data "  "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT106,2,_OMC_LIT106_data);
#define _OMC_LIT106 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT106)
#define _OMC_LIT107_data "else"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT107,4,_OMC_LIT107_data);
#define _OMC_LIT107 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT107)
#define _OMC_LIT108_data "end when;"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT108,9,_OMC_LIT108_data);
#define _OMC_LIT108 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT108)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT109,1,18) {&NFExpression_END__desc,}};
#define _OMC_LIT109 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT109)
#define _OMC_LIT110_data "NBEquation.IfEquationBody.getRHS failed because of un-split if-equation:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT110,73,_OMC_LIT110_data);
#define _OMC_LIT110 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT110)
#define _OMC_LIT111_data "NBEquation.IfEquationBody.getLHS failed because of ambiguous LHS for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT111,70,_OMC_LIT111_data);
#define _OMC_LIT111 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT111)
#define _OMC_LIT112_data "failtrace"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT112,9,_OMC_LIT112_data);
#define _OMC_LIT112 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT112)
#define _OMC_LIT113_data "Sets whether to print a failtrace or not."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT113,41,_OMC_LIT113_data);
#define _OMC_LIT113 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT113)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT114,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT113}};
#define _OMC_LIT114 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT114)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT115,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT112,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT114}};
#define _OMC_LIT115 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT115)
#define _OMC_LIT116_data "NBEquation.IfEquationBody.getLHS failed because of un-split if-equation:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT116,73,_OMC_LIT116_data);
#define _OMC_LIT116 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT116)
#define _OMC_LIT117_data "NBEquation.IfEquationBody.createResidual failed for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT117,53,_OMC_LIT117_data);
#define _OMC_LIT117 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT117)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT118,2,6) {&NFExpression_BOOLEAN__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */))}};
#define _OMC_LIT118 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT118)
#define _OMC_LIT119_data "if "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT119,3,_OMC_LIT119_data);
#define _OMC_LIT119 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT119)
#define _OMC_LIT120_data "end if;"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT120,7,_OMC_LIT120_data);
#define _OMC_LIT120 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT120)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT121,1,5) {&ErrorTypes_Severity_WARNING__desc,}};
#define _OMC_LIT121 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT121)
#define _OMC_LIT122_data "%s"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT122,2,_OMC_LIT122_data);
#define _OMC_LIT122 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT122)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT123,2,4) {&Gettext_TranslatableContent_notrans__desc,_OMC_LIT122}};
#define _OMC_LIT123 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT123)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT124,5,3) {&ErrorTypes_Message_MESSAGE__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(6000)),_OMC_LIT0,_OMC_LIT121,_OMC_LIT123}};
#define _OMC_LIT124 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT124)
#define _OMC_LIT125_data "NBEquation.IfEquationBody.toEquation: Creating if-equation with multiple body equations. Unsure of type:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT125,105,_OMC_LIT125_data);
#define _OMC_LIT125 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT125)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT126_6,1.758197185e9);
#define _OMC_LIT126_6 MMC_REFREALLIT(_OMC_LIT_STRUCT126_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT126,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2722)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2722)),MMC_IMMEDIATE(MMC_TAGFIXNUM(97)),_OMC_LIT126_6}};
#define _OMC_LIT126 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT126)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT127_6,1.758197185e9);
#define _OMC_LIT127_6 MMC_REFREALLIT(_OMC_LIT_STRUCT127_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT127,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2723)),MMC_IMMEDIATE(MMC_TAGFIXNUM(11)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2723)),MMC_IMMEDIATE(MMC_TAGFIXNUM(97)),_OMC_LIT127_6}};
#define _OMC_LIT127 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT127)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT128,1,3) {&NFStatement_ForType_NORMAL__desc,}};
#define _OMC_LIT128 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT128)
#define _OMC_LIT129_data "NBEquation.Equation.toStatement failed it is not yet supported for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT129,68,_OMC_LIT129_data);
#define _OMC_LIT129 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT129)
#define _OMC_LIT130_data "NBEquation.Equation.makeInequality"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT130,34,_OMC_LIT130_data);
#define _OMC_LIT130 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT130)
#define _OMC_LIT131_data "NBEquation.Equation.slice failed because slicing is not yet supported for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT131,75,_OMC_LIT131_data);
#define _OMC_LIT131 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT131)
#define _OMC_LIT132_data "["
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT132,1,_OMC_LIT132_data);
#define _OMC_LIT132 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT132)
#define _OMC_LIT133_data "] ### Entwining following equations:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT133,37,_OMC_LIT133_data);
#define _OMC_LIT133 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT133)
#define _OMC_LIT134_data "\n\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT134,2,_OMC_LIT134_data);
#define _OMC_LIT134 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT134)
#define _OMC_LIT135_data "dumpSlice"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT135,9,_OMC_LIT135_data);
#define _OMC_LIT135 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT135)
#define _OMC_LIT136_data "Dumps information about the slicing process (pseudo-array causalization)."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT136,73,_OMC_LIT136_data);
#define _OMC_LIT136 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT136)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT137,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT136}};
#define _OMC_LIT137 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT137)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT138,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(191)),_OMC_LIT135,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT137}};
#define _OMC_LIT138 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT138)
#define _OMC_LIT139_data "] +++ Result of entwining:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT139,27,_OMC_LIT139_data);
#define _OMC_LIT139 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT139)
#define _OMC_LIT140_data "BND"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT140,3,_OMC_LIT140_data);
#define _OMC_LIT140 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT140)
#define _OMC_LIT141_data "NBEquation.Equation.generateBindingEquation failed because of wrong binding type: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT141,82,_OMC_LIT141_data);
#define _OMC_LIT141 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT141)
#define _OMC_LIT142_data " for variable "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT142,14,_OMC_LIT142_data);
#define _OMC_LIT142 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT142)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT143,1,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(-1))}};
#define _OMC_LIT143 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT143)
#define _OMC_LIT144_data "NBEquation.Equation.generateBindingEquation"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT144,43,_OMC_LIT144_data);
#define _OMC_LIT144 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT144)
#define _OMC_LIT145_data "$i"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT145,2,_OMC_LIT145_data);
#define _OMC_LIT145 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT145)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT146_6,1.758197185e9);
#define _OMC_LIT146_6 MMC_REFREALLIT(_OMC_LIT_STRUCT146_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT146,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2348)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),MMC_IMMEDIATE(MMC_TAGFIXNUM(2348)),MMC_IMMEDIATE(MMC_TAGFIXNUM(101)),_OMC_LIT146_6}};
#define _OMC_LIT146 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT146)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT147,1,4) {&NFType_REAL__desc,}};
#define _OMC_LIT147 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT147)
#define _OMC_LIT148_data "Trying to construct residual expression of type "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT148,48,_OMC_LIT148_data);
#define _OMC_LIT148 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT148)
#define _OMC_LIT149_data " for equation "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT149,14,_OMC_LIT149_data);
#define _OMC_LIT149 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT149)
#define _OMC_LIT150_data " but operator "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT150,14,_OMC_LIT150_data);
#define _OMC_LIT150 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT150)
#define _OMC_LIT151_data " is not defined."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT151,16,_OMC_LIT151_data);
#define _OMC_LIT151 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT151)
#define _OMC_LIT152_data "'+'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT152,3,_OMC_LIT152_data);
#define _OMC_LIT152 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT152)
#define _OMC_LIT153_data "'0'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT153,3,_OMC_LIT153_data);
#define _OMC_LIT153 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT153)
#define _OMC_LIT154_data "'-'"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT154,3,_OMC_LIT154_data);
#define _OMC_LIT154 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT154)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT155,2,1) {_OMC_LIT154,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT155 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT155)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT156,2,1) {_OMC_LIT153,_OMC_LIT155}};
#define _OMC_LIT156 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT156)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT157,2,1) {_OMC_LIT152,_OMC_LIT156}};
#define _OMC_LIT157 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT157)
#define _OMC_LIT158_data "NBEquation.Equation.getResidualExp failed for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT158,47,_OMC_LIT158_data);
#define _OMC_LIT158 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT158)
#define _OMC_LIT159_data "NBEquation.Equation.getResidualExp"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT159,34,_OMC_LIT159_data);
#define _OMC_LIT159 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT159)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT160,1,8) {&NFSubscript_WHOLE__desc,}};
#define _OMC_LIT160 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT160)
#define _OMC_LIT161_data "NBEquation.Equation.subIdxName failed for\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT161,42,_OMC_LIT161_data);
#define _OMC_LIT161 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT161)
#define _OMC_LIT162_data "NBEquation.Equation.setResidualVar failed for\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT162,46,_OMC_LIT162_data);
#define _OMC_LIT162 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT162)
#define _OMC_LIT163_data "dumpSimplify"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT163,12,_OMC_LIT163_data);
#define _OMC_LIT163 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT163)
#define _OMC_LIT164_data "Dumps expressions before and after simplification."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT164,50,_OMC_LIT164_data);
#define _OMC_LIT164 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT164)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT165,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT164}};
#define _OMC_LIT165 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT165)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT166,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(187)),_OMC_LIT163,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT165}};
#define _OMC_LIT166 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT166)
#define _OMC_LIT167_data "NBEquation.Equation.simplify failed for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT167,41,_OMC_LIT167_data);
#define _OMC_LIT167 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT167)
#define _OMC_LIT168_data "### dumpSimplify | "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT168,19,_OMC_LIT168_data);
#define _OMC_LIT168 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT168)
#define _OMC_LIT169_data " ###\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT169,5,_OMC_LIT169_data);
#define _OMC_LIT169 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT169)
#define _OMC_LIT170_data "[BEFORE]\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT170,9,_OMC_LIT170_data);
#define _OMC_LIT170 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT170)
#define _OMC_LIT171_data "[AFTER ]\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT171,9,_OMC_LIT171_data);
#define _OMC_LIT171 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT171)
#define _OMC_LIT172_data "NBEquation.Equation.swapLHSandRHS failed for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT172,46,_OMC_LIT172_data);
#define _OMC_LIT172 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT172)
#define _OMC_LIT173_data "NBEquation.Equation.setRHS failed because RHS could not be set for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT173,68,_OMC_LIT173_data);
#define _OMC_LIT173 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT173)
#define _OMC_LIT174_data "NBEquation.Equation.setLHS failed because LHS "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT174,46,_OMC_LIT174_data);
#define _OMC_LIT174 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT174)
#define _OMC_LIT175_data " could not be set for:\n "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT175,24,_OMC_LIT175_data);
#define _OMC_LIT175 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT175)
#define _OMC_LIT176_data "NBEquation.Equation.getRHS failed because RHS was ambiguous for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT176,65,_OMC_LIT176_data);
#define _OMC_LIT176 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT176)
#define _OMC_LIT177_data "NBEquation.Equation.getLHS failed because LHS was ambiguous for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT177,65,_OMC_LIT177_data);
#define _OMC_LIT177 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT177)
#define _OMC_LIT178_data "NBEquation.Equation.map failed because there was no suitable case for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT178,71,_OMC_LIT178_data);
#define _OMC_LIT178 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT178)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT179,0.0);
#define _OMC_LIT179 MMC_REFREALLIT(_OMC_LIT_STRUCT179)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT180,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT6,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),_OMC_LIT179}};
#define _OMC_LIT180 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT180)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT181,1,4) {&DAE_ComponentPrefix_NOCOMPPRE__desc,}};
#define _OMC_LIT181 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT181)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT182,8,3) {&DAE_ElementSource_SOURCE__desc,_OMC_LIT180,MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT181,MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT182 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT182)
#define _OMC_LIT183_data "for "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT183,4,_OMC_LIT183_data);
#define _OMC_LIT183 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT183)
#define _OMC_LIT184_data " loop\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT184,6,_OMC_LIT184_data);
#define _OMC_LIT184 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT184)
#define _OMC_LIT185_data "end for;"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT185,8,_OMC_LIT185_data);
#define _OMC_LIT185 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT185)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT186,1,11) {&NFInstNode_InstNode_EMPTY__NODE__desc,}};
#define _OMC_LIT186 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT186)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT187_6,1.758197185e9);
#define _OMC_LIT187_6 MMC_REFREALLIT(_OMC_LIT_STRUCT187_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT187,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1315)),MMC_IMMEDIATE(MMC_TAGFIXNUM(67)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1316)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),_OMC_LIT187_6}};
#define _OMC_LIT187 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT187)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT188_6,1.758197185e9);
#define _OMC_LIT188_6 MMC_REFREALLIT(_OMC_LIT_STRUCT188_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT188,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1316)),MMC_IMMEDIATE(MMC_TAGFIXNUM(67)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1317)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),_OMC_LIT188_6}};
#define _OMC_LIT188 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT188)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT189_6,1.758197185e9);
#define _OMC_LIT189_6 MMC_REFREALLIT(_OMC_LIT_STRUCT189_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT189,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1317)),MMC_IMMEDIATE(MMC_TAGFIXNUM(67)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1318)),MMC_IMMEDIATE(MMC_TAGFIXNUM(9)),_OMC_LIT189_6}};
#define _OMC_LIT189 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT189)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT190,1,4) {&NFComponentRef_EMPTY__desc,}};
#define _OMC_LIT190 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT190)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT191,1,3) {&NFBinding_UNBOUND__desc,}};
#define _OMC_LIT191 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT191)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT192,1,4) {&NFPrefixes_Replaceable_NOT__REPLACEABLE__desc,}};
#define _OMC_LIT192 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT192)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT193,10,3) {&NFAttributes_ATTRIBUTES__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT192,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT193 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT193)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT194,3,3) {&SCode_Comment_COMMENT__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT194 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT194)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT195,1,35) {&NFBackendExtension_VariableKind_FRONTEND__DUMMY__desc,}};
#define _OMC_LIT195 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT195)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT196,17,3) {&NFBackendExtension_VariableAttributes_VAR__ATTR__REAL__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT196 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT196)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT197,3,3) {&NFBackendExtension_Annotations_ANNOTATIONS__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT197 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT197)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT198,8,3) {&NFBackendExtension_BackendInfo_BACKEND__INFO__desc,_OMC_LIT195,_OMC_LIT196,_OMC_LIT197,MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none),MMC_REFSTRUCTLIT(mmc_none)}};
#define _OMC_LIT198 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT198)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT199,11,3) {&NFVariable_VARIABLE__desc,_OMC_LIT190,_OMC_LIT81,_OMC_LIT191,MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT193,MMC_REFSTRUCTLIT(mmc_nil),MMC_REFSTRUCTLIT(mmc_nil),_OMC_LIT194,_OMC_LIT180,_OMC_LIT198}};
#define _OMC_LIT199 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT199)
#define _OMC_LIT200_data "NBEquation.Equation.getResidualVar failed because of missing residual variable."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT200,79,_OMC_LIT200_data);
#define _OMC_LIT200 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT200)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT201,2,1) {_OMC_LIT200,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT201 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT201)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT202,2,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT202 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT202)
#define _OMC_LIT203_data "NBEquation.Equation.sizes failed for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT203,38,_OMC_LIT203_data);
#define _OMC_LIT203 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT203)
#define _OMC_LIT204_data "NBEquation.Equation.size failed for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT204,37,_OMC_LIT204_data);
#define _OMC_LIT204 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT204)
#define _OMC_LIT205_data "NBEquation.Equation.source failed for:\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT205,39,_OMC_LIT205_data);
#define _OMC_LIT205 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT205)
#define _OMC_LIT206_data "[SCAL] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT206,7,_OMC_LIT206_data);
#define _OMC_LIT206 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT206)
#define _OMC_LIT207_data " = "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT207,3,_OMC_LIT207_data);
#define _OMC_LIT207 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT207)
#define _OMC_LIT208_data "[ARRY] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT208,7,_OMC_LIT208_data);
#define _OMC_LIT208 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT208)
#define _OMC_LIT209_data "[TUPL] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT209,7,_OMC_LIT209_data);
#define _OMC_LIT209 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT209)
#define _OMC_LIT210_data "[RECD] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT210,7,_OMC_LIT210_data);
#define _OMC_LIT210 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT210)
#define _OMC_LIT211_data "[ALGO] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT211,7,_OMC_LIT211_data);
#define _OMC_LIT211 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT211)
#define _OMC_LIT212_data "[----] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT212,7,_OMC_LIT212_data);
#define _OMC_LIT212 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT212)
#define _OMC_LIT213_data "[-IF-] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT213,7,_OMC_LIT213_data);
#define _OMC_LIT213 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT213)
#define _OMC_LIT214_data "[FOR-] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT214,7,_OMC_LIT214_data);
#define _OMC_LIT214 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT214)
#define _OMC_LIT215_data "[WHEN] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT215,7,_OMC_LIT215_data);
#define _OMC_LIT215 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT215)
#define _OMC_LIT216_data "[AUX-] "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT216,7,_OMC_LIT216_data);
#define _OMC_LIT216 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT216)
#define _OMC_LIT217_data "Auxiliary equation for "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT217,23,_OMC_LIT217_data);
#define _OMC_LIT217 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT217)
#define _OMC_LIT218_data "[DUMY] (0) Dummy equation."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT218,26,_OMC_LIT218_data);
#define _OMC_LIT218 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT218)
#define _OMC_LIT219_data "[FAIL] (0) "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT219,11,_OMC_LIT219_data);
#define _OMC_LIT219 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT219)
#define _OMC_LIT220_data "NBEquation.Equation.toString"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT220,28,_OMC_LIT220_data);
#define _OMC_LIT220 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT220)
#define _OMC_LIT221_data " failed!"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT221,8,_OMC_LIT221_data);
#define _OMC_LIT221 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT221)
#define _OMC_LIT222_data "NBEquation.Iterator.map failed for an unknown reason."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT222,53,_OMC_LIT222_data);
#define _OMC_LIT222 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT222)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT223,2,1) {_OMC_LIT222,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT223 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT223)
#define _OMC_LIT224_data " in "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT224,4,_OMC_LIT224_data);
#define _OMC_LIT224 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT224)
#define _OMC_LIT225_data " ("
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT225,2,_OMC_LIT225_data);
#define _OMC_LIT225 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT225)
#define _OMC_LIT226_data "{"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT226,1,_OMC_LIT226_data);
#define _OMC_LIT226 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT226)
#define _OMC_LIT227_data "}"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT227,1,_OMC_LIT227_data);
#define _OMC_LIT227 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT227)
#define _OMC_LIT228_data "<EMPTY ITERATOR>"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT228,16,_OMC_LIT228_data);
#define _OMC_LIT228 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT228)
#define _OMC_LIT229_data "NBEquation.Iterator.toString failed for an unknown reason."
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT229,58,_OMC_LIT229_data);
#define _OMC_LIT229 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT229)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT230,2,1) {_OMC_LIT229,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT230 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT230)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT231,2,3) {&NFExpression_INTEGER__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT231 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT231)
#define _OMC_LIT232_data "NBEquation.Iterator.applyOrder.applySingleOrder failed for unhandled range expression: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT232,87,_OMC_LIT232_data);
#define _OMC_LIT232 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT232)
#define _OMC_LIT233_data "NBEquation.Iterator.adaptArray failed because array range is non literal: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT233,74,_OMC_LIT233_data);
#define _OMC_LIT233 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT233)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT234,2,3) {&NFExpression_INTEGER__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT234 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT234)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT235,1,1) {_OMC_LIT234}};
#define _OMC_LIT235 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT235)
#define _OMC_LIT236_data "NBEquation.Iterator.adaptArray failed for operator: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT236,52,_OMC_LIT236_data);
#define _OMC_LIT236 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT236)
#define _OMC_LIT237_data "NBEquation.Iterator.adaptRange failed because range could not be evaluated: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT237,76,_OMC_LIT237_data);
#define _OMC_LIT237 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT237)
#define _OMC_LIT238_data "NBEquation.Iterator.adaptRange failed for operator: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT238,52,_OMC_LIT238_data);
#define _OMC_LIT238 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT238)
#define _OMC_LIT239_data "$TMP"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT239,4,_OMC_LIT239_data);
#define _OMC_LIT239 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT239)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT240,1,5) {&NFFlatten_FunctionTreeImpl_Tree_EMPTY__desc,}};
#define _OMC_LIT240 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT240)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT241_6,1.758197185e9);
#define _OMC_LIT241_6 MMC_REFREALLIT(_OMC_LIT_STRUCT241_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT241,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(769)),MMC_IMMEDIATE(MMC_TAGFIXNUM(15)),MMC_IMMEDIATE(MMC_TAGFIXNUM(769)),MMC_IMMEDIATE(MMC_TAGFIXNUM(74)),_OMC_LIT241_6}};
#define _OMC_LIT241 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT241)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT242_6,1.758197185e9);
#define _OMC_LIT242_6 MMC_REFREALLIT(_OMC_LIT_STRUCT242_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT242,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(772)),MMC_IMMEDIATE(MMC_TAGFIXNUM(43)),MMC_IMMEDIATE(MMC_TAGFIXNUM(775)),MMC_IMMEDIATE(MMC_TAGFIXNUM(19)),_OMC_LIT242_6}};
#define _OMC_LIT242 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT242)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT243_6,1.758197185e9);
#define _OMC_LIT243_6 MMC_REFREALLIT(_OMC_LIT_STRUCT243_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT243,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(775)),MMC_IMMEDIATE(MMC_TAGFIXNUM(43)),MMC_IMMEDIATE(MMC_TAGFIXNUM(778)),MMC_IMMEDIATE(MMC_TAGFIXNUM(19)),_OMC_LIT243_6}};
#define _OMC_LIT243 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT243)
#define _OMC_LIT244_data "NBEquation.Iterator.simplifyRangeCondition failed to combine iterator: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT244,71,_OMC_LIT244_data);
#define _OMC_LIT244 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT244)
#define _OMC_LIT245_data " with condition "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT245,16,_OMC_LIT245_data);
#define _OMC_LIT245 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT245)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT246_6,1.758197185e9);
#define _OMC_LIT246_6 MMC_REFREALLIT(_OMC_LIT_STRUCT246_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT246,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(793)),MMC_IMMEDIATE(MMC_TAGFIXNUM(13)),MMC_IMMEDIATE(MMC_TAGFIXNUM(793)),MMC_IMMEDIATE(MMC_TAGFIXNUM(175)),_OMC_LIT246_6}};
#define _OMC_LIT246 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT246)
#define _OMC_LIT247_data "NBEquation.Iterator.normalizedSubscript"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT247,39,_OMC_LIT247_data);
#define _OMC_LIT247 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT247)
#define _OMC_LIT248_data "integer"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT248,7,_OMC_LIT248_data);
#define _OMC_LIT248 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT248)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT249,2,4) {&Absyn_Path_IDENT__desc,_OMC_LIT248}};
#define _OMC_LIT249 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT249)
#define _OMC_LIT250_data "r"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT250,1,_OMC_LIT250_data);
#define _OMC_LIT250 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT250)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT251,9,4) {&NFComponent_COMPONENT__desc,_OMC_LIT186,_OMC_LIT147,_OMC_LIT191,_OMC_LIT191,_OMC_LIT193,_OMC_LIT194,MMC_IMMEDIATE(MMC_TAGFIXNUM(4)),_OMC_LIT180}};
#define _OMC_LIT251 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT251)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT252,1,1) {_OMC_LIT251}};
#define _OMC_LIT252 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT252)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT253,1,9) {&NFInstNode_InstNodeType_NORMAL__COMP__desc,}};
#define _OMC_LIT253 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT253)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT254,7,4) {&NFInstNode_InstNode_COMPONENT__NODE__desc,_OMC_LIT250,MMC_REFSTRUCTLIT(mmc_none),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT252,_OMC_LIT186,_OMC_LIT253}};
#define _OMC_LIT254 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT254)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT255,2,1) {_OMC_LIT254,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT255 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT255)
#define _OMC_LIT256_data "i"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT256,1,_OMC_LIT256_data);
#define _OMC_LIT256 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT256)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT257,9,4) {&NFComponent_COMPONENT__desc,_OMC_LIT186,_OMC_LIT96,_OMC_LIT191,_OMC_LIT191,_OMC_LIT193,_OMC_LIT194,MMC_IMMEDIATE(MMC_TAGFIXNUM(4)),_OMC_LIT180}};
#define _OMC_LIT257 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT257)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT258,1,1) {_OMC_LIT257}};
#define _OMC_LIT258 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT258)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT259,7,4) {&NFInstNode_InstNode_COMPONENT__NODE__desc,_OMC_LIT256,MMC_REFSTRUCTLIT(mmc_none),MMC_IMMEDIATE(MMC_TAGFIXNUM(1)),_OMC_LIT258,_OMC_LIT186,_OMC_LIT253}};
#define _OMC_LIT259 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT259)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT260,2,1) {_OMC_LIT259,MMC_REFSTRUCTLIT(mmc_nil)}};
#define _OMC_LIT260 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT260)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT261,1,7) {&DAE_InlineType_NO__INLINE__desc,}};
#define _OMC_LIT261 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT261)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT262,3,4) {&DAE_FunctionBuiltin_FUNCTION__BUILTIN__desc,MMC_REFSTRUCTLIT(mmc_none),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */))}};
#define _OMC_LIT262 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT262)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT263,1,3) {&DAE_FunctionParallelism_FP__NON__PARALLEL__desc,}};
#define _OMC_LIT263 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT263)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT264,7,3) {&DAE_FunctionAttributes_FUNCTION__ATTRIBUTES__desc,_OMC_LIT261,MMC_IMMEDIATE(MMC_TAGFIXNUM(1 /* true */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT262,_OMC_LIT263}};
#define _OMC_LIT264 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT264)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT265,1,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(1))}};
#define _OMC_LIT265 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT265)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT266,1,1) {MMC_IMMEDIATE(MMC_TAGFIXNUM(0))}};
#define _OMC_LIT266 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT266)
#define _OMC_LIT267_data "NBEquation.Iterator.normalizedSubscript failed because range is no range: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT267,74,_OMC_LIT267_data);
#define _OMC_LIT267 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT267)
static const MMC_DEFREALLIT(_OMC_LIT_STRUCT268_6,1.758197185e9);
#define _OMC_LIT268_6 MMC_REFREALLIT(_OMC_LIT_STRUCT268_6)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT268,8,3) {&SourceInfo_SOURCEINFO__desc,_OMC_LIT92,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),MMC_IMMEDIATE(MMC_TAGFIXNUM(616)),MMC_IMMEDIATE(MMC_TAGFIXNUM(7)),MMC_IMMEDIATE(MMC_TAGFIXNUM(616)),MMC_IMMEDIATE(MMC_TAGFIXNUM(72)),_OMC_LIT268_6}};
#define _OMC_LIT268 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT268)
#define _OMC_LIT269_data "NBEquation.Iterator.createReplacement could not create replacements for replacor: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT269,82,_OMC_LIT269_data);
#define _OMC_LIT269 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT269)
#define _OMC_LIT270_data " and replacee: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT270,15,_OMC_LIT270_data);
#define _OMC_LIT270 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT270)
#define _OMC_LIT271_data "NBEquation.Iterator.createLocationReplacements could not create replacements for location: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT271,91,_OMC_LIT271_data);
#define _OMC_LIT271 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT271)
#define _OMC_LIT272_data " and iterator: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT272,15,_OMC_LIT272_data);
#define _OMC_LIT272 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT272)
#define _OMC_LIT273_data "NBEquation.Iterator.sizes could not get sizes for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT273,51,_OMC_LIT273_data);
#define _OMC_LIT273 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT273)
#define _OMC_LIT274_data "NBEquation.Iterator.types could not get types for: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT274,51,_OMC_LIT274_data);
#define _OMC_LIT274 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT274)
#define _OMC_LIT275_data "1"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT275,1,_OMC_LIT275_data);
#define _OMC_LIT275 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT275)
#include "util/modelica.h"

#include "NBEquation_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_EquationPointers_createSortHashTpl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_integer _mod, modelica_metatype _hash_lst_ptr);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_EquationPointers_createSortHashTpl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_metatype _mod, modelica_metatype _hash_lst_ptr);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_EquationPointers_createSortHashTpl,2,0) {(void*) boxptr_NBEquation_EquationPointers_createSortHashTpl,0}};
#define boxvar_NBEquation_EquationPointers_createSortHashTpl MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_EquationPointers_createSortHashTpl)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_combineConditions(threadData_t *threadData, modelica_metatype _acc_condition, modelica_metatype __omcQ_24in_5Fcondition, modelica_boolean _invert);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_WhenEquationBody_combineConditions(threadData_t *threadData, modelica_metatype _acc_condition, modelica_metatype __omcQ_24in_5Fcondition, modelica_metatype _invert);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_combineConditions,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_combineConditions,0}};
#define boxvar_NBEquation_WhenEquationBody_combineConditions MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_combineConditions)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getFirstReinit(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _stmts);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getFirstReinit,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_getFirstReinit,0}};
#define boxvar_NBEquation_WhenEquationBody_getFirstReinit MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getFirstReinit)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getAssignments(threadData_t *threadData, modelica_metatype _crefSet, modelica_metatype _stmts);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getAssignments,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_getAssignments,0}};
#define boxvar_NBEquation_WhenEquationBody_getAssignments MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getAssignments)
PROTECTED_FUNCTION_STATIC void omc_NBEquation_WhenEquationBody_addCrefsMap(threadData_t *threadData, modelica_metatype _discr_map, modelica_metatype _crefs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_addCrefsMap,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_addCrefsMap,0}};
#define boxvar_NBEquation_WhenEquationBody_addCrefsMap MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_addCrefsMap)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_collectForSplit(threadData_t *threadData, modelica_metatype _body_opt, modelica_metatype _discr_map, modelica_metatype _state_set);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_collectForSplit,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_collectForSplit,0}};
#define boxvar_NBEquation_WhenEquationBody_collectForSplit MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_collectForSplit)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getBodyAttributes_getConditions(threadData_t *threadData, modelica_metatype _cond);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getBodyAttributes_getConditions,2,0) {(void*) boxptr_NBEquation_WhenEquationBody_getBodyAttributes_getConditions,0}};
#define boxvar_NBEquation_WhenEquationBody_getBodyAttributes_getConditions MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_WhenEquationBody_getBodyAttributes_getConditions)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_splitCollect(threadData_t *threadData, modelica_metatype _body, modelica_metatype __omcQ_24in_5Fconditions, modelica_metatype __omcQ_24in_5Fthen_5Feqns, modelica_metatype *out_then_eqns);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_splitCollect,2,0) {(void*) boxptr_NBEquation_IfEquationBody_splitCollect,0}};
#define boxvar_NBEquation_IfEquationBody_splitCollect MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_splitCollect)
PROTECTED_FUNCTION_STATIC modelica_boolean omc_NBEquation_IfEquationBody_sortForSplit_compareLHS(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_IfEquationBody_sortForSplit_compareLHS(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_sortForSplit_compareLHS,2,0) {(void*) boxptr_NBEquation_IfEquationBody_sortForSplit_compareLHS,0}};
#define boxvar_NBEquation_IfEquationBody_sortForSplit_compareLHS MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_sortForSplit_compareLHS)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_sortForSplit(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fbody);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_sortForSplit,2,0) {(void*) boxptr_NBEquation_IfEquationBody_sortForSplit,0}};
#define boxvar_NBEquation_IfEquationBody_sortForSplit MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_sortForSplit)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_makeIfEquationEqn(threadData_t *threadData, modelica_metatype _body, modelica_metatype _iter, modelica_metatype _source, modelica_metatype _attr);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_makeIfEquationEqn,2,0) {(void*) boxptr_NBEquation_IfEquationBody_makeIfEquationEqn,0}};
#define boxvar_NBEquation_IfEquationBody_makeIfEquationEqn MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_IfEquationBody_makeIfEquationEqn)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Equation_makeInequality(threadData_t *threadData, modelica_metatype _tpl);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_Equation_makeInequality,2,0) {(void*) boxptr_NBEquation_Equation_makeInequality,0}};
#define boxvar_NBEquation_Equation_makeInequality MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_Equation_makeInequality)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Equation_simplify_apply(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fe, modelica_fnptr _func);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_Equation_simplify_apply,2,0) {(void*) boxptr_NBEquation_Equation_simplify_apply,0}};
#define boxvar_NBEquation_Equation_simplify_apply MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_Equation_simplify_apply)
PROTECTED_FUNCTION_STATIC modelica_string omc_NBEquation_Iterator_toString_singleStr(threadData_t *threadData, modelica_metatype _name, modelica_metatype _range, modelica_metatype _map);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_toString_singleStr,2,0) {(void*) boxptr_NBEquation_Iterator_toString_singleStr,0}};
#define boxvar_NBEquation_Iterator_toString_singleStr MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_toString_singleStr)
PROTECTED_FUNCTION_STATIC modelica_integer omc_NBEquation_Iterator_interceptRange_lowerBoundary(threadData_t *threadData, modelica_integer _thresh, modelica_integer _start, modelica_integer _step);
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_Iterator_interceptRange_lowerBoundary(threadData_t *threadData, modelica_metatype _thresh, modelica_metatype _start, modelica_metatype _step);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_interceptRange_lowerBoundary,2,0) {(void*) boxptr_NBEquation_Iterator_interceptRange_lowerBoundary,0}};
#define boxvar_NBEquation_Iterator_interceptRange_lowerBoundary MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_interceptRange_lowerBoundary)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Iterator_dummy_dummyRange(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp);
static const MMC_DEFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_dummy_dummyRange,2,0) {(void*) boxptr_NBEquation_Iterator_dummy_dummyRange,0}};
#define boxvar_NBEquation_Iterator_dummy_dummyRange MMC_REFSTRUCTLIT(boxvar_lit_NBEquation_Iterator_dummy_dummyRange)

DLLDirection
modelica_metatype omc_NBEquation_typeList(threadData_t *threadData, modelica_metatype _equations, modelica_metatype *out_continuous_lst, modelica_metatype *out_clocked_lst, modelica_metatype *out_discretes_lst, modelica_metatype *out_initials_lst, modelica_metatype *out_auxiliaries_lst, modelica_metatype *out_removed_lst)
{
  modelica_metatype _simulation_lst = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _continuous_lst = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _clocked_lst = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype _discretes_lst = NULL;
  modelica_metatype tmpMeta4;
  modelica_metatype _initials_lst = NULL;
  modelica_metatype tmpMeta5;
  modelica_metatype _auxiliaries_lst = NULL;
  modelica_metatype tmpMeta6;
  modelica_metatype _removed_lst = NULL;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta32;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _simulation_lst = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _continuous_lst = tmpMeta2;
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _clocked_lst = tmpMeta3;
  tmpMeta4 = MMC_REFSTRUCTLIT(mmc_nil);
  _discretes_lst = tmpMeta4;
  tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
  _initials_lst = tmpMeta5;
  tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
  _auxiliaries_lst = tmpMeta6;
  tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
  _removed_lst = tmpMeta7;
  {
    modelica_metatype _eq;
    for (tmpMeta8 = _equations; !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
    {
      _eq = MMC_CAR(tmpMeta8);
      { /* match expression */
        modelica_metatype tmp11_1;
        tmp11_1 = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eq));
        {
          volatile mmc_switch_type tmp11;
          int tmp12;
          tmp11 = 0;
          for (; tmp11 < 6; tmp11++) {
            switch (MMC_SWITCH_CAST(tmp11)) {
            case 0: {
              modelica_metatype tmpMeta13;
              modelica_integer tmp14;
              modelica_metatype tmpMeta15;
              if (mmc__uniontype__metarecord__typedef__equal(tmp11_1,0,7) == 0) goto tmp10_end;
              tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp11_1), 6));
              tmp14 = mmc_unbox_integer(tmpMeta13);
              if (1 /* true */ != tmp14) goto tmp10_end;
              
              /* Pattern matching succeeded */
              tmpMeta15 = mmc_mk_cons(_eq, _initials_lst);
              _initials_lst = tmpMeta15;
              goto tmp10_done;
            }
            case 1: {
              modelica_metatype tmpMeta16;
              modelica_integer tmp17;
              modelica_metatype tmpMeta18;
              modelica_metatype tmpMeta19;
              if (mmc__uniontype__metarecord__typedef__equal(tmp11_1,0,7) == 0) goto tmp10_end;
              tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp11_1), 8));
              tmp17 = mmc_unbox_integer(tmpMeta16);
              if (1 != tmp17) goto tmp10_end;
              /* Pattern matching succeeded */
              tmpMeta18 = mmc_mk_cons(_eq, _continuous_lst);
              _continuous_lst = tmpMeta18;

              tmpMeta19 = mmc_mk_cons(_eq, _simulation_lst);
              _simulation_lst = tmpMeta19;
              goto tmp10_done;
            }
            case 2: {
              modelica_metatype tmpMeta20;
              modelica_integer tmp21;
              modelica_metatype tmpMeta22;
              if (mmc__uniontype__metarecord__typedef__equal(tmp11_1,0,7) == 0) goto tmp10_end;
              tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp11_1), 8));
              tmp21 = mmc_unbox_integer(tmpMeta20);
              if (3 != tmp21) goto tmp10_end;
              /* Pattern matching succeeded */
              tmpMeta22 = mmc_mk_cons(_eq, _clocked_lst);
              _clocked_lst = tmpMeta22;
              goto tmp10_done;
            }
            case 3: {
              modelica_metatype tmpMeta23;
              modelica_integer tmp24;
              modelica_metatype tmpMeta25;
              modelica_metatype tmpMeta26;
              if (mmc__uniontype__metarecord__typedef__equal(tmp11_1,0,7) == 0) goto tmp10_end;
              tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp11_1), 8));
              tmp24 = mmc_unbox_integer(tmpMeta23);
              if (2 != tmp24) goto tmp10_end;
              /* Pattern matching succeeded */
              tmpMeta25 = mmc_mk_cons(_eq, _discretes_lst);
              _discretes_lst = tmpMeta25;

              tmpMeta26 = mmc_mk_cons(_eq, _simulation_lst);
              _simulation_lst = tmpMeta26;
              goto tmp10_done;
            }
            case 4: {
              modelica_metatype tmpMeta27;
              modelica_integer tmp28;
              modelica_metatype tmpMeta29;
              if (mmc__uniontype__metarecord__typedef__equal(tmp11_1,0,7) == 0) goto tmp10_end;
              tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp11_1), 8));
              tmp28 = mmc_unbox_integer(tmpMeta27);
              if (4 != tmp28) goto tmp10_end;
              /* Pattern matching succeeded */
              tmpMeta29 = mmc_mk_cons(_eq, _removed_lst);
              _removed_lst = tmpMeta29;
              goto tmp10_done;
            }
            case 5: {
              modelica_metatype tmpMeta30;
              modelica_metatype tmpMeta31;
              
              /* Pattern matching succeeded */
              tmpMeta31 = stringAppend(_OMC_LIT5,omc_NBEquation_Equation_toString(threadData, omc_Pointer_access(threadData, _eq), _OMC_LIT6));
              tmpMeta30 = mmc_mk_cons(tmpMeta31, MMC_REFSTRUCTLIT(mmc_nil));
              omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta30);
              goto goto_9;
              goto tmp10_done;
            }
            }
            goto tmp10_end;
            tmp10_end: ;
          }
          goto goto_9;
          goto_9:;
          MMC_THROW_INTERNAL();
          goto tmp10_done;
          tmp10_done:;
        }
      }
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_continuous_lst) { *out_continuous_lst = _continuous_lst; }
  if (out_clocked_lst) { *out_clocked_lst = _clocked_lst; }
  if (out_discretes_lst) { *out_discretes_lst = _discretes_lst; }
  if (out_initials_lst) { *out_initials_lst = _initials_lst; }
  if (out_auxiliaries_lst) { *out_auxiliaries_lst = _auxiliaries_lst; }
  if (out_removed_lst) { *out_removed_lst = _removed_lst; }
  return _simulation_lst;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_compress(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta5;

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta6;

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[5] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[7] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[8] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))));
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[9] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))));
          _eqData = tmpMeta10;

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[10] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))));
          _eqData = tmpMeta11;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[3] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta12;

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[4] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta13;

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[5] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[6] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta15;

          tmpMeta16 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta16), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta16))[7] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta16;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          
          /* Pattern matching succeeded */
          tmpMeta17 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta17), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta17))[3] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta17;

          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[5] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta18;

          tmpMeta19 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta19), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta19))[6] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta19;

          tmpMeta20 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta20), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta20))[7] = omc_NBEquation_EquationPointers_compress(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta20;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT8);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_removeList(threadData_t *threadData, modelica_metatype _eq_lst, modelica_metatype __omcQ_24in_5FeqData)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta5;

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta6;

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[5] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[7] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[8] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))));
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[9] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))));
          _eqData = tmpMeta10;

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[10] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))));
          _eqData = tmpMeta11;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[3] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta12;

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[4] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta13;

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[5] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[6] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta15;

          tmpMeta16 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta16), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta16))[7] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta16;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          
          /* Pattern matching succeeded */
          tmpMeta17 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta17), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta17))[3] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta17;

          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[5] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta18;

          tmpMeta19 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta19), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta19))[6] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta19;

          tmpMeta20 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta20), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta20))[7] = omc_NBEquation_EquationPointers_removeList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta20;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT10);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_addUntypedList(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_metatype _eq_lst, modelica_boolean _newName)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype _equation_lst = NULL;
  modelica_metatype _continuous_lst = NULL;
  modelica_metatype _clocked_lst = NULL;
  modelica_metatype _discretes_lst = NULL;
  modelica_metatype _initials_lst = NULL;
  modelica_metatype _auxiliaries_lst = NULL;
  modelica_metatype _simulation_lst = NULL;
  modelica_metatype _removed_lst = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  // _equation_lst has no default value.
  // _continuous_lst has no default value.
  // _clocked_lst has no default value.
  // _discretes_lst has no default value.
  // _initials_lst has no default value.
  // _auxiliaries_lst has no default value.
  // _simulation_lst has no default value.
  // _removed_lst has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,9) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if(_newName)
          {
            {
              modelica_metatype _eqn_ptr;
              for (tmpMeta6 = _eq_lst; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
              {
                _eqn_ptr = MMC_CAR(tmpMeta6);
                omc_NBEquation_Equation_createName(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2))), _OMC_LIT11);
              }
            }
          }

          _simulation_lst = omc_NBEquation_typeList(threadData, _eq_lst ,&_continuous_lst ,&_clocked_lst ,&_discretes_lst ,&_initials_lst ,&_auxiliaries_lst ,&_removed_lst);

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = omc_NBEquation_EquationPointers_addList(threadData, _simulation_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[5] = omc_NBEquation_EquationPointers_addList(threadData, _continuous_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta10;

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[6] = omc_NBEquation_EquationPointers_addList(threadData, _clocked_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta11;

          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[7] = omc_NBEquation_EquationPointers_addList(threadData, _discretes_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta12;

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[8] = omc_NBEquation_EquationPointers_addList(threadData, _initials_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))));
          _eqData = tmpMeta13;

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[9] = omc_NBEquation_EquationPointers_addList(threadData, _auxiliaries_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))));
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[10] = omc_NBEquation_EquationPointers_addList(threadData, _removed_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))));
          _eqData = tmpMeta15;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT13);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}
modelica_metatype boxptr_NBEquation_EqData_addUntypedList(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_metatype _eq_lst, modelica_metatype _newName)
{
  modelica_integer tmp1;
  modelica_metatype _eqData = NULL;
  tmp1 = mmc_unbox_integer(_newName);
  _eqData = omc_NBEquation_EqData_addUntypedList(threadData, __omcQ_24in_5FeqData, _eq_lst, tmp1);
  /* skip box _eqData; NBEquation.EqData */
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_addTypedList(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_metatype _eq_lst, modelica_integer _eqType, modelica_boolean _newName)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;modelica_integer tmp4_2;
    tmp4_1 = _eqData;
    tmp4_2 = (modelica_integer)_eqType;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,9) == 0) goto tmp3_end;
          if (1 != tmp4_2) goto tmp3_end;
          /* Pattern matching succeeded */
          if(_newName)
          {
            {
              modelica_metatype _eqn_ptr;
              for (tmpMeta6 = _eq_lst; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
              {
                _eqn_ptr = MMC_CAR(tmpMeta6);
                omc_NBEquation_Equation_createName(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2))), _OMC_LIT11);
              }
            }
          }

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[5] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))));
          _eqData = tmpMeta10;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,9) == 0) goto tmp3_end;
          if (2 != tmp4_2) goto tmp3_end;
          /* Pattern matching succeeded */
          if(_newName)
          {
            {
              modelica_metatype _eqn_ptr;
              for (tmpMeta11 = _eq_lst; !listEmpty(tmpMeta11); tmpMeta11=MMC_CDR(tmpMeta11))
              {
                _eqn_ptr = MMC_CAR(tmpMeta11);
                omc_NBEquation_Equation_createName(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2))), _OMC_LIT11);
              }
            }
          }

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[3] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta13;

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[4] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[7] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))));
          _eqData = tmpMeta15;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,9) == 0) goto tmp3_end;
          if (3 != tmp4_2) goto tmp3_end;
          /* Pattern matching succeeded */
          if(_newName)
          {
            {
              modelica_metatype _eqn_ptr;
              for (tmpMeta16 = _eq_lst; !listEmpty(tmpMeta16); tmpMeta16=MMC_CDR(tmpMeta16))
              {
                _eqn_ptr = MMC_CAR(tmpMeta16);
                omc_NBEquation_Equation_createName(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2))), _OMC_LIT11);
              }
            }
          }

          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[6] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))));
          _eqData = tmpMeta18;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,9) == 0) goto tmp3_end;
          if (4 != tmp4_2) goto tmp3_end;
          /* Pattern matching succeeded */
          if(_newName)
          {
            {
              modelica_metatype _eqn_ptr;
              for (tmpMeta19 = _eq_lst; !listEmpty(tmpMeta19); tmpMeta19=MMC_CDR(tmpMeta19))
              {
                _eqn_ptr = MMC_CAR(tmpMeta19);
                omc_NBEquation_Equation_createName(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2))), _OMC_LIT11);
              }
            }
          }

          tmpMeta21 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta21), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta21))[3] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          _eqData = tmpMeta21;

          tmpMeta22 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta22), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta22))[8] = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))));
          _eqData = tmpMeta22;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT15);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}
modelica_metatype boxptr_NBEquation_EqData_addTypedList(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_metatype _eq_lst, modelica_metatype _eqType, modelica_metatype _newName)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _eqData = NULL;
  tmp1 = mmc_unbox_integer(_eqType);
  tmp2 = mmc_unbox_integer(_newName);
  _eqData = omc_NBEquation_EqData_addTypedList(threadData, __omcQ_24in_5FeqData, _eq_lst, tmp1, tmp2);
  /* skip box _eqData; NBEquation.EqData */
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_setEquations(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_metatype _equations)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = _equations;
          _eqData = tmpMeta5;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = _equations;
          _eqData = tmpMeta6;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[3] = _equations;
          _eqData = tmpMeta7;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_getEquations(threadData_t *threadData, modelica_metatype _eqData)
{
  modelica_metatype _equations = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _equations has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3)));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3)));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3)));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT17);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _equations = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_getUniqueIndex(threadData_t *threadData, modelica_metatype _eqData)
{
  modelica_metatype _uniqueIndex = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _uniqueIndex has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2)));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2)));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 2)));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT19);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _uniqueIndex = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _uniqueIndex;
}

DLLDirection
modelica_string omc_NBEquation_EqData_toString(threadData_t *threadData, modelica_metatype _eqData, modelica_integer _level, modelica_metatype _filter_opt)
{
  modelica_string _str = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      modelica_string _tmp = NULL;
      int tmp4;
      // _tmp has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          tmpMeta5 = stringAppend(_OMC_LIT20,intString(omc_NBEquation_EquationPointers_scalarSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), 1 /* true */)));
          tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT21);
          _tmp = tmpMeta6;

          tmpMeta7 = stringAppend(omc_StringUtil_headline__2(threadData, _tmp),_OMC_LIT22);
          _tmp = tmpMeta7;

          if((_level == ((modelica_integer) 0)))
          {
            tmpMeta8 = stringAppend(_tmp,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))), _OMC_LIT29, mmc_mk_none(), 0 /* false */, _filter_opt));
            _tmp = tmpMeta8;
          }
          else
          {
            tmpMeta9 = stringAppend(_tmp,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), _OMC_LIT23, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta10 = stringAppend(tmpMeta9,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), _OMC_LIT24, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta11 = stringAppend(tmpMeta10,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))), _OMC_LIT25, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta12 = stringAppend(tmpMeta11,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))), _OMC_LIT26, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta13 = stringAppend(tmpMeta12,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))), _OMC_LIT27, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta14 = stringAppend(tmpMeta13,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))), _OMC_LIT28, mmc_mk_none(), 0 /* false */, _filter_opt));
            _tmp = tmpMeta14;
          }
          tmp1 = _tmp;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          
          /* Pattern matching succeeded */
          if((_level == ((modelica_integer) 0)))
          {
            _tmp = omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))), _OMC_LIT32, mmc_mk_none(), 0 /* false */, _filter_opt);
          }
          else
          {
            tmpMeta15 = stringAppend(omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), _OMC_LIT30, mmc_mk_none(), 0 /* false */, _filter_opt),omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), _OMC_LIT31, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta16 = stringAppend(tmpMeta15,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), _OMC_LIT27, mmc_mk_none(), 0 /* false */, _filter_opt));
            _tmp = tmpMeta16;
          }
          tmp1 = _tmp;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          
          /* Pattern matching succeeded */
          if((_level == ((modelica_integer) 0)))
          {
            _tmp = omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))), _OMC_LIT35, mmc_mk_none(), 0 /* false */, _filter_opt);
          }
          else
          {
            tmpMeta17 = stringAppend(omc_StringUtil_headline__4(threadData, _OMC_LIT33),_OMC_LIT22);
            tmpMeta18 = stringAppend(tmpMeta17,omc_NBEquation_Equation_toString(threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4)))), _OMC_LIT6));
            tmpMeta19 = stringAppend(tmpMeta18,_OMC_LIT22);
            tmpMeta20 = stringAppend(tmpMeta19,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), _OMC_LIT34, mmc_mk_none(), 0 /* false */, _filter_opt));
            tmpMeta21 = stringAppend(tmpMeta20,omc_NBEquation_EquationPointers_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), _OMC_LIT27, mmc_mk_none(), 0 /* false */, _filter_opt));
            _tmp = tmpMeta21;
          }
          tmp1 = _tmp;
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT36;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT37;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _str = tmp1;
  _return: OMC_LABEL_UNUSED
  return _str;
}
modelica_metatype boxptr_NBEquation_EqData_toString(threadData_t *threadData, modelica_metatype _eqData, modelica_metatype _level, modelica_metatype _filter_opt)
{
  modelica_integer tmp1;
  modelica_string _str = NULL;
  tmp1 = mmc_unbox_integer(_level);
  _str = omc_NBEquation_EqData_toString(threadData, _eqData, tmp1, _filter_opt);
  /* skip box _str; String */
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_mapExp(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_fnptr _func)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[4] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta5;

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[5] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta6;

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[7] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[8] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[9] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta10;

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[10] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 10))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta11;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[4] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta12;

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[5] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta13;

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[6] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[7] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta15;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          
          /* Pattern matching succeeded */
          omc_Pointer_update(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), omc_NBEquation_Equation_map(threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4)))), ((modelica_fnptr) _func), mmc_mk_none(), boxvar_NFExpression_map));

          tmpMeta16 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta16), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta16))[5] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta16;

          tmpMeta17 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta17), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta17))[6] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta17;

          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[7] = omc_NBEquation_EquationPointers_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))), ((modelica_fnptr) _func), mmc_mk_none());
          _eqData = tmpMeta18;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}

DLLDirection
modelica_metatype omc_NBEquation_EqData_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5FeqData, modelica_fnptr _func)
{
  modelica_metatype _eqData = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqData = __omcQ_24in_5FeqData;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[4] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), ((modelica_fnptr) _func));
          _eqData = tmpMeta5;

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[5] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func));
          _eqData = tmpMeta6;

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func));
          _eqData = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[7] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 7))), ((modelica_fnptr) _func));
          _eqData = tmpMeta8;

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[8] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 8))), ((modelica_fnptr) _func));
          _eqData = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(11));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqData), 11*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[9] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 9))), ((modelica_fnptr) _func));
          _eqData = tmpMeta10;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[4] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), ((modelica_fnptr) _func));
          _eqData = tmpMeta11;

          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[5] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func));
          _eqData = tmpMeta12;

          tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[6] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func));
          _eqData = tmpMeta13;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          omc_Pointer_update(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))))));

          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[5] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 5))), ((modelica_fnptr) _func));
          _eqData = tmpMeta14;

          tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eqData), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[6] = omc_NBEquation_EquationPointers_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 6))), ((modelica_fnptr) _func));
          _eqData = tmpMeta15;
          tmpMeta1 = _eqData;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqData = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqData;
}

DLLDirection
modelica_integer omc_NBEquation_EqData_scalarSize(threadData_t *threadData, modelica_metatype _eqData, modelica_boolean _resize)
{
  modelica_integer _s;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _s has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_scalarSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))), _resize);
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_scalarSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))), _resize);
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_scalarSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))), _resize);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NBEquation_EqData_scalarSize(threadData_t *threadData, modelica_metatype _eqData, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _s;
  modelica_metatype out_s;
  tmp1 = mmc_unbox_integer(_resize);
  _s = omc_NBEquation_EqData_scalarSize(threadData, _eqData, tmp1);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

DLLDirection
modelica_integer omc_NBEquation_EqData_size(threadData_t *threadData, modelica_metatype _eqData)
{
  modelica_integer _s;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _s has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqData;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 4))));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_EquationPointers_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqData), 3))));
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NBEquation_EqData_size(threadData_t *threadData, modelica_metatype _eqData)
{
  modelica_integer _s;
  modelica_metatype out_s;
  _s = omc_NBEquation_EqData_size(threadData, _eqData);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_EquationPointers_createSortHashTpl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_integer _mod, modelica_metatype _hash_lst_ptr)
{
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _eqn = NULL;
  modelica_integer _hash;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn_ptr = __omcQ_24in_5Feqn_5Fptr;
  // _eqn has no default value.
  // _hash has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);

  _hash = omc_NBBackendUtil_noNameHashEq(threadData, _eqn, _mod);

  tmpMeta2 = mmc_mk_box2(0, mmc_mk_integer(_hash), _eqn_ptr);
  tmpMeta1 = mmc_mk_cons(tmpMeta2, omc_Pointer_access(threadData, _hash_lst_ptr));
  omc_Pointer_update(threadData, _hash_lst_ptr, tmpMeta1);
  _return: OMC_LABEL_UNUSED
  return _eqn_ptr;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_EquationPointers_createSortHashTpl(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_metatype _mod, modelica_metatype _hash_lst_ptr)
{
  modelica_integer tmp1;
  modelica_metatype _eqn_ptr = NULL;
  tmp1 = mmc_unbox_integer(_mod);
  _eqn_ptr = omc_NBEquation_EquationPointers_createSortHashTpl(threadData, __omcQ_24in_5Feqn_5Fptr, tmp1, _hash_lst_ptr);
  /* skip box _eqn_ptr; Pointer<NBEquation.Equation> */
  return _eqn_ptr;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_getResiduals(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_metatype _residuals = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _residuals has no default value.
  {
    modelica_metatype __omcQ_24tmpVar5;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar4;
    modelica_integer tmp4;
    modelica_metatype _eqn_loopVar = 0;
    modelica_metatype _eqn;
    _eqn_loopVar = omc_NBEquation_EquationPointers_toList(threadData, _equations);
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar5 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar5;
    while(1) {
      tmp4 = 1;
      if (!listEmpty(_eqn_loopVar)) {
        _eqn = MMC_CAR(_eqn_loopVar);
        _eqn_loopVar = MMC_CDR(_eqn_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar4 = omc_NBEquation_Equation_getResidualVar(threadData, _eqn);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar4,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar5;
  }
  _residuals = omc_NBVariable_VariablePointers_fromList(threadData, tmpMeta1, 0 /* false */);
  _return: OMC_LABEL_UNUSED
  return _residuals;
}

static modelica_metatype closure0_NBEquation_EquationPointers_createSortHashTpl(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_eqn_ptr)
{
  modelica_metatype mod = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype hash_lst_ptr = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  return boxptr_NBEquation_EquationPointers_createSortHashTpl(thData, $in_eqn_ptr, mod, hash_lst_ptr);
}
DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_sort(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  modelica_integer _size;
  modelica_metatype _hash_lst = NULL;
  modelica_metatype _hash_lst_ptr = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype tmpMeta2;
  modelica_real tmp3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _size has no default value.
  // _hash_lst has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _hash_lst_ptr = omc_Pointer_create(threadData, tmpMeta1);
  // _eqn_ptr has no default value.
  _size = omc_ExpandableArray_getNumberOfElements(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

  tmp3 = ((modelica_real)_size);
  if(!(tmp3 > 0.0))
  {
    FILE_INFO info = {"",0,0,0,0,0};
    omc_assert(threadData, info, "Model error: Argument of log(/*Real*/(size)) was %g should be > 0", tmp3);
  }tmpMeta2 = mmc_mk_box2(0, mmc_mk_integer(((modelica_integer)floor((((modelica_real)_size)) * (log(tmp3))))), _hash_lst_ptr);
  omc_NBEquation_EquationPointers_mapPtr(threadData, _equations, (modelica_fnptr) mmc_mk_box2(0,closure0_NBEquation_EquationPointers_createSortHashTpl,tmpMeta2));

  _hash_lst = omc_List_sort(threadData, omc_Pointer_access(threadData, _hash_lst_ptr), boxvar_NBBackendUtil_indexTplGt);

  _equations = omc_NBEquation_EquationPointers_empty(threadData, _size);

  {
    modelica_metatype _tpl;
    for (tmpMeta4 = _hash_lst; !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
    {
      _tpl = MMC_CAR(tmpMeta4);
      /* Pattern-matching assignment */
      tmpMeta5 = _tpl;
      tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 2));
      _eqn_ptr = tmpMeta6;

      tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(4));
      memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_equations), 4*sizeof(modelica_metatype));
      ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[3] = omc_ExpandableArray_add(threadData, _eqn_ptr, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))), NULL);
      _equations = tmpMeta7;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_compress(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype _eqns = NULL;
  modelica_metatype tmpMeta1;
  modelica_integer tmp8;
  modelica_integer tmp9;
  modelica_integer tmp10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _eqn has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _eqns = tmpMeta1;
  tmp8 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))); tmp9 = ((modelica_integer) -1); tmp10 = ((modelica_integer) 1);
  if(!(((tmp9 > 0) && (tmp8 > tmp10)) || ((tmp9 < 0) && (tmp8 < tmp10))))
  {
    modelica_integer _i;
    for(_i = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))); in_range_integer(_i, tmp8, tmp10); _i += tmp9)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _eqn = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

        { /* match expression */
          modelica_metatype tmp4_1;
          tmp4_1 = omc_Pointer_access(threadData, _eqn);
          {
            modelica_metatype _body = NULL;
            volatile mmc_switch_type tmp4;
            int tmp5;
            // _body has no default value.
            tmp4 = 0;
            for (; tmp4 < 3; tmp4++) {
              switch (MMC_SWITCH_CAST(tmp4)) {
              case 0: {
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,0) == 0) goto tmp3_end;
                /* Pattern matching succeeded */
                goto tmp3_done;
              }
              case 1: {
                modelica_metatype tmpMeta6;
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
                tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
                
                _body = tmpMeta6;
                /* Pattern matching succeeded */
                /* Check guard condition after assignments */
                if (!omc_List_all(threadData, _body, boxvar_NBEquation_Equation_isDummy)) goto tmp3_end;
                goto tmp3_done;
              }
              case 2: {
                modelica_metatype tmpMeta7;
                
                /* Pattern matching succeeded */
                tmpMeta7 = mmc_mk_cons(_eqn, _eqns);
                _eqns = tmpMeta7;
                goto tmp3_done;
              }
              }
              goto tmp3_end;
              tmp3_end: ;
            }
            goto goto_2;
            goto_2:;
            MMC_THROW_INTERNAL();
            goto tmp3_done;
            tmp3_done:;
          }
        }
        ;
      }
    }
  }

  _equations = omc_NBEquation_EquationPointers_fromList(threadData, _eqns);
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_integer omc_NBEquation_EquationPointers_getEqnIndex(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _name)
{
  modelica_integer _index;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _index = mmc_unbox_integer(omc_UnorderedMap_getOrDefault(threadData, _name, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))), mmc_mk_integer(((modelica_integer) -1))));
  _return: OMC_LABEL_UNUSED
  return _index;
}
modelica_metatype boxptr_NBEquation_EquationPointers_getEqnIndex(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _name)
{
  modelica_integer _index;
  modelica_metatype out_index;
  _index = omc_NBEquation_EquationPointers_getEqnIndex(threadData, _equations, _name);
  out_index = mmc_mk_icon(_index);
  return out_index;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_getEqnByName(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _name)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_UnorderedMap_get(threadData, _name, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))));
    {
      modelica_integer _index;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _index has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          _index = tmp7  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_index > ((modelica_integer) 0))) goto tmp3_end;
          tmpMeta1 = omc_NBEquation_EquationPointers_getEqnAt(threadData, _equations, _index);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          /* Pattern matching succeeded */
          tmpMeta10 = stringAppend(_OMC_LIT38,omc_NFComponentRef_toString(threadData, _name));
          tmpMeta11 = stringAppend(tmpMeta10,_OMC_LIT39);
          tmpMeta9 = mmc_mk_cons(tmpMeta11, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);
          goto goto_2;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          tmpMeta13 = stringAppend(_OMC_LIT40,omc_NFComponentRef_toString(threadData, _name));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT41);
          tmpMeta12 = mmc_mk_cons(tmpMeta14, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta12);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_getEqnAt(threadData_t *threadData, modelica_metatype _equations, modelica_integer _index)
{
  modelica_metatype _eqn = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  _eqn = omc_ExpandableArray_get(threadData, _index, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  _return: OMC_LABEL_UNUSED
  return _eqn;
}
modelica_metatype boxptr_NBEquation_EquationPointers_getEqnAt(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _index)
{
  modelica_integer tmp1;
  modelica_metatype _eqn = NULL;
  tmp1 = mmc_unbox_integer(_index);
  _eqn = omc_NBEquation_EquationPointers_getEqnAt(threadData, _equations, tmp1);
  /* skip box _eqn; Pointer<NBEquation.Equation> */
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_foldRemovePtr(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations, modelica_fnptr _func, modelica_metatype __omcQ_24in_5FextArg, modelica_metatype *out_extArg)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _extArg = NULL;
  modelica_metatype _eq_ptr = NULL;
  modelica_boolean _delete;
  modelica_metatype tmpMeta1;
  modelica_integer tmp2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  _extArg = __omcQ_24in_5FextArg;
  // _eq_ptr has no default value.
  // _delete has no default value.
  tmp5 = ((modelica_integer) 1); tmp6 = 1; tmp7 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp6 > 0) && (tmp5 > tmp7)) || ((tmp6 < 0) && (tmp5 < tmp7))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp5, tmp7); _i += tmp6)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _eq_ptr = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

        /* Pattern-matching tuple assignment */
        tmpMeta3 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _eq_ptr, _extArg, &tmpMeta1) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _eq_ptr, _extArg, &tmpMeta1);
        _extArg = tmpMeta3;
        tmp2 = mmc_unbox_integer(tmpMeta1);
        _delete = tmp2  /* pattern as ty=Boolean */;

        if(_delete)
        {
          omc_Pointer_update(threadData, _eq_ptr, _OMC_LIT42);

          tmpMeta4 = MMC_TAGPTR(mmc_alloc_words(4));
          memcpy(MMC_UNTAGPTR(tmpMeta4), MMC_UNTAGPTR(_equations), 4*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta4))[3] = omc_ExpandableArray_delete(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
          _equations = tmpMeta4;
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  if (out_extArg) { *out_extArg = _extArg; }
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_foldPtr(threadData_t *threadData, modelica_metatype _equations, modelica_fnptr _func, modelica_metatype __omcQ_24in_5FextArg)
{
  modelica_metatype _extArg = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _extArg = __omcQ_24in_5FextArg;
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _extArg = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))), _extArg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))), _extArg);
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _extArg;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_fold(threadData_t *threadData, modelica_metatype _equations, modelica_fnptr _func, modelica_metatype __omcQ_24in_5FextArg)
{
  modelica_metatype _extArg = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _extArg = __omcQ_24in_5FextArg;
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _extArg = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), omc_Pointer_access(threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))))), _extArg) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, omc_Pointer_access(threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))))), _extArg);
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _extArg;
}

DLLDirection
void omc_NBEquation_EquationPointers_mapRes(threadData_t *threadData, modelica_metatype _equations, modelica_fnptr _func)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((void(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), omc_NBEquation_Equation_getResidualVar(threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))) : ((void(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, omc_NBEquation_Equation_getResidualVar(threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))))));
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_mapRemovePtr(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations, modelica_fnptr _func)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _eq_ptr = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _eq_ptr has no default value.
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _eq_ptr = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

        if(mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _eq_ptr) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _eq_ptr)))
        {
          _equations = omc_NBEquation_EquationPointers_remove(threadData, _eq_ptr, _equations);
        }
      }
    }
  }

  _equations = omc_NBEquation_EquationPointers_compress(threadData, _equations);
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_mapExp(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _eq_ptr = NULL;
  modelica_metatype _eq = NULL;
  modelica_metatype _new_eq = NULL;
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _eq_ptr has no default value.
  // _eq has no default value.
  // _new_eq has no default value.
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _eq_ptr = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

        _eq = omc_Pointer_access(threadData, _eq_ptr);

        _new_eq = omc_NBEquation_Equation_map(threadData, _eq, ((modelica_fnptr) _funcExp), _funcCrefOpt, boxvar_NFExpression_map);

        if((!referenceEq(_eq, _new_eq)))
        {
          omc_Pointer_update(threadData, _eq_ptr, _new_eq);
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
void omc_NBEquation_EquationPointers_mapPtr(threadData_t *threadData, modelica_metatype _equations, modelica_fnptr _func)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmp1 = ((modelica_integer) 1); tmp2 = 1; tmp3 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp2 > 0) && (tmp1 > tmp3)) || ((tmp2 < 0) && (tmp1 < tmp3))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp1, tmp3); _i += tmp2)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))));
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fequations, modelica_fnptr _func)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _eq_ptr = NULL;
  modelica_metatype _eq = NULL;
  modelica_metatype _new_eq = NULL;
  modelica_metatype _followEquations = NULL;
  modelica_boolean _debug;
  modelica_metatype _debug_eqns = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_integer tmp7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _eq_ptr has no default value.
  // _eq has no default value.
  // _new_eq has no default value.
  _followEquations = omc_Flags_getConfigStringList(threadData, _OMC_LIT48);
  _debug = (!listEmpty(_followEquations));
  // _debug_eqns has no default value.
  if(_debug)
  {
    _debug_eqns = omc_UnorderedSet_fromList(threadData, _followEquations, boxvar_stringHashDjb2, boxvar_stringEq);
  }

  tmp5 = ((modelica_integer) 1); tmp6 = 1; tmp7 = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  if(!(((tmp6 > 0) && (tmp5 > tmp7)) || ((tmp6 < 0) && (tmp5 < tmp7))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp5, tmp7); _i += tmp6)
    {
      if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
      {
        _eq_ptr = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

        _eq = omc_Pointer_access(threadData, _eq_ptr);

        _new_eq = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _eq) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _eq);

        if((!referenceEq(_eq, _new_eq)))
        {
          if(((_debug && (omc_UnorderedSet_contains(threadData, omc_NFComponentRef_toString(threadData, omc_NBEquation_Equation_getEqnName(threadData, _eq_ptr)), _debug_eqns) || omc_UnorderedSet_contains(threadData, omc_NFComponentRef_toString(threadData, omc_NBEquation_Equation_getEqnName(threadData, omc_Pointer_create(threadData, _new_eq))), _debug_eqns))) && (!omc_NBEquation_Equation_equalName(threadData, omc_Pointer_create(threadData, _eq), omc_Pointer_create(threadData, _new_eq)))))
          {
            tmpMeta1 = stringAppend(_OMC_LIT49,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
            tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT50);
            tmpMeta3 = stringAppend(tmpMeta2,omc_NBEquation_Equation_toString(threadData, _new_eq, _OMC_LIT6));
            tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT22);
            fputs(MMC_STRINGDATA(tmpMeta4),stdout);
          }

          omc_Pointer_update(threadData, _eq_ptr, _new_eq);
        }
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_remove(threadData_t *threadData, modelica_metatype _eqn, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _name = NULL;
  modelica_integer _index;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _name has no default value.
  // _index has no default value.
  _name = omc_NBEquation_Equation_getEqnName(threadData, _eqn);

  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = omc_UnorderedMap_get(threadData, _name, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))));
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_integer tmp6;
          if (optionNone(tmp3_1)) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 1));
          tmp6 = mmc_unbox_integer(tmpMeta5);
          _index = tmp6  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_index > ((modelica_integer) 0))) goto tmp2_end;
          omc_ExpandableArray_delete(threadData, _index, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

          omc_UnorderedMap_add(threadData, _name, mmc_mk_integer(((modelica_integer) -1)), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))));
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_add(threadData_t *threadData, modelica_metatype _eqn, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  modelica_metatype _name = NULL;
  modelica_integer _index;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  // _name has no default value.
  // _index has no default value.
  _name = omc_NBEquation_Equation_getEqnName(threadData, _eqn);

  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = omc_UnorderedMap_get(threadData, _name, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))));
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_integer tmp6;
          if (optionNone(tmp3_1)) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 1));
          tmp6 = mmc_unbox_integer(tmpMeta5);
          _index = tmp6  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(_index > ((modelica_integer) 0))) goto tmp2_end;
          omc_ExpandableArray_update(threadData, _index, _eqn, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          omc_ExpandableArray_add(threadData, _eqn, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))) ,&_index);

          omc_UnorderedMap_add(threadData, _name, mmc_mk_integer(_index), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 2))));
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_removeList(threadData_t *threadData, modelica_metatype _eq_lst, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  _equations = omc_List_fold(threadData, _eq_lst, boxvar_NBEquation_EquationPointers_remove, _equations);

  _equations = omc_NBEquation_EquationPointers_compress(threadData, _equations);
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_addList(threadData_t *threadData, modelica_metatype _eq_lst, modelica_metatype __omcQ_24in_5Fequations)
{
  modelica_metatype _equations = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _equations = __omcQ_24in_5Fequations;
  _equations = omc_List_fold(threadData, _eq_lst, boxvar_NBEquation_EquationPointers_add, _equations);
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_fromList(threadData_t *threadData, modelica_metatype _eq_lst)
{
  modelica_metatype _equations = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _equations has no default value.
  _equations = omc_NBEquation_EquationPointers_empty(threadData, listLength(_eq_lst));

  _equations = omc_NBEquation_EquationPointers_addList(threadData, _eq_lst, _equations);
  _return: OMC_LABEL_UNUSED
  return _equations;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_toList(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_metatype _eqn_lst = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn_lst has no default value.
  _eqn_lst = omc_ExpandableArray_toList(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  _return: OMC_LABEL_UNUSED
  return _eqn_lst;
}

DLLDirection
modelica_integer omc_NBEquation_EquationPointers_lastUsedIndex(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_integer _sz;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _sz = omc_ExpandableArray_getLastUsedIndex(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  _return: OMC_LABEL_UNUSED
  return _sz;
}
modelica_metatype boxptr_NBEquation_EquationPointers_lastUsedIndex(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_integer _sz;
  modelica_metatype out_sz;
  _sz = omc_NBEquation_EquationPointers_lastUsedIndex(threadData, _equations);
  out_sz = mmc_mk_icon(_sz);
  return out_sz;
}

DLLDirection
modelica_integer omc_NBEquation_EquationPointers_scalarSize(threadData_t *threadData, modelica_metatype _equations, modelica_boolean _resize)
{
  modelica_integer _sz;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _sz = ((modelica_integer) 0);
  {
    modelica_metatype _eqn_ptr;
    for (tmpMeta1 = omc_NBEquation_EquationPointers_toList(threadData, _equations); !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _eqn_ptr = MMC_CAR(tmpMeta1);
      _sz = _sz + omc_NBEquation_Equation_size(threadData, _eqn_ptr, _resize);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _sz;
}
modelica_metatype boxptr_NBEquation_EquationPointers_scalarSize(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _sz;
  modelica_metatype out_sz;
  tmp1 = mmc_unbox_integer(_resize);
  _sz = omc_NBEquation_EquationPointers_scalarSize(threadData, _equations, tmp1);
  out_sz = mmc_mk_icon(_sz);
  return out_sz;
}

DLLDirection
modelica_integer omc_NBEquation_EquationPointers_size(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_integer _sz;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _sz = omc_ExpandableArray_getNumberOfElements(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));
  _return: OMC_LABEL_UNUSED
  return _sz;
}
modelica_metatype boxptr_NBEquation_EquationPointers_size(threadData_t *threadData, modelica_metatype _equations)
{
  modelica_integer _sz;
  modelica_metatype out_sz;
  _sz = omc_NBEquation_EquationPointers_size(threadData, _equations);
  out_sz = mmc_mk_icon(_sz);
  return out_sz;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_clone(threadData_t *threadData, modelica_metatype _equations, modelica_boolean _shallow)
{
  modelica_metatype _new = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _new has no default value.
  if(_shallow)
  {
    _new = omc_NBEquation_EquationPointers_fromList(threadData, omc_NBEquation_EquationPointers_toList(threadData, _equations));
  }
  else
  {
    {
      modelica_metatype __omcQ_24tmpVar7;
      modelica_metatype* tmp2;
      modelica_metatype tmpMeta3;
      modelica_metatype __omcQ_24tmpVar6;
      modelica_integer tmp4;
      modelica_metatype _eqn_loopVar = 0;
      modelica_metatype _eqn;
      _eqn_loopVar = omc_NBEquation_EquationPointers_toList(threadData, _equations);
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      __omcQ_24tmpVar7 = tmpMeta3; /* defaultValue */
      tmp2 = &__omcQ_24tmpVar7;
      while(1) {
        tmp4 = 1;
        if (!listEmpty(_eqn_loopVar)) {
          _eqn = MMC_CAR(_eqn_loopVar);
          _eqn_loopVar = MMC_CDR(_eqn_loopVar);
          tmp4--;
        }
        if (tmp4 == 0) {
          __omcQ_24tmpVar6 = omc_Pointer_create(threadData, omc_Pointer_access(threadData, _eqn));
          *tmp2 = mmc_mk_cons(__omcQ_24tmpVar6,0);
          tmp2 = &MMC_CDR(*tmp2);
        } else if (tmp4 == 1) {
          break;
        } else {
          MMC_THROW_INTERNAL();
        }
      }
      *tmp2 = mmc_mk_nil();
      tmpMeta1 = __omcQ_24tmpVar7;
    }
    _new = omc_NBEquation_EquationPointers_fromList(threadData, tmpMeta1);
  }
  _return: OMC_LABEL_UNUSED
  return _new;
}
modelica_metatype boxptr_NBEquation_EquationPointers_clone(threadData_t *threadData, modelica_metatype _equations, modelica_metatype _shallow)
{
  modelica_integer tmp1;
  modelica_metatype _new = NULL;
  tmp1 = mmc_unbox_integer(_shallow);
  _new = omc_NBEquation_EquationPointers_clone(threadData, _equations, tmp1);
  /* skip box _new; NBEquation.EquationPointers */
  return _new;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationPointers_empty(threadData_t *threadData, modelica_integer _size)
{
  modelica_metatype _equationPointers = NULL;
  modelica_integer _arr_size;
  modelica_integer _bucketSize;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _equationPointers has no default value.
  // _arr_size has no default value.
  // _bucketSize has no default value.
  _arr_size = modelica_integer_max((modelica_integer)(_size),(modelica_integer)(((modelica_integer) 257)));

  _bucketSize = omc_Util_nextPrime(threadData, _arr_size);

  tmpMeta1 = mmc_mk_box3(3, &NBEquation_EquationPointers_EQUATION__POINTERS__desc, omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, _bucketSize), omc_ExpandableArray_new(threadData, _arr_size, omc_Pointer_create(threadData, _OMC_LIT42)));
  _equationPointers = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _equationPointers;
}
modelica_metatype boxptr_NBEquation_EquationPointers_empty(threadData_t *threadData, modelica_metatype _size)
{
  modelica_integer tmp1;
  modelica_metatype _equationPointers = NULL;
  tmp1 = mmc_unbox_integer(_size);
  _equationPointers = omc_NBEquation_EquationPointers_empty(threadData, tmp1);
  /* skip box _equationPointers; NBEquation.EquationPointers */
  return _equationPointers;
}

DLLDirection
modelica_string omc_NBEquation_EquationPointers_toString(threadData_t *threadData, modelica_metatype _equations, modelica_string __omcQ_24in_5Fstr, modelica_metatype _mapping_opt, modelica_boolean _printEmpty, modelica_metatype _filter_opt)
{
  modelica_string _str = NULL;
  modelica_integer _luI;
  modelica_integer _length;
  modelica_integer _scal_start;
  modelica_integer _current_index;
  modelica_string _index = NULL;
  modelica_boolean _useMapping;
  modelica_boolean _filterEqs;
  modelica_metatype _mapping = NULL;
  modelica_metatype _filter = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_integer tmp9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_integer tmp19;
  modelica_integer tmp20;
  modelica_integer tmp21;
  modelica_metatype tmpMeta22;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  _luI = omc_NBEquation_EquationPointers_lastUsedIndex(threadData, _equations);
  // _length has no default value.
  // _scal_start has no default value.
  _current_index = ((modelica_integer) 1);
  // _index has no default value.
  _useMapping = isSome(_mapping_opt);
  _filterEqs = isSome(_filter_opt);
  // _mapping has no default value.
  // _filter has no default value.
  // _eqn has no default value.
  if(_useMapping)
  {
    _length = ((modelica_integer) 15);

    _mapping = omc_Util_getOption(threadData, _mapping_opt);
  }
  else
  {
    _length = ((modelica_integer) 10);
  }

  if(_filterEqs)
  {
    _filter = omc_Util_getOption(threadData, _filter_opt);

    tmpMeta1 = stringAppend(_OMC_LIT51,_str);
    _str = tmpMeta1;
  }

  if((_printEmpty || (_luI > ((modelica_integer) 0))))
  {
    tmpMeta2 = stringAppend(_str,_OMC_LIT52);
    tmpMeta3 = stringAppend(tmpMeta2,intString(omc_NBEquation_EquationPointers_size(threadData, _equations)));
    tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT53);
    tmpMeta5 = stringAppend(tmpMeta4,intString(omc_NBEquation_EquationPointers_scalarSize(threadData, _equations, 1 /* true */)));
    tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT21);
    _str = omc_StringUtil_headline__4(threadData, tmpMeta6);

    tmp19 = ((modelica_integer) 1); tmp20 = 1; tmp21 = _luI;
    if(!(((tmp20 > 0) && (tmp19 > tmp21)) || ((tmp20 < 0) && (tmp19 < tmp21))))
    {
      modelica_integer _i;
      for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp19, tmp21); _i += tmp20)
      {
        if(omc_ExpandableArray_occupied(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3)))))
        {
          _eqn = omc_ExpandableArray_get(threadData, _i, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_equations), 3))));

          if(((!_filterEqs) || omc_UnorderedSet_contains(threadData, omc_NFComponentRef_toString(threadData, omc_NBEquation_Equation_getEqnName(threadData, _eqn)), _filter)))
          {
            if(_useMapping)
            {
              /* Pattern-matching assignment */
              tmpMeta7 = arrayGet(_mapping,_current_index) /* DAE.ASUB */;
              tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 1));
              tmp9 = mmc_unbox_integer(tmpMeta8);
              _scal_start = tmp9  /* pattern as ty=Integer */;

              tmpMeta10 = stringAppend(_OMC_LIT54,intString(_current_index));
              tmpMeta11 = stringAppend(tmpMeta10,_OMC_LIT55);
              tmpMeta12 = stringAppend(tmpMeta11,intString(_scal_start));
              tmpMeta13 = stringAppend(tmpMeta12,_OMC_LIT21);
              _index = tmpMeta13;
            }
            else
            {
              tmpMeta14 = stringAppend(_OMC_LIT54,intString(_current_index));
              tmpMeta15 = stringAppend(tmpMeta14,_OMC_LIT21);
              _index = tmpMeta15;
            }

            tmpMeta16 = stringAppend(_index,omc_StringUtil_repeat(threadData, _OMC_LIT56, _length - stringLength(_index)));
            _index = tmpMeta16;

            tmpMeta17 = stringAppend(_str,omc_NBEquation_Equation_toString(threadData, omc_Pointer_access(threadData, _eqn), _index));
            tmpMeta18 = stringAppend(tmpMeta17,_OMC_LIT22);
            _str = tmpMeta18;
          }

          _current_index = ((modelica_integer) 1) + _current_index;
        }
      }
    }

    tmpMeta22 = stringAppend(_str,_OMC_LIT22);
    _str = tmpMeta22;
  }
  else
  {
    _str = _OMC_LIT6;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}
modelica_metatype boxptr_NBEquation_EquationPointers_toString(threadData_t *threadData, modelica_metatype _equations, modelica_metatype __omcQ_24in_5Fstr, modelica_metatype _mapping_opt, modelica_metatype _printEmpty, modelica_metatype _filter_opt)
{
  modelica_integer tmp1;
  modelica_string _str = NULL;
  tmp1 = mmc_unbox_integer(_printEmpty);
  _str = omc_NBEquation_EquationPointers_toString(threadData, _equations, __omcQ_24in_5Fstr, _mapping_opt, tmp1, _filter_opt);
  /* skip box _str; String */
  return _str;
}

DLLDirection
modelica_string omc_NBEquation_equationKindString(threadData_t *threadData, modelica_integer _eqKind, modelica_metatype _clock_idx, modelica_boolean _exclusively_initial)
{
  modelica_string _str = NULL;
  modelica_string tmp1 = 0;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_boolean tmp8;
  modelica_string tmp9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  { /* match expression */
    modelica_integer tmp4_1;
    tmp4_1 = (modelica_integer)_eqKind;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (1 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT57;
          goto tmp3_done;
        }
        case 1: {
          if (3 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT58;
          goto tmp3_done;
        }
        case 2: {
          if (2 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT59;
          goto tmp3_done;
        }
        case 3: {
          if (4 != tmp4_1) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT60;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT61;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _str = tmp1;

  tmp8 = (modelica_boolean)_exclusively_initial;
  if(tmp8)
  {
    tmpMeta6 = stringAppend(_OMC_LIT62,_str);
    tmp9 = tmpMeta6;
  }
  else
  {
    tmpMeta7 = stringAppend(_OMC_LIT63,_str);
    tmp9 = tmpMeta7;
  }
  _str = tmp9;

  if(isSome(_clock_idx))
  {
    tmpMeta10 = stringAppend(_str,_OMC_LIT54);
    tmpMeta11 = stringAppend(tmpMeta10,intString(mmc_unbox_integer(omc_Util_getOption(threadData, _clock_idx))));
    tmpMeta12 = stringAppend(tmpMeta11,_OMC_LIT65);
    _str = tmpMeta12;
  }
  else
  {
    tmpMeta13 = stringAppend(_str,_OMC_LIT64);
    _str = tmpMeta13;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}
modelica_metatype boxptr_NBEquation_equationKindString(threadData_t *threadData, modelica_metatype _eqKind, modelica_metatype _clock_idx, modelica_metatype _exclusively_initial)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_string _str = NULL;
  tmp1 = mmc_unbox_integer(_eqKind);
  tmp2 = mmc_unbox_integer(_exclusively_initial);
  _str = omc_NBEquation_equationKindString(threadData, tmp1, _clock_idx, tmp2);
  /* skip box _str; String */
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_convertEquationKind(threadData_t *threadData, modelica_integer _eqKind, modelica_metatype _clock_idx, modelica_boolean _exclusively_initial)
{
  modelica_metatype _oldEqKind = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldEqKind has no default value.
  { /* match expression */
    modelica_integer tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = (modelica_integer)_eqKind;
    tmp4_2 = _clock_idx;
    {
      modelica_integer _clk;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _clk has no default value.
      tmp4 = 0;
      for (; tmp4 < 9; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!_exclusively_initial) goto tmp3_end;
          tmpMeta1 = _OMC_LIT66;
          goto tmp3_done;
        }
        case 1: {
          if (1 != tmp4_1) goto tmp3_end;
          if (!optionNone(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT67;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          if (3 != tmp4_1) goto tmp3_end;
          if (optionNone(tmp4_2)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          _clk = tmp7  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box2(6, &BackendDAE_EquationKind_CLOCKED__EQUATION__desc, mmc_mk_integer(_clk));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 3: {
          if (2 != tmp4_1) goto tmp3_end;
          if (!optionNone(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT68;
          goto tmp3_done;
        }
        case 4: {
          if (4 != tmp4_1) goto tmp3_end;
          if (!optionNone(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT69;
          goto tmp3_done;
        }
        case 5: {
          if (5 != tmp4_1) goto tmp3_end;
          if (!optionNone(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT70;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          if (optionNone(tmp4_2)) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          
          /* Pattern matching succeeded */
          tmpMeta11 = stringAppend(_OMC_LIT71,omc_NBEquation_equationKindString(threadData, (modelica_integer)_eqKind, _clock_idx, _exclusively_initial));
          tmpMeta12 = stringAppend(tmpMeta11,_OMC_LIT72);
          tmpMeta10 = mmc_mk_cons(tmpMeta12, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta10);
          goto goto_2;
          goto tmp3_done;
        }
        case 7: {
          if (3 != tmp4_1) goto tmp3_end;
          if (!optionNone(tmp4_2)) goto tmp3_end;
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT74);
          goto goto_2;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT76);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _oldEqKind = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oldEqKind;
}
modelica_metatype boxptr_NBEquation_convertEquationKind(threadData_t *threadData, modelica_metatype _eqKind, modelica_metatype _clock_idx, modelica_metatype _exclusively_initial)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _oldEqKind = NULL;
  tmp1 = mmc_unbox_integer(_eqKind);
  tmp2 = mmc_unbox_integer(_exclusively_initial);
  _oldEqKind = omc_NBEquation_convertEquationKind(threadData, tmp1, _clock_idx, tmp2);
  /* skip box _oldEqKind; BackendDAE.EquationKind */
  return _oldEqKind;
}

DLLDirection
modelica_metatype omc_NBEquation_default(threadData_t *threadData, modelica_integer _kind, modelica_boolean _exclusively_initial, modelica_metatype _clock_idx)
{
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _attr has no default value.
  tmpMeta1 = mmc_mk_box8(3, &NBEquation_EquationAttributes_EQUATION__ATTRIBUTES__desc, mmc_mk_none(), mmc_mk_none(), _clock_idx, mmc_mk_boolean(0 /* false */), mmc_mk_boolean(_exclusively_initial), _OMC_LIT77, mmc_mk_integer((modelica_integer)_kind));
  _attr = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _attr;
}
modelica_metatype boxptr_NBEquation_default(threadData_t *threadData, modelica_metatype _kind, modelica_metatype _exclusively_initial, modelica_metatype _clock_idx)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_metatype _attr = NULL;
  tmp1 = mmc_unbox_integer(_kind);
  tmp2 = mmc_unbox_integer(_exclusively_initial);
  _attr = omc_NBEquation_default(threadData, tmp1, tmp2, _clock_idx);
  /* skip box _attr; NBEquation.EquationAttributes */
  return _attr;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationAttributes_convert(threadData_t *threadData, modelica_metatype _attributes)
{
  modelica_metatype _oldAttributes = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldAttributes has no default value.
  tmpMeta1 = mmc_mk_box4(3, &BackendDAE_EquationAttributes_EQUATION__ATTRIBUTES__desc, mmc_mk_boolean(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attributes), 2))))), omc_NBEquation_convertEquationKind(threadData, mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attributes), 8)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attributes), 4))), mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attributes), 6))))), omc_NBEvaluation_Stages_convert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attributes), 7)))));
  _oldAttributes = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oldAttributes;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationAttributes_getResidualVar(threadData_t *threadData, modelica_metatype _attr)
{
  modelica_metatype _residualVar = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _residualVar has no default value.
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attr), 3)));
          if (optionNone(tmpMeta5)) goto goto_1;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 1));
          _residualVar = tmpMeta6;
          goto tmp2_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT79);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _residualVar;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationAttributes_setResidualVar(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fattr, modelica_metatype _residualVar)
{
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _attr = __omcQ_24in_5Fattr;
  tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(9));
  memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_attr), 9*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[3] = mmc_mk_some(_residualVar);
  _attr = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _attr;
}

DLLDirection
modelica_metatype omc_NBEquation_EquationAttributes_setKind(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fattr, modelica_integer _kind, modelica_metatype _clock_idx)
{
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _attr = __omcQ_24in_5Fattr;
  tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(9));
  memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_attr), 9*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[8] = mmc_mk_integer((modelica_integer)_kind);
  _attr = tmpMeta1;

  tmpMeta2 = MMC_TAGPTR(mmc_alloc_words(9));
  memcpy(MMC_UNTAGPTR(tmpMeta2), MMC_UNTAGPTR(_attr), 9*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta2))[4] = _clock_idx;
  _attr = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _attr;
}
modelica_metatype boxptr_NBEquation_EquationAttributes_setKind(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fattr, modelica_metatype _kind, modelica_metatype _clock_idx)
{
  modelica_integer tmp1;
  modelica_metatype _attr = NULL;
  tmp1 = mmc_unbox_integer(_kind);
  _attr = omc_NBEquation_EquationAttributes_setKind(threadData, __omcQ_24in_5Fattr, tmp1, _clock_idx);
  /* skip box _attr; NBEquation.EquationAttributes */
  return _attr;
}

DLLDirection
modelica_string omc_NBEquation_EquationAttributes_toString(threadData_t *threadData, modelica_metatype _attr, modelica_string _indent)
{
  modelica_string _str = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _attr;
    {
      modelica_metatype _residualVar = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _residualVar has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,7) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          
          _residualVar = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta8 = stringAppend(_indent,_OMC_LIT54);
          tmpMeta9 = stringAppend(tmpMeta8,omc_NFComponentRef_toString(threadData, omc_NBVariable_getVarName(threadData, _residualVar)));
          tmpMeta10 = stringAppend(tmpMeta9,_OMC_LIT21);
          tmp1 = tmpMeta10;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT6;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _str = tmp1;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenStatement_convert(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_metatype _oldStmt = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _oldStmt has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box4(3, &BackendDAE_WhenOperator_ASSIGN__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 4))));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box4(4, &BackendDAE_WhenOperator_REINIT__desc, omc_NFComponentRef_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 4))));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box5(5, &BackendDAE_WhenOperator_ASSERT__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3)))), omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 4)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 5))));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box3(6, &BackendDAE_WhenOperator_TERMINATE__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_box3(7, &BackendDAE_WhenOperator_NORETCALL__desc, omc_NFExpression_toDAE(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))));
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = stringAppend(_OMC_LIT80,omc_NBEquation_WhenStatement_toString(threadData, _stmt, _OMC_LIT6));
          tmpMeta10 = mmc_mk_cons(tmpMeta11, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta10);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _oldStmt = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _oldStmt;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenStatement_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fstmt, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _stmt = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _stmt = __omcQ_24in_5Fstmt;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      modelica_fnptr _funcCref;
      modelica_metatype _lhs = NULL;
      modelica_metatype _rhs = NULL;
      modelica_metatype _value = NULL;
      modelica_metatype _condition = NULL;
      modelica_metatype _message = NULL;
      modelica_metatype _stateVar = NULL;
      int tmp4;
      // _lhs has no default value.
      // _rhs has no default value.
      // _value has no default value.
      // _condition has no default value.
      // _message has no default value.
      // _stateVar has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          _lhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp));

          _rhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_lhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))))))
          {
            tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_stmt), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[2] = _lhs;
            _stmt = tmpMeta5;
          }

          if((!referenceEq(_rhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))))))
          {
            tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_stmt), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = _rhs;
            _stmt = tmpMeta6;
          }
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          if(isSome(_funcCrefOpt))
          {
            /* Pattern-matching assignment */
            tmpMeta7 = _funcCrefOpt;
            if (optionNone(tmpMeta7)) goto goto_2;
            tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 1));
            _funcCref = tmpMeta8;

            _stateVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))));

            if((!referenceEq(_stateVar, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))))))
            {
              tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(5));
              memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_stmt), 5*sizeof(modelica_metatype));
              ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[2] = _stateVar;
              _stmt = tmpMeta9;
            }
          }

          _value = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_value, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))))))
          {
            tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_stmt), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[3] = _value;
            _stmt = tmpMeta10;
          }
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          _condition = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_condition, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))))))
          {
            tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(6));
            memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_stmt), 6*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[2] = _condition;
            _stmt = tmpMeta11;
          }

          _message = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_message, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))))))
          {
            tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(6));
            memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_stmt), 6*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[3] = _message;
            _stmt = tmpMeta12;
          }
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          _value = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_value, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))))))
          {
            tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(4));
            memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_stmt), 4*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[2] = _value;
            _stmt = tmpMeta13;
          }
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _stmt;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _stmt = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _stmt;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenStatement_getType(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT81;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenStatement_isAssignOrReinit(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenStatement_isAssignOrReinit(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenStatement_isAssignOrReinit(threadData, _stmt);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenStatement_isAssign(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenStatement_isAssign(threadData_t *threadData, modelica_metatype _stmt)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenStatement_isAssign(threadData, _stmt);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NBEquation_WhenStatement_size(threadData_t *threadData, modelica_metatype _stmt, modelica_boolean _resize)
{
  modelica_integer _s;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _s has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFType_sizeOf(threadData, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2)))), _resize);
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NBEquation_WhenStatement_size(threadData_t *threadData, modelica_metatype _stmt, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _s;
  modelica_metatype out_s;
  tmp1 = mmc_unbox_integer(_resize);
  _s = omc_NBEquation_WhenStatement_size(threadData, _stmt, tmp1);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenStatement_toEquation(threadData_t *threadData, modelica_metatype _stmt, modelica_metatype _attr, modelica_boolean _init)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_Equation_makeAssignmentEqn(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 3))), _OMC_LIT82, _attr);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_cons(omc_NBEquation_WhenStatement_toStatement(threadData, _stmt), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = omc_NBEquation_Equation_setAttributes(threadData, omc_Pointer_access(threadData, omc_NBEquation_Equation_makeAlgorithm(threadData, tmpMeta6, _init)), _attr);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}
modelica_metatype boxptr_NBEquation_WhenStatement_toEquation(threadData_t *threadData, modelica_metatype _stmt, modelica_metatype _attr, modelica_metatype _init)
{
  modelica_integer tmp1;
  modelica_metatype _eqn = NULL;
  tmp1 = mmc_unbox_integer(_init);
  _eqn = omc_NBEquation_WhenStatement_toEquation(threadData, _stmt, _attr, tmp1);
  /* skip box _eqn; NBEquation.Equation */
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenStatement_toStatement(threadData_t *threadData, modelica_metatype _wstmt)
{
  modelica_metatype _stmt = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _stmt has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _wstmt;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 3))), omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 4))));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box4(10, &NFStatement_REINIT__desc, omc_NFExpression_fromCref(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2))), 0 /* false */), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 4))));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box5(8, &NFStatement_ASSERT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 5))));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box3(9, &NFStatement_TERMINATE__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 3))));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_box3(11, &NFStatement_NORETCALL__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_wstmt), 3))));
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = stringAppend(_OMC_LIT83,omc_NBEquation_WhenStatement_toString(threadData, _wstmt, _OMC_LIT6));
          tmpMeta10 = mmc_mk_cons(tmpMeta11, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta10);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _stmt = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _stmt;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenStatement_isEqual(threadData_t *threadData, modelica_metatype _stmt1, modelica_metatype _stmt2)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _stmt1;
    tmp4_2 = _stmt2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 6; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 2)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 3)))));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFComponentRef_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 2)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 3)))));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 2)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 3))))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 4)))));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,3,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 2))));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,2) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,4,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt2), 2))));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenStatement_isEqual(threadData_t *threadData, modelica_metatype _stmt1, modelica_metatype _stmt2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenStatement_isEqual(threadData, _stmt1, _stmt2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenStatement_isEqualTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype _stmt1 = NULL;
  modelica_metatype _stmt2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _stmt1 has no default value.
  // _stmt2 has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _tpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _stmt1 = tmpMeta2;
  _stmt2 = tmpMeta3;

  _b = omc_NBEquation_WhenStatement_isEqual(threadData, _stmt1, _stmt2);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenStatement_isEqualTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenStatement_isEqualTpl(threadData, _tpl);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_string omc_NBEquation_WhenStatement_toString(threadData_t *threadData, modelica_metatype _stmt, modelica_string __omcQ_24in_5Fstr)
{
  modelica_string _str = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _stmt;
    {
      modelica_metatype _lhs = NULL;
      modelica_metatype _rhs = NULL;
      modelica_metatype _value = NULL;
      modelica_metatype _condition = NULL;
      modelica_metatype _message = NULL;
      modelica_metatype _level = NULL;
      modelica_metatype _stateVar = NULL;
      int tmp4;
      // _lhs has no default value.
      // _rhs has no default value.
      // _value has no default value.
      // _condition has no default value.
      // _message has no default value.
      // _level has no default value.
      // _stateVar has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _lhs = tmpMeta5;
          _rhs = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta7 = stringAppend(_str,omc_NFExpression_toString(threadData, _lhs));
          tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT84);
          tmpMeta9 = stringAppend(tmpMeta8,omc_NFExpression_toString(threadData, _rhs));
          tmp1 = tmpMeta9;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _stateVar = tmpMeta10;
          _value = tmpMeta11;
          /* Pattern matching succeeded */
          tmpMeta12 = stringAppend(_str,_OMC_LIT85);
          tmpMeta13 = stringAppend(tmpMeta12,omc_NFComponentRef_toString(threadData, _stateVar));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT86);
          tmpMeta15 = stringAppend(tmpMeta14,omc_NFExpression_toString(threadData, _value));
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT21);
          tmp1 = tmpMeta16;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,4) == 0) goto tmp3_end;
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          
          _condition = tmpMeta17;
          _message = tmpMeta18;
          _level = tmpMeta19;
          /* Pattern matching succeeded */
          tmpMeta20 = stringAppend(_str,_OMC_LIT87);
          tmpMeta21 = stringAppend(tmpMeta20,omc_NFExpression_toString(threadData, _condition));
          tmpMeta22 = stringAppend(tmpMeta21,_OMC_LIT86);
          tmpMeta23 = stringAppend(tmpMeta22,omc_NFExpression_toString(threadData, _message));
          tmpMeta24 = stringAppend(tmpMeta23,_OMC_LIT86);
          tmpMeta25 = stringAppend(tmpMeta24,omc_NFExpression_toString(threadData, _level));
          tmpMeta26 = stringAppend(tmpMeta25,_OMC_LIT21);
          tmp1 = tmpMeta26;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,2) == 0) goto tmp3_end;
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _message = tmpMeta27;
          /* Pattern matching succeeded */
          tmpMeta28 = stringAppend(_str,_OMC_LIT88);
          tmpMeta29 = stringAppend(tmpMeta28,omc_NFExpression_toString(threadData, _message));
          tmpMeta30 = stringAppend(tmpMeta29,_OMC_LIT21);
          tmp1 = tmpMeta30;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,2) == 0) goto tmp3_end;
          tmpMeta31 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          
          _value = tmpMeta31;
          /* Pattern matching succeeded */
          tmpMeta32 = stringAppend(_str,omc_NFExpression_toString(threadData, _value));
          tmp1 = tmpMeta32;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          
          /* Pattern matching succeeded */
          tmpMeta33 = stringAppend(_str,_OMC_LIT89);
          tmpMeta34 = stringAppend(tmpMeta33,_OMC_LIT90);
          tmp1 = tmpMeta34;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _str = tmp1;
  _return: OMC_LABEL_UNUSED
  return _str;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_combineConditions(threadData_t *threadData, modelica_metatype _acc_condition, modelica_metatype __omcQ_24in_5Fcondition, modelica_boolean _invert)
{
  modelica_metatype _condition = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _condition = __omcQ_24in_5Fcondition;
  if(_invert)
  {
    _condition = omc_NFExpression_logicNegate(threadData, _condition);
  }

  if((!omc_NFExpression_isEmpty(threadData, _acc_condition)))
  {
    tmpMeta1 = mmc_mk_box4(21, &NFExpression_LBINARY__desc, _acc_condition, omc_NFOperator_makeAnd(threadData, _OMC_LIT91), _condition);
    _condition = tmpMeta1;
  }
  _return: OMC_LABEL_UNUSED
  return _condition;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_WhenEquationBody_combineConditions(threadData_t *threadData, modelica_metatype _acc_condition, modelica_metatype __omcQ_24in_5Fcondition, modelica_metatype _invert)
{
  modelica_integer tmp1;
  modelica_metatype _condition = NULL;
  tmp1 = mmc_unbox_integer(_invert);
  _condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, __omcQ_24in_5Fcondition, tmp1);
  /* skip box _condition; NFExpression */
  return _condition;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getFirstReinit(threadData_t *threadData, modelica_metatype _cref, modelica_metatype _stmts)
{
  modelica_metatype _assign = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _assign = mmc_mk_none();
  {
    modelica_metatype _stmt;
    for (tmpMeta1 = _stmts; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _stmt = MMC_CAR(tmpMeta1);
      { /* match expression */
        modelica_metatype tmp4_1;
        tmp4_1 = _stmt;
        {
          volatile mmc_switch_type tmp4;
          int tmp5;
          tmp4 = 0;
          for (; tmp4 < 2; tmp4++) {
            switch (MMC_SWITCH_CAST(tmp4)) {
            case 0: {
              if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
              
              /* Pattern matching succeeded */
              /* Check guard condition after assignments */
              if (!omc_NFComponentRef_isEqual(threadData, _cref, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_stmt), 2))))) goto tmp3_end;
              _assign = mmc_mk_some(_stmt);

              break;
              goto tmp3_done;
            }
            case 1: {
              
              /* Pattern matching succeeded */
              goto tmp3_done;
            }
            }
            goto tmp3_end;
            tmp3_end: ;
          }
          goto goto_2;
          goto_2:;
          MMC_THROW_INTERNAL();
          goto tmp3_done;
          tmp3_done:;
        }
      }
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _assign;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getAssignments(threadData_t *threadData, modelica_metatype _crefSet, modelica_metatype _stmts)
{
  modelica_metatype _assigns = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta16;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _assigns = tmpMeta1;
  {
    modelica_metatype _stmt;
    for (tmpMeta2 = _stmts; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _stmt = MMC_CAR(tmpMeta2);
      { /* match expression */
        modelica_metatype tmp5_1;
        tmp5_1 = _stmt;
        {
          modelica_metatype _cref = NULL;
          modelica_metatype _tpl = NULL;
          volatile mmc_switch_type tmp5;
          int tmp6;
          // _cref has no default value.
          // _tpl has no default value.
          tmp5 = 0;
          for (; tmp5 < 3; tmp5++) {
            switch (MMC_SWITCH_CAST(tmp5)) {
            case 0: {
              modelica_metatype tmpMeta7;
              modelica_metatype tmpMeta8;
              modelica_metatype tmpMeta9;
              if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,0,3) == 0) goto tmp4_end;
              tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp5_1), 2));
              if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,6,2) == 0) goto tmp4_end;
              tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 3));
              
              _cref = tmpMeta8;
              /* Pattern matching succeeded */
              /* Check guard condition after assignments */
              if (!omc_UnorderedSet_contains(threadData, _cref, _crefSet)) goto tmp4_end;
              tmpMeta9 = mmc_mk_cons(_stmt, _assigns);
              _assigns = tmpMeta9;
              goto tmp4_done;
            }
            case 1: {
              modelica_metatype tmpMeta10;
              modelica_metatype tmpMeta11;
              modelica_metatype tmpMeta12;
              if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,0,3) == 0) goto tmp4_end;
              tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp5_1), 2));
              if (mmc__uniontype__metarecord__typedef__equal(tmpMeta10,11,2) == 0) goto tmp4_end;
              
              _tpl = tmpMeta10;
              {
                modelica_metatype __omcQ_24tmpVar9;
                modelica_metatype* tmp13;
                modelica_metatype tmpMeta14;
                modelica_metatype __omcQ_24tmpVar8;
                modelica_integer tmp15;
                modelica_metatype _c_loopVar = 0;
                modelica_metatype _c;
                _c_loopVar = omc_UnorderedSet_toList(threadData, omc_NFExpression_extractCrefs(threadData, _tpl));
                tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
                __omcQ_24tmpVar9 = tmpMeta14; /* defaultValue */
                tmp13 = &__omcQ_24tmpVar9;
                while(1) {
                  tmp15 = 1;
                  if (!listEmpty(_c_loopVar)) {
                    _c = MMC_CAR(_c_loopVar);
                    _c_loopVar = MMC_CDR(_c_loopVar);
                    tmp15--;
                  }
                  if (tmp15 == 0) {
                    __omcQ_24tmpVar8 = mmc_mk_boolean(omc_UnorderedSet_contains(threadData, _c, _crefSet));
                    *tmp13 = mmc_mk_cons(__omcQ_24tmpVar8,0);
                    tmp13 = &MMC_CDR(*tmp13);
                  } else if (tmp15 == 1) {
                    break;
                  } else {
                    goto goto_3;
                  }
                }
                *tmp13 = mmc_mk_nil();
                tmpMeta12 = __omcQ_24tmpVar9;
              }
              /* Pattern matching succeeded */
              /* Check guard condition after assignments */
              if (!omc_List_any(threadData, tmpMeta12, boxvar_Util_id)) goto tmp4_end;
              tmpMeta11 = mmc_mk_cons(_stmt, _assigns);
              _assigns = tmpMeta11;
              goto tmp4_done;
            }
            case 2: {
              
              /* Pattern matching succeeded */
              goto tmp4_done;
            }
            }
            goto tmp4_end;
            tmp4_end: ;
          }
          goto goto_3;
          goto_3:;
          MMC_THROW_INTERNAL();
          goto tmp4_done;
          tmp4_done:;
        }
      }
      ;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _assigns;
}

PROTECTED_FUNCTION_STATIC void omc_NBEquation_WhenEquationBody_addCrefsMap(threadData_t *threadData, modelica_metatype _discr_map, modelica_metatype _crefs)
{
  modelica_metatype _set_new = NULL;
  modelica_metatype _set = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _set_new has no default value.
  _set = omc_UnorderedSet_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 13));
  {
    modelica_metatype _c;
    for (tmpMeta1 = _crefs; !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _c = MMC_CAR(tmpMeta1);
      if(omc_UnorderedMap_contains(threadData, _c, _discr_map))
      {
        _set_new = omc_UnorderedMap_getSafe(threadData, _c, _discr_map, _OMC_LIT93);

        if((!referenceEq(_set, _set_new)))
        {
          _set = omc_UnorderedSet_union(threadData, _set, _set_new);
        }
      }
      else
      {
        omc_UnorderedSet_add(threadData, _c, _set);
      }
    }
  }

  {
    modelica_metatype _c;
    for (tmpMeta3 = _crefs; !listEmpty(tmpMeta3); tmpMeta3=MMC_CDR(tmpMeta3))
    {
      _c = MMC_CAR(tmpMeta3);
      omc_UnorderedMap_add(threadData, _c, _set, _discr_map);
    }
  }
  _return: OMC_LABEL_UNUSED
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_collectForSplit(threadData_t *threadData, modelica_metatype _body_opt, modelica_metatype _discr_map, modelica_metatype _state_set)
{
  modelica_metatype _flat_when = NULL;
  modelica_metatype _body = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _flat_when has no default value.
  // _body has no default value.
  if(isSome(_body_opt))
  {
    _body = omc_Util_getOption(threadData, _body_opt);

    {
      modelica_metatype _stmt;
      for (tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
      {
        _stmt = MMC_CAR(tmpMeta1);
        { /* match expression */
          modelica_metatype tmp4_1;
          tmp4_1 = _stmt;
          {
            modelica_metatype _cref = NULL;
            modelica_metatype _tpl = NULL;
            volatile mmc_switch_type tmp4;
            int tmp5;
            // _cref has no default value.
            // _tpl has no default value.
            tmp4 = 0;
            for (; tmp4 < 5; tmp4++) {
              switch (MMC_SWITCH_CAST(tmp4)) {
              case 0: {
                modelica_metatype tmpMeta6;
                modelica_metatype tmpMeta7;
                modelica_metatype tmpMeta8;
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
                tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
                if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,6,2) == 0) goto tmp3_end;
                tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
                
                _cref = tmpMeta7;
                /* Pattern matching succeeded */
                tmpMeta8 = mmc_mk_cons(_cref, MMC_REFSTRUCTLIT(mmc_nil));
                omc_NBEquation_WhenEquationBody_addCrefsMap(threadData, _discr_map, tmpMeta8);
                goto tmp3_done;
              }
              case 1: {
                modelica_metatype tmpMeta9;
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
                tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
                if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,11,2) == 0) goto tmp3_end;
                
                _tpl = tmpMeta9;
                /* Pattern matching succeeded */
                omc_NBEquation_WhenEquationBody_addCrefsMap(threadData, _discr_map, omc_UnorderedSet_toList(threadData, omc_NFExpression_extractCrefs(threadData, _tpl)));
                goto tmp3_done;
              }
              case 2: {
                modelica_metatype tmpMeta10;
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
                tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
                
                _cref = tmpMeta10;
                /* Pattern matching succeeded */
                omc_UnorderedSet_add(threadData, _cref, _state_set);
                goto tmp3_done;
              }
              case 3: {
                modelica_metatype tmpMeta11;
                modelica_metatype tmpMeta12;
                if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
                
                /* Pattern matching succeeded */
                tmpMeta12 = stringAppend(_OMC_LIT94,omc_NBEquation_WhenStatement_toString(threadData, _stmt, _OMC_LIT6));
                tmpMeta11 = mmc_mk_cons(tmpMeta12, MMC_REFSTRUCTLIT(mmc_nil));
                omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta11);
                goto goto_2;
                goto tmp3_done;
              }
              case 4: {
                
                /* Pattern matching succeeded */
                goto tmp3_done;
              }
              }
              goto tmp3_end;
              tmp3_end: ;
            }
            goto goto_2;
            goto_2:;
            MMC_THROW_INTERNAL();
            goto tmp3_done;
            tmp3_done:;
          }
        }
        ;
      }
    }

    tmpMeta15 = mmc_mk_box2(0, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))));
    tmpMeta14 = mmc_mk_cons(tmpMeta15, omc_NBEquation_WhenEquationBody_collectForSplit(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))), _discr_map, _state_set));
    _flat_when = tmpMeta14;
  }
  else
  {
    tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
    _flat_when = tmpMeta16;
  }
  _return: OMC_LABEL_UNUSED
  return _flat_when;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenEquationBody_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _body)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      modelica_metatype _cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,3) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,11,2) == 0) goto tmp3_end;
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta9 = MMC_CAR(tmp4_1);
          tmpMeta10 = MMC_CDR(tmp4_1);
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta9,0,3) == 0) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta9), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,12,3) == 0) goto tmp3_end;
          if (!listEmpty(tmpMeta10)) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta12 = MMC_CAR(tmp4_1);
          tmpMeta13 = MMC_CDR(tmp4_1);
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta12,0,3) == 0) goto tmp3_end;
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,6,2) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 3));
          if (!listEmpty(tmpMeta13)) goto tmp3_end;
          _cref = tmpMeta15;
          /* Pattern matching succeeded */
          tmp1 = omc_NBVariable_checkCref(threadData, _cref, boxvar_NBVariable_isRecord, _OMC_LIT95);
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(omc_List_count(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))), boxvar_NBEquation_WhenStatement_isAssign) > ((modelica_integer) 1))) goto tmp3_end;
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenEquationBody_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _body)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenEquationBody_isRecordOrTupleEquation(threadData, _body);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_getAllAssigned(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _assigned = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta11;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _assigned = tmpMeta1;
  {
    modelica_metatype _stmt;
    for (tmpMeta2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _stmt = MMC_CAR(tmpMeta2);
      { /* match expression */
        modelica_metatype tmp6_1;
        tmp6_1 = _stmt;
        {
          modelica_metatype _lhs = NULL;
          volatile mmc_switch_type tmp6;
          int tmp7;
          // _lhs has no default value.
          tmp6 = 0;
          for (; tmp6 < 2; tmp6++) {
            switch (MMC_SWITCH_CAST(tmp6)) {
            case 0: {
              modelica_metatype tmpMeta8;
              modelica_metatype tmpMeta9;
              modelica_metatype tmpMeta10;
              if (mmc__uniontype__metarecord__typedef__equal(tmp6_1,0,3) == 0) goto tmp5_end;
              tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp6_1), 2));
              if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,6,2) == 0) goto tmp5_end;
              tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
              
              _lhs = tmpMeta9;
              /* Pattern matching succeeded */
              tmpMeta10 = mmc_mk_cons(_lhs, _assigned);
              tmpMeta3 = tmpMeta10;
              goto tmp5_done;
            }
            case 1: {
              
              /* Pattern matching succeeded */
              tmpMeta3 = _assigned;
              goto tmp5_done;
            }
            }
            goto tmp5_end;
            tmp5_end: ;
          }
          goto goto_4;
          goto_4:;
          MMC_THROW_INTERNAL();
          goto tmp5_done;
          tmp5_done:;
        }
      }
      _assigned = tmpMeta3;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _assigned;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_simplify(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fbody)
{
  modelica_metatype _body = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _body = __omcQ_24in_5Fbody;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _body;
    {
      modelica_metatype _b = NULL;
      modelica_metatype _condition = NULL;
      modelica_metatype _conditions = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _b has no default value.
      // _condition has no default value.
      // _conditions has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,0,3) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,8,3) == 0) goto tmp3_end;
          
          _b = tmpMeta6;
          _condition = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[4] = omc_NBEquation_WhenEquationBody_simplify(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4))));
          _b = tmpMeta8;

          {
            modelica_metatype __omcQ_24tmpVar11;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_metatype __omcQ_24tmpVar10;
            modelica_integer tmp12;
            modelica_metatype _elem_loopVar = 0;
            modelica_metatype _elem;
            _elem_loopVar = arrayList((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_condition), 3))));
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar11 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar11;
            while(1) {
              tmp12 = 1;
              while (!listEmpty(_elem_loopVar)) {
                _elem = MMC_CAR(_elem_loopVar);
                _elem_loopVar = MMC_CDR(_elem_loopVar);
                if ((!omc_NFExpression_isBoolean(threadData, _elem))) {
                  tmp12--;
                  break;
                }
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar10 = _elem;
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar10,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar11;
          }
          _conditions = tmpMeta9;

          if(listEmpty(_conditions))
          {
            _body = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4)));
          }
          else
          {
            if(omc_List_hasOneElement(threadData, _conditions))
            {
              tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(5));
              memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
              ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[2] = listHead(_conditions);
              _b = tmpMeta13;

              _body = mmc_mk_some(_b);
            }
            else
            {
              tmpMeta15 = mmc_mk_cons(omc_NFDimension_fromInteger(threadData, listLength(_conditions), 1), MMC_REFSTRUCTLIT(mmc_nil));
              tmpMeta16 = mmc_mk_box3(10, &NFType_ARRAY__desc, _OMC_LIT91, tmpMeta15);
              tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(5));
              memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
              ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[2] = omc_NFExpression_makeArrayCheckLiteral(threadData, tmpMeta16, listArray(_conditions));
              _b = tmpMeta14;

              _body = mmc_mk_some(_b);
            }
          }
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          _b = tmpMeta17;
          /* Pattern matching succeeded */
          tmpMeta18 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta18), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta18))[4] = omc_NBEquation_WhenEquationBody_simplify(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4))));
          _b = tmpMeta18;

          if(omc_NFExpression_isBoolean(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 2)))))
          {
            _body = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4)));
          }
          else
          {
            _body = mmc_mk_some(_b);
          }
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _body = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _body;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_split(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _bodies = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _discr_map = NULL;
  modelica_metatype _state_set = NULL;
  modelica_metatype _discr_marks = NULL;
  modelica_metatype _flat_when = NULL;
  modelica_metatype _flat_new = NULL;
  modelica_metatype _discretes = NULL;
  modelica_metatype _states = NULL;
  modelica_metatype _set = NULL;
  modelica_metatype _condition = NULL;
  modelica_metatype _acc_condition = NULL;
  modelica_metatype _stmts = NULL;
  modelica_metatype _assigns = NULL;
  modelica_metatype _stmt = NULL;
  modelica_metatype _new_body = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta18;
  modelica_metatype tmpMeta19;
  modelica_metatype tmpMeta20;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta22;
  modelica_metatype tmpMeta23;
  modelica_metatype tmpMeta24;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta29;
  modelica_metatype tmpMeta30;
  modelica_metatype tmpMeta31;
  modelica_metatype tmpMeta32;
  modelica_metatype tmpMeta33;
  modelica_metatype tmpMeta34;
  modelica_metatype tmpMeta35;
  modelica_metatype tmpMeta36;
  modelica_metatype tmpMeta37;
  modelica_metatype tmpMeta41;
  modelica_metatype tmpMeta42;
  modelica_metatype tmpMeta43;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _bodies = tmpMeta1;
  _discr_map = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));
  _state_set = omc_UnorderedSet_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 13));
  _discr_marks = omc_UnorderedSet_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 13));
  // _flat_when has no default value.
  // _flat_new has no default value.
  // _discretes has no default value.
  // _states has no default value.
  // _set has no default value.
  // _condition has no default value.
  _acc_condition = _OMC_LIT97;
  // _stmts has no default value.
  // _assigns has no default value.
  // _stmt has no default value.
  // _new_body has no default value.
  _flat_when = omc_NBEquation_WhenEquationBody_collectForSplit(threadData, mmc_mk_some(_body), _discr_map, _state_set);

  _discretes = omc_UnorderedMap_keyList(threadData, _discr_map);

  _states = omc_UnorderedSet_toList(threadData, _state_set);

  {
    modelica_metatype _disc;
    for (tmpMeta2 = _discretes; !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _disc = MMC_CAR(tmpMeta2);
      if((!omc_UnorderedSet_contains(threadData, _disc, _discr_marks)))
      {
        _set = omc_UnorderedMap_getSafe(threadData, _disc, _discr_map, _OMC_LIT98);

        {
          modelica_metatype _marked;
          for (tmpMeta3 = omc_UnorderedSet_toList(threadData, _set); !listEmpty(tmpMeta3); tmpMeta3=MMC_CDR(tmpMeta3))
          {
            _marked = MMC_CAR(tmpMeta3);
            omc_UnorderedSet_add(threadData, _marked, _discr_marks);
          }
        }

        tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
        _flat_new = tmpMeta5;

        {
          modelica_metatype _tpl;
          for (tmpMeta6 = _flat_when; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
          {
            _tpl = MMC_CAR(tmpMeta6);
            /* Pattern-matching assignment */
            tmpMeta7 = _tpl;
            tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 1));
            tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
            _condition = tmpMeta8;
            _stmts = tmpMeta9;

            _assigns = omc_NBEquation_WhenEquationBody_getAssignments(threadData, _set, _stmts);

            if((!listEmpty(_assigns)))
            {
              _condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 0 /* false */);

              _acc_condition = _OMC_LIT97;

              tmpMeta11 = mmc_mk_box2(0, _condition, _assigns);
              tmpMeta10 = mmc_mk_cons(tmpMeta11, _flat_new);
              _flat_new = tmpMeta10;
            }
            else
            {
              _acc_condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 1 /* true */);
            }
          }
        }

        _new_body = omc_NBEquation_WhenEquationBody_fromFlatList(threadData, _flat_new, mmc_mk_none());

        if(isSome(_new_body))
        {
          tmpMeta13 = mmc_mk_cons(omc_Util_getOption(threadData, _new_body), _bodies);
          _bodies = tmpMeta13;
        }
        else
        {
          tmpMeta15 = stringAppend(_OMC_LIT99,omc_NFComponentRef_toString(threadData, _disc));
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT100);
          tmpMeta14 = mmc_mk_cons(tmpMeta16, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta14);
        }
      }
    }
  }

  {
    modelica_metatype _state;
    for (tmpMeta18 = _states; !listEmpty(tmpMeta18); tmpMeta18=MMC_CDR(tmpMeta18))
    {
      _state = MMC_CAR(tmpMeta18);
      tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
      _flat_new = tmpMeta19;

      {
        modelica_metatype _tpl;
        for (tmpMeta20 = _flat_when; !listEmpty(tmpMeta20); tmpMeta20=MMC_CDR(tmpMeta20))
        {
          _tpl = MMC_CAR(tmpMeta20);
          /* Pattern-matching assignment */
          tmpMeta21 = _tpl;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta21), 1));
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta21), 2));
          _condition = tmpMeta22;
          _stmts = tmpMeta23;

          _stmt = omc_NBEquation_WhenEquationBody_getFirstReinit(threadData, _state, _stmts);

          if(isSome(_stmt))
          {
            _condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 0 /* false */);

            _acc_condition = _OMC_LIT97;

            tmpMeta25 = mmc_mk_cons(omc_Util_getOption(threadData, _stmt), MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta26 = mmc_mk_box2(0, _condition, tmpMeta25);
            tmpMeta24 = mmc_mk_cons(tmpMeta26, _flat_new);
            _flat_new = tmpMeta24;
          }
          else
          {
            _acc_condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 1 /* true */);
          }
        }
      }

      _new_body = omc_NBEquation_WhenEquationBody_fromFlatList(threadData, _flat_new, mmc_mk_none());

      if(isSome(_new_body))
      {
        tmpMeta28 = mmc_mk_cons(omc_Util_getOption(threadData, _new_body), _bodies);
        _bodies = tmpMeta28;
      }
      else
      {
        tmpMeta30 = stringAppend(_OMC_LIT99,omc_NFComponentRef_toString(threadData, _state));
        tmpMeta31 = stringAppend(tmpMeta30,_OMC_LIT100);
        tmpMeta29 = mmc_mk_cons(tmpMeta31, MMC_REFSTRUCTLIT(mmc_nil));
        omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta29);
      }
    }
  }

  {
    modelica_metatype _tpl;
    for (tmpMeta33 = _flat_when; !listEmpty(tmpMeta33); tmpMeta33=MMC_CDR(tmpMeta33))
    {
      _tpl = MMC_CAR(tmpMeta33);
      /* Pattern-matching assignment */
      tmpMeta34 = _tpl;
      tmpMeta35 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta34), 1));
      tmpMeta36 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta34), 2));
      _condition = tmpMeta35;
      _stmts = tmpMeta36;

      {
        modelica_metatype __omcQ_24tmpVar13;
        modelica_metatype* tmp38;
        modelica_metatype tmpMeta39;
        modelica_metatype __omcQ_24tmpVar12;
        modelica_integer tmp40;
        modelica_metatype _stmt_loopVar = 0;
        modelica_metatype _stmt;
        _stmt_loopVar = _stmts;
        tmpMeta39 = MMC_REFSTRUCTLIT(mmc_nil);
        __omcQ_24tmpVar13 = tmpMeta39; /* defaultValue */
        tmp38 = &__omcQ_24tmpVar13;
        while(1) {
          tmp40 = 1;
          while (!listEmpty(_stmt_loopVar)) {
            _stmt = MMC_CAR(_stmt_loopVar);
            _stmt_loopVar = MMC_CDR(_stmt_loopVar);
            if ((!omc_NBEquation_WhenStatement_isAssignOrReinit(threadData, _stmt))) {
              tmp40--;
              break;
            }
          }
          if (tmp40 == 0) {
            __omcQ_24tmpVar12 = _stmt;
            *tmp38 = mmc_mk_cons(__omcQ_24tmpVar12,0);
            tmp38 = &MMC_CDR(*tmp38);
          } else if (tmp40 == 1) {
            break;
          } else {
            MMC_THROW_INTERNAL();
          }
        }
        *tmp38 = mmc_mk_nil();
        tmpMeta37 = __omcQ_24tmpVar13;
      }
      _stmts = tmpMeta37;

      if((!listEmpty(_stmts)))
      {
        _condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 0 /* false */);

        _acc_condition = _OMC_LIT97;

        tmpMeta42 = mmc_mk_box2(0, _condition, _stmts);
        tmpMeta41 = mmc_mk_cons(tmpMeta42, _flat_new);
        _flat_new = tmpMeta41;
      }
      else
      {
        _acc_condition = omc_NBEquation_WhenEquationBody_combineConditions(threadData, _acc_condition, _condition, 1 /* true */);
      }
    }
  }

  _bodies = listReverse(_bodies);
  _return: OMC_LABEL_UNUSED
  return _bodies;
}

static modelica_metatype closure1_NBEquation_WhenEquationBody_mapCondition(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_whenBody)
{
  modelica_fnptr funcExp = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype funcCrefOpt = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  modelica_fnptr mapFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),3));
  return boxptr_NBEquation_WhenEquationBody_mapCondition(thData, $in_whenBody, funcExp, funcCrefOpt, mapFunc);
}
DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_mapCondition(threadData_t *threadData, modelica_metatype __omcQ_24in_5FwhenBody, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _whenBody = NULL;
  modelica_metatype _condition = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _whenBody = __omcQ_24in_5FwhenBody;
  // _condition has no default value.
  _condition = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))), ((modelica_fnptr) _funcExp));

  if((!referenceEq(_condition, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))))))
  {
    tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(5));
    memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_whenBody), 5*sizeof(modelica_metatype));
    ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[2] = _condition;
    _whenBody = tmpMeta1;
  }

  tmpMeta3 = mmc_mk_box3(0, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
  tmpMeta2 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta2), MMC_UNTAGPTR(_whenBody), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta2))[4] = omc_Util_applyOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 4))), (modelica_fnptr) mmc_mk_box2(0,closure1_NBEquation_WhenEquationBody_mapCondition,tmpMeta3));
  _whenBody = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _whenBody;
}

static modelica_metatype closure2_NBEquation_WhenStatement_map(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_stmt)
{
  modelica_fnptr funcExp = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype funcCrefOpt = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  modelica_fnptr mapFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),3));
  return boxptr_NBEquation_WhenStatement_map(thData, $in_stmt, funcExp, funcCrefOpt, mapFunc);
}static modelica_metatype closure3_NBEquation_WhenEquationBody_map(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_whenBody)
{
  modelica_fnptr funcExp = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype funcCrefOpt = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  modelica_fnptr mapFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),3));
  return boxptr_NBEquation_WhenEquationBody_map(thData, $in_whenBody, funcExp, funcCrefOpt, mapFunc);
}
DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5FwhenBody, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _whenBody = NULL;
  modelica_metatype _condition = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _whenBody = __omcQ_24in_5FwhenBody;
  // _condition has no default value.
  _condition = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))), ((modelica_fnptr) _funcExp));

  if((!referenceEq(_condition, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 2))))))
  {
    tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(5));
    memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_whenBody), 5*sizeof(modelica_metatype));
    ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[2] = _condition;
    _whenBody = tmpMeta1;
  }

  tmpMeta3 = mmc_mk_box3(0, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
  tmpMeta2 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta2), MMC_UNTAGPTR(_whenBody), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta2))[3] = omc_List_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 3))), (modelica_fnptr) mmc_mk_box2(0,closure2_NBEquation_WhenStatement_map,tmpMeta3));
  _whenBody = tmpMeta2;

  tmpMeta5 = mmc_mk_box3(0, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
  tmpMeta4 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta4), MMC_UNTAGPTR(_whenBody), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta4))[4] = omc_Util_applyOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_whenBody), 4))), (modelica_fnptr) mmc_mk_box2(0,closure3_NBEquation_WhenEquationBody_map,tmpMeta5));
  _whenBody = tmpMeta4;
  _return: OMC_LABEL_UNUSED
  return _whenBody;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_toStatement(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _stmts = NULL;
  modelica_metatype _stmt = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _stmts has no default value.
  // _stmt has no default value.
  {
    modelica_metatype __omcQ_24tmpVar15;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar14;
    modelica_integer tmp4;
    modelica_metatype _st_loopVar = 0;
    modelica_metatype _st;
    _st_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar15 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar15;
    while(1) {
      tmp4 = 1;
      if (!listEmpty(_st_loopVar)) {
        _st = MMC_CAR(_st_loopVar);
        _st_loopVar = MMC_CDR(_st_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar14 = omc_NBEquation_WhenStatement_toStatement(threadData, _st);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar14,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar15;
  }
  tmpMeta5 = mmc_mk_box2(0, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))), tmpMeta1);
  _stmt = tmpMeta5;

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    tmpMeta6 = mmc_mk_cons(_stmt, omc_NBEquation_WhenEquationBody_toStatement(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))))));
    _stmts = tmpMeta6;
  }
  else
  {
    tmpMeta7 = mmc_mk_cons(_stmt, MMC_REFSTRUCTLIT(mmc_nil));
    _stmts = tmpMeta7;
  }
  _return: OMC_LABEL_UNUSED
  return _stmts;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_WhenEquationBody_getBodyAttributes_getConditions(threadData_t *threadData, modelica_metatype _cond)
{
  modelica_metatype _conditions = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _conditions has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _cond;
    {
      modelica_metatype _cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          _cref = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_cons(_cref, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar17;
            modelica_metatype* tmp9;
            modelica_metatype tmpMeta10;
            modelica_metatype __omcQ_24tmpVar16;
            modelica_integer tmp11;
            modelica_metatype _elem_loopVar = 0;
            modelica_integer tmp12;
            modelica_metatype _elem;
            _elem_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cond), 3)));
            tmp12 = 1;
            tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar17 = tmpMeta10; /* defaultValue */
            tmp9 = &__omcQ_24tmpVar17;
            while(1) {
              tmp11 = 1;
              if (tmp12 <= arrayLength(_elem_loopVar)) {
                _elem = arrayGet(_elem_loopVar, tmp12++);
                tmp11--;
              }
              if (tmp11 == 0) {
                __omcQ_24tmpVar16 = omc_NBEquation_WhenEquationBody_getBodyAttributes_getConditions(threadData, _elem);
                *tmp9 = mmc_mk_cons(__omcQ_24tmpVar16,0);
                tmp9 = &MMC_CDR(*tmp9);
              } else if (tmp11 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp9 = mmc_mk_nil();
            tmpMeta8 = __omcQ_24tmpVar17;
          }
          tmpMeta1 = omc_List_flatten(threadData, tmpMeta8);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,13,1) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!omc_NFCall_isNamed(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_cond), 2))), _OMC_LIT101)) goto tmp3_end;
          tmpMeta13 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta13;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          tmpMeta15 = stringAppend(_OMC_LIT102,omc_NFExpression_toString(threadData, _cond));
          tmpMeta14 = mmc_mk_cons(tmpMeta15, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta14);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _conditions = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _conditions;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_getBodyAttributes(threadData_t *threadData, modelica_metatype _body, modelica_metatype *out_when_stmts, modelica_metatype *out_else_when)
{
  modelica_metatype _conditions = NULL;
  modelica_metatype _when_stmts = NULL;
  modelica_metatype _else_when = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _conditions has no default value.
  _when_stmts = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
  _else_when = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)));
  _conditions = omc_NBEquation_WhenEquationBody_getBodyAttributes_getConditions(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))));
  _return: OMC_LABEL_UNUSED
  if (out_when_stmts) { *out_when_stmts = _when_stmts; }
  if (out_else_when) { *out_else_when = _else_when; }
  return _conditions;
}

DLLDirection
modelica_boolean omc_NBEquation_WhenEquationBody_isEqual(threadData_t *threadData, modelica_metatype _body1, modelica_metatype _body2)
{
  modelica_boolean _b;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  {
    modelica_metatype __omcQ_24tmpVar19;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar18;
    modelica_integer tmp4;
    modelica_metatype _b1_loopVar = 0;
    modelica_metatype _b1;
    modelica_metatype _b2_loopVar = 0;
    modelica_metatype _b2;
    _b1_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body1), 3)));
    _b2_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body2), 3)));
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar19 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar19;
    while(1) {
      tmp4 = 2;
      if (!listEmpty(_b1_loopVar)) {
        _b1 = MMC_CAR(_b1_loopVar);
        _b1_loopVar = MMC_CDR(_b1_loopVar);
        tmp4--;
      }if (!listEmpty(_b2_loopVar)) {
        _b2 = MMC_CAR(_b2_loopVar);
        _b2_loopVar = MMC_CDR(_b2_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar18 = mmc_mk_boolean(omc_NBEquation_WhenStatement_isEqual(threadData, _b1, _b2));
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar18,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 2) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar19;
  }
  _b = ((omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body2), 2)))) && omc_List_all(threadData, tmpMeta1, boxvar_Util_id)) && omc_Util_optionEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body2), 4))), boxvar_NBEquation_WhenEquationBody_isEqual));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_WhenEquationBody_isEqual(threadData_t *threadData, modelica_metatype _body1, modelica_metatype _body2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_WhenEquationBody_isEqual(threadData, _body1, _body2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_getType(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      modelica_metatype _stmt = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _stmt has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          _stmt = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_WhenStatement_getType(threadData, _stmt);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = stringAppend(_OMC_LIT103,omc_NBEquation_WhenEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
          tmpMeta8 = mmc_mk_cons(tmpMeta9, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta8);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}

DLLDirection
modelica_integer omc_NBEquation_WhenEquationBody_size(threadData_t *threadData, modelica_metatype _body, modelica_boolean _resize)
{
  modelica_integer _s;
  modelica_integer tmp1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_integer __omcQ_24tmpVar21;
    modelica_integer __omcQ_24tmpVar20;
    modelica_integer tmp2;
    modelica_metatype _stmt_loopVar = 0;
    modelica_metatype _stmt;
    _stmt_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    __omcQ_24tmpVar21 = ((modelica_integer) 0); /* defaultValue */
    while(1) {
      tmp2 = 1;
      if (!listEmpty(_stmt_loopVar)) {
        _stmt = MMC_CAR(_stmt_loopVar);
        _stmt_loopVar = MMC_CDR(_stmt_loopVar);
        tmp2--;
      }
      if (tmp2 == 0) {
        __omcQ_24tmpVar20 = omc_NBEquation_WhenStatement_size(threadData, _stmt, _resize);
        __omcQ_24tmpVar21 = __omcQ_24tmpVar21 + __omcQ_24tmpVar20;
      } else if (tmp2 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp1 = __omcQ_24tmpVar21;
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NBEquation_WhenEquationBody_size(threadData_t *threadData, modelica_metatype _body, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _s;
  modelica_integer tmp2;
  modelica_metatype out_s;
  tmp1 = mmc_unbox_integer(_resize);
  _s = omc_NBEquation_WhenEquationBody_size(threadData, _body, tmp1);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

DLLDirection
modelica_string omc_NBEquation_WhenEquationBody_toString(threadData_t *threadData, modelica_metatype _body, modelica_string _indent, modelica_string _elseStr, modelica_boolean _selfCall)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  _str = _elseStr;

  if((!_selfCall))
  {
    tmpMeta1 = stringAppend(_str,_indent);
    _str = tmpMeta1;
  }

  tmpMeta2 = stringAppend(_str,_OMC_LIT104);
  tmpMeta3 = stringAppend(tmpMeta2,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2)))));
  tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT105);
  _str = tmpMeta4;

  {
    modelica_metatype _stmt;
    for (tmpMeta5 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta5); tmpMeta5=MMC_CDR(tmpMeta5))
    {
      _stmt = MMC_CAR(tmpMeta5);
      tmpMeta6 = stringAppend(_indent,_OMC_LIT106);
      tmpMeta7 = stringAppend(_str,omc_NBEquation_WhenStatement_toString(threadData, _stmt, tmpMeta6));
      tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT22);
      _str = tmpMeta8;
    }
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    tmpMeta10 = stringAppend(_indent,_OMC_LIT107);
    tmpMeta11 = stringAppend(_str,omc_NBEquation_WhenEquationBody_toString(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))), _indent, tmpMeta10, 1 /* true */));
    _str = tmpMeta11;
  }

  if((!_selfCall))
  {
    tmpMeta12 = stringAppend(_str,_indent);
    tmpMeta13 = stringAppend(tmpMeta12,_OMC_LIT108);
    _str = tmpMeta13;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}
modelica_metatype boxptr_NBEquation_WhenEquationBody_toString(threadData_t *threadData, modelica_metatype _body, modelica_metatype _indent, modelica_metatype _elseStr, modelica_metatype _selfCall)
{
  modelica_integer tmp1;
  modelica_string _str = NULL;
  tmp1 = mmc_unbox_integer(_selfCall);
  _str = omc_NBEquation_WhenEquationBody_toString(threadData, _body, _indent, _elseStr, tmp1);
  /* skip box _str; String */
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_WhenEquationBody_fromFlatList(threadData_t *threadData, modelica_metatype _flat_list, modelica_metatype __omcQ_24in_5Fbody)
{
  modelica_metatype _body = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _body = __omcQ_24in_5Fbody;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _flat_list;
    {
      modelica_metatype _condition = NULL;
      modelica_metatype _stmts = NULL;
      modelica_metatype _tail = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _condition has no default value.
      // _stmts has no default value.
      // _tail has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          _condition = tmpMeta8;
          _stmts = tmpMeta9;
          _tail = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_box4(3, &NBEquation_WhenEquationBody_WHEN__EQUATION__BODY__desc, _condition, _stmts, _body);
          /* Tail recursive call */
          _flat_list = _tail;
          __omcQ_24in_5Fbody = mmc_mk_some(tmpMeta10);
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _body = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _body;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_splitCollect(threadData_t *threadData, modelica_metatype _body, modelica_metatype __omcQ_24in_5Fconditions, modelica_metatype __omcQ_24in_5Fthen_5Feqns, modelica_metatype *out_then_eqns)
{
  modelica_metatype _conditions = NULL;
  modelica_metatype _then_eqns = NULL;
  modelica_integer _i;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _conditions = __omcQ_24in_5Fconditions;
  _then_eqns = __omcQ_24in_5Fthen_5Feqns;
  _i = ((modelica_integer) 1);
  tmpMeta1 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))), _conditions);
  _conditions = tmpMeta1;

  {
    modelica_metatype _eqn;
    for (tmpMeta2 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _eqn = MMC_CAR(tmpMeta2);
      tmpMeta3 = mmc_mk_cons(_eqn, arrayGet(_then_eqns,_i) /* DAE.ASUB */);
      arrayUpdate(_then_eqns,_i,tmpMeta3);

      _i = ((modelica_integer) 1) + _i;
    }
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    /* Tail recursive call */
    _body = omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))));
    __omcQ_24in_5Fconditions = _conditions;
    __omcQ_24in_5Fthen_5Feqns = _then_eqns;
    goto _tailrecursive;
    /* TODO: Make sure any eventual dead code below is never generated */
    ;
  }
  _return: OMC_LABEL_UNUSED
  if (out_then_eqns) { *out_then_eqns = _then_eqns; }
  return _conditions;
}

PROTECTED_FUNCTION_STATIC modelica_boolean omc_NBEquation_IfEquationBody_sortForSplit_compareLHS(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = (omc_NFExpression_compare(threadData, omc_NBEquation_Equation_getLHS(threadData, omc_Pointer_access(threadData, _eqn1)), omc_NBEquation_Equation_getLHS(threadData, omc_Pointer_access(threadData, _eqn2))) > ((modelica_integer) 0));
  _return: OMC_LABEL_UNUSED
  return _b;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_IfEquationBody_sortForSplit_compareLHS(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_IfEquationBody_sortForSplit_compareLHS(threadData, _eqn1, _eqn2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_sortForSplit(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fbody)
{
  modelica_metatype _body = NULL;
  modelica_metatype _discretes = NULL;
  modelica_metatype _continuous = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _body = __omcQ_24in_5Fbody;
  // _discretes has no default value.
  // _continuous has no default value.
  _discretes = omc_List_splitOnTrue(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))), boxvar_NBEquation_Equation_isDiscrete ,&_continuous);

  _discretes = omc_List_sort(threadData, _discretes, boxvar_NBEquation_IfEquationBody_sortForSplit_compareLHS);

  _continuous = omc_List_sort(threadData, _continuous, boxvar_NBEquation_IfEquationBody_sortForSplit_compareLHS);

  tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_body), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[3] = listAppend(_discretes, _continuous);
  _body = tmpMeta1;

  tmpMeta2 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta2), MMC_UNTAGPTR(_body), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta2))[4] = omc_Util_applyOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))), boxvar_NBEquation_IfEquationBody_sortForSplit);
  _body = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _body;
}

DLLDirection
modelica_boolean omc_NBEquation_IfEquationBody_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _body)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      modelica_metatype _eqn_ptr = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _eqn_ptr has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          _eqn_ptr = tmpMeta6;
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_Equation_isRecordOrTupleEquation(threadData, _eqn_ptr);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_1);
          tmpMeta9 = MMC_CDR(tmp4_1);
          if (listEmpty(tmpMeta9)) goto tmp3_end;
          tmpMeta10 = MMC_CAR(tmpMeta9);
          tmpMeta11 = MMC_CDR(tmpMeta9);
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _body)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_IfEquationBody_isRecordOrTupleEquation(threadData, _body);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_simplify(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fbody)
{
  modelica_metatype _body = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _body = __omcQ_24in_5Fbody;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _body;
    {
      modelica_metatype _b = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _b has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (optionNone(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          _b = tmpMeta6;
          /* Pattern matching succeeded */
          if(omc_NFExpression_isTrue(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 2)))))
          {
            tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[2] = _OMC_LIT109;
            _b = tmpMeta7;

            tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[4] = mmc_mk_none();
            _b = tmpMeta8;
          }
          else
          {
            tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_b), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = omc_NBEquation_IfEquationBody_simplify(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4))));
            _b = tmpMeta9;
          }

          if(omc_NFExpression_isFalse(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 2)))))
          {
            _body = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_b), 4)));
          }
          else
          {
            _body = mmc_mk_some(_b);
          }
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _body = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _body;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_split(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _bodies = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _conditions = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _then_eqns = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype _condition = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype _tmp = NULL;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_integer tmp12;
  modelica_integer tmp13;
  modelica_integer tmp14;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _bodies = tmpMeta1;
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _conditions = tmpMeta2;
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _then_eqns = arrayCreate(listLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)))), tmpMeta3);
  // _condition has no default value.
  // _eqn has no default value.
  // _tmp has no default value.
  _conditions = omc_NBEquation_IfEquationBody_splitCollect(threadData, omc_NBEquation_IfEquationBody_sortForSplit(threadData, _body), _conditions, _then_eqns ,&_then_eqns);

  tmp12 = ((modelica_integer) 1); tmp13 = 1; tmp14 = arrayLength(_then_eqns);
  if(!(((tmp13 > 0) && (tmp12 > tmp14)) || ((tmp13 < 0) && (tmp12 < tmp14))))
  {
    modelica_integer _i;
    for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp12, tmp14); _i += tmp13)
    {
      _tmp = mmc_mk_none();

      {
        modelica_metatype _tpl;
        for (tmpMeta4 = omc_List_zip(threadData, _conditions, arrayGet(_then_eqns,_i) /* DAE.ASUB */); !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
        {
          _tpl = MMC_CAR(tmpMeta4);
          /* Pattern-matching assignment */
          tmpMeta5 = _tpl;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 1));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 2));
          _condition = tmpMeta6;
          _eqn = tmpMeta7;

          tmpMeta8 = mmc_mk_cons(_eqn, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta9 = mmc_mk_box4(3, &NBEquation_IfEquationBody_IF__EQUATION__BODY__desc, _condition, tmpMeta8, _tmp);
          _tmp = mmc_mk_some(tmpMeta9);
        }
      }

      tmpMeta11 = mmc_mk_cons(omc_Util_getOption(threadData, _tmp), _bodies);
      _bodies = tmpMeta11;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _bodies;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_getRHS(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _exp = NULL;
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _new_exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _exp has no default value.
  // _eqn_ptr has no default value.
  // _new_exp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          _eqn_ptr = tmpMeta6;
          /* Pattern matching succeeded */
          _new_exp = omc_NBEquation_Equation_getRHS(threadData, omc_Pointer_access(threadData, _eqn_ptr));

          if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
          {
            tmpMeta8 = mmc_mk_box5(25, &NFExpression_IF__desc, omc_NFExpression_typeOf(threadData, _new_exp), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))), _new_exp, omc_NBEquation_IfEquationBody_getRHS(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))))));
            _new_exp = tmpMeta8;
          }
          tmpMeta1 = _new_exp;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = stringAppend(_OMC_LIT110,omc_NBEquation_IfEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_getLHS(threadData_t *threadData, modelica_metatype _body, modelica_metatype __omcQ_24in_5Fexp, modelica_boolean *out_success)
{
  modelica_metatype _exp = NULL;
  modelica_boolean _success;
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _new_exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _exp = __omcQ_24in_5Fexp;
  _success = 1 /* true */;
  // _eqn_ptr has no default value.
  // _new_exp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          _eqn_ptr = tmpMeta6;
          /* Pattern matching succeeded */
          _new_exp = omc_NBEquation_Equation_getLHS(threadData, omc_Pointer_access(threadData, _eqn_ptr));

          if((omc_NFExpression_isEnd(threadData, _exp) || omc_NFExpression_isEqual(threadData, _exp, _new_exp)))
          {
            if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
            {
              _new_exp = omc_NBEquation_IfEquationBody_getLHS(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))), _new_exp ,&_success);
            }
          }
          else
          {
            if(omc_Flags_isSet(threadData, _OMC_LIT115))
            {
              tmpMeta8 = stringAppend(_OMC_LIT111,omc_NBEquation_IfEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
              omc_Error_addCompilerWarning(threadData, tmpMeta8);
            }

            _success = 0 /* false */;
          }
          tmpMeta1 = _new_exp;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = stringAppend(_OMC_LIT116,omc_NBEquation_IfEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  if (out_success) { *out_success = _success; }
  return _exp;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_getLHS(threadData_t *threadData, modelica_metatype _body, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype *out_success)
{
  modelica_boolean _success;
  modelica_metatype _exp = NULL;
  _exp = omc_NBEquation_IfEquationBody_getLHS(threadData, _body, __omcQ_24in_5Fexp, &_success);
  /* skip box _exp; NFExpression */
  if (out_success) { *out_success = mmc_mk_icon(_success); }
  return _exp;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_inline(threadData_t *threadData, modelica_metatype _body, modelica_metatype __omcQ_24in_5Feqn)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _lhs = NULL;
  modelica_metatype _rhs = NULL;
  modelica_boolean _success;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  // _lhs has no default value.
  // _rhs has no default value.
  // _success has no default value.
  _lhs = omc_NBEquation_IfEquationBody_getLHS(threadData, _body, _OMC_LIT109 ,&_success);

  if(_success)
  {
    _rhs = omc_NFSimplifyExp_simplify(threadData, omc_NBEquation_IfEquationBody_getRHS(threadData, _body), 0 /* false */);

    _eqn = omc_NBEquation_Equation_makeAssignmentUpdate(threadData, _eqn, _lhs, _rhs, omc_NBEquation_Equation_getForIterator(threadData, _eqn), omc_NBEquation_Equation_getAttributes(threadData, _eqn));
  }
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

static modelica_metatype closure4_NBEquation_IfEquationBody_createResidual(threadData_t *thData, modelica_metatype closure, modelica_metatype body)
{
  modelica_metatype res = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_IfEquationBody_createResidual(thData, body, res);
}
DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_createResidual(threadData_t *threadData, modelica_metatype _body, modelica_metatype _res)
{
  modelica_metatype _body_res = NULL;
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _body_res has no default value.
  // _eqn_ptr has no default value.
  // _eqn has no default value.
  // _exp has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = mmc_mk_box1(0, _res);
  tmpMeta3 = mmc_mk_box4(3, &NBEquation_IfEquationBody_IF__EQUATION__BODY__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))), tmpMeta1, omc_Util_applyOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))), (modelica_fnptr) mmc_mk_box2(0,closure4_NBEquation_IfEquationBody_createResidual,tmpMeta2)));
  _body_res = tmpMeta3;

  { /* match expression */
    modelica_metatype tmp7_1;
    tmp7_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      volatile mmc_switch_type tmp7;
      int tmp8;
      tmp7 = 0;
      for (; tmp7 < 2; tmp7++) {
        switch (MMC_SWITCH_CAST(tmp7)) {
        case 0: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          if (listEmpty(tmp7_1)) goto tmp6_end;
          tmpMeta9 = MMC_CAR(tmp7_1);
          tmpMeta10 = MMC_CDR(tmp7_1);
          if (!listEmpty(tmpMeta10)) goto tmp6_end;
          _eqn_ptr = tmpMeta9;
          /* Pattern matching succeeded */
          _eqn = omc_Pointer_access(threadData, _eqn_ptr);

          _exp = omc_NBEquation_Equation_getResidualExp(threadData, _eqn);

          _eqn = omc_NBEquation_Equation_setLHS(threadData, _eqn, omc_NFExpression_fromCref(threadData, _res, 0 /* false */));

          _eqn = omc_NBEquation_Equation_setRHS(threadData, _eqn, _exp);

          tmpMeta12 = mmc_mk_cons(omc_Pointer_create(threadData, _eqn), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body_res), 3))));
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_body_res), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[3] = tmpMeta12;
          _body_res = tmpMeta11;
          tmpMeta4 = _body_res;
          goto tmp6_done;
        }
        case 1: {
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          tmpMeta14 = stringAppend(_OMC_LIT117,omc_NBEquation_IfEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
          tmpMeta13 = mmc_mk_cons(tmpMeta14, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta13);
          goto goto_5;
          goto tmp6_done;
        }
        }
        goto tmp6_end;
        tmp6_end: ;
      }
      goto goto_5;
      goto_5:;
      MMC_THROW_INTERNAL();
      goto tmp6_done;
      tmp6_done:;
    }
  }
  _body_res = tmpMeta4;
  _return: OMC_LABEL_UNUSED
  return _body_res;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_toStatement(threadData_t *threadData, modelica_metatype _body)
{
  modelica_metatype _stmts = NULL;
  modelica_metatype _stmt = NULL;
  modelica_metatype _condition = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _stmts has no default value.
  // _stmt has no default value.
  _condition = (omc_NFExpression_isEnd(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))))?_OMC_LIT118:(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))));
  {
    modelica_metatype __omcQ_24tmpVar23;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar22;
    modelica_integer tmp4;
    modelica_metatype _eqn_loopVar = 0;
    modelica_metatype _eqn;
    _eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar23 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar23;
    while(1) {
      tmp4 = 1;
      if (!listEmpty(_eqn_loopVar)) {
        _eqn = MMC_CAR(_eqn_loopVar);
        _eqn_loopVar = MMC_CDR(_eqn_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar22 = omc_NBEquation_Equation_toStatement(threadData, omc_Pointer_access(threadData, _eqn));
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar22,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar23;
  }
  tmpMeta5 = mmc_mk_box2(0, _condition, omc_List_flatten(threadData, tmpMeta1));
  _stmt = tmpMeta5;

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    tmpMeta6 = mmc_mk_cons(_stmt, omc_NBEquation_IfEquationBody_toStatement(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))))));
    _stmts = tmpMeta6;
  }
  else
  {
    tmpMeta7 = mmc_mk_cons(_stmt, MMC_REFSTRUCTLIT(mmc_nil));
    _stmts = tmpMeta7;
  }
  _return: OMC_LABEL_UNUSED
  return _stmts;
}

DLLDirection
void omc_NBEquation_IfEquationBody_createNames(threadData_t *threadData, modelica_metatype _body, modelica_metatype _idx, modelica_string _context)
{
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_metatype _eqn;
    for (tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta1); tmpMeta1=MMC_CDR(tmpMeta1))
    {
      _eqn = MMC_CAR(tmpMeta1);
      omc_NBEquation_Equation_createName(threadData, _eqn, _idx, _context);
    }
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    /* Tail recursive call */
    _body = omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4))));
    goto _tailrecursive;
    /* TODO: Make sure any eventual dead code below is never generated */
    ;
  }
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_boolean omc_NBEquation_IfEquationBody_isEqual(threadData_t *threadData, modelica_metatype _body1, modelica_metatype _body2)
{
  modelica_boolean _b;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  {
    modelica_metatype __omcQ_24tmpVar25;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar24;
    modelica_integer tmp4;
    modelica_metatype _b1_loopVar = 0;
    modelica_metatype _b1;
    modelica_metatype _b2_loopVar = 0;
    modelica_metatype _b2;
    _b1_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body1), 3)));
    _b2_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body2), 3)));
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar25 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar25;
    while(1) {
      tmp4 = 2;
      if (!listEmpty(_b1_loopVar)) {
        _b1 = MMC_CAR(_b1_loopVar);
        _b1_loopVar = MMC_CDR(_b1_loopVar);
        tmp4--;
      }if (!listEmpty(_b2_loopVar)) {
        _b2 = MMC_CAR(_b2_loopVar);
        _b2_loopVar = MMC_CDR(_b2_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar24 = mmc_mk_boolean(omc_NBEquation_Equation_isEqualPtr(threadData, _b1, _b2));
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar24,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 2) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar25;
  }
  _b = (omc_List_all(threadData, tmpMeta1, boxvar_Util_id) && omc_Util_optionEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body2), 4))), boxvar_NBEquation_IfEquationBody_isEqual));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_isEqual(threadData_t *threadData, modelica_metatype _body1, modelica_metatype _body2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_IfEquationBody_isEqual(threadData, _body1, _body2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NBEquation_IfEquationBody_size(threadData_t *threadData, modelica_metatype _body, modelica_boolean _resize)
{
  modelica_integer _size;
  modelica_integer tmp1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_integer __omcQ_24tmpVar27;
    modelica_integer __omcQ_24tmpVar26;
    modelica_integer tmp2;
    modelica_metatype _eqn_loopVar = 0;
    modelica_metatype _eqn;
    _eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    __omcQ_24tmpVar27 = ((modelica_integer) 0); /* defaultValue */
    while(1) {
      tmp2 = 1;
      if (!listEmpty(_eqn_loopVar)) {
        _eqn = MMC_CAR(_eqn_loopVar);
        _eqn_loopVar = MMC_CDR(_eqn_loopVar);
        tmp2--;
      }
      if (tmp2 == 0) {
        __omcQ_24tmpVar26 = omc_NBEquation_Equation_size(threadData, _eqn, _resize);
        __omcQ_24tmpVar27 = __omcQ_24tmpVar27 + __omcQ_24tmpVar26;
      } else if (tmp2 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp1 = __omcQ_24tmpVar27;
  }
  _size = tmp1;
  _return: OMC_LABEL_UNUSED
  return _size;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_size(threadData_t *threadData, modelica_metatype _body, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _size;
  modelica_integer tmp2;
  modelica_metatype out_size;
  tmp1 = mmc_unbox_integer(_resize);
  _size = omc_NBEquation_IfEquationBody_size(threadData, _body, tmp1);
  out_size = mmc_mk_icon(_size);
  return out_size;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_mapEqnExpCref(threadData_t *threadData, modelica_metatype __omcQ_24in_5FifBody, modelica_fnptr _func, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _ifBody = NULL;
  modelica_metatype _condition = NULL;
  modelica_metatype _else_if = NULL;
  modelica_metatype _old_else_if = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _ifBody = __omcQ_24in_5FifBody;
  // _condition has no default value.
  // _else_if has no default value.
  // _old_else_if has no default value.
  _condition = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 2))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 2))), ((modelica_fnptr) _funcExp));

  if((!referenceEq(_condition, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 2))))))
  {
    tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(5));
    memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_ifBody), 5*sizeof(modelica_metatype));
    ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[2] = _condition;
    _ifBody = tmpMeta1;
  }

  tmpMeta2 = MMC_TAGPTR(mmc_alloc_words(5));
  memcpy(MMC_UNTAGPTR(tmpMeta2), MMC_UNTAGPTR(_ifBody), 5*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta2))[3] = omc_List_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 3))), ((modelica_fnptr) _func));
  _ifBody = tmpMeta2;

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 4)))))
  {
    _old_else_if = omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_ifBody), 4))));

    _else_if = omc_NBEquation_IfEquationBody_mapEqnExpCref(threadData, _old_else_if, ((modelica_fnptr) _func), ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));

    if((!referenceEq(_else_if, _old_else_if)))
    {
      tmpMeta3 = MMC_TAGPTR(mmc_alloc_words(5));
      memcpy(MMC_UNTAGPTR(tmpMeta3), MMC_UNTAGPTR(_ifBody), 5*sizeof(modelica_metatype));
      ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta3))[4] = mmc_mk_some(_else_if);
      _ifBody = tmpMeta3;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _ifBody;
}

static modelica_metatype closure6_NBEquation_Equation_map(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_eq)
{
  modelica_fnptr funcExp = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype funcCrefOpt = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  modelica_fnptr mapFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),3));
  return boxptr_NBEquation_Equation_map(thData, $in_eq, funcExp, funcCrefOpt, mapFunc);
}static modelica_metatype closure5_Pointer_apply(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_mutable)
{
  modelica_fnptr func = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_Pointer_apply(thData, $in_mutable, func);
}
DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5FifBody, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _ifBody = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _ifBody = __omcQ_24in_5FifBody;
  tmpMeta2 = mmc_mk_box3(0, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
  tmpMeta1 = mmc_mk_box1(0, (modelica_fnptr) mmc_mk_box2(0,closure6_NBEquation_Equation_map,tmpMeta2));
  _ifBody = omc_NBEquation_IfEquationBody_mapEqnExpCref(threadData, _ifBody, (modelica_fnptr) mmc_mk_box2(0,closure5_Pointer_apply,tmpMeta1), ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
  _return: OMC_LABEL_UNUSED
  return _ifBody;
}

DLLDirection
modelica_string omc_NBEquation_IfEquationBody_toString(threadData_t *threadData, modelica_metatype _body, modelica_string _indent, modelica_string _elseStr, modelica_boolean _selfCall)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _str has no default value.
  _str = _elseStr;

  if((!_selfCall))
  {
    tmpMeta1 = stringAppend(_str,_indent);
    _str = tmpMeta1;
  }

  if((!omc_NFExpression_isEnd(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2))))))
  {
    tmpMeta2 = stringAppend(_str,_OMC_LIT119);
    tmpMeta3 = stringAppend(tmpMeta2,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 2)))));
    tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT105);
    _str = tmpMeta4;
  }
  else
  {
    tmpMeta5 = stringAppend(_str,_OMC_LIT22);
    _str = tmpMeta5;
  }

  {
    modelica_metatype _eqn;
    for (tmpMeta6 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3))); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
    {
      _eqn = MMC_CAR(tmpMeta6);
      tmpMeta7 = stringAppend(_indent,_OMC_LIT106);
      tmpMeta8 = stringAppend(_str,omc_NBEquation_Equation_toString(threadData, omc_Pointer_access(threadData, _eqn), tmpMeta7));
      tmpMeta9 = stringAppend(tmpMeta8,_OMC_LIT22);
      _str = tmpMeta9;
    }
  }

  if(isSome((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))))
  {
    tmpMeta11 = stringAppend(_indent,_OMC_LIT107);
    tmpMeta12 = stringAppend(_str,omc_NBEquation_IfEquationBody_toString(threadData, omc_Util_getOption(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 4)))), _indent, tmpMeta11, 1 /* true */));
    _str = tmpMeta12;
  }

  if((!_selfCall))
  {
    tmpMeta13 = stringAppend(_str,_indent);
    tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT120);
    _str = tmpMeta14;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_toString(threadData_t *threadData, modelica_metatype _body, modelica_metatype _indent, modelica_metatype _elseStr, modelica_metatype _selfCall)
{
  modelica_integer tmp1;
  modelica_string _str = NULL;
  tmp1 = mmc_unbox_integer(_selfCall);
  _str = omc_NBEquation_IfEquationBody_toString(threadData, _body, _indent, _elseStr, tmp1);
  /* skip box _str; String */
  return _str;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_IfEquationBody_makeIfEquationEqn(threadData_t *threadData, modelica_metatype _body, modelica_metatype _iter, modelica_metatype _source, modelica_metatype _attr)
{
  modelica_metatype _e = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _e has no default value.
  tmpMeta1 = mmc_mk_box5(7, &NBEquation_Equation_IF__EQUATION__desc, mmc_mk_integer(omc_NBEquation_IfEquationBody_size(threadData, _body, 0 /* false */)), _body, _source, _attr);
  _e = tmpMeta1;

  if((!omc_NBEquation_Iterator_isEmpty(threadData, _iter)))
  {
    tmpMeta2 = mmc_mk_cons(_e, MMC_REFSTRUCTLIT(mmc_nil));
    tmpMeta3 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, mmc_mk_integer((omc_NBEquation_IfEquationBody_size(threadData, _body, 0 /* false */)) * (omc_NBEquation_Iterator_size(threadData, _iter, 0 /* false */))), _iter, tmpMeta2, _source, _attr);
    _e = tmpMeta3;

    _e = omc_NBInline_inlineForEquation(threadData, _e);
  }
  _return: OMC_LABEL_UNUSED
  return _e;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_makeIfEquation(threadData_t *threadData, modelica_metatype _body, modelica_metatype _idx, modelica_string _str, modelica_metatype _iter, modelica_metatype _source, modelica_metatype _attr)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _e = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eq has no default value.
  // _e has no default value.
  _e = omc_NBEquation_IfEquationBody_makeIfEquationEqn(threadData, _body, _iter, _source, _attr);

  _eq = omc_Pointer_create(threadData, _e);

  omc_NBEquation_Equation_createName(threadData, _eq, _idx, _str);
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_IfEquationBody_toEquation(threadData_t *threadData, modelica_metatype _body, modelica_metatype _source, modelica_boolean _init)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  // _attr has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_body), 3)));
    {
      modelica_metatype _then_eqn = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _then_eqn has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_1)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_1);
          tmpMeta7 = MMC_CDR(tmp4_1);
          if (!listEmpty(tmpMeta7)) goto tmp3_end;
          _then_eqn = tmpMeta6;
          /* Pattern matching succeeded */
          tmpMeta1 = (omc_NBEquation_Equation_isDiscrete(threadData, _then_eqn)?omc_NBEquation_default(threadData, 2, _init, mmc_mk_none()):omc_NBEquation_default(threadData, 1, _init, mmc_mk_none()));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          if(omc_Flags_isSet(threadData, _OMC_LIT115))
          {
            tmpMeta9 = stringAppend(_OMC_LIT125,omc_NBEquation_IfEquationBody_toString(threadData, _body, _OMC_LIT6, _OMC_LIT6, 0 /* false */));
            tmpMeta8 = mmc_mk_cons(tmpMeta9, MMC_REFSTRUCTLIT(mmc_nil));
            omc_Error_addMessage(threadData, _OMC_LIT124, tmpMeta8);
          }
          tmpMeta1 = omc_NBEquation_default(threadData, 1, _init, mmc_mk_none());
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _attr = tmpMeta1;

  tmpMeta10 = mmc_mk_box5(7, &NBEquation_Equation_IF__EQUATION__desc, mmc_mk_integer(omc_NBEquation_IfEquationBody_size(threadData, _body, 0 /* false */)), _body, _source, _attr);
  _eqn = omc_Pointer_create(threadData, tmpMeta10);
  _return: OMC_LABEL_UNUSED
  return _eqn;
}
modelica_metatype boxptr_NBEquation_IfEquationBody_toEquation(threadData_t *threadData, modelica_metatype _body, modelica_metatype _source, modelica_metatype _init)
{
  modelica_integer tmp1;
  modelica_metatype _eqn = NULL;
  tmp1 = mmc_unbox_integer(_init);
  _eqn = omc_NBEquation_IfEquationBody_toEquation(threadData, _body, _source, tmp1);
  /* skip box _eqn; Pointer<NBEquation.Equation> */
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_toStatement(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _stmts = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _stmts = tmpMeta1;
  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _eqn;
    {
      modelica_metatype _iter_lst = NULL;
      modelica_metatype _range_lst = NULL;
      modelica_metatype _iter = NULL;
      modelica_metatype _lhs_rec = NULL;
      modelica_metatype _rhs_rec = NULL;
      modelica_metatype _range = NULL;
      modelica_metatype _body = NULL;
      modelica_metatype _lhs = NULL;
      modelica_metatype _rhs = NULL;
      modelica_metatype _lhs_lst = NULL;
      modelica_metatype _rhs_lst = NULL;
      volatile mmc_switch_type tmp5;
      int tmp6;
      // _iter_lst has no default value.
      // _range_lst has no default value.
      // _iter has no default value.
      // _lhs_rec has no default value.
      // _rhs_rec has no default value.
      // _range has no default value.
      // _body has no default value.
      // _lhs has no default value.
      // _rhs has no default value.
      // _lhs_lst has no default value.
      // _rhs_lst has no default value.
      tmp5 = 0;
      for (; tmp5 < 8; tmp5++) {
        switch (MMC_SWITCH_CAST(tmp5)) {
        case 0: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,0,5) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
          tmpMeta7 = mmc_mk_cons(tmpMeta8, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta2 = tmpMeta7;
          goto tmp4_done;
        }
        case 1: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,1,6) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta2 = tmpMeta9;
          goto tmp4_done;
        }
        case 2: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,2,6) == 0) goto tmp4_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp5_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,6,2) == 0) goto tmp4_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 3));
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp5_1), 4));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta13,6,2) == 0) goto tmp4_end;
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta13), 3));
          
          _lhs_rec = tmpMeta12;
          _rhs_rec = tmpMeta14;
          /* Pattern matching succeeded */
          _lhs_lst = omc_NBVariable_getRecordChildren(threadData, omc_NBVariable_getVarPointer(threadData, _lhs_rec, _OMC_LIT126));

          _rhs_lst = omc_NBVariable_getRecordChildren(threadData, omc_NBVariable_getVarPointer(threadData, _rhs_rec, _OMC_LIT127));

          if(((omc_List_compareLength(threadData, _lhs_lst, _rhs_lst) == ((modelica_integer) 0)) && (!omc_NFType_isExternalObject(threadData, omc_NFType_arrayElementType(threadData, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))))))))
          {
            {
              modelica_metatype _tpl;
              for (tmpMeta15 = omc_List_zip(threadData, _lhs_lst, _rhs_lst); !listEmpty(tmpMeta15); tmpMeta15=MMC_CDR(tmpMeta15))
              {
                _tpl = MMC_CAR(tmpMeta15);
                /* Pattern-matching assignment */
                tmpMeta16 = _tpl;
                tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta16), 1));
                tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta16), 2));
                _lhs = tmpMeta17;
                _rhs = tmpMeta18;

                tmpMeta20 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, omc_NFExpression_fromCref(threadData, omc_NBVariable_getVarName(threadData, _lhs), 0 /* false */), omc_NFExpression_fromCref(threadData, omc_NBVariable_getVarName(threadData, _rhs), 0 /* false */), omc_NFVariable_typeOf(threadData, omc_Pointer_access(threadData, _lhs)), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
                tmpMeta19 = mmc_mk_cons(tmpMeta20, _stmts);
                _stmts = tmpMeta19;
              }
            }
          }
          else
          {
            tmpMeta23 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
            tmpMeta22 = mmc_mk_cons(tmpMeta23, MMC_REFSTRUCTLIT(mmc_nil));
            _stmts = tmpMeta22;
          }
          tmpMeta2 = _stmts;
          goto tmp4_done;
        }
        case 3: {
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,2,6) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta25 = mmc_mk_box5(3, &NFStatement_ASSIGNMENT__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
          tmpMeta24 = mmc_mk_cons(tmpMeta25, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta2 = tmpMeta24;
          goto tmp4_done;
        }
        case 4: {
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,5,5) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          _iter_lst = omc_NBEquation_Iterator_getFrames(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))) ,&_range_lst, NULL);

          {
            modelica_metatype __omcQ_24tmpVar33;
            modelica_metatype* tmp27;
            modelica_metatype tmpMeta28;
            modelica_metatype __omcQ_24tmpVar32;
            modelica_integer tmp29;
            modelica_metatype _body_eqn_loopVar = 0;
            modelica_metatype _body_eqn;
            _body_eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));
            tmpMeta28 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar33 = tmpMeta28; /* defaultValue */
            tmp27 = &__omcQ_24tmpVar33;
            while(1) {
              tmp29 = 1;
              if (!listEmpty(_body_eqn_loopVar)) {
                _body_eqn = MMC_CAR(_body_eqn_loopVar);
                _body_eqn_loopVar = MMC_CDR(_body_eqn_loopVar);
                tmp29--;
              }
              if (tmp29 == 0) {
                __omcQ_24tmpVar32 = omc_NBEquation_Equation_toStatement(threadData, _body_eqn);
                *tmp27 = mmc_mk_cons(__omcQ_24tmpVar32,0);
                tmp27 = &MMC_CDR(*tmp27);
              } else if (tmp29 == 1) {
                break;
              } else {
                goto goto_3;
              }
            }
            *tmp27 = mmc_mk_nil();
            tmpMeta26 = __omcQ_24tmpVar33;
          }
          _body = omc_List_flatten(threadData, tmpMeta26);

          {
            modelica_metatype _tpl;
            for (tmpMeta30 = listReverse(omc_List_zip(threadData, _iter_lst, _range_lst)); !listEmpty(tmpMeta30); tmpMeta30=MMC_CDR(tmpMeta30))
            {
              _tpl = MMC_CAR(tmpMeta30);
              /* Pattern-matching assignment */
              tmpMeta31 = _tpl;
              tmpMeta32 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta31), 1));
              tmpMeta33 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta31), 2));
              _iter = tmpMeta32;
              _range = tmpMeta33;

              tmpMeta35 = mmc_mk_box6(5, &NFStatement_FOR__desc, omc_NFComponentRef_node(threadData, _iter), mmc_mk_some(_range), _body, _OMC_LIT128, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));
              tmpMeta34 = mmc_mk_cons(tmpMeta35, MMC_REFSTRUCTLIT(mmc_nil));
              _body = tmpMeta34;
            }
          }
          tmpMeta2 = _body;
          goto tmp4_done;
        }
        case 5: {
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,4,4) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta38 = mmc_mk_box3(6, &NFStatement_IF__desc, omc_NBEquation_IfEquationBody_toStatement(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))));
          tmpMeta37 = mmc_mk_cons(tmpMeta38, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta2 = tmpMeta37;
          goto tmp4_done;
        }
        case 6: {
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,6,4) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta40 = mmc_mk_box3(7, &NFStatement_WHEN__desc, omc_NBEquation_WhenEquationBody_toStatement(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))));
          tmpMeta39 = mmc_mk_cons(tmpMeta40, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta2 = tmpMeta39;
          goto tmp4_done;
        }
        case 7: {
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          
          /* Pattern matching succeeded */
          tmpMeta42 = stringAppend(_OMC_LIT129,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta41 = mmc_mk_cons(tmpMeta42, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta41);
          goto goto_3;
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_3;
      goto_3:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _stmts = tmpMeta2;
  _return: OMC_LABEL_UNUSED
  return _stmts;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Equation_makeInequality(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_metatype _equality_exp = NULL;
  modelica_metatype _cref = NULL;
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _equality_exp has no default value.
  // _cref has no default value.
  // _exp has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _tpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _cref = tmpMeta2;
  _exp = tmpMeta3;

  tmpMeta4 = mmc_mk_box3(3, &NFOperator_OPERATOR__desc, omc_NFComponentRef_nodeType(threadData, _cref), mmc_mk_integer(35));
  tmpMeta5 = mmc_mk_box5(23, &NFExpression_RELATION__desc, omc_NFExpression_fromCref(threadData, _cref, 0 /* false */), tmpMeta4, omc_NFSimplifyExp_simplifyDump(threadData, _exp, 1 /* true */, _OMC_LIT130, _OMC_LIT6), mmc_mk_integer(((modelica_integer) -1)));
  _equality_exp = tmpMeta5;
  _return: OMC_LABEL_UNUSED
  return _equality_exp;
}

static modelica_metatype closure7_NBReplacements_applySimpleExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBReplacements_applySimpleExp(thData, $in_exp, replacements);
}
DLLDirection
modelica_metatype omc_NBEquation_Equation_singleSlice(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_integer _scal_idx, modelica_metatype _sizes, modelica_metatype _cref_to_solve, modelica_metatype _replacements, modelica_metatype __omcQ_24in_5FfuncTree, modelica_metatype *out_funcTree, modelica_integer *out_solve_status)
{
  modelica_metatype _sliced_eqn = NULL;
  modelica_metatype _funcTree = NULL;
  modelica_integer _solve_status;
  modelica_metatype _eqn = NULL;
  modelica_metatype _location = NULL;
  modelica_integer tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sliced_eqn has no default value.
  _funcTree = __omcQ_24in_5FfuncTree;
  // _solve_status has no default value.
  // _eqn has no default value.
  // _location has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);

  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _location = omc_NBSlice_indexToLocation(threadData, _scal_idx, _sizes);

          omc_NBEquation_Iterator_createLocationReplacements(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), listArray(_location), _replacements);

          tmpMeta6 = mmc_mk_box1(0, _replacements);
          _sliced_eqn = omc_NBEquation_Equation_map(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)))), (modelica_fnptr) mmc_mk_box2(0,closure7_NBReplacements_applySimpleExp,tmpMeta6), mmc_mk_none(), boxvar_NFExpression_map);

          if((!omc_NFComponentRef_isEmpty(threadData, _cref_to_solve)))
          {
            _sliced_eqn = omc_NBSolve_solveBody(threadData, _sliced_eqn, _cref_to_solve, _funcTree ,&_funcTree ,&_solve_status ,NULL);
          }
          tmpMeta[0+0] = _sliced_eqn;
          tmp1_c1 = (modelica_integer)_solve_status;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _eqn;
          tmp1_c1 = 1;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sliced_eqn = tmpMeta[0+0];
  _solve_status = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_funcTree) { *out_funcTree = _funcTree; }
  if (out_solve_status) { *out_solve_status = _solve_status; }
  return _sliced_eqn;
}
modelica_metatype boxptr_NBEquation_Equation_singleSlice(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _scal_idx, modelica_metatype _sizes, modelica_metatype _cref_to_solve, modelica_metatype _replacements, modelica_metatype __omcQ_24in_5FfuncTree, modelica_metatype *out_funcTree, modelica_metatype *out_solve_status)
{
  modelica_integer tmp1;
  modelica_integer _solve_status;
  modelica_metatype _sliced_eqn = NULL;
  tmp1 = mmc_unbox_integer(_scal_idx);
  _sliced_eqn = omc_NBEquation_Equation_singleSlice(threadData, _eqn_ptr, tmp1, _sizes, _cref_to_solve, _replacements, __omcQ_24in_5FfuncTree, out_funcTree, &_solve_status);
  /* skip box _sliced_eqn; NBEquation.Equation */
  /* skip box _funcTree; NFFlatten.FunctionTreeImpl.Tree */
  if (out_solve_status) { *out_solve_status = mmc_mk_icon(_solve_status); }
  return _sliced_eqn;
}

static modelica_metatype closure8_NBReplacements_applySimpleExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBReplacements_applySimpleExp(thData, $in_exp, replacements);
}static modelica_metatype closure9_NBReplacements_applySimpleExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBReplacements_applySimpleExp(thData, $in_exp, replacements);
}
DLLDirection
modelica_metatype omc_NBEquation_Equation_sliceFor(threadData_t *threadData, modelica_metatype _body, modelica_metatype _iter, modelica_metatype _sizes, modelica_metatype _frames, modelica_metatype _indices, modelica_boolean _naive)
{
  modelica_metatype _result = NULL;
  modelica_metatype _location = NULL;
  modelica_metatype _new_frames = NULL;
  modelica_metatype _locations = NULL;
  modelica_metatype _locations_T = NULL;
  modelica_metatype _frame_locations = NULL;
  modelica_metatype _replacements = NULL;
  modelica_integer _frame_status;
  modelica_integer _recollect_status;
  modelica_metatype _tmp = NULL;
  modelica_metatype _removed_diagonals_opt = NULL;
  modelica_integer _size;
  modelica_metatype _new_iter = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta16;
  modelica_metatype tmpMeta21;
  modelica_metatype tmpMeta25;
  modelica_metatype tmpMeta26;
  modelica_metatype tmpMeta27;
  modelica_metatype tmpMeta28;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _result has no default value.
  // _location has no default value.
  // _new_frames has no default value.
  // _locations has no default value.
  // _locations_T has no default value.
  // _frame_locations has no default value.
  // _replacements has no default value.
  // _frame_status has no default value.
  // _recollect_status has no default value.
  // _tmp has no default value.
  // _removed_diagonals_opt has no default value.
  // _size has no default value.
  // _new_iter has no default value.
  if((listLength(_indices) == ((modelica_integer) 1)))
  {
    _location = omc_NBSlice_indexToLocation(threadData, mmc_unbox_integer(listHead(_indices)), _sizes);

    _replacements = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));

    omc_NBEquation_Iterator_createLocationReplacements(threadData, _iter, listArray(_location), _replacements);

    tmpMeta1 = mmc_mk_box1(0, _replacements);
    _tmp = omc_NBEquation_Equation_map(threadData, _body, (modelica_fnptr) mmc_mk_box2(0,closure8_NBReplacements_applySimpleExp,tmpMeta1), mmc_mk_none(), boxvar_NFExpression_map);

    tmpMeta2 = mmc_mk_cons(omc_Pointer_create(threadData, _tmp), MMC_REFSTRUCTLIT(mmc_nil));
    _result = tmpMeta2;
  }
  else
  {
    {
      modelica_metatype __omcQ_24tmpVar35;
      modelica_metatype* tmp4;
      modelica_metatype tmpMeta5;
      modelica_metatype __omcQ_24tmpVar34;
      modelica_integer tmp6;
      modelica_metatype _idx_loopVar = 0;
      modelica_metatype _idx;
      _idx_loopVar = _indices;
      tmpMeta5 = MMC_REFSTRUCTLIT(mmc_nil);
      __omcQ_24tmpVar35 = tmpMeta5; /* defaultValue */
      tmp4 = &__omcQ_24tmpVar35;
      while(1) {
        tmp6 = 1;
        if (!listEmpty(_idx_loopVar)) {
          _idx = MMC_CAR(_idx_loopVar);
          _idx_loopVar = MMC_CDR(_idx_loopVar);
          tmp6--;
        }
        if (tmp6 == 0) {
          __omcQ_24tmpVar34 = omc_NBSlice_indexToLocation(threadData, mmc_unbox_integer(_idx), _sizes);
          *tmp4 = mmc_mk_cons(__omcQ_24tmpVar34,0);
          tmp4 = &MMC_CDR(*tmp4);
        } else if (tmp6 == 1) {
          break;
        } else {
          MMC_THROW_INTERNAL();
        }
      }
      *tmp4 = mmc_mk_nil();
      tmpMeta3 = __omcQ_24tmpVar35;
    }
    _locations = tmpMeta3;

    _locations_T = omc_NBSlice_transposeLocations(threadData, _locations, listLength(_sizes));

    _frame_locations = omc_List_zip(threadData, _locations_T, _frames);

    _frame_locations = omc_NBSlice_orderTransposedFrameLocations(threadData, _frame_locations ,&_replacements ,&_frame_status);

    if(((modelica_integer)_frame_status == 3))
    {
      if(_naive)
      {
        {
          modelica_metatype __omcQ_24tmpVar37;
          modelica_metatype* tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype __omcQ_24tmpVar36;
          modelica_integer tmp11;
          modelica_metatype _i_loopVar = 0;
          modelica_metatype _i;
          _i_loopVar = _indices;
          tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
          __omcQ_24tmpVar37 = tmpMeta9; /* defaultValue */
          tmp8 = &__omcQ_24tmpVar37;
          while(1) {
            tmp11 = 1;
            if (!listEmpty(_i_loopVar)) {
              _i = MMC_CAR(_i_loopVar);
              _i_loopVar = MMC_CDR(_i_loopVar);
              tmp11--;
            }
            if (tmp11 == 0) {
              tmpMeta10 = mmc_mk_cons(_i, MMC_REFSTRUCTLIT(mmc_nil));
              __omcQ_24tmpVar36 = omc_NBEquation_Equation_sliceFor(threadData, _body, _iter, _sizes, _frames, tmpMeta10, 1 /* true */);
              *tmp8 = mmc_mk_cons(__omcQ_24tmpVar36,0);
              tmp8 = &MMC_CDR(*tmp8);
            } else if (tmp11 == 1) {
              break;
            } else {
              MMC_THROW_INTERNAL();
            }
          }
          *tmp8 = mmc_mk_nil();
          tmpMeta7 = __omcQ_24tmpVar37;
        }
        _result = omc_List_flatten(threadData, tmpMeta7);
      }
      else
      {
        {
          modelica_metatype __omcQ_24tmpVar39;
          modelica_metatype* tmp13;
          modelica_metatype tmpMeta14;
          modelica_metatype __omcQ_24tmpVar38;
          modelica_integer tmp15;
          modelica_metatype _subset_loopVar = 0;
          modelica_metatype _subset;
          _subset_loopVar = omc_NBSlice_naiveSeparation(threadData, _indices);
          tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
          __omcQ_24tmpVar39 = tmpMeta14; /* defaultValue */
          tmp13 = &__omcQ_24tmpVar39;
          while(1) {
            tmp15 = 1;
            if (!listEmpty(_subset_loopVar)) {
              _subset = MMC_CAR(_subset_loopVar);
              _subset_loopVar = MMC_CDR(_subset_loopVar);
              tmp15--;
            }
            if (tmp15 == 0) {
              __omcQ_24tmpVar38 = omc_NBEquation_Equation_sliceFor(threadData, _body, _iter, _sizes, _frames, _subset, 1 /* true */);
              *tmp13 = mmc_mk_cons(__omcQ_24tmpVar38,0);
              tmp13 = &MMC_CDR(*tmp13);
            } else if (tmp15 == 1) {
              break;
            } else {
              MMC_THROW_INTERNAL();
            }
          }
          *tmp13 = mmc_mk_nil();
          tmpMeta12 = __omcQ_24tmpVar39;
        }
        _result = omc_List_flatten(threadData, tmpMeta12);
      }
    }
    else
    {
      _new_frames = omc_NBSlice_recollectRangesHeuristic(threadData, _frame_locations ,&_removed_diagonals_opt ,&_recollect_status);

      if((((modelica_integer)_recollect_status == 2) || isSome(_removed_diagonals_opt)))
      {
        if(_naive)
        {
          {
            modelica_metatype __omcQ_24tmpVar41;
            modelica_metatype* tmp17;
            modelica_metatype tmpMeta18;
            modelica_metatype tmpMeta19;
            modelica_metatype __omcQ_24tmpVar40;
            modelica_integer tmp20;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _indices;
            tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar41 = tmpMeta18; /* defaultValue */
            tmp17 = &__omcQ_24tmpVar41;
            while(1) {
              tmp20 = 1;
              if (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                tmp20--;
              }
              if (tmp20 == 0) {
                tmpMeta19 = mmc_mk_cons(_i, MMC_REFSTRUCTLIT(mmc_nil));
                __omcQ_24tmpVar40 = omc_NBEquation_Equation_sliceFor(threadData, _body, _iter, _sizes, _frames, tmpMeta19, 1 /* true */);
                *tmp17 = mmc_mk_cons(__omcQ_24tmpVar40,0);
                tmp17 = &MMC_CDR(*tmp17);
              } else if (tmp20 == 1) {
                break;
              } else {
                MMC_THROW_INTERNAL();
              }
            }
            *tmp17 = mmc_mk_nil();
            tmpMeta16 = __omcQ_24tmpVar41;
          }
          _result = omc_List_flatten(threadData, tmpMeta16);
        }
        else
        {
          {
            modelica_metatype __omcQ_24tmpVar43;
            modelica_metatype* tmp22;
            modelica_metatype tmpMeta23;
            modelica_metatype __omcQ_24tmpVar42;
            modelica_integer tmp24;
            modelica_metatype _subset_loopVar = 0;
            modelica_metatype _subset;
            _subset_loopVar = omc_NBSlice_naiveSeparation(threadData, _indices);
            tmpMeta23 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar43 = tmpMeta23; /* defaultValue */
            tmp22 = &__omcQ_24tmpVar43;
            while(1) {
              tmp24 = 1;
              if (!listEmpty(_subset_loopVar)) {
                _subset = MMC_CAR(_subset_loopVar);
                _subset_loopVar = MMC_CDR(_subset_loopVar);
                tmp24--;
              }
              if (tmp24 == 0) {
                __omcQ_24tmpVar42 = omc_NBEquation_Equation_sliceFor(threadData, _body, _iter, _sizes, _frames, _subset, 1 /* true */);
                *tmp22 = mmc_mk_cons(__omcQ_24tmpVar42,0);
                tmp22 = &MMC_CDR(*tmp22);
              } else if (tmp24 == 1) {
                break;
              } else {
                MMC_THROW_INTERNAL();
              }
            }
            *tmp22 = mmc_mk_nil();
            tmpMeta21 = __omcQ_24tmpVar43;
          }
          _result = omc_List_flatten(threadData, tmpMeta21);
        }
      }
      else
      {
        tmpMeta25 = mmc_mk_box1(0, _replacements);
        _tmp = omc_NBEquation_Equation_map(threadData, _body, (modelica_fnptr) mmc_mk_box2(0,closure9_NBReplacements_applySimpleExp,tmpMeta25), mmc_mk_none(), boxvar_NFExpression_map);

        _new_iter = omc_NBEquation_Iterator_fromFrames(threadData, _new_frames);

        _size = (omc_NBEquation_Iterator_size(threadData, _new_iter, 0 /* false */)) * (omc_NBEquation_Equation_size(threadData, omc_Pointer_create(threadData, _tmp), 0 /* false */));

        tmpMeta26 = mmc_mk_cons(_tmp, MMC_REFSTRUCTLIT(mmc_nil));
        tmpMeta27 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, mmc_mk_integer(_size), _new_iter, tmpMeta26, omc_NBEquation_Equation_getSource(threadData, _body), omc_NBEquation_Equation_getAttributes(threadData, _body));
        _tmp = tmpMeta27;

        tmpMeta28 = mmc_mk_cons(omc_Pointer_create(threadData, _tmp), MMC_REFSTRUCTLIT(mmc_nil));
        _result = tmpMeta28;
      }
    }
  }
  _return: OMC_LABEL_UNUSED
  return _result;
}
modelica_metatype boxptr_NBEquation_Equation_sliceFor(threadData_t *threadData, modelica_metatype _body, modelica_metatype _iter, modelica_metatype _sizes, modelica_metatype _frames, modelica_metatype _indices, modelica_metatype _naive)
{
  modelica_integer tmp1;
  modelica_metatype _result = NULL;
  tmp1 = mmc_unbox_integer(_naive);
  _result = omc_NBEquation_Equation_sliceFor(threadData, _body, _iter, _sizes, _frames, _indices, tmp1);
  /* skip box _result; list<Pointer<NBEquation.Equation>> */
  return _result;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_slice(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _indices, modelica_integer *out_slicing_status)
{
  modelica_metatype _sliced_eqn = NULL;
  modelica_integer _slicing_status;
  modelica_metatype _eqn = NULL;
  modelica_metatype _dims = NULL;
  modelica_metatype _sizes = NULL;
  modelica_integer tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sliced_eqn has no default value.
  // _slicing_status has no default value.
  // _eqn has no default value.
  // _dims has no default value.
  // _sizes has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);

  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!listEmpty(_indices)) goto tmp3_end;
          tmpMeta6 = mmc_mk_cons(omc_Pointer_create(threadData, _eqn), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta[0+0] = tmpMeta6;
          tmp1_c1 = 1;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _slicing_status = ((omc_NBEquation_Equation_size(threadData, _eqn_ptr, 0 /* false */) == listLength(_indices))?2:3);
          tmpMeta7 = mmc_mk_cons(omc_Pointer_create(threadData, _eqn), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta[0+0] = tmpMeta7;
          tmp1_c1 = (modelica_integer)_slicing_status;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _slicing_status = ((omc_NBEquation_Equation_size(threadData, _eqn_ptr, 0 /* false */) == listLength(_indices))?2:3);
          tmpMeta8 = mmc_mk_cons(omc_Pointer_create(threadData, _eqn), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta[0+0] = tmpMeta8;
          tmp1_c1 = (modelica_integer)_slicing_status;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _dims = omc_NFType_arrayDims(threadData, omc_NBEquation_Equation_getType(threadData, _eqn, 0 /* false */));

          {
            modelica_metatype __omcQ_24tmpVar45;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_metatype __omcQ_24tmpVar44;
            modelica_integer tmp12;
            modelica_metatype _dim_loopVar = 0;
            modelica_metatype _dim;
            _dim_loopVar = _dims;
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar45 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar45;
            while(1) {
              tmp12 = 1;
              if (!listEmpty(_dim_loopVar)) {
                _dim = MMC_CAR(_dim_loopVar);
                _dim_loopVar = MMC_CDR(_dim_loopVar);
                tmp12--;
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar44 = mmc_mk_integer(omc_NFDimension_size(threadData, _dim, 0 /* false */));
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar44,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar45;
          }
          _sizes = tmpMeta9;

          _slicing_status = ((omc_NBEquation_Equation_size(threadData, _eqn_ptr, 0 /* false */) == listLength(_indices))?2:3);

          if(((modelica_integer)_slicing_status == 3))
          {
            _sliced_eqn = omc_NBEquation_Equation_sliceFor(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)))), omc_NBEquation_Equation_getForIterator(threadData, _eqn), _sizes, listReverse(omc_NBEquation_Equation_getForFrames(threadData, _eqn)), _indices, 0 /* false */);
          }
          tmpMeta[0+0] = _sliced_eqn;
          tmp1_c1 = (modelica_integer)_slicing_status;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          tmpMeta14 = stringAppend(_OMC_LIT131,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta13 = mmc_mk_cons(tmpMeta14, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta13);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sliced_eqn = tmpMeta[0+0];
  _slicing_status = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_slicing_status) { *out_slicing_status = _slicing_status; }
  return _sliced_eqn;
}
modelica_metatype boxptr_NBEquation_Equation_slice(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _indices, modelica_metatype *out_slicing_status)
{
  modelica_integer _slicing_status;
  modelica_metatype _sliced_eqn = NULL;
  _sliced_eqn = omc_NBEquation_Equation_slice(threadData, _eqn_ptr, _indices, &_slicing_status);
  /* skip box _sliced_eqn; list<Pointer<NBEquation.Equation>> */
  if (out_slicing_status) { *out_slicing_status = mmc_mk_icon(_slicing_status); }
  return _sliced_eqn;
}

static modelica_metatype closure10_NBEquation_Equation_toString(threadData_t *thData, modelica_metatype closure, modelica_metatype eq)
{
  modelica_string $in_str = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_Equation_toString(thData, eq, $in_str);
}static modelica_metatype closure11_NBEquation_Equation_toString(threadData_t *thData, modelica_metatype closure, modelica_metatype eq)
{
  modelica_string $in_str = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_Equation_toString(thData, eq, $in_str);
}
DLLDirection
modelica_metatype omc_NBEquation_Equation_entwine(threadData_t *threadData, modelica_metatype _eqn_lst, modelica_integer _nesting_level)
{
  modelica_metatype _entwined = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _eqn1 = NULL;
  modelica_metatype _eqn2 = NULL;
  modelica_metatype _next = NULL;
  modelica_metatype _rest = NULL;
  modelica_metatype _tmp = NULL;
  modelica_metatype _intersection = NULL;
  modelica_metatype _rest1_left = NULL;
  modelica_metatype _rest1_right = NULL;
  modelica_metatype _rest2_left = NULL;
  modelica_metatype _rest2_right = NULL;
  modelica_string _shift = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta42;
  modelica_metatype tmpMeta43;
  modelica_metatype tmpMeta44;
  modelica_metatype tmpMeta45;
  modelica_metatype tmpMeta46;
  modelica_metatype tmpMeta47;
  modelica_metatype tmpMeta48;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _entwined = tmpMeta1;
  // _eqn1 has no default value.
  // _eqn2 has no default value.
  // _next has no default value.
  // _rest has no default value.
  // _tmp has no default value.
  // _intersection has no default value.
  // _rest1_left has no default value.
  // _rest1_right has no default value.
  // _rest2_left has no default value.
  // _rest2_right has no default value.
  _shift = omc_StringUtil_repeat(threadData, _OMC_LIT106, _nesting_level);
  if(omc_Flags_isSet(threadData, _OMC_LIT138))
  {
    tmpMeta2 = stringAppend(_shift,_OMC_LIT132);
    tmpMeta3 = stringAppend(tmpMeta2,intString(_nesting_level));
    tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT133);
    tmpMeta6 = stringAppend(_shift,_OMC_LIT106);
    tmpMeta5 = mmc_mk_box1(0, tmpMeta6);
    tmpMeta7 = stringAppend(tmpMeta4,omc_List_toString(threadData, _eqn_lst, (modelica_fnptr) mmc_mk_box2(0,closure10_NBEquation_Equation_toString,tmpMeta5), _OMC_LIT6, _OMC_LIT6, _OMC_LIT22, _OMC_LIT134, 1 /* true */, ((modelica_integer) 0)));
    fputs(MMC_STRINGDATA(tmpMeta7),stdout);
  }

  /* Pattern-matching assignment */
  tmpMeta8 = _eqn_lst;
  if (listEmpty(tmpMeta8)) MMC_THROW_INTERNAL();
  tmpMeta9 = MMC_CAR(tmpMeta8);
  tmpMeta10 = MMC_CDR(tmpMeta8);
  _eqn1 = tmpMeta9;
  _rest = tmpMeta10;

  while(1)
  {
    if(!(!listEmpty(_rest))) break;
    /* Pattern-matching assignment */
    tmpMeta11 = _rest;
    if (listEmpty(tmpMeta11)) MMC_THROW_INTERNAL();
    tmpMeta12 = MMC_CAR(tmpMeta11);
    tmpMeta13 = MMC_CDR(tmpMeta11);
    _eqn2 = tmpMeta12;
    _rest = tmpMeta13;

    { /* match expression */
      modelica_metatype tmp17_1;modelica_metatype tmp17_2;
      tmp17_1 = _eqn1;
      tmp17_2 = _eqn2;
      {
        volatile mmc_switch_type tmp17;
        int tmp18;
        tmp17 = 0;
        for (; tmp17 < 3; tmp17++) {
          switch (MMC_SWITCH_CAST(tmp17)) {
          case 0: {
            modelica_metatype tmpMeta19;
            if (mmc__uniontype__metarecord__typedef__equal(tmp17_1,5,5) == 0) goto tmp16_end;
            if (mmc__uniontype__metarecord__typedef__equal(tmp17_2,5,5) == 0) goto tmp16_end;
            
            /* Pattern matching succeeded */
            /* Check guard condition after assignments */
            if (!omc_NBEquation_Iterator_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))))) goto tmp16_end;
            tmpMeta19 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta19), MMC_UNTAGPTR(_eqn1), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta19))[4] = omc_NBEquation_Equation_entwine(threadData, listAppend((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)))), ((modelica_integer) 1) + _nesting_level);
            _eqn1 = tmpMeta19;
            tmpMeta14 = _eqn1;
            goto tmp16_done;
          }
          case 1: {
            modelica_metatype tmpMeta20;
            modelica_metatype tmpMeta21;
            modelica_metatype tmpMeta22;
            modelica_metatype tmpMeta23;
            modelica_metatype tmpMeta24;
            modelica_metatype tmpMeta25;
            modelica_metatype tmpMeta26;
            modelica_metatype tmpMeta27;
            modelica_metatype tmpMeta28;
            modelica_metatype tmpMeta29;
            modelica_metatype tmpMeta30;
            modelica_metatype tmpMeta31;
            modelica_metatype tmpMeta32;
            modelica_metatype tmpMeta33;
            modelica_metatype tmpMeta34;
            modelica_metatype tmpMeta35;
            modelica_metatype tmpMeta36;
            modelica_metatype tmpMeta37;
            modelica_metatype tmpMeta38;
            modelica_metatype tmpMeta39;
            modelica_metatype tmpMeta40;
            if (mmc__uniontype__metarecord__typedef__equal(tmp17_1,5,5) == 0) goto tmp16_end;
            if (mmc__uniontype__metarecord__typedef__equal(tmp17_2,5,5) == 0) goto tmp16_end;
            
            /* Pattern matching succeeded */
            /* Pattern-matching tuple assignment */
            tmpMeta26 = omc_NBEquation_Iterator_intersect(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))), &tmpMeta20, &tmpMeta23);
            _intersection = tmpMeta26;
            tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta20), 1));
            tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta20), 2));
            tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta23), 1));
            tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta23), 2));
            _rest1_left = tmpMeta21;
            _rest1_right = tmpMeta22;
            _rest2_left = tmpMeta24;
            _rest2_right = tmpMeta25;

            tmpMeta27 = MMC_REFSTRUCTLIT(mmc_nil);
            _tmp = tmpMeta27;

            if((!omc_NBEquation_Iterator_isEmpty(threadData, _rest1_left)))
            {
              tmpMeta29 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 2))), _rest1_left, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 6))));
              tmpMeta28 = mmc_mk_cons(tmpMeta29, _tmp);
              _tmp = tmpMeta28;
            }

            if((!omc_NBEquation_Iterator_isEmpty(threadData, _rest2_left)))
            {
              tmpMeta31 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 2))), _rest2_left, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 6))));
              tmpMeta30 = mmc_mk_cons(tmpMeta31, _tmp);
              _tmp = tmpMeta30;
            }

            if((!omc_NBEquation_Iterator_isEmpty(threadData, _intersection)))
            {
              tmpMeta33 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 2))), _intersection, omc_NBEquation_Equation_entwine(threadData, listAppend((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)))), ((modelica_integer) 1) + _nesting_level), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 6))));
              tmpMeta32 = mmc_mk_cons(tmpMeta33, _tmp);
              _tmp = tmpMeta32;
            }

            if((!omc_NBEquation_Iterator_isEmpty(threadData, _rest1_right)))
            {
              tmpMeta35 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 2))), _rest1_right, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 6))));
              tmpMeta34 = mmc_mk_cons(tmpMeta35, _tmp);
              _tmp = tmpMeta34;
            }

            if((!omc_NBEquation_Iterator_isEmpty(threadData, _rest2_right)))
            {
              tmpMeta37 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 2))), _rest2_right, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 6))));
              tmpMeta36 = mmc_mk_cons(tmpMeta37, _tmp);
              _tmp = tmpMeta36;
            }

            /* Pattern-matching assignment */
            tmpMeta38 = _tmp;
            if (listEmpty(tmpMeta38)) goto goto_15;
            tmpMeta39 = MMC_CAR(tmpMeta38);
            tmpMeta40 = MMC_CDR(tmpMeta38);
            _next = tmpMeta39;
            _tmp = tmpMeta40;

            _entwined = listAppend(_tmp, _entwined);
            tmpMeta14 = _next;
            goto tmp16_done;
          }
          case 2: {
            modelica_metatype tmpMeta41;
            
            /* Pattern matching succeeded */
            tmpMeta41 = mmc_mk_cons(_eqn1, _entwined);
            _entwined = tmpMeta41;
            tmpMeta14 = _eqn2;
            goto tmp16_done;
          }
          }
          goto tmp16_end;
          tmp16_end: ;
        }
        goto goto_15;
        goto_15:;
        MMC_THROW_INTERNAL();
        goto tmp16_done;
        tmp16_done:;
      }
    }
    _eqn1 = tmpMeta14;
  }

  tmpMeta42 = mmc_mk_cons(_eqn1, _entwined);
  _entwined = listReverse(tmpMeta42);

  if(omc_Flags_isSet(threadData, _OMC_LIT138))
  {
    tmpMeta43 = stringAppend(_shift,_OMC_LIT132);
    tmpMeta44 = stringAppend(tmpMeta43,intString(_nesting_level));
    tmpMeta45 = stringAppend(tmpMeta44,_OMC_LIT139);
    tmpMeta47 = stringAppend(_shift,_OMC_LIT106);
    tmpMeta46 = mmc_mk_box1(0, tmpMeta47);
    tmpMeta48 = stringAppend(tmpMeta45,omc_List_toString(threadData, _entwined, (modelica_fnptr) mmc_mk_box2(0,closure11_NBEquation_Equation_toString,tmpMeta46), _OMC_LIT6, _OMC_LIT6, _OMC_LIT22, _OMC_LIT134, 1 /* true */, ((modelica_integer) 0)));
    fputs(MMC_STRINGDATA(tmpMeta48),stdout);
  }
  _return: OMC_LABEL_UNUSED
  return _entwined;
}
modelica_metatype boxptr_NBEquation_Equation_entwine(threadData_t *threadData, modelica_metatype _eqn_lst, modelica_metatype _nesting_level)
{
  modelica_integer tmp1;
  modelica_metatype _entwined = NULL;
  modelica_metatype tmpMeta2;
  tmp1 = mmc_unbox_integer(_nesting_level);
  _entwined = omc_NBEquation_Equation_entwine(threadData, _eqn_lst, tmp1);
  /* skip box _entwined; list<NBEquation.Equation> */
  return _entwined;
}

static modelica_metatype closure12_NBReplacements_applySimpleExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBReplacements_applySimpleExp(thData, $in_exp, replacements);
}
DLLDirection
void omc_NBEquation_Equation_renameIterators(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_string _newBaseName)
{
  modelica_metatype _eqn = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _eqn;
    {
      modelica_metatype _replacements = NULL;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _replacements has no default value.
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,5,5) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          _replacements = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));

          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = omc_NBEquation_Iterator_rename(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _newBaseName, _replacements);
          _eqn = tmpMeta5;

          {
            modelica_metatype __omcQ_24tmpVar47;
            modelica_metatype* tmp8;
            modelica_metatype tmpMeta9;
            modelica_metatype tmpMeta10;
            modelica_metatype __omcQ_24tmpVar46;
            modelica_integer tmp11;
            modelica_metatype _body_eqn_loopVar = 0;
            modelica_metatype _body_eqn;
            _body_eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));
            tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar47 = tmpMeta9; /* defaultValue */
            tmp8 = &__omcQ_24tmpVar47;
            while(1) {
              tmp11 = 1;
              if (!listEmpty(_body_eqn_loopVar)) {
                _body_eqn = MMC_CAR(_body_eqn_loopVar);
                _body_eqn_loopVar = MMC_CDR(_body_eqn_loopVar);
                tmp11--;
              }
              if (tmp11 == 0) {
                tmpMeta10 = mmc_mk_box1(0, _replacements);
                __omcQ_24tmpVar46 = omc_NBEquation_Equation_map(threadData, _body_eqn, (modelica_fnptr) mmc_mk_box2(0,closure12_NBReplacements_applySimpleExp,tmpMeta10), mmc_mk_none(), boxvar_NFExpression_map);
                *tmp8 = mmc_mk_cons(__omcQ_24tmpVar46,0);
                tmp8 = &MMC_CDR(*tmp8);
              } else if (tmp11 == 1) {
                break;
              } else {
                goto goto_1;
              }
            }
            *tmp8 = mmc_mk_nil();
            tmpMeta7 = __omcQ_24tmpVar47;
          }
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = tmpMeta7;
          _eqn = tmpMeta6;

          omc_Pointer_update(threadData, _eqn_ptr, _eqn);
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_splitIterators(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _iterators = NULL;
      modelica_metatype _body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _iterators has no default value.
      // _body has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _iterators = omc_NBEquation_Iterator_split(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))));

          _body = listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))));

          {
            modelica_metatype _iter;
            for (tmpMeta6 = _iterators; !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _iter = MMC_CAR(tmpMeta6);
              tmpMeta7 = mmc_mk_cons(_body, MMC_REFSTRUCTLIT(mmc_nil));
              tmpMeta8 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), _iter, tmpMeta7, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));
              _body = tmpMeta8;
            }
          }
          tmpMeta1 = _body;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_mergeIterators(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_boolean _top_level, modelica_metatype *out_acc)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _acc = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  // _acc has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _body has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_boolean tmp9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _body = omc_NBEquation_Equation_mergeIterators(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))), 0 /* false */ ,&_acc);

          tmpMeta6 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), _acc);
          _acc = tmpMeta6;
          tmp9 = (modelica_boolean)_top_level;
          if(tmp9)
          {
            tmpMeta7 = mmc_mk_cons(_body, MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta8 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))), omc_NBEquation_Iterator_merge(threadData, _acc), tmpMeta7, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))));
            tmpMeta10 = tmpMeta8;
          }
          else
          {
            tmpMeta10 = _body;
          }
          tmpMeta[0+0] = tmpMeta10;
          tmpMeta[0+1] = _acc;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta[0+0] = _eq;
          tmpMeta[0+1] = tmpMeta11;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta[0+0];
  _acc = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_acc) { *out_acc = _acc; }
  return _eq;
}
modelica_metatype boxptr_NBEquation_Equation_mergeIterators(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _top_level, modelica_metatype *out_acc)
{
  modelica_integer tmp1;
  modelica_metatype _eq = NULL;
  tmp1 = mmc_unbox_integer(_top_level);
  _eq = omc_NBEquation_Equation_mergeIterators(threadData, __omcQ_24in_5Feq, tmp1, out_acc);
  /* skip box _eq; NBEquation.Equation */
  /* skip box _acc; list<NBEquation.Iterator> */
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_generateBindingEquation(threadData_t *threadData, modelica_metatype _var_ptr, modelica_metatype _idx, modelica_boolean _initial_, modelica_metatype _new_iters)
{
  modelica_metatype _eqn = NULL;
  modelica_string _context = NULL;
  modelica_metatype _var = NULL;
  modelica_metatype _lhs = NULL;
  modelica_metatype _rhs = NULL;
  modelica_metatype _eqnAttr = NULL;
  modelica_metatype _iter = NULL;
  modelica_metatype _subs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  _context = _OMC_LIT140;
  // _var has no default value.
  // _lhs has no default value.
  // _rhs has no default value.
  // _eqnAttr has no default value.
  // _iter has no default value.
  // _subs has no default value.
  _var = omc_Pointer_access(threadData, _var_ptr);

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 4)));
    {
      modelica_metatype _qual = NULL;
      modelica_metatype _start = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _qual has no default value.
      // _start has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,9) == 0) goto tmp3_end;
          
          _qual = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_qual), 2)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          _qual = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_qual), 2)));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,3) == 0) goto tmp3_end;
          
          _qual = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_qual), 2)));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          _start = omc_NFBackendExtension_VariableAttributes_getStartAttribute(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 11)))), 3))));
          tmpMeta1 = omc_Util_getOptionOrDefault(threadData, _start, omc_NFExpression_makeZero(threadData, omc_NFComponentRef_getSubscriptedType(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 2))), 1 /* true */)));
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta7 = stringAppend(_OMC_LIT141,omc_NFBinding_toDebugString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 4)))));
          tmpMeta8 = stringAppend(tmpMeta7,_OMC_LIT142);
          tmpMeta9 = stringAppend(tmpMeta8,omc_NFVariable_toString(threadData, omc_Pointer_access(threadData, _var_ptr), _OMC_LIT6, 0 /* false */));
          tmpMeta6 = mmc_mk_cons(tmpMeta9, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta6);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _rhs = tmpMeta1;

  if(omc_NBVariable_isClock(threadData, _var_ptr))
  {
    _eqnAttr = omc_NBEquation_default(threadData, 3, _initial_, _OMC_LIT143);
  }
  else
  {
    if(omc_NBVariable_isContinuous(threadData, _var_ptr, _initial_))
    {
      _eqnAttr = omc_NBEquation_default(threadData, 1, _initial_, mmc_mk_none());
    }
    else
    {
      _eqnAttr = omc_NBEquation_default(threadData, 2, _initial_, mmc_mk_none());
    }
  }

  _iter = omc_NBEquation_Iterator_extract(threadData, _rhs, _new_iters ,&_rhs);

  _rhs = omc_NFSimplifyExp_simplifyDump(threadData, _rhs, 1 /* true */, _OMC_LIT144, _OMC_LIT6);

  if(omc_NBEquation_Iterator_isEmpty(threadData, _iter))
  {
    _lhs = omc_NFExpression_fromCref(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 2))), 0 /* false */);

    _eqn = omc_NBEquation_Equation_makeAssignment(threadData, _lhs, _rhs, _idx, _context, _OMC_LIT82, _eqnAttr);
  }
  else
  {
    _rhs = omc_NFExpression_map(threadData, _rhs, boxvar_NFExpression_repairOperator);

    _subs = omc_NBEquation_Iterator_normalizedSubscripts(threadData, _iter);

    _lhs = omc_NFExpression_fromCref(threadData, omc_NFComponentRef_mergeSubscripts(threadData, _subs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_var), 2))), 1 /* true */, 1 /* true */), 0 /* false */);

    _eqn = omc_NBEquation_Equation_makeAssignment(threadData, _lhs, _rhs, _idx, _context, _iter, _eqnAttr);

    omc_NBEquation_Equation_renameIterators(threadData, _eqn, _OMC_LIT145);
  }
  _return: OMC_LABEL_UNUSED
  return _eqn;
}
modelica_metatype boxptr_NBEquation_Equation_generateBindingEquation(threadData_t *threadData, modelica_metatype _var_ptr, modelica_metatype _idx, modelica_metatype _initial_, modelica_metatype _new_iters)
{
  modelica_integer tmp1;
  modelica_metatype _eqn = NULL;
  tmp1 = mmc_unbox_integer(_initial_);
  _eqn = omc_NBEquation_Equation_generateBindingEquation(threadData, _var_ptr, _idx, tmp1, _new_iters);
  /* skip box _eqn; Pointer<NBEquation.Equation> */
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_crefIsParamOrConst(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _b_ptr)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  if(mmc_unbox_boolean(omc_Pointer_access(threadData, _b_ptr)))
  {
    omc_Pointer_update(threadData, _b_ptr, mmc_mk_boolean(omc_NBVariable_isParamOrConst(threadData, omc_NBVariable_getVarPointer(threadData, _cref, _OMC_LIT146))));
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_expIsParamOrConst(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype _b_ptr)
{
  modelica_metatype _exp = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _exp = __omcQ_24in_5Fexp;
  if(mmc_unbox_boolean(omc_Pointer_access(threadData, _b_ptr)))
  {
    { /* match expression */
      modelica_metatype tmp3_1;
      tmp3_1 = _exp;
      {
        int tmp3;
        {
          switch (MMC_SWITCH_CAST(valueConstructor(tmp3_1))) {
          case 9: {
            
            /* Pattern matching succeeded */
            omc_NBEquation_Equation_crefIsParamOrConst(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))), _b_ptr);
            goto tmp2_done;
          }
          case 16: {
            
            /* Pattern matching succeeded */
            omc_Pointer_update(threadData, _b_ptr, mmc_mk_boolean(omc_NFCall_isImpure(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 2))))));
            goto tmp2_done;
          }
          default:
          tmp2_default: OMC_LABEL_UNUSED; {
            
            /* Pattern matching succeeded */
            goto tmp2_done;
          }
          }
          goto tmp2_end;
          tmp2_end: ;
        }
        goto goto_1;
        goto_1:;
        MMC_THROW_INTERNAL();
        goto tmp2_done;
        tmp2_done:;
      }
    }
    ;
  }
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isClocked(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn_ptr));
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,7) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 8));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (3 != tmp7) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isClocked(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isClocked(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

static modelica_metatype closure13_NBEquation_Equation_expIsParamOrConst(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype b_ptr = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_Equation_expIsParamOrConst(thData, $in_exp, b_ptr);
}static modelica_metatype closure14_NBEquation_Equation_crefIsParamOrConst(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_cref)
{
  modelica_metatype b_ptr = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_Equation_crefIsParamOrConst(thData, $in_cref, b_ptr);
}
DLLDirection
modelica_boolean omc_NBEquation_Equation_isParameterEquation(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_boolean _b;
  modelica_metatype _b_ptr = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = 1 /* true */;
  _b_ptr = omc_Pointer_create(threadData, mmc_mk_boolean(_b));
  tmpMeta1 = mmc_mk_box1(0, _b_ptr);
  tmpMeta2 = mmc_mk_box1(0, _b_ptr);
  omc_NBEquation_Equation_map(threadData, _eqn, (modelica_fnptr) mmc_mk_box2(0,closure13_NBEquation_Equation_expIsParamOrConst,tmpMeta1), mmc_mk_some((modelica_fnptr) mmc_mk_box2(0,closure14_NBEquation_Equation_crefIsParamOrConst,tmpMeta2)), boxvar_NFExpression_map);

  _b = mmc_unbox_boolean(omc_Pointer_access(threadData, _b_ptr));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isParameterEquation(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isParameterEquation(threadData, _eqn);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isAlgorithm(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isAlgorithm(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isAlgorithm(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isTupleEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      modelica_metatype _e = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _e has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          _e = tmp4_1;
          /* Pattern matching succeeded */
          tmp1 = omc_NFType_isTuple(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_e), 2))));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isTupleEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isTupleEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isRecordEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      modelica_metatype _e = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _e has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          _e = tmp4_1;
          /* Pattern matching succeeded */
          tmp1 = (!omc_NFType_isTuple(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_e), 2)))));
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 7));
          if (optionNone(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isRecordEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isRecordEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      modelica_metatype _when_body = NULL;
      modelica_metatype _if_body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _when_body has no default value.
      // _if_body has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 7));
          if (optionNone(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _when_body = tmpMeta8;
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_WhenEquationBody_isRecordOrTupleEquation(threadData, _when_body);
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          
          _if_body = tmpMeta9;
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_IfEquationBody_isRecordOrTupleEquation(threadData, _if_body);
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isRecordOrTupleEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isRecordOrTupleEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isArrayEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isArrayEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isArrayEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isForEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isForEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isForEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isIfEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = omc_Pointer_access(threadData, _eqn_ptr);
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isIfEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isIfEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isWhenEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype _eqn = NULL;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 9: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar49;
            modelica_metatype* tmp6;
            modelica_metatype tmpMeta7;
            modelica_metatype __omcQ_24tmpVar48;
            modelica_integer tmp8;
            modelica_metatype _e_loopVar = 0;
            modelica_metatype _e;
            _e_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));
            tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar49 = tmpMeta7; /* defaultValue */
            tmp6 = &__omcQ_24tmpVar49;
            while(1) {
              tmp8 = 1;
              if (!listEmpty(_e_loopVar)) {
                _e = MMC_CAR(_e_loopVar);
                _e_loopVar = MMC_CDR(_e_loopVar);
                tmp8--;
              }
              if (tmp8 == 0) {
                __omcQ_24tmpVar48 = omc_Pointer_create(threadData, _e);
                *tmp6 = mmc_mk_cons(__omcQ_24tmpVar48,0);
                tmp6 = &MMC_CDR(*tmp6);
              } else if (tmp8 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp6 = mmc_mk_nil();
            tmpMeta5 = __omcQ_24tmpVar49;
          }
          tmp1 = omc_List_any(threadData, tmpMeta5, boxvar_NBEquation_Equation_isWhenEquation);
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isWhenEquation(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isWhenEquation(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isInitial(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype _attr = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _attr has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn_ptr));

  _b = mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attr), 6))));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isInitial(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isInitial(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isContinuous(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype _attr = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _attr has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn_ptr));

  _b = (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attr), 8)))) == 1);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isContinuous(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isContinuous(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isDiscrete(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype _attr = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _attr has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn_ptr));

  _b = (mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attr), 8)))) == 2);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isDiscrete(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isDiscrete(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isResidual(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype _attr = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _attr has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn_ptr));

  _b = mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_attr), 5))));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isResidual(threadData_t *threadData, modelica_metatype _eqn_ptr)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isResidual(threadData, _eqn_ptr);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isDummy(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isDummy(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isDummy(threadData, _eqn);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_applyForOrder(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn, modelica_metatype _order)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = omc_NBEquation_Iterator_applyOrder(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _order);
          _eqn = tmpMeta6;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getForFrames(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _frames = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _frames has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _names = NULL;
      modelica_metatype _ranges = NULL;
      modelica_metatype _maps = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _names has no default value.
      // _ranges has no default value.
      // _maps has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _names = omc_NBEquation_Iterator_getFrames(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))) ,&_ranges ,&_maps);
          tmpMeta1 = omc_List_zip3(threadData, _names, _ranges, _maps);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _frames = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _frames;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getForIterator(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _iterator = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _iterator has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)));
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT82;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iterator = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iterator;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getType(threadData_t *threadData, modelica_metatype _eq, modelica_boolean _skipIterator)
{
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _ty has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2)));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2)));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2)));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          _ty = omc_NBEquation_Equation_getType(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))), 0 /* false */);

          if((!_skipIterator))
          {
            _ty = omc_NFType_liftArrayRightList(threadData, _ty, omc_NBEquation_Iterator_dimensions(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
          }
          tmpMeta1 = _ty;
          goto tmp3_done;
        }
        case 9: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_WhenEquationBody_getType(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT147;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _ty = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _ty;
}
modelica_metatype boxptr_NBEquation_Equation_getType(threadData_t *threadData, modelica_metatype _eq, modelica_metatype _skipIterator)
{
  modelica_integer tmp1;
  modelica_metatype _ty = NULL;
  tmp1 = mmc_unbox_integer(_skipIterator);
  _ty = omc_NBEquation_Equation_getType(threadData, _eq, tmp1);
  /* skip box _ty; NFType */
  return _ty;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getResidualExp(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _exp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _operator = NULL;
      modelica_metatype _cls_node = NULL;
      modelica_metatype _cls = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _operator has no default value.
      // _cls_node has no default value.
      // _cls has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box3(3, &NFOperator_OPERATOR__desc, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))), mmc_mk_integer(1));
          _operator = tmpMeta6;
          tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta8 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta9 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta7, tmpMeta8, _operator);
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_box3(3, &NFOperator_OPERATOR__desc, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))), mmc_mk_integer(6));
          _operator = tmpMeta10;
          tmpMeta11 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta12 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta13 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta11, tmpMeta12, _operator);
          tmpMeta1 = tmpMeta13;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,11,2) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 2));
          
          _cls_node = tmpMeta15;
          /* Pattern matching succeeded */
          _cls = omc_NFInstNode_InstNode_getClass(threadData, _cls_node);

          {
            modelica_metatype _op;
            for (tmpMeta16 = _OMC_LIT157; !listEmpty(tmpMeta16); tmpMeta16=MMC_CDR(tmpMeta16))
            {
              _op = MMC_CAR(tmpMeta16);
              if((!omc_NFClass_hasOperator(threadData, _op, _cls)))
              {
                tmpMeta18 = stringAppend(_OMC_LIT148,omc_NFType_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))));
                tmpMeta19 = stringAppend(tmpMeta18,_OMC_LIT149);
                tmpMeta20 = stringAppend(tmpMeta19,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
                tmpMeta21 = stringAppend(tmpMeta20,_OMC_LIT150);
                tmpMeta22 = stringAppend(tmpMeta21,_op);
                tmpMeta23 = stringAppend(tmpMeta22,_OMC_LIT151);
                tmpMeta17 = mmc_mk_cons(tmpMeta23, MMC_REFSTRUCTLIT(mmc_nil));
                omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta17);

                goto goto_2;
              }
            }
          }

          tmpMeta25 = mmc_mk_box3(3, &NFOperator_OPERATOR__desc, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)))), mmc_mk_integer(1));
          _operator = tmpMeta25;
          tmpMeta26 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta27 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta28 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta26, tmpMeta27, _operator);
          tmpMeta1 = tmpMeta28;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta29)) goto tmp3_end;
          tmpMeta30 = MMC_CAR(tmpMeta29);
          tmpMeta31 = MMC_CDR(tmpMeta29);
          if (!listEmpty(tmpMeta31)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_Equation_getResidualExp(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)))));
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          
          /* Pattern matching succeeded */
          tmpMeta33 = stringAppend(_OMC_LIT158,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta32 = mmc_mk_cons(tmpMeta33, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta32);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta1;

  _exp = omc_NFSimplifyExp_simplifyDump(threadData, _exp, 1 /* true */, _OMC_LIT159, _OMC_LIT6);
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_createResidual(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_boolean _new)
{
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype _attr = NULL;
  modelica_metatype _residualCref = NULL;
  modelica_metatype _lhs = NULL;
  modelica_metatype _rhs = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta7;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn_ptr = __omcQ_24in_5Feqn_5Fptr;
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  // _attr has no default value.
  // _residualCref has no default value.
  // _lhs has no default value.
  // _rhs has no default value.
  if(omc_NBEquation_Equation_isResidual(threadData, _eqn_ptr))
  {
    goto _return;
  }
  else
  {
    _attr = omc_NBEquation_Equation_getAttributes(threadData, _eqn);

    tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(9));
    memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_attr), 9*sizeof(modelica_metatype));
    ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[5] = mmc_mk_boolean(1 /* true */);
    _attr = tmpMeta1;

    _eqn = omc_NBEquation_Equation_setAttributes(threadData, _eqn, _attr);
  }

  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _eqn;
    {
      modelica_metatype _subs = NULL;
      volatile mmc_switch_type tmp5;
      int tmp6;
      // _subs has no default value.
      tmp5 = 0;
      for (; tmp5 < 2; tmp5++) {
        switch (MMC_SWITCH_CAST(tmp5)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,5,5) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          _residualCref = omc_NBEquation_Equation_getEqnName(threadData, _eqn_ptr);

          _subs = omc_NBEquation_Iterator_normalizedSubscripts(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))));

          _subs = listAppend(omc_List_fill(threadData, _OMC_LIT160, omc_NFType_dimensionCount(threadData, omc_NBEquation_Equation_getType(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)))), 0 /* false */))), _subs);
          tmpMeta2 = omc_NFComponentRef_setSubscripts(threadData, _subs, _residualCref);
          goto tmp4_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta2 = omc_NBEquation_Equation_getEqnName(threadData, _eqn_ptr);
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_3;
      goto_3:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _residualCref = tmpMeta2;

  { /* match expression */
    modelica_metatype tmp10_1;
    tmp10_1 = _eqn;
    {
      volatile mmc_switch_type tmp10;
      int tmp11;
      tmp10 = 0;
      for (; tmp10 < 2; tmp10++) {
        switch (MMC_SWITCH_CAST(tmp10)) {
        case 0: {
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp10_1,4,4) == 0) goto tmp9_end;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eqn), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[3] = omc_NBEquation_IfEquationBody_createResidual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _residualCref);
          _eqn = tmpMeta12;
          tmpMeta7 = omc_NBEquation_IfEquationBody_inline(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _eqn);
          goto tmp9_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          _lhs = omc_NFExpression_fromCref(threadData, _residualCref, 0 /* false */);

          _rhs = omc_NBEquation_Equation_getResidualExp(threadData, _eqn);

          _eqn = omc_NBEquation_Equation_setLHS(threadData, _eqn, _lhs);
          tmpMeta7 = omc_NBEquation_Equation_setRHS(threadData, _eqn, _rhs);
          goto tmp9_done;
        }
        }
        goto tmp9_end;
        tmp9_end: ;
      }
      goto goto_8;
      goto_8:;
      MMC_THROW_INTERNAL();
      goto tmp9_done;
      tmp9_done:;
    }
  }
  _eqn = tmpMeta7;

  if(_new)
  {
    _eqn_ptr = omc_Pointer_create(threadData, _eqn);
  }
  else
  {
    omc_Pointer_update(threadData, _eqn_ptr, _eqn);
  }
  _return: OMC_LABEL_UNUSED
  return _eqn_ptr;
}
modelica_metatype boxptr_NBEquation_Equation_createResidual(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_metatype _new)
{
  modelica_integer tmp1;
  modelica_metatype _eqn_ptr = NULL;
  tmp1 = mmc_unbox_integer(_new);
  _eqn_ptr = omc_NBEquation_Equation_createResidual(threadData, __omcQ_24in_5Feqn_5Fptr, tmp1);
  /* skip box _eqn_ptr; Pointer<NBEquation.Equation> */
  return _eqn_ptr;
}

DLLDirection
void omc_NBEquation_Equation_subIdxName(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _idx)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _residualVar = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  // _residualVar has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta5;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta6;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta7;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta8;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqn), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[5] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))), _residualVar);
          _eqn = tmpMeta9;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta10;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))));

          _residualVar = omc_NBVariable_subIdxName(threadData, _residualVar, _idx);

          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqn), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[5] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))), _residualVar);
          _eqn = tmpMeta11;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta13 = stringAppend(_OMC_LIT161,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta12 = mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta12);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;

  omc_Pointer_update(threadData, _idx, mmc_mk_integer(((modelica_integer) 1) + mmc_unbox_integer(omc_Pointer_access(threadData, _idx))));

  omc_Pointer_update(threadData, _eqn_ptr, _eqn);
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setResidualVar(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn, modelica_metatype _residualVar)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta5;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta6;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta7;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta8;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqn), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[5] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))), _residualVar);
          _eqn = tmpMeta9;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 6))), _residualVar);
          _eqn = tmpMeta10;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqn), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[5] = omc_NBEquation_EquationAttributes_setResidualVar(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 5))), _residualVar);
          _eqn = tmpMeta11;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta13 = stringAppend(_OMC_LIT162,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta12 = mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta12);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
void omc_NBEquation_Equation_createName(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _idx, modelica_string _context)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _residualVar = NULL;
  modelica_metatype _dummy_eqns = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  // _residualVar has no default value.
  // _dummy_eqns has no default value.
  _residualVar = omc_NBVariable_makeResidualVar(threadData, _context, mmc_unbox_integer(omc_Pointer_access(threadData, _idx)), omc_NBEquation_Equation_getType(threadData, _eqn, 0 /* false */), NULL);

  omc_Pointer_update(threadData, _idx, mmc_mk_integer(((modelica_integer) 1) + mmc_unbox_integer(omc_Pointer_access(threadData, _idx))));

  _eqn = omc_NBEquation_Equation_setResidualVar(threadData, _eqn, _residualVar);

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 7: {
          
          /* Pattern matching succeeded */
          omc_NBEquation_IfEquationBody_createNames(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _idx, _context);
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar53;
            modelica_metatype* tmp6;
            modelica_metatype tmpMeta7;
            modelica_metatype __omcQ_24tmpVar52;
            modelica_integer tmp8;
            modelica_metatype _body_eqn_loopVar = 0;
            modelica_metatype _body_eqn;
            _body_eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));
            tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar53 = tmpMeta7; /* defaultValue */
            tmp6 = &__omcQ_24tmpVar53;
            while(1) {
              tmp8 = 1;
              if (!listEmpty(_body_eqn_loopVar)) {
                _body_eqn = MMC_CAR(_body_eqn_loopVar);
                _body_eqn_loopVar = MMC_CDR(_body_eqn_loopVar);
                tmp8--;
              }
              if (tmp8 == 0) {
                __omcQ_24tmpVar52 = omc_Pointer_create(threadData, _body_eqn);
                *tmp6 = mmc_mk_cons(__omcQ_24tmpVar52,0);
                tmp6 = &MMC_CDR(*tmp6);
              } else if (tmp8 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp6 = mmc_mk_nil();
            tmpMeta5 = __omcQ_24tmpVar53;
          }
          _dummy_eqns = tmpMeta5;

          {
            modelica_metatype _body_eqn;
            for (tmpMeta9 = _dummy_eqns; !listEmpty(tmpMeta9); tmpMeta9=MMC_CDR(tmpMeta9))
            {
              _body_eqn = MMC_CAR(tmpMeta9);
              omc_NBEquation_Equation_createName(threadData, _body_eqn, _idx, _context);
            }
          }

          {
            modelica_metatype __omcQ_24tmpVar55;
            modelica_metatype* tmp13;
            modelica_metatype tmpMeta14;
            modelica_metatype __omcQ_24tmpVar54;
            modelica_integer tmp15;
            modelica_metatype _body_eqn_loopVar = 0;
            modelica_metatype _body_eqn;
            _body_eqn_loopVar = _dummy_eqns;
            tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar55 = tmpMeta14; /* defaultValue */
            tmp13 = &__omcQ_24tmpVar55;
            while(1) {
              tmp15 = 1;
              if (!listEmpty(_body_eqn_loopVar)) {
                _body_eqn = MMC_CAR(_body_eqn_loopVar);
                _body_eqn_loopVar = MMC_CDR(_body_eqn_loopVar);
                tmp15--;
              }
              if (tmp15 == 0) {
                __omcQ_24tmpVar54 = omc_Pointer_access(threadData, _body_eqn);
                *tmp13 = mmc_mk_cons(__omcQ_24tmpVar54,0);
                tmp13 = &MMC_CDR(*tmp13);
              } else if (tmp15 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp13 = mmc_mk_nil();
            tmpMeta12 = __omcQ_24tmpVar55;
          }
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[4] = tmpMeta12;
          _eqn = tmpMeta11;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;

  omc_Pointer_update(threadData, _eqn_ptr, _eqn);
  _return: OMC_LABEL_UNUSED
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Equation_simplify_apply(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fe, modelica_fnptr _func)
{
  modelica_metatype _e = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _e = __omcQ_24in_5Fe;
  _e = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), _e) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, _e);
  _return: OMC_LABEL_UNUSED
  return _e;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_simplify(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_string _name, modelica_string _indent, modelica_metatype _acc_discrete_states, modelica_metatype _acc_previous, modelica_fnptr _simplifyExp)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _old_eq = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta45;
  modelica_metatype tmpMeta46;
  modelica_metatype tmpMeta47;
  modelica_metatype tmpMeta48;
  modelica_metatype tmpMeta49;
  modelica_metatype tmpMeta50;
  modelica_metatype tmpMeta51;
  modelica_metatype tmpMeta52;
  modelica_metatype tmpMeta53;
  modelica_metatype tmpMeta54;
  modelica_metatype tmpMeta55;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  // _old_eq has no default value.
  if((omc_Flags_isSet(threadData, _OMC_LIT166) && (!(stringEqual(_indent, _OMC_LIT6)))))
  {
    fputs(MMC_STRINGDATA(_OMC_LIT22),stdout);
  }

  _eq = omc_NBEquation_Equation_map(threadData, _eq, ((modelica_fnptr) _simplifyExp), mmc_mk_none(), boxvar_NBEquation_Equation_simplify_apply);

  _old_eq = _eq;

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _new_eq = NULL;
      modelica_metatype _when_body = NULL;
      modelica_metatype _if_body = NULL;
      modelica_metatype _iter = NULL;
      modelica_integer _status;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _new_eq has no default value.
      // _when_body has no default value.
      // _if_body has no default value.
      // _iter has no default value.
      // _status has no default value.
      tmp4 = 0;
      for (; tmp4 < 10; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if(omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))))
          {
            tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta6;

            tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[4] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta7;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if(omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))))
          {
            tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta8;

            tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta9;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if(omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))))
          {
            tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[3] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta10;

            tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[4] = omc_NFExpression_makeZero(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))));
            _eq = tmpMeta11;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta12;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[3] = omc_NFSimplifyModel_simplifyAlgorithm(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))));
          _eq = tmpMeta12;
          tmpMeta1 = (omc_NFAlgorithm_isEmpty(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))?_OMC_LIT42:_eq);
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          { /* match expression */
            modelica_metatype tmp16_1;
            tmp16_1 = omc_NBEquation_WhenEquationBody_simplify(threadData, mmc_mk_some((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
            {
              volatile mmc_switch_type tmp16;
              int tmp17;
              tmp16 = 0;
              for (; tmp16 < 2; tmp16++) {
                switch (MMC_SWITCH_CAST(tmp16)) {
                case 0: {
                  modelica_metatype tmpMeta18;
                  modelica_metatype tmpMeta19;
                  if (optionNone(tmp16_1)) goto tmp15_end;
                  tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp16_1), 1));
                  _when_body = tmpMeta18;
                  /* Pattern matching succeeded */
                  tmpMeta19 = MMC_TAGPTR(mmc_alloc_words(6));
                  memcpy(MMC_UNTAGPTR(tmpMeta19), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
                  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta19))[3] = _when_body;
                  _eq = tmpMeta19;
                  tmpMeta13 = _eq;
                  goto tmp15_done;
                }
                case 1: {
                  
                  /* Pattern matching succeeded */
                  omc_NBDetectStates_findDiscreteStatesFromWhenBody(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), _acc_discrete_states, _acc_previous);
                  tmpMeta13 = _OMC_LIT42;
                  goto tmp15_done;
                }
                }
                goto tmp15_end;
                tmp15_end: ;
              }
              goto goto_14;
              goto_14:;
              goto goto_2;
              goto tmp15_done;
              tmp15_done:;
            }
          }tmpMeta1 = tmpMeta13;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta20;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          { /* match expression */
            modelica_metatype tmp23_1;
            tmp23_1 = omc_NBEquation_IfEquationBody_simplify(threadData, mmc_mk_some((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
            {
              volatile mmc_switch_type tmp23;
              int tmp24;
              tmp23 = 0;
              for (; tmp23 < 2; tmp23++) {
                switch (MMC_SWITCH_CAST(tmp23)) {
                case 0: {
                  modelica_metatype tmpMeta25;
                  modelica_metatype tmpMeta26;
                  if (optionNone(tmp23_1)) goto tmp22_end;
                  tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp23_1), 1));
                  _if_body = tmpMeta25;
                  /* Pattern matching succeeded */
                  if((isNone((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_if_body), 4)))) && (!omc_List_hasSeveralElements(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_if_body), 3)))))))
                  {
                    _new_eq = omc_Pointer_access(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_if_body), 3)))));
                  }
                  else
                  {
                    tmpMeta26 = MMC_TAGPTR(mmc_alloc_words(6));
                    memcpy(MMC_UNTAGPTR(tmpMeta26), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
                    ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta26))[3] = _if_body;
                    _eq = tmpMeta26;

                    { /* matchcontinue expression */
                      {
                        volatile mmc_switch_type tmp29;
                        int tmp30;
                        tmp29 = 0;
                        MMC_TRY_INTERNAL(mmc_jumper)
                        tmp28_top:
                        threadData->mmc_jumper = &new_mmc_jumper;
                        for (; tmp29 < 2; tmp29++) {
                          switch (MMC_SWITCH_CAST(tmp29)) {
                          case 0: {
                            /* Pattern matching succeeded */
                            _new_eq = omc_NBEquation_IfEquationBody_inline(threadData, _if_body, _eq);
                            goto tmp28_done;
                          }
                          case 1: {
                            /* Pattern matching succeeded */
                            _new_eq = _eq;
                            goto tmp28_done;
                          }
                          }
                          goto tmp28_end;
                          tmp28_end: ;
                        }
                        goto goto_27;
                        tmp28_done:
                        (void)tmp29;
                        MMC_RESTORE_INTERNAL(mmc_jumper);
                        goto tmp28_done2;
                        goto_27:;
                        MMC_CATCH_INTERNAL(mmc_jumper);
                        if (++tmp29 < 2) {
                          goto tmp28_top;
                        }
                        goto goto_21;
                        tmp28_done2:;
                      }
                    }
                    ;
                  }
                  tmpMeta20 = _new_eq;
                  goto tmp22_done;
                }
                case 1: {
                  
                  /* Pattern matching succeeded */
                  tmpMeta20 = _OMC_LIT42;
                  goto tmp22_done;
                }
                }
                goto tmp22_end;
                tmp22_end: ;
              }
              goto goto_21;
              goto_21:;
              goto goto_2;
              goto tmp22_done;
              tmp22_done:;
            }
          }tmpMeta1 = tmpMeta20;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta42;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta31 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta31)) goto tmp3_end;
          tmpMeta32 = MMC_CAR(tmpMeta31);
          tmpMeta33 = MMC_CDR(tmpMeta31);
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta32,4,4) == 0) goto tmp3_end;
          tmpMeta34 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta32), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta34,0,3) == 0) goto tmp3_end;
          tmpMeta35 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta34), 4));
          if (!optionNone(tmpMeta35)) goto tmp3_end;
          if (!listEmpty(tmpMeta33)) goto tmp3_end;
          
          _if_body = tmpMeta34;
          /* Pattern matching succeeded */
          _iter = omc_NBEquation_Iterator_simplifyRangeCondition(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_if_body), 2))) ,&_status);

          if(((modelica_integer)_status == 2))
          {
            tmpMeta36 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta36), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta36))[3] = _iter;
            _eq = tmpMeta36;

            {
              modelica_metatype __omcQ_24tmpVar57;
              modelica_metatype* tmp39;
              modelica_metatype tmpMeta40;
              modelica_metatype __omcQ_24tmpVar56;
              modelica_integer tmp41;
              modelica_metatype _be_loopVar = 0;
              modelica_metatype _be;
              _be_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_if_body), 3)));
              tmpMeta40 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar57 = tmpMeta40; /* defaultValue */
              tmp39 = &__omcQ_24tmpVar57;
              while(1) {
                tmp41 = 1;
                if (!listEmpty(_be_loopVar)) {
                  _be = MMC_CAR(_be_loopVar);
                  _be_loopVar = MMC_CDR(_be_loopVar);
                  tmp41--;
                }
                if (tmp41 == 0) {
                  __omcQ_24tmpVar56 = omc_Pointer_access(threadData, _be);
                  *tmp39 = mmc_mk_cons(__omcQ_24tmpVar56,0);
                  tmp39 = &MMC_CDR(*tmp39);
                } else if (tmp41 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp39 = mmc_mk_nil();
              tmpMeta38 = __omcQ_24tmpVar57;
            }
            tmpMeta37 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta37), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta37))[4] = tmpMeta38;
            _eq = tmpMeta37;

            tmpMeta42 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta42), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta42))[2] = mmc_mk_integer(omc_NBEquation_Equation_size(threadData, omc_Pointer_create(threadData, _eq), 1 /* true */));
            _eq = tmpMeta42;
          }
          tmpMeta1 = omc_NBInline_inlineForEquation(threadData, _eq);
          goto tmp3_done;
        }
        case 7: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBInline_inlineForEquation(threadData, _eq);
          goto tmp3_done;
        }
        case 8: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          
          /* Pattern matching succeeded */
          tmpMeta44 = stringAppend(_OMC_LIT167,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta43 = mmc_mk_cons(tmpMeta44, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta43);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;

  if((omc_Flags_isSet(threadData, _OMC_LIT166) && (!omc_NBEquation_Equation_isEqual(threadData, _old_eq, _eq))))
  {
    tmpMeta45 = stringAppend(_indent,_OMC_LIT168);
    tmpMeta46 = stringAppend(tmpMeta45,_name);
    tmpMeta47 = stringAppend(tmpMeta46,_OMC_LIT169);
    fputs(MMC_STRINGDATA(tmpMeta47),stdout);

    tmpMeta48 = stringAppend(_indent,_OMC_LIT170);
    tmpMeta49 = stringAppend(_indent,_OMC_LIT106);
    tmpMeta50 = stringAppend(tmpMeta48,omc_NBEquation_Equation_toString(threadData, _old_eq, tmpMeta49));
    tmpMeta51 = stringAppend(tmpMeta50,_OMC_LIT22);
    fputs(MMC_STRINGDATA(tmpMeta51),stdout);

    tmpMeta52 = stringAppend(_indent,_OMC_LIT171);
    tmpMeta53 = stringAppend(_indent,_OMC_LIT106);
    tmpMeta54 = stringAppend(tmpMeta52,omc_NBEquation_Equation_toString(threadData, _eq, tmpMeta53));
    tmpMeta55 = stringAppend(tmpMeta54,_OMC_LIT134);
    fputs(MMC_STRINGDATA(tmpMeta55),stdout);
  }
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_swapLHSandRHS(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _tmpExp = NULL;
      int tmp4;
      // _tmpExp has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          _tmpExp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));

          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[4] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)));
          _eqn = tmpMeta5;

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eqn), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = _tmpExp;
          _eqn = tmpMeta6;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          _tmpExp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[4] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)));
          _eqn = tmpMeta7;

          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = _tmpExp;
          _eqn = tmpMeta8;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          _tmpExp = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 4)));

          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3)));
          _eqn = tmpMeta9;

          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eqn), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[3] = _tmpExp;
          _eqn = tmpMeta10;
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = stringAppend(_OMC_LIT172,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta11 = mmc_mk_cons(tmpMeta12, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta11);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_updateLHSandRHS(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn, modelica_metatype _lhs, modelica_metatype _rhs)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _ty = NULL;
  modelica_metatype _attr = NULL;
  modelica_metatype _src = NULL;
  modelica_metatype _opt_rec_size = NULL;
  modelica_integer _rec_size;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn = __omcQ_24in_5Feqn;
  // _ty has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, _eqn);
  _src = omc_NBEquation_Equation_source(threadData, _eqn);
  // _opt_rec_size has no default value.
  // _rec_size has no default value.
  _ty = omc_NFExpression_typeOf(threadData, _lhs);

  _opt_rec_size = omc_NFType_complexSize(threadData, _ty, 0 /* false */);

  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _ty;
    tmp4_2 = _opt_rec_size;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box7(4, &NBEquation_Equation_ARRAY__EQUATION__desc, _ty, _lhs, _rhs, _src, _attr, _opt_rec_size);
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,11,2) == 0) goto tmp3_end;
          if (optionNone(tmp4_2)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 1));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          _rec_size = tmp8  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_box7(5, &NBEquation_Equation_RECORD__EQUATION__desc, _ty, _lhs, _rhs, _src, _attr, mmc_mk_integer(_rec_size));
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_box6(3, &NBEquation_Equation_SCALAR__EQUATION__desc, _ty, _lhs, _rhs, _src, _attr);
          tmpMeta1 = tmpMeta10;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eqn = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setRHS(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _rhs)
{
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[4] = _rhs;
          _eq = tmpMeta6;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[4] = _rhs;
          _eq = tmpMeta7;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[4] = _rhs;
          _eq = tmpMeta8;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta9)) goto tmp3_end;
          tmpMeta10 = MMC_CAR(tmpMeta9);
          tmpMeta11 = MMC_CDR(tmpMeta9);
          if (!listEmpty(tmpMeta11)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta13 = mmc_mk_cons(omc_NBEquation_Equation_setRHS(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))), _rhs), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[4] = tmpMeta13;
          _eq = tmpMeta12;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          tmpMeta15 = stringAppend(_OMC_LIT173,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta14 = mmc_mk_cons(tmpMeta15, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta14);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setLHS(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _lhs)
{
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = _lhs;
          _eq = tmpMeta6;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[3] = _lhs;
          _eq = tmpMeta7;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = _lhs;
          _eq = tmpMeta8;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta9)) goto tmp3_end;
          tmpMeta10 = MMC_CAR(tmpMeta9);
          tmpMeta11 = MMC_CDR(tmpMeta9);
          if (!listEmpty(tmpMeta11)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta13 = mmc_mk_cons(omc_NBEquation_Equation_setLHS(threadData, listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))), _lhs), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta12 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta12), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta12))[4] = tmpMeta13;
          _eq = tmpMeta12;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          
          /* Pattern matching succeeded */
          tmpMeta15 = stringAppend(_OMC_LIT174,omc_NFExpression_toString(threadData, _lhs));
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT175);
          tmpMeta17 = stringAppend(tmpMeta16,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta14 = mmc_mk_cons(tmpMeta17, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta14);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getRHS(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _rhs = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _rhs has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 6; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_CAR(tmpMeta6);
          tmpMeta8 = MMC_CDR(tmpMeta6);
          if (!listEmpty(tmpMeta8)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _eq = listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_IfEquationBody_getRHS(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))));
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = stringAppend(_OMC_LIT176,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _rhs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _rhs;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getLHS(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _lhs = NULL;
  modelica_boolean _success;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _lhs has no default value.
  // _success has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 6; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)));
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_CAR(tmpMeta6);
          tmpMeta8 = MMC_CDR(tmpMeta6);
          if (!listEmpty(tmpMeta8)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _eq = listHead((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))));
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _lhs = omc_NBEquation_IfEquationBody_getLHS(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), _OMC_LIT109 ,&_success);

          if((!_success))
          {
            tmpMeta10 = stringAppend(_OMC_LIT177,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
            tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
            omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);

            goto goto_2;
          }
          tmpMeta1 = _lhs;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = stringAppend(_OMC_LIT177,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta11 = mmc_mk_cons(tmpMeta12, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta11);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _lhs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _lhs;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_collectFromMap(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _acc, modelica_metatype _check_map)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  if(omc_UnorderedMap_contains(threadData, _cref, _check_map))
  {
    omc_UnorderedSet_add(threadData, _cref, _acc);
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_collectFromSet(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fcref, modelica_metatype _acc, modelica_metatype _check_set)
{
  modelica_metatype _cref = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _cref = __omcQ_24in_5Fcref;
  if(omc_UnorderedSet_contains(threadData, _cref, _check_set))
  {
    omc_UnorderedSet_add(threadData, _cref, _acc);
  }
  _return: OMC_LABEL_UNUSED
  return _cref;
}

static modelica_metatype closure15_NBSlice_filterExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_fnptr filter = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype acc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  return boxptr_NBSlice_filterExp(thData, $in_exp, filter, acc);
}static modelica_metatype closure16_filter(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_cref)
{
  modelica_metatype acc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_fnptr _filter = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  if (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_filter),2))) {
    return  ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_filter), 1)))) (thData, MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_filter),2)), $in_cref, acc);
  } else { /* No closure in the called variable */
    return  ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_filter), 1)))) (thData, $in_cref, acc);
  }
}
DLLDirection
modelica_metatype omc_NBEquation_Equation_collectCrefs(threadData_t *threadData, modelica_metatype _eq, modelica_fnptr _filter, modelica_fnptr _mapFunc)
{
  modelica_metatype _cref_lst = NULL;
  modelica_metatype _acc = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _cref_lst has no default value.
  _acc = omc_UnorderedSet_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 13));
  tmpMeta1 = mmc_mk_box2(0, ((modelica_fnptr) _filter), _acc);
  tmpMeta2 = mmc_mk_box2(0, _acc, _filter);
  omc_NBEquation_Equation_map(threadData, _eq, (modelica_fnptr) mmc_mk_box2(0,closure15_NBSlice_filterExp,tmpMeta1), mmc_mk_some((modelica_fnptr) mmc_mk_box2(0,closure16_filter,tmpMeta2)), ((modelica_fnptr) _mapFunc));

  _cref_lst = omc_UnorderedSet_toList(threadData, _acc);
  _return: OMC_LABEL_UNUSED
  return _cref_lst;
}

static modelica_metatype closure17_mapFunc(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_e)
{
  modelica_fnptr func = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_fnptr _mapFunc = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  if (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc),2))) {
    return  ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (thData, MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc),2)), $in_e, func);
  } else { /* No closure in the called variable */
    return  ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (thData, $in_e, func);
  }
}
DLLDirection
modelica_metatype omc_NBEquation_Equation_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      modelica_metatype _lhs = NULL;
      modelica_metatype _rhs = NULL;
      modelica_metatype _iter = NULL;
      modelica_metatype _alg = NULL;
      modelica_metatype _ifEqBody = NULL;
      modelica_metatype _whenEqBody = NULL;
      modelica_metatype _new_body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _body has no default value.
      // _lhs has no default value.
      // _rhs has no default value.
      // _iter has no default value.
      // _alg has no default value.
      // _ifEqBody has no default value.
      // _whenEqBody has no default value.
      // _new_body has no default value.
      tmp4 = 0;
      for (; tmp4 < 10; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _lhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp));

          _rhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_lhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = _lhs;
            _eq = tmpMeta6;
          }

          if((!referenceEq(_rhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))))))
          {
            tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[4] = _rhs;
            _eq = tmpMeta7;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _lhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp));

          _rhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_lhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[3] = _lhs;
            _eq = tmpMeta8;
          }

          if((!referenceEq(_rhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))))))
          {
            tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[4] = _rhs;
            _eq = tmpMeta9;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _lhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp));

          _rhs = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), ((modelica_fnptr) _funcExp));

          if((!referenceEq(_lhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[3] = _lhs;
            _eq = tmpMeta10;
          }

          if((!referenceEq(_rhs, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))))))
          {
            tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(8));
            memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[4] = _rhs;
            _eq = tmpMeta11;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta12 = mmc_mk_box2(0, ((modelica_fnptr) _funcExp), _mapFunc);
          _alg = omc_NFAlgorithm_mapExp(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (modelica_fnptr) mmc_mk_box2(0,closure17_mapFunc,tmpMeta12));

          if((!referenceEq(_alg, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[3] = omc_NFAlgorithm_setInputsOutputs(threadData, _alg);
            _eq = tmpMeta13;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta14;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _ifEqBody = omc_NBEquation_IfEquationBody_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));

          if((!referenceEq(_ifEqBody, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(6));
            memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[3] = _ifEqBody;
            _eq = tmpMeta14;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _iter = omc_NBEquation_Iterator_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));

          if((!referenceEq(_iter, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta15 = MMC_TAGPTR(mmc_alloc_words(7));
            memcpy(MMC_UNTAGPTR(tmpMeta15), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta15))[3] = _iter;
            _eq = tmpMeta15;
          }

          {
            modelica_metatype __omcQ_24tmpVar59;
            modelica_metatype* tmp18;
            modelica_metatype tmpMeta19;
            modelica_metatype __omcQ_24tmpVar58;
            modelica_integer tmp20;
            modelica_metatype _body_eqn_loopVar = 0;
            modelica_metatype _body_eqn;
            _body_eqn_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
            tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar59 = tmpMeta19; /* defaultValue */
            tmp18 = &__omcQ_24tmpVar59;
            while(1) {
              tmp20 = 1;
              if (!listEmpty(_body_eqn_loopVar)) {
                _body_eqn = MMC_CAR(_body_eqn_loopVar);
                _body_eqn_loopVar = MMC_CDR(_body_eqn_loopVar);
                tmp20--;
              }
              if (tmp20 == 0) {
                __omcQ_24tmpVar58 = omc_NBEquation_Equation_map(threadData, _body_eqn, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));
                *tmp18 = mmc_mk_cons(__omcQ_24tmpVar58,0);
                tmp18 = &MMC_CDR(*tmp18);
              } else if (tmp20 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp18 = mmc_mk_nil();
            tmpMeta17 = __omcQ_24tmpVar59;
          }
          tmpMeta16 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta16), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta16))[4] = tmpMeta17;
          _eq = tmpMeta16;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta21;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _whenEqBody = omc_NBEquation_WhenEquationBody_map(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));

          if((!referenceEq(_whenEqBody, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))))))
          {
            tmpMeta21 = MMC_TAGPTR(mmc_alloc_words(6));
            memcpy(MMC_UNTAGPTR(tmpMeta21), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta21))[3] = _whenEqBody;
            _eq = tmpMeta21;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta22)) goto tmp3_end;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta22), 1));
          _body = tmpMeta23;
          /* Pattern matching succeeded */
          _new_body = omc_NBEquation_Equation_map(threadData, _body, ((modelica_fnptr) _funcExp), _funcCrefOpt, ((modelica_fnptr) _mapFunc));

          if((!referenceEq(_new_body, _body)))
          {
            tmpMeta24 = MMC_TAGPTR(mmc_alloc_words(4));
            memcpy(MMC_UNTAGPTR(tmpMeta24), MMC_UNTAGPTR(_eq), 4*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta24))[3] = mmc_mk_some(_new_body);
            _eq = tmpMeta24;
          }
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 8: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          
          /* Pattern matching succeeded */
          tmpMeta26 = stringAppend(_OMC_LIT178,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta25 = mmc_mk_cons(tmpMeta26, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta25);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setDerivative(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _derivative)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  // _attr has no default value.
  _attr = omc_NBEquation_Equation_getAttributes(threadData, _eq);

  tmpMeta1 = MMC_TAGPTR(mmc_alloc_words(9));
  memcpy(MMC_UNTAGPTR(tmpMeta1), MMC_UNTAGPTR(_attr), 9*sizeof(modelica_metatype));
  ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta1))[2] = mmc_mk_some(_derivative);
  _attr = tmpMeta1;

  _eq = omc_NBEquation_Equation_setAttributes(threadData, _eq, _attr);
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getSource(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _source = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _source has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _body has no default value.
      tmp4 = 0;
      for (; tmp4 < 9; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 5: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          _body = tmpMeta7;
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _eq = _body;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT182;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _source = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _source;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setKind(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_integer _kind, modelica_metatype _clock_idx)
{
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      int tmp4;
      // _body has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta5;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta6;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta7;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[6] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta8;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[5] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta9;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta10;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[5] = omc_NBEquation_EquationAttributes_setKind(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5))), (modelica_integer)_kind, _clock_idx);
          _eq = tmpMeta11;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta12)) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 1));
          _body = tmpMeta13;
          /* Pattern matching succeeded */
          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(4));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eq), 4*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[3] = mmc_mk_some(omc_NBEquation_Equation_setKind(threadData, _body, (modelica_integer)_kind, _clock_idx));
          _eq = tmpMeta14;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eq;
}
modelica_metatype boxptr_NBEquation_Equation_setKind(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _kind, modelica_metatype _clock_idx)
{
  modelica_integer tmp1;
  modelica_metatype _eq = NULL;
  tmp1 = mmc_unbox_integer(_kind);
  _eq = omc_NBEquation_Equation_setKind(threadData, __omcQ_24in_5Feq, tmp1, _clock_idx);
  /* skip box _eq; NBEquation.Equation */
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_setAttributes(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _attr)
{
  modelica_metatype _eq = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      int tmp4;
      // _body has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[6] = _attr;
          _eq = tmpMeta5;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[6] = _attr;
          _eq = tmpMeta6;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_eq), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[6] = _attr;
          _eq = tmpMeta7;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta8), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta8))[6] = _attr;
          _eq = tmpMeta8;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta9), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta9))[5] = _attr;
          _eq = tmpMeta9;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = MMC_TAGPTR(mmc_alloc_words(7));
          memcpy(MMC_UNTAGPTR(tmpMeta10), MMC_UNTAGPTR(_eq), 7*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta10))[6] = _attr;
          _eq = tmpMeta10;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_TAGPTR(mmc_alloc_words(6));
          memcpy(MMC_UNTAGPTR(tmpMeta11), MMC_UNTAGPTR(_eq), 6*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta11))[5] = _attr;
          _eq = tmpMeta11;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta12)) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 1));
          _body = tmpMeta13;
          /* Pattern matching succeeded */
          tmpMeta14 = MMC_TAGPTR(mmc_alloc_words(4));
          memcpy(MMC_UNTAGPTR(tmpMeta14), MMC_UNTAGPTR(_eq), 4*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta14))[3] = mmc_mk_some(omc_NBEquation_Equation_setAttributes(threadData, _body, _attr));
          _eq = tmpMeta14;
          tmpMeta1 = _eq;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _eq = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getAttributes(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _attr = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _attr has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      modelica_metatype _body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _body has no default value.
      tmp4 = 0;
      for (; tmp4 < 9; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6)));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6)));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6)));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6)));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 5: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6)));
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (optionNone(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 1));
          _body = tmpMeta7;
          /* Pattern matching succeeded */
          /* Tail recursive call */
          _eq = _body;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBEquation_default(threadData, 5, 0 /* false */, mmc_mk_none());
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _attr = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _attr;
}

DLLDirection
modelica_string omc_NBEquation_Equation_forEquationToString(threadData_t *threadData, modelica_metatype _iter, modelica_metatype _body, modelica_string __omcQ_24in_5Fstr, modelica_string _indent, modelica_string _indicator)
{
  modelica_string _str = NULL;
  modelica_string _iterators = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  // _iterators has no default value.
  tmpMeta1 = stringAppend(_str,_indicator);
  tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT22);
  _str = tmpMeta2;

  tmpMeta3 = stringAppend(_str,_indent);
  tmpMeta4 = stringAppend(tmpMeta3,_OMC_LIT183);
  tmpMeta5 = stringAppend(tmpMeta4,omc_NBEquation_Iterator_toString(threadData, _iter));
  tmpMeta6 = stringAppend(tmpMeta5,_OMC_LIT184);
  _str = tmpMeta6;

  {
    modelica_metatype _eqn;
    for (tmpMeta7 = _body; !listEmpty(tmpMeta7); tmpMeta7=MMC_CDR(tmpMeta7))
    {
      _eqn = MMC_CAR(tmpMeta7);
      tmpMeta8 = stringAppend(_indent,_OMC_LIT106);
      tmpMeta9 = stringAppend(_str,omc_NBEquation_Equation_toString(threadData, _eqn, tmpMeta8));
      tmpMeta10 = stringAppend(tmpMeta9,_OMC_LIT22);
      _str = tmpMeta10;
    }
  }

  tmpMeta12 = stringAppend(_str,_indent);
  tmpMeta13 = stringAppend(tmpMeta12,_OMC_LIT185);
  _str = tmpMeta13;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_makeAlgorithm(threadData_t *threadData, modelica_metatype _stmts, modelica_boolean _init)
{
  modelica_metatype _eqn = NULL;
  modelica_metatype _alg = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eqn has no default value.
  // _alg has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  tmpMeta3 = mmc_mk_box6(3, &NFAlgorithm_ALGORITHM__desc, _stmts, tmpMeta1, tmpMeta2, _OMC_LIT186, _OMC_LIT182);
  _alg = tmpMeta3;

  _alg = omc_NFAlgorithm_setInputsOutputs(threadData, _alg);

  _eqn = omc_NBackendDAE_lowerAlgorithm(threadData, _alg, _init);
  _return: OMC_LABEL_UNUSED
  return _eqn;
}
modelica_metatype boxptr_NBEquation_Equation_makeAlgorithm(threadData_t *threadData, modelica_metatype _stmts, modelica_metatype _init)
{
  modelica_integer tmp1;
  modelica_metatype _eqn = NULL;
  tmp1 = mmc_unbox_integer(_init);
  _eqn = omc_NBEquation_Equation_makeAlgorithm(threadData, _stmts, tmp1);
  /* skip box _eqn; Pointer<NBEquation.Equation> */
  return _eqn;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_makeAssignmentEqn(threadData_t *threadData, modelica_metatype _lhs, modelica_metatype _rhs, modelica_metatype _iter, modelica_metatype _attr)
{
  modelica_metatype _e = NULL;
  modelica_metatype _ty = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _e has no default value.
  _ty = omc_NFExpression_typeOf(threadData, _lhs);
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _ty;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 10: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_box7(4, &NBEquation_Equation_ARRAY__EQUATION__desc, _ty, _lhs, _rhs, _OMC_LIT182, _attr, mmc_mk_none());
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 11: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_box7(5, &NBEquation_Equation_RECORD__EQUATION__desc, _ty, _lhs, _rhs, _OMC_LIT182, _attr, mmc_mk_integer(omc_NFType_sizeOf(threadData, _ty, 0 /* false */)));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 14: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_box7(5, &NBEquation_Equation_RECORD__EQUATION__desc, _ty, _lhs, _rhs, _OMC_LIT182, _attr, mmc_mk_integer(omc_NFType_sizeOf(threadData, _ty, 0 /* false */)));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_box6(3, &NBEquation_Equation_SCALAR__EQUATION__desc, _ty, _lhs, _rhs, _OMC_LIT182, _attr);
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _e = tmpMeta1;

  if((!omc_NBEquation_Iterator_isEmpty(threadData, _iter)))
  {
    tmpMeta9 = mmc_mk_cons(_e, MMC_REFSTRUCTLIT(mmc_nil));
    tmpMeta10 = mmc_mk_box6(8, &NBEquation_Equation_FOR__EQUATION__desc, mmc_mk_integer((omc_NFType_sizeOf(threadData, _ty, 0 /* false */)) * (omc_NBEquation_Iterator_size(threadData, _iter, 0 /* false */))), _iter, tmpMeta9, _OMC_LIT182, _attr);
    _e = tmpMeta10;

    _e = omc_NBInline_inlineForEquation(threadData, _e);
  }
  _return: OMC_LABEL_UNUSED
  return _e;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_makeAssignmentUpdate(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feq, modelica_metatype _lhs, modelica_metatype _rhs, modelica_metatype _iter, modelica_metatype _attr)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _res_var = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eq = __omcQ_24in_5Feq;
  _res_var = omc_NBEquation_Equation_getResidualVar(threadData, omc_Pointer_create(threadData, _eq));
  _eq = omc_NBEquation_Equation_makeAssignmentEqn(threadData, _lhs, _rhs, _iter, _attr);

  _eq = omc_NBEquation_Equation_setResidualVar(threadData, _eq, _res_var);
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_makeAssignment(threadData_t *threadData, modelica_metatype _lhs, modelica_metatype _rhs, modelica_metatype _idx, modelica_string _str, modelica_metatype _iter, modelica_metatype _attr)
{
  modelica_metatype _eq = NULL;
  modelica_metatype _e = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _eq has no default value.
  // _e has no default value.
  _e = omc_NBEquation_Equation_makeAssignmentEqn(threadData, _lhs, _rhs, _iter, _attr);

  _eq = omc_Pointer_create(threadData, _e);

  omc_NBEquation_Equation_createName(threadData, _eq, _idx, _str);
  _return: OMC_LABEL_UNUSED
  return _eq;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getSolvedVar(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _var = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _var has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _cref = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _cref has no default value.
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,6,2) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          
          _cref = tmpMeta7;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBVariable_getVar(threadData, _cref, _OMC_LIT187);
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,6,2) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 3));
          
          _cref = tmpMeta9;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBVariable_getVar(threadData, _cref, _OMC_LIT188);
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta10,6,2) == 0) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 3));
          
          _cref = tmpMeta11;
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NBVariable_getVar(threadData, _cref, _OMC_LIT189);
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT199;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _var = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _var;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getResidualVar(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _residualVar = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _residualVar has no default value.
  { /* matchcontinue expression */
    {
      volatile mmc_switch_type tmp3;
      int tmp4;
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          /* Pattern matching succeeded */
          _residualVar = omc_NBEquation_EquationAttributes_getResidualVar(threadData, omc_NBEquation_Equation_getAttributes(threadData, omc_Pointer_access(threadData, _eqn)));
          goto tmp2_done;
        }
        case 1: {
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT201);

          goto goto_1;
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return _residualVar;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_getEqnName(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_metatype _name = NULL;
  modelica_metatype _residualVar = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _name has no default value.
  // _residualVar has no default value.
  if(omc_NBEquation_Equation_isDummy(threadData, omc_Pointer_access(threadData, _eqn)))
  {
    _name = _OMC_LIT190;
  }
  else
  {
    _residualVar = omc_NBEquation_Equation_getResidualVar(threadData, _eqn);

    _name = omc_NBVariable_getVarName(threadData, _residualVar);
  }
  _return: OMC_LABEL_UNUSED
  return _name;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isEqual(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _eqn1;
    tmp4_2 = _eqn2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 10; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)))));
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)))));
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3)))) && omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)))));
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFAlgorithm_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_IfEquationBody_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))));
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,5,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar61;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar60;
            modelica_integer tmp9;
            modelica_metatype _b1_loopVar = 0;
            modelica_metatype _b1;
            modelica_metatype _b2_loopVar = 0;
            modelica_metatype _b2;
            _b1_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 4)));
            _b2_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 4)));
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar61 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar61;
            while(1) {
              tmp9 = 2;
              if (!listEmpty(_b1_loopVar)) {
                _b1 = MMC_CAR(_b1_loopVar);
                _b1_loopVar = MMC_CDR(_b1_loopVar);
                tmp9--;
              }if (!listEmpty(_b2_loopVar)) {
                _b2 = MMC_CAR(_b2_loopVar);
                _b2_loopVar = MMC_CDR(_b2_loopVar);
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar60 = mmc_mk_boolean(omc_NBEquation_Equation_isEqual(threadData, _b1, _b2));
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar60,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 2) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar61;
          }
          tmp1 = (omc_NBEquation_Iterator_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3)))) && omc_List_all(threadData, tmpMeta6, boxvar_Util_id));
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_WhenEquationBody_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))));
          goto tmp3_done;
        }
        case 7: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NBVariable_equalName(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 2)))) && omc_Util_optionEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn2), 3))), boxvar_NBEquation_Equation_isEqual));
          goto tmp3_done;
        }
        case 8: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,8,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 9: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isEqual(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isEqual(threadData, _eqn1, _eqn2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isEqualTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype _eqn1 = NULL;
  modelica_metatype _eqn2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _eqn1 has no default value.
  // _eqn2 has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _tpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _eqn1 = tmpMeta2;
  _eqn2 = tmpMeta3;

  _b = omc_NBEquation_Equation_isEqual(threadData, _eqn1, _eqn2);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isEqualTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isEqualTpl(threadData, _tpl);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isEqualPtr(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = omc_NBEquation_Equation_isEqual(threadData, omc_Pointer_access(threadData, _eqn1), omc_Pointer_access(threadData, _eqn2));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isEqualPtr(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isEqualPtr(threadData, _eqn1, _eqn2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_isEqualPtrTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype _eqn1 = NULL;
  modelica_metatype _eqn2 = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  // _eqn1 has no default value.
  // _eqn2 has no default value.
  /* Pattern-matching assignment */
  tmpMeta1 = _tpl;
  tmpMeta2 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 1));
  tmpMeta3 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta1), 2));
  _eqn1 = tmpMeta2;
  _eqn2 = tmpMeta3;

  _b = omc_NBEquation_Equation_isEqualPtr(threadData, _eqn1, _eqn2);
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_isEqualPtrTpl(threadData_t *threadData, modelica_metatype _tpl)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_isEqualPtrTpl(threadData, _tpl);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Equation_equalName(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = omc_NFComponentRef_isEqual(threadData, omc_NBEquation_Equation_getEqnName(threadData, _eqn1), omc_NBEquation_Equation_getEqnName(threadData, _eqn2));
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Equation_equalName(threadData_t *threadData, modelica_metatype _eqn1, modelica_metatype _eqn2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Equation_equalName(threadData, _eqn1, _eqn2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_integer omc_NBEquation_Equation_hash(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_integer _i;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _i = (omc_NBEquation_Equation_isDummy(threadData, omc_Pointer_access(threadData, _eqn))?((modelica_integer) 0):omc_NFComponentRef_hash(threadData, omc_NBEquation_Equation_getEqnName(threadData, _eqn)));
  _return: OMC_LABEL_UNUSED
  return _i;
}
modelica_metatype boxptr_NBEquation_Equation_hash(threadData_t *threadData, modelica_metatype _eqn)
{
  modelica_integer _i;
  modelica_metatype out_i;
  _i = omc_NBEquation_Equation_hash(threadData, _eqn);
  out_i = mmc_mk_icon(_i);
  return out_i;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_applyToType(threadData_t *threadData, modelica_metatype __omcQ_24in_5Feqn_5Fptr, modelica_fnptr _func)
{
  modelica_metatype _eqn_ptr = NULL;
  modelica_metatype _new = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _eqn_ptr = __omcQ_24in_5Feqn_5Fptr;
  // _new has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          _new = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_new), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[2] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_new), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_new), 2))));
          _new = tmpMeta6;
          tmpMeta1 = _new;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          _new = tmp4_1;
          /* Pattern matching succeeded */
          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(8));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_new), 8*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[2] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_new), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_new), 2))));
          _new = tmpMeta7;
          tmpMeta1 = _new;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _eqn;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _new = tmpMeta1;

  if((!referenceEq(_eqn, _new)))
  {
    omc_Pointer_update(threadData, _eqn_ptr, _new);
  }
  _return: OMC_LABEL_UNUSED
  return _eqn_ptr;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_sizes(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_boolean _resize)
{
  modelica_metatype _size_lst = NULL;
  modelica_metatype _eqn = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _size_lst has no default value.
  // _eqn has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _OMC_LIT202;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_cons(mmc_mk_integer(omc_NFType_sizeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), _resize)), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = mmc_mk_cons(mmc_mk_integer(omc_NFType_sizeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), _resize)), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta7;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmpMeta8 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = listReverse(omc_NBEquation_Iterator_sizes(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _resize));
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          tmpMeta9 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta9;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = mmc_mk_cons(mmc_mk_integer(omc_NFVariable_size(threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))), _resize)), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta10;
          goto tmp3_done;
        }
        case 11: {
          modelica_metatype tmpMeta11;
          
          /* Pattern matching succeeded */
          tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta11;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta13 = stringAppend(_OMC_LIT203,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta12 = mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta12);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _size_lst = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _size_lst;
}
modelica_metatype boxptr_NBEquation_Equation_sizes(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _size_lst = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _size_lst = omc_NBEquation_Equation_sizes(threadData, _eqn_ptr, tmp1);
  /* skip box _size_lst; list<#Integer> */
  return _size_lst;
}

DLLDirection
modelica_integer omc_NBEquation_Equation_size(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_boolean _resize)
{
  modelica_integer _s;
  modelica_metatype _eqn = NULL;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _s has no default value.
  // _eqn has no default value.
  _eqn = omc_Pointer_access(threadData, _eqn_ptr);

  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eqn;
    {
      modelica_metatype _body = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _body has no default value.
      tmp4 = 0;
      for (; tmp4 < 10; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1);
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFType_sizeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), _resize);
          goto tmp3_done;
        }
        case 2: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,6) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFType_sizeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))), _resize);
          goto tmp3_done;
        }
        case 3: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,3,5) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2))));
          goto tmp3_done;
        }
        case 4: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,4,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (_resize?omc_NBEquation_IfEquationBody_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _resize):mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))));
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,5,5) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          if (listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_CAR(tmpMeta6);
          tmpMeta8 = MMC_CDR(tmpMeta6);
          if (!listEmpty(tmpMeta8)) goto tmp3_end;
          
          _body = tmpMeta7;
          /* Pattern matching succeeded */
          tmp1 = (_resize?(omc_NBEquation_Iterator_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _resize)) * (omc_NBEquation_Equation_size(threadData, omc_Pointer_create(threadData, _body), _resize)):mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))));
          goto tmp3_done;
        }
        case 6: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,6,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (_resize?omc_NBEquation_WhenEquationBody_size(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 3))), _resize):mmc_unbox_integer((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))));
          goto tmp3_done;
        }
        case 7: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,7,2) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NFVariable_size(threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eqn), 2)))), _resize);
          goto tmp3_done;
        }
        case 8: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta10 = stringAppend(_OMC_LIT204,omc_NBEquation_Equation_toString(threadData, _eqn, _OMC_LIT6));
          tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _s = tmp1;
  _return: OMC_LABEL_UNUSED
  return _s;
}
modelica_metatype boxptr_NBEquation_Equation_size(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _s;
  modelica_metatype out_s;
  tmp1 = mmc_unbox_integer(_resize);
  _s = omc_NBEquation_Equation_size(threadData, _eqn_ptr, tmp1);
  out_s = mmc_mk_icon(_s);
  return out_s;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_info(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _info = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _info = omc_ElementSource_getInfo(threadData, omc_NBEquation_Equation_source(threadData, _eq));
  _return: OMC_LABEL_UNUSED
  return _info;
}

DLLDirection
modelica_metatype omc_NBEquation_Equation_source(threadData_t *threadData, modelica_metatype _eq)
{
  modelica_metatype _src = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _src has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _eq;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 6: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 7: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        case 8: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5)));
          goto tmp3_done;
        }
        case 9: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          tmpMeta6 = stringAppend(_OMC_LIT205,omc_NBEquation_Equation_toString(threadData, _eq, _OMC_LIT6));
          tmpMeta5 = mmc_mk_cons(tmpMeta6, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta5);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _src = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _src;
}

DLLDirection
modelica_string omc_NBEquation_Equation_pointerToString(threadData_t *threadData, modelica_metatype _eqn_ptr, modelica_string __omcQ_24in_5Fstr)
{
  modelica_string _str = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  _str = omc_NBEquation_Equation_toString(threadData, omc_Pointer_access(threadData, _eqn_ptr), _str);
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_string omc_NBEquation_Equation_toString(threadData_t *threadData, modelica_metatype _eq, modelica_string __omcQ_24in_5Fstr)
{
  modelica_string _str = NULL;
  modelica_string _s = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_string _tupl_recd_str = NULL;
  modelica_string tmp3 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = __omcQ_24in_5Fstr;
  tmpMeta1 = stringAppend(_OMC_LIT54,intString(omc_NBEquation_Equation_size(threadData, omc_Pointer_create(threadData, _eq), 1 /* true */)));
  tmpMeta2 = stringAppend(tmpMeta1,_OMC_LIT21);
  _s = tmpMeta2;
  // _tupl_recd_str has no default value.
  { /* match expression */
    modelica_metatype tmp6_1;
    tmp6_1 = _eq;
    {
      int tmp6;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp6_1))) {
        case 3: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          
          /* Pattern matching succeeded */
          tmpMeta7 = stringAppend(_str,_OMC_LIT206);
          tmpMeta8 = stringAppend(tmpMeta7,_s);
          tmpMeta9 = stringAppend(tmpMeta8,_OMC_LIT56);
          tmpMeta10 = stringAppend(tmpMeta9,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
          tmpMeta11 = stringAppend(tmpMeta10,_OMC_LIT207);
          tmpMeta12 = stringAppend(tmpMeta11,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))));
          tmpMeta13 = stringAppend(tmpMeta12,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), _OMC_LIT56));
          tmp3 = tmpMeta13;
          goto tmp5_done;
        }
        case 4: {
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          
          /* Pattern matching succeeded */
          tmpMeta14 = stringAppend(_str,_OMC_LIT208);
          tmpMeta15 = stringAppend(tmpMeta14,_s);
          tmpMeta16 = stringAppend(tmpMeta15,_OMC_LIT56);
          tmpMeta17 = stringAppend(tmpMeta16,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
          tmpMeta18 = stringAppend(tmpMeta17,_OMC_LIT207);
          tmpMeta19 = stringAppend(tmpMeta18,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))));
          tmpMeta20 = stringAppend(tmpMeta19,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), _OMC_LIT56));
          tmp3 = tmpMeta20;
          goto tmp5_done;
        }
        case 5: {
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          
          /* Pattern matching succeeded */
          _tupl_recd_str = (omc_NFType_isTuple(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2))))?_OMC_LIT209:_OMC_LIT210);
          tmpMeta21 = stringAppend(_str,_tupl_recd_str);
          tmpMeta22 = stringAppend(tmpMeta21,_s);
          tmpMeta23 = stringAppend(tmpMeta22,_OMC_LIT56);
          tmpMeta24 = stringAppend(tmpMeta23,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3)))));
          tmpMeta25 = stringAppend(tmpMeta24,_OMC_LIT207);
          tmpMeta26 = stringAppend(tmpMeta25,omc_NFExpression_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4)))));
          tmpMeta27 = stringAppend(tmpMeta26,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), _OMC_LIT56));
          tmp3 = tmpMeta27;
          goto tmp5_done;
        }
        case 6: {
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          
          /* Pattern matching succeeded */
          tmpMeta28 = stringAppend(_str,_OMC_LIT211);
          tmpMeta29 = stringAppend(tmpMeta28,_s);
          tmpMeta30 = stringAppend(tmpMeta29,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), _OMC_LIT56));
          tmpMeta31 = stringAppend(tmpMeta30,_OMC_LIT22);
          tmpMeta32 = stringAppend(_str,_OMC_LIT212);
          tmpMeta33 = stringAppend(tmpMeta31,omc_NFAlgorithm_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), tmpMeta32));
          tmp3 = tmpMeta33;
          goto tmp5_done;
        }
        case 7: {
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          
          /* Pattern matching succeeded */
          tmpMeta34 = stringAppend(_str,_OMC_LIT212);
          tmpMeta35 = stringAppend(_OMC_LIT213,_s);
          tmpMeta36 = stringAppend(tmpMeta35,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5))), _OMC_LIT56));
          tmpMeta37 = stringAppend(tmpMeta36,_OMC_LIT22);
          tmpMeta38 = stringAppend(_str,omc_NBEquation_IfEquationBody_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), tmpMeta34, tmpMeta37, 0 /* false */));
          tmp3 = tmpMeta38;
          goto tmp5_done;
        }
        case 8: {
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          
          /* Pattern matching succeeded */
          tmpMeta39 = stringAppend(_str,_OMC_LIT212);
          tmpMeta40 = stringAppend(_OMC_LIT214,_s);
          tmpMeta41 = stringAppend(tmpMeta40,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 6))), _OMC_LIT56));
          tmpMeta42 = stringAppend(_str,omc_NBEquation_Equation_forEquationToString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 4))), _OMC_LIT6, tmpMeta39, tmpMeta41));
          tmp3 = tmpMeta42;
          goto tmp5_done;
        }
        case 9: {
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          modelica_metatype tmpMeta45;
          modelica_metatype tmpMeta46;
          modelica_metatype tmpMeta47;
          
          /* Pattern matching succeeded */
          tmpMeta43 = stringAppend(_str,_OMC_LIT212);
          tmpMeta44 = stringAppend(_OMC_LIT215,_s);
          tmpMeta45 = stringAppend(tmpMeta44,omc_NBEquation_EquationAttributes_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 5))), _OMC_LIT56));
          tmpMeta46 = stringAppend(tmpMeta45,_OMC_LIT22);
          tmpMeta47 = stringAppend(_str,omc_NBEquation_WhenEquationBody_toString(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 3))), tmpMeta43, tmpMeta46, 0 /* false */));
          tmp3 = tmpMeta47;
          goto tmp5_done;
        }
        case 10: {
          modelica_metatype tmpMeta48;
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          
          /* Pattern matching succeeded */
          tmpMeta48 = stringAppend(_str,_OMC_LIT216);
          tmpMeta49 = stringAppend(tmpMeta48,_s);
          tmpMeta50 = stringAppend(tmpMeta49,_OMC_LIT217);
          tmpMeta51 = stringAppend(tmpMeta50,omc_NFVariable_toString(threadData, omc_Pointer_access(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_eq), 2)))), _OMC_LIT6, 0 /* false */));
          tmp3 = tmpMeta51;
          goto tmp5_done;
        }
        case 11: {
          modelica_metatype tmpMeta52;
          
          /* Pattern matching succeeded */
          tmpMeta52 = stringAppend(_str,_OMC_LIT218);
          tmp3 = tmpMeta52;
          goto tmp5_done;
        }
        default:
        tmp5_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          modelica_metatype tmpMeta55;
          
          /* Pattern matching succeeded */
          tmpMeta53 = stringAppend(_str,_OMC_LIT219);
          tmpMeta54 = stringAppend(tmpMeta53,_OMC_LIT220);
          tmpMeta55 = stringAppend(tmpMeta54,_OMC_LIT221);
          tmp3 = tmpMeta55;
          goto tmp5_done;
        }
        }
        goto tmp5_end;
        tmp5_end: ;
      }
      goto goto_4;
      goto_4:;
      MMC_THROW_INTERNAL();
      goto tmp5_done;
      tmp5_done:;
    }
  }
  _str = tmp3;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_map(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_fnptr _funcExp, modelica_metatype _funcCrefOpt, modelica_fnptr _mapFunc)
{
  modelica_metatype _iter = NULL;
  modelica_fnptr _funcCref;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          if(isSome(_funcCrefOpt))
          {
            _funcCref = (modelica_fnptr) omc_Util_getOption(threadData, _funcCrefOpt);

            tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_iter), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[2] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2)))) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
            _iter = tmpMeta5;
          }

          tmpMeta6 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta6), MMC_UNTAGPTR(_iter), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta6))[3] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), ((modelica_fnptr) _funcExp));
          _iter = tmpMeta6;
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        case 4: {
          modelica_integer tmp7;
          modelica_integer tmp8;
          modelica_integer tmp9;
          modelica_integer tmp10;
          modelica_integer tmp11;
          modelica_integer tmp12;
          
          /* Pattern matching succeeded */
          if(isSome(_funcCrefOpt))
          {
            _funcCref = (modelica_fnptr) omc_Util_getOption(threadData, _funcCrefOpt);

            tmp7 = ((modelica_integer) 1); tmp8 = 1; tmp9 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
            if(!(((tmp8 > 0) && (tmp7 > tmp9)) || ((tmp8 < 0) && (tmp7 < tmp9))))
            {
              modelica_integer _i;
              for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp7, tmp9); _i += tmp8)
              {
                arrayUpdate((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i,(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 2))), arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */) : ((modelica_metatype(*)(threadData_t*, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_funcCref), 1)))) (threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */));
              }
            }
          }

          tmp10 = ((modelica_integer) 1); tmp11 = 1; tmp12 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))));
          if(!(((tmp11 > 0) && (tmp10 > tmp12)) || ((tmp11 < 0) && (tmp10 < tmp12))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp10, tmp12); _i += tmp11)
            {
              arrayUpdate((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i,(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 2))), arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */, ((modelica_fnptr) _funcExp)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_fnptr)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_mapFunc), 1)))) (threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */, ((modelica_fnptr) _funcExp)));
            }
          }
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT223);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iter = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iter;
}

PROTECTED_FUNCTION_STATIC modelica_string omc_NBEquation_Iterator_toString_singleStr(threadData_t *threadData, modelica_metatype _name, modelica_metatype _range, modelica_metatype _map)
{
  modelica_string _str = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype _names = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = stringAppend(omc_NFComponentRef_toString(threadData, _name),_OMC_LIT224);
  tmpMeta2 = stringAppend(tmpMeta1,omc_NFExpression_toString(threadData, _range));
  _str = tmpMeta2;
  // _names has no default value.
  if(isSome(_map))
  {
    _names = omc_NBEquation_Iterator_getFrames(threadData, omc_Util_getOption(threadData, _map), NULL, NULL);

    tmpMeta3 = stringAppend(_str,_OMC_LIT225);
    tmpMeta4 = stringAppend(tmpMeta3,omc_NFComponentRef_toString(threadData, listHead(_names)));
    tmpMeta5 = stringAppend(tmpMeta4,_OMC_LIT21);
    _str = tmpMeta5;
  }
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_string omc_NBEquation_Iterator_toString(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_string _str = NULL;
  modelica_string tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _str = _OMC_LIT6;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_Iterator_toString_singleStr(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))));
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar65;
            modelica_metatype* tmp6;
            modelica_metatype tmpMeta7;
            modelica_string __omcQ_24tmpVar64;
            modelica_integer tmp8;
            modelica_integer tmp9;
            modelica_integer tmp10;
            modelica_integer _i;
            tmp9 = 1 /* Range step-value */;
            tmp10 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2)))) /* Range stop-value */;
            _i = ((modelica_integer) 1) /* Range start-value */;
            _i = (((modelica_integer) 1) /* Range start-value */)-tmp9;
            tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar65 = tmpMeta7; /* defaultValue */
            tmp6 = &__omcQ_24tmpVar65;
            while(1) {
              tmp8 = 1;
              if (tmp9 > 0 ? _i+tmp9 <= tmp10 : _i+tmp9 >= tmp10) {
                _i += tmp9;
                tmp8--;
              }
              if (tmp8 == 0) {
                __omcQ_24tmpVar64 = omc_NBEquation_Iterator_toString_singleStr(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))),_i) /* DAE.ASUB */);
                *tmp6 = mmc_mk_cons(__omcQ_24tmpVar64,0);
                tmp6 = &MMC_CDR(*tmp6);
              } else if (tmp8 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp6 = mmc_mk_nil();
            tmpMeta5 = __omcQ_24tmpVar65;
          }
          tmpMeta11 = stringAppend(_OMC_LIT226,stringDelimitList(tmpMeta5, _OMC_LIT86));
          tmpMeta12 = stringAppend(tmpMeta11,_OMC_LIT227);
          tmp1 = tmpMeta12;
          goto tmp3_done;
        }
        case 5: {
          
          /* Pattern matching succeeded */
          tmp1 = _OMC_LIT228;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          omc_Error_addMessage(threadData, _OMC_LIT4, _OMC_LIT230);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _str = tmp1;
  _return: OMC_LABEL_UNUSED
  return _str;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_applyOrder_applySingleOrder(threadData_t *threadData, modelica_metatype _name, modelica_metatype __omcQ_24in_5Frange, modelica_metatype _order)
{
  modelica_metatype _range = NULL;
  modelica_integer _eo;
  modelica_metatype _step = NULL;
  modelica_metatype _res = NULL;
  modelica_metatype _elements = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _range = __omcQ_24in_5Frange;
  _eo = mmc_unbox_integer(omc_UnorderedMap_getOrDefault(threadData, _name, _order, mmc_mk_integer(1)));
  // _step has no default value.
  // _res has no default value.
  // _elements has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _range;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,10,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _step = omc_Util_getOptionOrDefault(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 4))), _OMC_LIT231);

          if(((omc_NFExpression_isNegative(threadData, _step) && ((modelica_integer)_eo == 2)) || (omc_NFExpression_isPositive(threadData, _step) && ((modelica_integer)_eo == 3))))
          {
            _res = omc_NFExpression_revertRange(threadData, _range);
          }
          else
          {
            _res = _range;
          }
          tmpMeta1 = _res;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,8,3) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 4));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (1 /* true */ != tmp7) goto tmp3_end;
          /* Pattern matching succeeded */
          if(((modelica_integer)_eo == 2))
          {
            {
              modelica_metatype __omcQ_24tmpVar67;
              modelica_metatype* tmp9;
              modelica_metatype tmpMeta10;
              modelica_metatype __omcQ_24tmpVar66;
              modelica_integer tmp11;
              modelica_metatype _e_loopVar = 0;
              modelica_integer tmp12;
              modelica_metatype _e;
              _e_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 3)));
              tmp12 = 1;
              tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar67 = tmpMeta10; /* defaultValue */
              tmp9 = &__omcQ_24tmpVar67;
              while(1) {
                tmp11 = 1;
                if (tmp12 <= arrayLength(_e_loopVar)) {
                  _e = arrayGet(_e_loopVar, tmp12++);
                  tmp11--;
                }
                if (tmp11 == 0) {
                  __omcQ_24tmpVar66 = mmc_mk_integer(omc_NFExpression_getInteger(threadData, _e));
                  *tmp9 = mmc_mk_cons(__omcQ_24tmpVar66,0);
                  tmp9 = &MMC_CDR(*tmp9);
                } else if (tmp11 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp9 = mmc_mk_nil();
              tmpMeta8 = __omcQ_24tmpVar67;
            }
            _elements = tmpMeta8;

            {
              modelica_metatype __omcQ_24tmpVar69;
              modelica_metatype* tmp15;
              modelica_metatype tmpMeta16;
              modelica_metatype tmpMeta17;
              modelica_metatype __omcQ_24tmpVar68;
              modelica_integer tmp18;
              modelica_metatype _e_loopVar = 0;
              modelica_metatype _e;
              _e_loopVar = omc_List_sort(threadData, _elements, boxvar_intGt);
              tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar69 = tmpMeta16; /* defaultValue */
              tmp15 = &__omcQ_24tmpVar69;
              while(1) {
                tmp18 = 1;
                if (!listEmpty(_e_loopVar)) {
                  _e = MMC_CAR(_e_loopVar);
                  _e_loopVar = MMC_CDR(_e_loopVar);
                  tmp18--;
                }
                if (tmp18 == 0) {
                  tmpMeta17 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _e);
                  __omcQ_24tmpVar68 = tmpMeta17;
                  *tmp15 = mmc_mk_cons(__omcQ_24tmpVar68,0);
                  tmp15 = &MMC_CDR(*tmp15);
                } else if (tmp18 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp15 = mmc_mk_nil();
              tmpMeta14 = __omcQ_24tmpVar69;
            }
            tmpMeta13 = MMC_TAGPTR(mmc_alloc_words(5));
            memcpy(MMC_UNTAGPTR(tmpMeta13), MMC_UNTAGPTR(_range), 5*sizeof(modelica_metatype));
            ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta13))[3] = listArray(tmpMeta14);
            _range = tmpMeta13;
          }
          else
          {
            if(((modelica_integer)_eo == 3))
            {
              {
                modelica_metatype __omcQ_24tmpVar71;
                modelica_metatype* tmp20;
                modelica_metatype tmpMeta21;
                modelica_metatype __omcQ_24tmpVar70;
                modelica_integer tmp22;
                modelica_metatype _e_loopVar = 0;
                modelica_integer tmp23;
                modelica_metatype _e;
                _e_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 3)));
                tmp23 = 1;
                tmpMeta21 = MMC_REFSTRUCTLIT(mmc_nil);
                __omcQ_24tmpVar71 = tmpMeta21; /* defaultValue */
                tmp20 = &__omcQ_24tmpVar71;
                while(1) {
                  tmp22 = 1;
                  if (tmp23 <= arrayLength(_e_loopVar)) {
                    _e = arrayGet(_e_loopVar, tmp23++);
                    tmp22--;
                  }
                  if (tmp22 == 0) {
                    __omcQ_24tmpVar70 = mmc_mk_integer(omc_NFExpression_getInteger(threadData, _e));
                    *tmp20 = mmc_mk_cons(__omcQ_24tmpVar70,0);
                    tmp20 = &MMC_CDR(*tmp20);
                  } else if (tmp22 == 1) {
                    break;
                  } else {
                    goto goto_2;
                  }
                }
                *tmp20 = mmc_mk_nil();
                tmpMeta19 = __omcQ_24tmpVar71;
              }
              _elements = tmpMeta19;

              {
                modelica_metatype __omcQ_24tmpVar73;
                modelica_metatype* tmp26;
                modelica_metatype tmpMeta27;
                modelica_metatype tmpMeta28;
                modelica_metatype __omcQ_24tmpVar72;
                modelica_integer tmp29;
                modelica_metatype _e_loopVar = 0;
                modelica_metatype _e;
                _e_loopVar = omc_List_sort(threadData, _elements, boxvar_intLt);
                tmpMeta27 = MMC_REFSTRUCTLIT(mmc_nil);
                __omcQ_24tmpVar73 = tmpMeta27; /* defaultValue */
                tmp26 = &__omcQ_24tmpVar73;
                while(1) {
                  tmp29 = 1;
                  if (!listEmpty(_e_loopVar)) {
                    _e = MMC_CAR(_e_loopVar);
                    _e_loopVar = MMC_CDR(_e_loopVar);
                    tmp29--;
                  }
                  if (tmp29 == 0) {
                    tmpMeta28 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _e);
                    __omcQ_24tmpVar72 = tmpMeta28;
                    *tmp26 = mmc_mk_cons(__omcQ_24tmpVar72,0);
                    tmp26 = &MMC_CDR(*tmp26);
                  } else if (tmp29 == 1) {
                    break;
                  } else {
                    goto goto_2;
                  }
                }
                *tmp26 = mmc_mk_nil();
                tmpMeta25 = __omcQ_24tmpVar73;
              }
              tmpMeta24 = MMC_TAGPTR(mmc_alloc_words(5));
              memcpy(MMC_UNTAGPTR(tmpMeta24), MMC_UNTAGPTR(_range), 5*sizeof(modelica_metatype));
              ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta24))[3] = listArray(tmpMeta25);
              _range = tmpMeta24;
            }
          }
          tmpMeta1 = _range;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          
          /* Pattern matching succeeded */
          tmpMeta31 = stringAppend(_OMC_LIT232,omc_NFExpression_toString(threadData, _range));
          tmpMeta30 = mmc_mk_cons(tmpMeta31, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta30);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _range = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _range;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_applyOrder(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _order)
{
  modelica_metatype _iter = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta5), MMC_UNTAGPTR(_iter), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta5))[3] = omc_NBEquation_Iterator_applyOrder_applySingleOrder(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), _order);
          _iter = tmpMeta5;
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        case 4: {
          modelica_integer tmp6;
          modelica_integer tmp7;
          modelica_integer tmp8;
          
          /* Pattern matching succeeded */
          tmp6 = ((modelica_integer) 1); tmp7 = 1; tmp8 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
          if(!(((tmp7 > 0) && (tmp6 > tmp8)) || ((tmp7 < 0) && (tmp6 < tmp8))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp6, tmp8); _i += tmp7)
            {
              arrayUpdate((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i,omc_NBEquation_Iterator_applyOrder_applySingleOrder(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */, _order));
            }
          }
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iter = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iter;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_adaptArray(threadData_t *threadData, modelica_metatype __omcQ_24in_5Farray, modelica_metatype _rhs, modelica_metatype _operator)
{
  modelica_metatype _array = NULL;
  modelica_integer _thresh;
  modelica_metatype _elems = NULL;
  modelica_integer tmp1_c0 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta17;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _array = __omcQ_24in_5Farray;
  // _thresh has no default value.
  // _elems has no default value.
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _rhs;
    tmp4_2 = _array;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,8,3) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          if (1 /* true */ != tmp9) goto tmp3_end;
          _thresh = tmp7  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar75;
            modelica_metatype* tmp11;
            modelica_metatype tmpMeta12;
            modelica_metatype __omcQ_24tmpVar74;
            modelica_integer tmp13;
            modelica_metatype _e_loopVar = 0;
            modelica_integer tmp14;
            modelica_metatype _e;
            _e_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_array), 3)));
            tmp14 = 1;
            tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar75 = tmpMeta12; /* defaultValue */
            tmp11 = &__omcQ_24tmpVar75;
            while(1) {
              tmp13 = 1;
              if (tmp14 <= arrayLength(_e_loopVar)) {
                _e = arrayGet(_e_loopVar, tmp14++);
                tmp13--;
              }
              if (tmp13 == 0) {
                __omcQ_24tmpVar74 = mmc_mk_integer(omc_NFExpression_integerValue(threadData, _e));
                *tmp11 = mmc_mk_cons(__omcQ_24tmpVar74,0);
                tmp11 = &MMC_CDR(*tmp11);
              } else if (tmp13 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp11 = mmc_mk_nil();
            tmpMeta10 = __omcQ_24tmpVar75;
          }
          tmp1_c0 = _thresh;
          tmpMeta[0+1] = tmpMeta10;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          
          /* Pattern matching succeeded */
          tmpMeta16 = stringAppend(_OMC_LIT233,omc_NFExpression_toString(threadData, _array));
          tmpMeta15 = mmc_mk_cons(tmpMeta16, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta15);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _thresh = tmp1_c0;
  _elems = tmpMeta[0+1];

  { /* match expression */
    modelica_metatype tmp20_1;
    tmp20_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_operator), 3)));
    {
      volatile mmc_switch_type tmp20;
      int tmp21;
      tmp20 = 0;
      for (; tmp20 < 7; tmp20++) {
        switch (MMC_SWITCH_CAST(tmp20)) {
        case 0: {
          modelica_integer tmp22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_boolean tmp25;
          modelica_metatype tmpMeta26;
          tmp22 = mmc_unbox_integer(tmp20_1);
          if (34 != tmp22) goto tmp19_end;
          /* Pattern matching succeeded */
          tmp25 = (modelica_boolean)omc_List_contains(threadData, _elems, mmc_mk_integer(_thresh), boxvar_intEq);
          if(tmp25)
          {
            tmpMeta23 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_thresh));
            tmpMeta24 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_thresh));
            tmpMeta26 = omc_NFExpression_makeRange(threadData, tmpMeta23, mmc_mk_none(), tmpMeta24);
          }
          else
          {
            tmpMeta26 = omc_NFExpression_makeRange(threadData, _OMC_LIT234, _OMC_LIT235, _OMC_LIT234);
          }
          tmpMeta17 = tmpMeta26;
          goto tmp19_done;
        }
        case 1: {
          modelica_integer tmp27;
          modelica_metatype tmpMeta28;
          tmp27 = mmc_unbox_integer(tmp20_1);
          if (35 != tmp27) goto tmp19_end;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar77;
            modelica_metatype* tmp29;
            modelica_metatype tmpMeta30;
            modelica_metatype tmpMeta31;
            modelica_metatype __omcQ_24tmpVar76;
            modelica_integer tmp32;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _elems;
            tmpMeta30 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar77 = tmpMeta30; /* defaultValue */
            tmp29 = &__omcQ_24tmpVar77;
            while(1) {
              tmp32 = 1;
              while (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                if ((mmc_unbox_integer(_i) != _thresh)) {
                  tmp32--;
                  break;
                }
              }
              if (tmp32 == 0) {
                tmpMeta31 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                __omcQ_24tmpVar76 = tmpMeta31;
                *tmp29 = mmc_mk_cons(__omcQ_24tmpVar76,0);
                tmp29 = &MMC_CDR(*tmp29);
              } else if (tmp32 == 1) {
                break;
              } else {
                goto goto_18;
              }
            }
            *tmp29 = mmc_mk_nil();
            tmpMeta28 = __omcQ_24tmpVar77;
          }
          tmpMeta17 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta28), _OMC_LIT96, 1 /* true */);
          goto tmp19_done;
        }
        case 2: {
          modelica_integer tmp33;
          modelica_metatype tmpMeta34;
          tmp33 = mmc_unbox_integer(tmp20_1);
          if (30 != tmp33) goto tmp19_end;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar79;
            modelica_metatype* tmp35;
            modelica_metatype tmpMeta36;
            modelica_metatype tmpMeta37;
            modelica_metatype __omcQ_24tmpVar78;
            modelica_integer tmp38;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _elems;
            tmpMeta36 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar79 = tmpMeta36; /* defaultValue */
            tmp35 = &__omcQ_24tmpVar79;
            while(1) {
              tmp38 = 1;
              while (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                if ((mmc_unbox_integer(_i) < _thresh)) {
                  tmp38--;
                  break;
                }
              }
              if (tmp38 == 0) {
                tmpMeta37 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                __omcQ_24tmpVar78 = tmpMeta37;
                *tmp35 = mmc_mk_cons(__omcQ_24tmpVar78,0);
                tmp35 = &MMC_CDR(*tmp35);
              } else if (tmp38 == 1) {
                break;
              } else {
                goto goto_18;
              }
            }
            *tmp35 = mmc_mk_nil();
            tmpMeta34 = __omcQ_24tmpVar79;
          }
          tmpMeta17 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta34), _OMC_LIT96, 1 /* true */);
          goto tmp19_done;
        }
        case 3: {
          modelica_integer tmp39;
          modelica_metatype tmpMeta40;
          tmp39 = mmc_unbox_integer(tmp20_1);
          if (31 != tmp39) goto tmp19_end;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar81;
            modelica_metatype* tmp41;
            modelica_metatype tmpMeta42;
            modelica_metatype tmpMeta43;
            modelica_metatype __omcQ_24tmpVar80;
            modelica_integer tmp44;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _elems;
            tmpMeta42 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar81 = tmpMeta42; /* defaultValue */
            tmp41 = &__omcQ_24tmpVar81;
            while(1) {
              tmp44 = 1;
              while (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                if ((mmc_unbox_integer(_i) <= _thresh)) {
                  tmp44--;
                  break;
                }
              }
              if (tmp44 == 0) {
                tmpMeta43 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                __omcQ_24tmpVar80 = tmpMeta43;
                *tmp41 = mmc_mk_cons(__omcQ_24tmpVar80,0);
                tmp41 = &MMC_CDR(*tmp41);
              } else if (tmp44 == 1) {
                break;
              } else {
                goto goto_18;
              }
            }
            *tmp41 = mmc_mk_nil();
            tmpMeta40 = __omcQ_24tmpVar81;
          }
          tmpMeta17 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta40), _OMC_LIT96, 1 /* true */);
          goto tmp19_done;
        }
        case 4: {
          modelica_integer tmp45;
          modelica_metatype tmpMeta46;
          tmp45 = mmc_unbox_integer(tmp20_1);
          if (32 != tmp45) goto tmp19_end;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar83;
            modelica_metatype* tmp47;
            modelica_metatype tmpMeta48;
            modelica_metatype tmpMeta49;
            modelica_metatype __omcQ_24tmpVar82;
            modelica_integer tmp50;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _elems;
            tmpMeta48 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar83 = tmpMeta48; /* defaultValue */
            tmp47 = &__omcQ_24tmpVar83;
            while(1) {
              tmp50 = 1;
              while (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                if ((mmc_unbox_integer(_i) > _thresh)) {
                  tmp50--;
                  break;
                }
              }
              if (tmp50 == 0) {
                tmpMeta49 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                __omcQ_24tmpVar82 = tmpMeta49;
                *tmp47 = mmc_mk_cons(__omcQ_24tmpVar82,0);
                tmp47 = &MMC_CDR(*tmp47);
              } else if (tmp50 == 1) {
                break;
              } else {
                goto goto_18;
              }
            }
            *tmp47 = mmc_mk_nil();
            tmpMeta46 = __omcQ_24tmpVar83;
          }
          tmpMeta17 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta46), _OMC_LIT96, 1 /* true */);
          goto tmp19_done;
        }
        case 5: {
          modelica_integer tmp51;
          modelica_metatype tmpMeta52;
          tmp51 = mmc_unbox_integer(tmp20_1);
          if (33 != tmp51) goto tmp19_end;
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar85;
            modelica_metatype* tmp53;
            modelica_metatype tmpMeta54;
            modelica_metatype tmpMeta55;
            modelica_metatype __omcQ_24tmpVar84;
            modelica_integer tmp56;
            modelica_metatype _i_loopVar = 0;
            modelica_metatype _i;
            _i_loopVar = _elems;
            tmpMeta54 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar85 = tmpMeta54; /* defaultValue */
            tmp53 = &__omcQ_24tmpVar85;
            while(1) {
              tmp56 = 1;
              while (!listEmpty(_i_loopVar)) {
                _i = MMC_CAR(_i_loopVar);
                _i_loopVar = MMC_CDR(_i_loopVar);
                if ((mmc_unbox_integer(_i) >= _thresh)) {
                  tmp56--;
                  break;
                }
              }
              if (tmp56 == 0) {
                tmpMeta55 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                __omcQ_24tmpVar84 = tmpMeta55;
                *tmp53 = mmc_mk_cons(__omcQ_24tmpVar84,0);
                tmp53 = &MMC_CDR(*tmp53);
              } else if (tmp56 == 1) {
                break;
              } else {
                goto goto_18;
              }
            }
            *tmp53 = mmc_mk_nil();
            tmpMeta52 = __omcQ_24tmpVar85;
          }
          tmpMeta17 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta52), _OMC_LIT96, 1 /* true */);
          goto tmp19_done;
        }
        case 6: {
          modelica_metatype tmpMeta57;
          modelica_metatype tmpMeta58;
          
          /* Pattern matching succeeded */
          tmpMeta58 = stringAppend(_OMC_LIT236,omc_NFOperator_toDebugString(threadData, _operator));
          tmpMeta57 = mmc_mk_cons(tmpMeta58, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta57);
          goto goto_18;
          goto tmp19_done;
        }
        }
        goto tmp19_end;
        tmp19_end: ;
      }
      goto goto_18;
      goto_18:;
      MMC_THROW_INTERNAL();
      goto tmp19_done;
      tmp19_done:;
    }
  }
  _array = tmpMeta17;
  _return: OMC_LABEL_UNUSED
  return _array;
}

PROTECTED_FUNCTION_STATIC modelica_integer omc_NBEquation_Iterator_interceptRange_lowerBoundary(threadData_t *threadData, modelica_integer _thresh, modelica_integer _start, modelica_integer _step)
{
  modelica_integer _boundary;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _boundary = _thresh + modelica_integer_mod(_start - _thresh, _step);
  _return: OMC_LABEL_UNUSED
  return _boundary;
}
PROTECTED_FUNCTION_STATIC modelica_metatype boxptr_NBEquation_Iterator_interceptRange_lowerBoundary(threadData_t *threadData, modelica_metatype _thresh, modelica_metatype _start, modelica_metatype _step)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer _boundary;
  modelica_metatype out_boundary;
  tmp1 = mmc_unbox_integer(_thresh);
  tmp2 = mmc_unbox_integer(_start);
  tmp3 = mmc_unbox_integer(_step);
  _boundary = omc_NBEquation_Iterator_interceptRange_lowerBoundary(threadData, tmp1, tmp2, tmp3);
  out_boundary = mmc_mk_icon(_boundary);
  return out_boundary;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_interceptRange(threadData_t *threadData, modelica_integer _thresh, modelica_integer _start, modelica_integer _step, modelica_integer _stop, modelica_boolean _within_range, modelica_boolean _at_end, modelica_metatype __omcQ_24in_5Frange, modelica_fnptr _func)
{
  modelica_metatype _range = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _range = __omcQ_24in_5Frange;
  if(_within_range)
  {
    if(_at_end)
    {
      tmpMeta1 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start));
      tmpMeta2 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_step));
      tmpMeta3 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_thresh));
      _range = omc_NFExpression_makeRange(threadData, tmpMeta1, mmc_mk_some(tmpMeta2), tmpMeta3);
    }
    else
    {
      tmpMeta4 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(omc_NBEquation_Iterator_interceptRange_lowerBoundary(threadData, _thresh, _start, _step)));
      tmpMeta5 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_step));
      tmpMeta6 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_stop));
      _range = omc_NFExpression_makeRange(threadData, tmpMeta4, mmc_mk_some(tmpMeta5), tmpMeta6);
    }
  }
  else
  {
    if(mmc_unbox_boolean((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))) ? ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 2))), mmc_mk_integer((_at_end?_stop:_start)), mmc_mk_integer(_thresh)) : ((modelica_metatype(*)(threadData_t*, modelica_metatype, modelica_metatype)) (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_func), 1)))) (threadData, mmc_mk_integer((_at_end?_stop:_start)), mmc_mk_integer(_thresh))))
    {
      _range = omc_NFExpression_makeRange(threadData, _OMC_LIT234, _OMC_LIT235, _OMC_LIT234);
    }
  }
  _return: OMC_LABEL_UNUSED
  return _range;
}
modelica_metatype boxptr_NBEquation_Iterator_interceptRange(threadData_t *threadData, modelica_metatype _thresh, modelica_metatype _start, modelica_metatype _step, modelica_metatype _stop, modelica_metatype _within_range, modelica_metatype _at_end, modelica_metatype __omcQ_24in_5Frange, modelica_fnptr _func)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_integer tmp6;
  modelica_metatype _range = NULL;
  tmp1 = mmc_unbox_integer(_thresh);
  tmp2 = mmc_unbox_integer(_start);
  tmp3 = mmc_unbox_integer(_step);
  tmp4 = mmc_unbox_integer(_stop);
  tmp5 = mmc_unbox_integer(_within_range);
  tmp6 = mmc_unbox_integer(_at_end);
  _range = omc_NBEquation_Iterator_interceptRange(threadData, tmp1, tmp2, tmp3, tmp4, tmp5, tmp6, __omcQ_24in_5Frange, _func);
  /* skip box _range; NFExpression */
  return _range;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_adaptRange(threadData_t *threadData, modelica_metatype __omcQ_24in_5Frange, modelica_metatype _rhs, modelica_metatype _operator)
{
  modelica_metatype _range = NULL;
  modelica_integer _thresh;
  modelica_integer _start;
  modelica_integer _step;
  modelica_integer _stop;
  modelica_boolean _within_range;
  modelica_integer tmp1_c0 __attribute__((unused)) = 0;
  modelica_integer tmp1_c1 __attribute__((unused)) = 0;
  modelica_integer tmp1_c2 __attribute__((unused)) = 0;
  modelica_integer tmp1_c3 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta28;
  modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _range = __omcQ_24in_5Frange;
  // _thresh has no default value.
  // _start has no default value.
  // _step has no default value.
  // _stop has no default value.
  // _within_range has no default value.
  
  
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _rhs;
    tmp4_2 = _range;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_integer tmp10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_integer tmp14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_integer tmp17;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp7 = mmc_unbox_integer(tmpMeta6);
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,10,4) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta8,0,1) == 0) goto tmp3_end;
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta8), 2));
          tmp10 = mmc_unbox_integer(tmpMeta9);
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (optionNone(tmpMeta11)) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta12,0,1) == 0) goto tmp3_end;
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 2));
          tmp14 = mmc_unbox_integer(tmpMeta13);
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta15,0,1) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta15), 2));
          tmp17 = mmc_unbox_integer(tmpMeta16);
          _thresh = tmp7  /* pattern as ty=Integer */;
          _range = tmp4_2;
          _start = tmp10  /* pattern as ty=Integer */;
          _step = tmp14  /* pattern as ty=Integer */;
          _stop = tmp17  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmp1_c0 = _thresh;
          tmp1_c1 = _start;
          tmp1_c2 = _step;
          tmp1_c3 = _stop;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta18;
          modelica_integer tmp19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_integer tmp22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_integer tmp25;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,1) == 0) goto tmp3_end;
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp19 = mmc_unbox_integer(tmpMeta18);
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,10,4) == 0) goto tmp3_end;
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta20,0,1) == 0) goto tmp3_end;
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta20), 2));
          tmp22 = mmc_unbox_integer(tmpMeta21);
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta23,0,1) == 0) goto tmp3_end;
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta23), 2));
          tmp25 = mmc_unbox_integer(tmpMeta24);
          _thresh = tmp19  /* pattern as ty=Integer */;
          _range = tmp4_2;
          _start = tmp22  /* pattern as ty=Integer */;
          _stop = tmp25  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmp1_c0 = _thresh;
          tmp1_c1 = _start;
          tmp1_c2 = ((modelica_integer) 1);
          tmp1_c3 = _stop;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          
          /* Pattern matching succeeded */
          tmpMeta27 = stringAppend(_OMC_LIT237,omc_NFExpression_toString(threadData, _range));
          tmpMeta26 = mmc_mk_cons(tmpMeta27, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta26);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _thresh = tmp1_c0;
  _start = tmp1_c1;
  _step = tmp1_c2;
  _stop = tmp1_c3;

  _within_range = (((_thresh) * (sign(((modelica_real)_step))) > (_start) * (sign(((modelica_real)_step)))) && ((_thresh) * (sign(((modelica_real)_step))) < (_stop) * (sign(((modelica_real)_step)))));

  { /* match expression */
    modelica_metatype tmp31_1;
    tmp31_1 = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_operator), 3)));
    {
      volatile mmc_switch_type tmp31;
      int tmp32;
      tmp31 = 0;
      for (; tmp31 < 7; tmp31++) {
        switch (MMC_SWITCH_CAST(tmp31)) {
        case 0: {
          modelica_integer tmp33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_boolean tmp36;
          modelica_metatype tmpMeta37;
          tmp33 = mmc_unbox_integer(tmp31_1);
          if (34 != tmp33) goto tmp30_end;
          /* Pattern matching succeeded */
          tmp36 = (modelica_boolean)_within_range;
          if(tmp36)
          {
            tmpMeta34 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_thresh));
            tmpMeta35 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_thresh));
            tmpMeta37 = omc_NFExpression_makeRange(threadData, tmpMeta34, mmc_mk_none(), tmpMeta35);
          }
          else
          {
            tmpMeta37 = omc_NFExpression_makeRange(threadData, _OMC_LIT234, _OMC_LIT235, _OMC_LIT234);
          }
          tmpMeta28 = tmpMeta37;
          goto tmp30_done;
        }
        case 1: {
          modelica_integer tmp38;
          modelica_metatype tmpMeta39;
          modelica_boolean tmp44;
          modelica_metatype tmpMeta45;
          tmp38 = mmc_unbox_integer(tmp31_1);
          if (35 != tmp38) goto tmp30_end;
          /* Pattern matching succeeded */
          tmp44 = (modelica_boolean)_within_range;
          if(tmp44)
          {
            {
              modelica_metatype __omcQ_24tmpVar87;
              modelica_metatype* tmp40;
              modelica_metatype tmpMeta41;
              modelica_metatype tmpMeta42;
              modelica_metatype __omcQ_24tmpVar86;
              modelica_integer tmp43;
              modelica_metatype _i_loopVar = 0;
              modelica_metatype _i;
              _i_loopVar = omc_List_intRange3(threadData, _start, _step, _stop);
              tmpMeta41 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar87 = tmpMeta41; /* defaultValue */
              tmp40 = &__omcQ_24tmpVar87;
              while(1) {
                tmp43 = 1;
                while (!listEmpty(_i_loopVar)) {
                  _i = MMC_CAR(_i_loopVar);
                  _i_loopVar = MMC_CDR(_i_loopVar);
                  if ((mmc_unbox_integer(_i) != _thresh)) {
                    tmp43--;
                    break;
                  }
                }
                if (tmp43 == 0) {
                  tmpMeta42 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, _i);
                  __omcQ_24tmpVar86 = tmpMeta42;
                  *tmp40 = mmc_mk_cons(__omcQ_24tmpVar86,0);
                  tmp40 = &MMC_CDR(*tmp40);
                } else if (tmp43 == 1) {
                  break;
                } else {
                  goto goto_29;
                }
              }
              *tmp40 = mmc_mk_nil();
              tmpMeta39 = __omcQ_24tmpVar87;
            }
            tmpMeta45 = omc_NFExpression_makeExpArray(threadData, listArray(tmpMeta39), _OMC_LIT96, 1 /* true */);
          }
          else
          {
            tmpMeta45 = _range;
          }
          tmpMeta28 = tmpMeta45;
          goto tmp30_done;
        }
        case 2: {
          modelica_integer tmp46;
          tmp46 = mmc_unbox_integer(tmp31_1);
          if (30 != tmp46) goto tmp30_end;
          /* Pattern matching succeeded */
          tmpMeta28 = omc_NBEquation_Iterator_interceptRange(threadData, ((modelica_integer) -1) + _thresh, _start, _step, _stop, _within_range, (sign(((modelica_real)_step)) > ((modelica_integer) 0)), _range, boxvar_intLe);
          goto tmp30_done;
        }
        case 3: {
          modelica_integer tmp47;
          tmp47 = mmc_unbox_integer(tmp31_1);
          if (31 != tmp47) goto tmp30_end;
          /* Pattern matching succeeded */
          tmpMeta28 = omc_NBEquation_Iterator_interceptRange(threadData, _thresh, _start, _step, _stop, _within_range, (sign(((modelica_real)_step)) > ((modelica_integer) 0)), _range, boxvar_intLt);
          goto tmp30_done;
        }
        case 4: {
          modelica_integer tmp48;
          tmp48 = mmc_unbox_integer(tmp31_1);
          if (32 != tmp48) goto tmp30_end;
          /* Pattern matching succeeded */
          tmpMeta28 = omc_NBEquation_Iterator_interceptRange(threadData, ((modelica_integer) 1) + _thresh, _start, _step, _stop, _within_range, (sign(((modelica_real)_step)) < ((modelica_integer) 0)), _range, boxvar_intGe);
          goto tmp30_done;
        }
        case 5: {
          modelica_integer tmp49;
          tmp49 = mmc_unbox_integer(tmp31_1);
          if (33 != tmp49) goto tmp30_end;
          /* Pattern matching succeeded */
          tmpMeta28 = omc_NBEquation_Iterator_interceptRange(threadData, _thresh, _start, _step, _stop, _within_range, (sign(((modelica_real)_step)) < ((modelica_integer) 0)), _range, boxvar_intGt);
          goto tmp30_done;
        }
        case 6: {
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          
          /* Pattern matching succeeded */
          tmpMeta51 = stringAppend(_OMC_LIT238,omc_NFOperator_toDebugString(threadData, _operator));
          tmpMeta50 = mmc_mk_cons(tmpMeta51, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta50);
          goto goto_29;
          goto tmp30_done;
        }
        }
        goto tmp30_end;
        tmp30_end: ;
      }
      goto goto_29;
      goto_29:;
      MMC_THROW_INTERNAL();
      goto tmp30_done;
      tmp30_done:;
    }
  }
  _range = tmpMeta28;
  _return: OMC_LABEL_UNUSED
  return _range;
}

static modelica_metatype closure18_NBEquation_Equation_collectFromMap(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_cref, modelica_metatype acc)
{
  modelica_metatype check_map = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBEquation_Equation_collectFromMap(thData, $in_cref, acc, check_map);
}
DLLDirection
modelica_metatype omc_NBEquation_Iterator_simplifyRangeCondition(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _condition, modelica_integer *out_status)
{
  modelica_metatype _iter = NULL;
  modelica_integer _status;
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype _iter_map = NULL;
  modelica_metatype _opt_map = NULL;
  modelica_integer tmp1_c1 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[4] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  // _status has no default value.
  // _names has no default value.
  // _ranges has no default value.
  // _maps has no default value.
  _iter_map = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));
  _opt_map = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _condition;
    {
      modelica_metatype _tmpEqn = NULL;
      modelica_metatype _occs = NULL;
      modelica_metatype _cref = NULL;
      modelica_integer _invert;
      modelica_metatype _range = NULL;
      modelica_metatype _operator = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _tmpEqn has no default value.
      // _occs has no default value.
      // _cref has no default value.
      // _invert has no default value.
      // _range has no default value.
      // _operator has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta22;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,20,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges ,&_maps);

          {
            modelica_metatype _frame;
            for (tmpMeta6 = omc_List_zip3(threadData, _names, _ranges, _maps); !listEmpty(tmpMeta6); tmpMeta6=MMC_CDR(tmpMeta6))
            {
              _frame = MMC_CAR(tmpMeta6);
              omc_UnorderedMap_add(threadData, omc_Util_tuple31(threadData, _frame), omc_Util_tuple32(threadData, _frame), _iter_map);

              omc_UnorderedMap_add(threadData, omc_Util_tuple31(threadData, _frame), omc_Util_tuple33(threadData, _frame), _opt_map);
            }
          }

          _tmpEqn = omc_Pointer_access(threadData, omc_NBEquation_Equation_makeAssignment(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_condition), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_condition), 4))), omc_Pointer_create(threadData, mmc_mk_integer(((modelica_integer) 0))), _OMC_LIT239, _OMC_LIT82, omc_NBEquation_default(threadData, 5, 0 /* false */, mmc_mk_none())));

          tmpMeta8 = mmc_mk_box1(0, _iter_map);
          _occs = omc_NBEquation_Equation_collectCrefs(threadData, _tmpEqn, (modelica_fnptr) mmc_mk_box2(0,closure18_NBEquation_Equation_collectFromMap,tmpMeta8), boxvar_NFExpression_map);

          if((listLength(_occs) == ((modelica_integer) 1)))
          {
            _cref = listHead(_occs);

            _tmpEqn = omc_NBSolve_solveBody(threadData, _tmpEqn, _cref, _OMC_LIT240 ,NULL ,&_status ,&_invert);

            _operator = (((modelica_integer)_invert == 1)?omc_NFOperator_invert(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_condition), 3)))):(MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_condition), 3))));

            if((((modelica_integer)_status == 2) && ((modelica_integer)_invert != 3)))
            {
              _range = omc_UnorderedMap_getSafe(threadData, _cref, _iter_map, _OMC_LIT241);

              { /* matchcontinue expression */
                {
                  volatile mmc_switch_type tmp11;
                  int tmp12;
                  tmp11 = 0;
                  MMC_TRY_INTERNAL(mmc_jumper)
                  tmp10_top:
                  threadData->mmc_jumper = &new_mmc_jumper;
                  for (; tmp11 < 2; tmp11++) {
                    switch (MMC_SWITCH_CAST(tmp11)) {
                    case 0: {
                      modelica_integer tmp13_c1 __attribute__((unused)) = 0;
                      /* Pattern matching succeeded */
                      
                      
                      { /* match expression */
                        modelica_metatype tmp16_1;
                        tmp16_1 = _range;
                        {
                          int tmp16;
                          {
                            switch (MMC_SWITCH_CAST(valueConstructor(tmp16_1))) {
                            case 13: {
                              
                              /* Pattern matching succeeded */
                              tmpMeta[2+0] = omc_NBEquation_Iterator_adaptRange(threadData, omc_UnorderedMap_getSafe(threadData, _cref, _iter_map, _OMC_LIT242), omc_NBEquation_Equation_getRHS(threadData, _tmpEqn), _operator);
                              tmp13_c1 = (modelica_integer)_status;
                              goto tmp15_done;
                            }
                            case 11: {
                              
                              /* Pattern matching succeeded */
                              tmpMeta[2+0] = omc_NBEquation_Iterator_adaptArray(threadData, omc_UnorderedMap_getSafe(threadData, _cref, _iter_map, _OMC_LIT243), omc_NBEquation_Equation_getRHS(threadData, _tmpEqn), _operator);
                              tmp13_c1 = (modelica_integer)_status;
                              goto tmp15_done;
                            }
                            default:
                            tmp15_default: OMC_LABEL_UNUSED; {
                              
                              /* Pattern matching succeeded */
                              tmpMeta[2+0] = _range;
                              tmp13_c1 = 4;
                              goto tmp15_done;
                            }
                            }
                            goto tmp15_end;
                            tmp15_end: ;
                          }
                          goto goto_14;
                          goto_14:;
                          goto goto_9;
                          goto tmp15_done;
                          tmp15_done:;
                        }
                      }
                      _range = tmpMeta[2+0];
                      _status = tmp13_c1;
                      goto tmp10_done;
                    }
                    case 1: {
                      modelica_metatype tmpMeta17;
                      modelica_metatype tmpMeta18;
                      modelica_metatype tmpMeta19;
                      modelica_metatype tmpMeta20;
                      modelica_metatype tmpMeta21;
                      /* Pattern matching succeeded */
                      tmpMeta18 = stringAppend(_OMC_LIT244,omc_NBEquation_Iterator_toString(threadData, _iter));
                      tmpMeta19 = stringAppend(tmpMeta18,_OMC_LIT245);
                      tmpMeta20 = stringAppend(tmpMeta19,omc_NFExpression_toString(threadData, _condition));
                      tmpMeta21 = stringAppend(tmpMeta20,_OMC_LIT41);
                      tmpMeta17 = mmc_mk_cons(tmpMeta21, MMC_REFSTRUCTLIT(mmc_nil));
                      omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta17);

                      goto goto_9;
                      goto tmp10_done;
                    }
                    }
                    goto tmp10_end;
                    tmp10_end: ;
                  }
                  goto goto_9;
                  tmp10_done:
                  (void)tmp11;
                  MMC_RESTORE_INTERNAL(mmc_jumper);
                  goto tmp10_done2;
                  goto_9:;
                  MMC_CATCH_INTERNAL(mmc_jumper);
                  if (++tmp11 < 2) {
                    goto tmp10_top;
                  }
                  goto goto_2;
                  tmp10_done2:;
                }
              }
              ;

              omc_UnorderedMap_add(threadData, _cref, _range, _iter_map);
            }
            else
            {
              _status = 4;
            }
          }

          if(((modelica_integer)_status == 2))
          {
            {
              modelica_metatype __omcQ_24tmpVar89;
              modelica_metatype* tmp23;
              modelica_metatype tmpMeta24;
              modelica_metatype tmpMeta25;
              modelica_metatype __omcQ_24tmpVar88;
              modelica_integer tmp26;
              modelica_metatype _name_loopVar = 0;
              modelica_metatype _name;
              _name_loopVar = _names;
              tmpMeta24 = MMC_REFSTRUCTLIT(mmc_nil);
              __omcQ_24tmpVar89 = tmpMeta24; /* defaultValue */
              tmp23 = &__omcQ_24tmpVar89;
              while(1) {
                tmp26 = 1;
                if (!listEmpty(_name_loopVar)) {
                  _name = MMC_CAR(_name_loopVar);
                  _name_loopVar = MMC_CDR(_name_loopVar);
                  tmp26--;
                }
                if (tmp26 == 0) {
                  tmpMeta25 = mmc_mk_box3(0, _name, omc_UnorderedMap_getSafe(threadData, _name, _iter_map, _OMC_LIT246), omc_UnorderedMap_getSafe(threadData, _name, _opt_map, _OMC_LIT246));
                  __omcQ_24tmpVar88 = tmpMeta25;
                  *tmp23 = mmc_mk_cons(__omcQ_24tmpVar88,0);
                  tmp23 = &MMC_CDR(*tmp23);
                } else if (tmp26 == 1) {
                  break;
                } else {
                  goto goto_2;
                }
              }
              *tmp23 = mmc_mk_nil();
              tmpMeta22 = __omcQ_24tmpVar89;
            }
            _iter = omc_NBEquation_Iterator_fromFrames(threadData, tmpMeta22);
          }
          tmpMeta[0+0] = _iter;
          tmp1_c1 = (modelica_integer)_status;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _iter;
          tmp1_c1 = 4;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iter = tmpMeta[0+0];
  _status = tmp1_c1;
  _return: OMC_LABEL_UNUSED
  if (out_status) { *out_status = _status; }
  return _iter;
}
modelica_metatype boxptr_NBEquation_Iterator_simplifyRangeCondition(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _condition, modelica_metatype *out_status)
{
  modelica_integer _status;
  modelica_metatype _iter = NULL;
  _iter = omc_NBEquation_Iterator_simplifyRangeCondition(threadData, __omcQ_24in_5Fiter, _condition, &_status);
  /* skip box _iter; NBEquation.Iterator */
  if (out_status) { *out_status = mmc_mk_icon(_status); }
  return _iter;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_normalizedSubscript(threadData_t *threadData, modelica_metatype _iter_name, modelica_metatype _range)
{
  modelica_metatype _sub = NULL;
  modelica_metatype _step = NULL;
  modelica_metatype _sub_exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sub has no default value.
  // _step has no default value.
  // _sub_exp has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _range;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,10,4) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          _step = omc_Util_getOptionOrDefault(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 4))), _OMC_LIT231);

          _sub_exp = omc_NFExpression_fromCref(threadData, _iter_name, 0 /* false */);

          if((!omc_NFExpression_isOne(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 3))))))
          {
            tmpMeta6 = mmc_mk_cons(_sub_exp, MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 3))), MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta8 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta6, tmpMeta7, omc_NFOperator_makeAdd(threadData, _OMC_LIT96));
            _sub_exp = tmpMeta8;
          }

          if((!omc_NFExpression_isOne(threadData, _step)))
          {
            tmpMeta9 = mmc_mk_cons(_sub_exp, MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta10 = mmc_mk_cons(_step, MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta11 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta9, tmpMeta10, omc_NFOperator_makeMul(threadData, _OMC_LIT147));
            _sub_exp = tmpMeta11;
          }

          if((!omc_NFExpression_isOne(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_range), 3))))))
          {
            tmpMeta12 = mmc_mk_cons(_sub_exp, mmc_mk_cons(_OMC_LIT231, MMC_REFSTRUCTLIT(mmc_nil)));
            tmpMeta13 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta14 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta12, tmpMeta13, omc_NFOperator_makeAdd(threadData, omc_NFExpression_typeOf(threadData, _sub_exp)));
            _sub_exp = tmpMeta14;
          }

          _sub_exp = omc_NFSimplifyExp_simplifyDump(threadData, _sub_exp, 1 /* true */, _OMC_LIT247, _OMC_LIT6);

          if((!omc_NFType_isInteger(threadData, omc_NFExpression_typeOf(threadData, _sub_exp))))
          {
            tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta16 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta17 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta18 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta19 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta20 = mmc_mk_box14(3, &NFFunction_Function_FUNCTION__desc, _OMC_LIT249, _OMC_LIT186, _OMC_LIT255, _OMC_LIT260, tmpMeta15, tmpMeta16, _OMC_LIT96, _OMC_LIT264, tmpMeta17, tmpMeta18, listArray(tmpMeta19), _OMC_LIT265, _OMC_LIT266);
            tmpMeta21 = mmc_mk_cons(_sub_exp, MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta22 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta23 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta24 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta25 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta26 = MMC_REFSTRUCTLIT(mmc_nil);
            tmpMeta27 = mmc_mk_box14(3, &NFFunction_Function_FUNCTION__desc, _OMC_LIT249, _OMC_LIT186, _OMC_LIT255, _OMC_LIT260, tmpMeta22, tmpMeta23, _OMC_LIT96, _OMC_LIT264, tmpMeta24, tmpMeta25, listArray(tmpMeta26), _OMC_LIT265, _OMC_LIT266);
            tmpMeta28 = mmc_mk_box2(16, &NFExpression_CALL__desc, omc_NFCall_makeTypedCall(threadData, tmpMeta20, tmpMeta21, 5, 1, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta27), 8)))));
            _sub_exp = tmpMeta28;
          }
          tmpMeta29 = mmc_mk_box2(5, &NFSubscript_INDEX__desc, _sub_exp);
          tmpMeta1 = tmpMeta29;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          
          /* Pattern matching succeeded */
          tmpMeta31 = stringAppend(_OMC_LIT267,omc_NFExpression_toString(threadData, _range));
          tmpMeta30 = mmc_mk_cons(tmpMeta31, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta30);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sub = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sub;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_normalizedSubscripts(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_metatype _subs = NULL;
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _subs has no default value.
  // _names has no default value.
  // _ranges has no default value.
  _names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges, NULL);

  {
    modelica_metatype __omcQ_24tmpVar91;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar90;
    modelica_integer tmp4;
    modelica_metatype _name_loopVar = 0;
    modelica_metatype _name;
    modelica_metatype _range_loopVar = 0;
    modelica_metatype _range;
    _name_loopVar = _names;
    _range_loopVar = _ranges;
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar91 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar91;
    while(1) {
      tmp4 = 2;
      if (!listEmpty(_name_loopVar)) {
        _name = MMC_CAR(_name_loopVar);
        _name_loopVar = MMC_CDR(_name_loopVar);
        tmp4--;
      }if (!listEmpty(_range_loopVar)) {
        _range = MMC_CAR(_range_loopVar);
        _range_loopVar = MMC_CDR(_range_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar90 = omc_NBEquation_Iterator_normalizedSubscript(threadData, _name, _range);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar90,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 2) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar91;
  }
  _subs = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _subs;
}

static modelica_metatype closure19_NBEquation_Iterator_extractFromCall(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp, modelica_metatype $in_iter, modelica_metatype tmp11)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  modelica_metatype new_iters = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),2));
  return boxptr_NBEquation_Iterator_extractFromCall(thData, $in_exp, $in_iter, replacements, new_iters, tmp11);
}
DLLDirection
modelica_metatype omc_NBEquation_Iterator_extractFromCall(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _replacements, modelica_metatype _new_iters, modelica_metatype *out_iter)
{
  modelica_metatype _exp = NULL;
  modelica_metatype _iter = NULL;
  modelica_metatype tmpMeta[2] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _exp = __omcQ_24in_5Fexp;
  _iter = __omcQ_24in_5Fiter;
  
  
  { /* match expression */
    modelica_metatype tmp5_1;
    tmp5_1 = _exp;
    {
      modelica_metatype _call = NULL;
      modelica_metatype _frames = NULL;
      modelica_metatype tmpMeta3;
      modelica_metatype _tmp = NULL;
      volatile mmc_switch_type tmp5;
      int tmp6;
      // _call has no default value.
      tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
      _frames = tmpMeta3;
      // _tmp has no default value.
      tmp5 = 0;
      for (; tmp5 < 3; tmp5++) {
        switch (MMC_SWITCH_CAST(tmp5)) {
        case 0: {
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,13,1) == 0) goto tmp4_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp5_1), 2));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,4,5) == 0) goto tmp4_end;
          
          _call = tmpMeta7;
          /* Pattern matching succeeded */
          {
            modelica_metatype _tpl;
            for (tmpMeta8 = listReverse((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_call), 6)))); !listEmpty(tmpMeta8); tmpMeta8=MMC_CDR(tmpMeta8))
            {
              _tpl = MMC_CAR(tmpMeta8);
              tmpMeta9 = mmc_mk_cons(omc_NBInline_inlineArrayIterator(threadData, _tpl, _new_iters), _frames);
              _frames = tmpMeta9;
            }
          }

          _tmp = omc_NBEquation_Iterator_fromFrames(threadData, _frames);

          if((!omc_NBEquation_Iterator_isEmpty(threadData, _iter)))
          {
            omc_NBEquation_Iterator_createReplacement(threadData, _iter, _tmp, _replacements);
          }
          else
          {
            _iter = _tmp;
          }
          tmpMeta[0+0] = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_call), 5)));
          tmpMeta[0+1] = _iter;
          goto tmp4_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp5_1,13,1) == 0) goto tmp4_end;
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = _exp;
          tmpMeta[0+1] = _iter;
          goto tmp4_done;
        }
        case 2: {
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = mmc_mk_box2(0, _replacements, _new_iters);
          tmpMeta[0+0] = omc_NFExpression_mapFoldShallow(threadData, _exp, (modelica_fnptr) mmc_mk_box2(0,closure19_NBEquation_Iterator_extractFromCall,tmpMeta12), _iter, &tmpMeta[0+1]);
          goto tmp4_done;
        }
        }
        goto tmp4_end;
        tmp4_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp4_done;
      tmp4_done:;
    }
  }
  _exp = tmpMeta[0+0];
  _iter = tmpMeta[0+1];
  _return: OMC_LABEL_UNUSED
  if (out_iter) { *out_iter = _iter; }
  return _exp;
}

static modelica_metatype closure20_NBReplacements_applySimpleExp(threadData_t *thData, modelica_metatype closure, modelica_metatype $in_exp)
{
  modelica_metatype replacements = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(closure),1));
  return boxptr_NBReplacements_applySimpleExp(thData, $in_exp, replacements);
}
DLLDirection
modelica_metatype omc_NBEquation_Iterator_extract(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp, modelica_metatype _new_iters, modelica_metatype *out_exp)
{
  modelica_metatype _iter = NULL;
  modelica_metatype _exp = NULL;
  modelica_metatype _replacements = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _iter has no default value.
  _exp = __omcQ_24in_5Fexp;
  _replacements = omc_UnorderedMap_new(threadData, boxvar_NFComponentRef_hash, boxvar_NFComponentRef_isEqual, ((modelica_integer) 1));
  _exp = omc_NBEquation_Iterator_extractFromCall(threadData, _exp, _OMC_LIT82, _replacements, _new_iters ,&_iter);

  tmpMeta1 = mmc_mk_box1(0, _replacements);
  _exp = omc_NFExpression_map(threadData, _exp, (modelica_fnptr) mmc_mk_box2(0,closure20_NBReplacements_applySimpleExp,tmpMeta1));

  _exp = omc_NFTyping_typeExp(threadData, _exp, ((modelica_integer) 1024), _OMC_LIT268, 1 /* true */, NULL, NULL, NULL);
  _return: OMC_LABEL_UNUSED
  if (out_exp) { *out_exp = _exp; }
  return _iter;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_expand(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _call)
{
  modelica_metatype _iter = NULL;
  modelica_metatype _new_iters = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  _new_iters = omc_UnorderedSet_new(threadData, boxvar_NBVariable_hash, boxvar_NBVariable_equalName, ((modelica_integer) 13));
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _call;
    {
      modelica_metatype _names = NULL;
      modelica_metatype _ranges = NULL;
      modelica_metatype _maps = NULL;
      int tmp4;
      // _names has no default value.
      // _ranges has no default value.
      // _maps has no default value.
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 7: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          _names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges ,&_maps);
          {
            modelica_metatype __omcQ_24tmpVar93;
            modelica_metatype* tmp6;
            modelica_metatype tmpMeta7;
            modelica_metatype __omcQ_24tmpVar92;
            modelica_integer tmp8;
            modelica_metatype _tpl_loopVar = 0;
            modelica_metatype _tpl;
            _tpl_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_call), 6)));
            tmpMeta7 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar93 = tmpMeta7; /* defaultValue */
            tmp6 = &__omcQ_24tmpVar93;
            while(1) {
              tmp8 = 1;
              if (!listEmpty(_tpl_loopVar)) {
                _tpl = MMC_CAR(_tpl_loopVar);
                _tpl_loopVar = MMC_CDR(_tpl_loopVar);
                tmp8--;
              }
              if (tmp8 == 0) {
                __omcQ_24tmpVar92 = omc_NBInline_inlineArrayIterator(threadData, _tpl, _new_iters);
                *tmp6 = mmc_mk_cons(__omcQ_24tmpVar92,0);
                tmp6 = &MMC_CDR(*tmp6);
              } else if (tmp8 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp6 = mmc_mk_nil();
            tmpMeta5 = __omcQ_24tmpVar93;
          }
          tmpMeta1 = omc_NBEquation_Iterator_fromFrames(threadData, listAppend(tmpMeta5, omc_List_zip3(threadData, _names, _ranges, _maps)));
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta9;
          
          /* Pattern matching succeeded */
          _names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges ,&_maps);
          {
            modelica_metatype __omcQ_24tmpVar95;
            modelica_metatype* tmp10;
            modelica_metatype tmpMeta11;
            modelica_metatype __omcQ_24tmpVar94;
            modelica_integer tmp12;
            modelica_metatype _tpl_loopVar = 0;
            modelica_metatype _tpl;
            _tpl_loopVar = (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_call), 7)));
            tmpMeta11 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar95 = tmpMeta11; /* defaultValue */
            tmp10 = &__omcQ_24tmpVar95;
            while(1) {
              tmp12 = 1;
              if (!listEmpty(_tpl_loopVar)) {
                _tpl = MMC_CAR(_tpl_loopVar);
                _tpl_loopVar = MMC_CDR(_tpl_loopVar);
                tmp12--;
              }
              if (tmp12 == 0) {
                __omcQ_24tmpVar94 = omc_NBInline_inlineArrayIterator(threadData, _tpl, _new_iters);
                *tmp10 = mmc_mk_cons(__omcQ_24tmpVar94,0);
                tmp10 = &MMC_CDR(*tmp10);
              } else if (tmp12 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp10 = mmc_mk_nil();
            tmpMeta9 = __omcQ_24tmpVar95;
          }
          tmpMeta1 = omc_NBEquation_Iterator_fromFrames(threadData, listAppend(tmpMeta9, omc_List_zip3(threadData, _names, _ranges, _maps)));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iter = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iter;
}

DLLDirection
modelica_boolean omc_NBEquation_Iterator_createSingleReplacement(threadData_t *threadData, modelica_metatype _replacor_cref, modelica_metatype _replacor_range, modelica_metatype _replacee_cref, modelica_metatype _replacee_range, modelica_metatype _replacements)
{
  modelica_boolean _failed;
  modelica_integer _or_start;
  modelica_integer _or_step;
  modelica_integer _or_stop;
  modelica_integer _ee_start;
  modelica_integer _ee_step;
  modelica_integer _ee_stop;
  modelica_metatype _exp = NULL;
  modelica_real tmp1;
  modelica_real tmp2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_real tmp6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  modelica_metatype tmpMeta14;
  modelica_metatype tmpMeta15;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _failed = 0 /* false */;
  // _or_start has no default value.
  // _or_step has no default value.
  // _or_stop has no default value.
  // _ee_start has no default value.
  // _ee_step has no default value.
  // _ee_stop has no default value.
  // _exp has no default value.
  _or_start = omc_NFExpression_getIntegerRange(threadData, _replacor_range ,&_or_step ,&_or_stop);

  _ee_start = omc_NFExpression_getIntegerRange(threadData, _replacee_range ,&_ee_step ,&_ee_stop);

  tmp1 = ((modelica_real)_or_step);
  if (tmp1 == 0) {MMC_THROW_INTERNAL();}
  tmp2 = ((modelica_real)_ee_step);
  if (tmp2 == 0) {MMC_THROW_INTERNAL();}
  if(((((modelica_real)((modelica_integer) 1) + _or_stop - _or_start)) / tmp1 == (((modelica_real)((modelica_integer) 1) + _ee_stop - _ee_start)) / tmp2))
  {
    tmpMeta4 = mmc_mk_box2(4, &NFExpression_REAL__desc, mmc_mk_real(((modelica_real)_ee_start)));
    tmp6 = ((modelica_real)_or_step);
    if (tmp6 == 0) {MMC_THROW_INTERNAL();}
    tmpMeta7 = mmc_mk_box2(4, &NFExpression_REAL__desc, mmc_mk_real((((modelica_real)_ee_step)) / tmp6));
    tmpMeta8 = mmc_mk_cons(omc_NFExpression_fromCref(threadData, _replacor_cref, 0 /* false */), MMC_REFSTRUCTLIT(mmc_nil));
    tmpMeta10 = mmc_mk_box2(4, &NFExpression_REAL__desc, mmc_mk_real(((modelica_real)_or_start)));
    tmpMeta9 = mmc_mk_cons(tmpMeta10, MMC_REFSTRUCTLIT(mmc_nil));
    tmpMeta11 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta8, tmpMeta9, omc_NFOperator_makeAdd(threadData, _OMC_LIT147));
    tmpMeta5 = mmc_mk_cons(tmpMeta7, mmc_mk_cons(tmpMeta11, MMC_REFSTRUCTLIT(mmc_nil)));
    tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
    tmpMeta13 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta5, tmpMeta12, omc_NFOperator_makeMul(threadData, _OMC_LIT147));
    tmpMeta3 = mmc_mk_cons(tmpMeta4, mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil)));
    tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
    tmpMeta15 = mmc_mk_box4(24, &NFExpression_MULTARY__desc, tmpMeta3, tmpMeta14, omc_NFOperator_makeAdd(threadData, _OMC_LIT147));
    _exp = tmpMeta15;

    omc_UnorderedMap_add(threadData, _replacee_cref, _exp, _replacements);
  }
  else
  {
    _failed = 1 /* true */;
  }
  _return: OMC_LABEL_UNUSED
  return _failed;
}
modelica_metatype boxptr_NBEquation_Iterator_createSingleReplacement(threadData_t *threadData, modelica_metatype _replacor_cref, modelica_metatype _replacor_range, modelica_metatype _replacee_cref, modelica_metatype _replacee_range, modelica_metatype _replacements)
{
  modelica_boolean _failed;
  modelica_metatype out_failed;
  _failed = omc_NBEquation_Iterator_createSingleReplacement(threadData, _replacor_cref, _replacor_range, _replacee_cref, _replacee_range, _replacements);
  out_failed = mmc_mk_icon(_failed);
  return out_failed;
}

DLLDirection
void omc_NBEquation_Iterator_createReplacement(threadData_t *threadData, modelica_metatype _replacor, modelica_metatype _replacee, modelica_metatype _replacements)
{
  modelica_boolean _failed;
  modelica_boolean tmp1 = 0;
  modelica_metatype tmpMeta9;
  modelica_metatype tmpMeta10;
  modelica_metatype tmpMeta11;
  modelica_metatype tmpMeta12;
  modelica_metatype tmpMeta13;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _failed = 0 /* false */;
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _replacor;
    tmp4_2 = _replacee;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = omc_NBEquation_Iterator_createSingleReplacement(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacee), 2))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacee), 3))), _replacements);
          goto tmp3_done;
        }
        case 1: {
          modelica_integer tmp6;
          modelica_integer tmp7;
          modelica_integer tmp8;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if((arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 2)))) == arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacee), 2))))))
          {
            tmp6 = ((modelica_integer) 1); tmp7 = 1; tmp8 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 2))));
            if(!(((tmp7 > 0) && (tmp6 > tmp8)) || ((tmp7 < 0) && (tmp6 < tmp8))))
            {
              modelica_integer _i;
              for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp6, tmp8); _i += tmp7)
              {
                _failed = omc_NBEquation_Iterator_createSingleReplacement(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 2))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacor), 3))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacee), 2))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_replacee), 3))),_i) /* DAE.ASUB */, _replacements);

                if(_failed)
                {
                  break;
                }
              }
            }
          }
          else
          {
            _failed = 1 /* true */;
          }
          tmp1 = _failed;
          goto tmp3_done;
        }
        case 2: {
          
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _failed = tmp1;

  if(_failed)
  {
    tmpMeta10 = stringAppend(_OMC_LIT269,omc_NBEquation_Iterator_toString(threadData, _replacor));
    tmpMeta11 = stringAppend(tmpMeta10,_OMC_LIT270);
    tmpMeta12 = stringAppend(tmpMeta11,omc_NBEquation_Iterator_toString(threadData, _replacee));
    tmpMeta13 = stringAppend(tmpMeta12,_OMC_LIT22);
    tmpMeta9 = mmc_mk_cons(tmpMeta13, MMC_REFSTRUCTLIT(mmc_nil));
    omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta9);

    MMC_THROW_INTERNAL();
  }
  _return: OMC_LABEL_UNUSED
  return;
}

DLLDirection
void omc_NBEquation_Iterator_createMappedLocationReplacement(threadData_t *threadData, modelica_metatype _map, modelica_integer _location, modelica_metatype _replacements)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _map;
    {
      modelica_metatype _name = NULL;
      modelica_metatype _arr = NULL;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _name has no default value.
      // _arr has no default value.
      tmp3 = 0;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (optionNone(tmp3_1)) goto tmp2_end;
          tmpMeta5 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp3_1), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta5,0,3) == 0) goto tmp2_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 2));
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta5), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,8,3) == 0) goto tmp2_end;
          
          _name = tmpMeta6;
          _arr = tmpMeta7;
          /* Pattern matching succeeded */
          omc_UnorderedMap_add(threadData, _name, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_arr), 3))),_location) /* DAE.ASUB */, _replacements);
          goto tmp2_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}
void boxptr_NBEquation_Iterator_createMappedLocationReplacement(threadData_t *threadData, modelica_metatype _map, modelica_metatype _location, modelica_metatype _replacements)
{
  modelica_integer tmp1;
  tmp1 = mmc_unbox_integer(_location);
  omc_NBEquation_Iterator_createMappedLocationReplacement(threadData, _map, tmp1, _replacements);
  return;
}

DLLDirection
void omc_NBEquation_Iterator_createLocationReplacements(threadData_t *threadData, modelica_metatype _iter, modelica_metatype _location, modelica_metatype _replacements)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* match expression */
    modelica_metatype tmp3_1;
    tmp3_1 = _iter;
    {
      modelica_integer _start;
      modelica_integer _step;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _start has no default value.
      // _step has no default value.
      tmp3 = 0;
      for (; tmp3 < 3; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_metatype tmpMeta5;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,0,3) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(arrayLength(_location) == ((modelica_integer) 1))) goto tmp2_end;
          _start = omc_NFExpression_getIntegerRange(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))) ,&_step ,NULL);

          tmpMeta5 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start + (mmc_unbox_integer(arrayGet(_location,((modelica_integer) 1)) /* DAE.ASUB */)) * (_step)));
          omc_UnorderedMap_add(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))), tmpMeta5, _replacements);

          omc_NBEquation_Iterator_createMappedLocationReplacement(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))), mmc_unbox_integer(arrayGet(_location,((modelica_integer) 1)) /* DAE.ASUB */), _replacements);
          goto tmp2_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_integer tmp7;
          modelica_integer tmp8;
          modelica_integer tmp9;
          if (mmc__uniontype__metarecord__typedef__equal(tmp3_1,1,3) == 0) goto tmp2_end;
          
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!(arrayLength(_location) == arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3)))))) goto tmp2_end;
          tmp7 = ((modelica_integer) 1); tmp8 = 1; tmp9 = arrayLength(_location);
          if(!(((tmp8 > 0) && (tmp7 > tmp9)) || ((tmp8 < 0) && (tmp7 < tmp9))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp7, tmp9); _i += tmp8)
            {
              _start = omc_NFExpression_getIntegerRange(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */ ,&_step ,NULL);

              tmpMeta6 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start + (mmc_unbox_integer(arrayGet(_location,_i) /* DAE.ASUB */)) * (_step)));
              omc_UnorderedMap_add(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */, tmpMeta6, _replacements);

              omc_NBEquation_Iterator_createMappedLocationReplacement(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))),_i) /* DAE.ASUB */, mmc_unbox_integer(arrayGet(_location,_i) /* DAE.ASUB */), _replacements);
            }
          }
          goto tmp2_done;
        }
        case 2: {
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          
          /* Pattern matching succeeded */
          tmpMeta11 = stringAppend(_OMC_LIT271,omc_Array_toString(threadData, _location, boxvar_intString, _OMC_LIT6, _OMC_LIT132, _OMC_LIT86, _OMC_LIT64, 1 /* true */, ((modelica_integer) 0)));
          tmpMeta12 = stringAppend(tmpMeta11,_OMC_LIT272);
          tmpMeta13 = stringAppend(tmpMeta12,omc_NBEquation_Iterator_toString(threadData, _iter));
          tmpMeta14 = stringAppend(tmpMeta13,_OMC_LIT22);
          tmpMeta10 = mmc_mk_cons(tmpMeta14, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta10);
          goto goto_1;
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      goto_1:;
      MMC_THROW_INTERNAL();
      goto tmp2_done;
      tmp2_done:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_NBEquation_Iterator_dummy_dummyRange(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fexp)
{
  modelica_metatype _exp = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _exp = __omcQ_24in_5Fexp;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _exp;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 13: {
          
          /* Pattern matching succeeded */
          tmpMeta1 = omc_NFExpression_makeRange(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))), mmc_mk_none(), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))));
          goto tmp3_done;
        }
        case 11: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_boolean tmp7;
          modelica_metatype tmpMeta8;
          
          /* Pattern matching succeeded */
          tmp7 = (modelica_boolean)(arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3)))) > ((modelica_integer) 0));
          if(tmp7)
          {
            tmpMeta5 = mmc_mk_cons(omc_NFDimension_fromInteger(threadData, ((modelica_integer) 1), 1), MMC_REFSTRUCTLIT(mmc_nil));
            tmpMeta6 = mmc_mk_box3(10, &NFType_ARRAY__desc, _OMC_LIT96, tmpMeta5);
            tmpMeta8 = omc_NFExpression_makeArray(threadData, tmpMeta6, arrayCreate(((modelica_integer) 1), arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))),((modelica_integer) 1)) /* DAE.ASUB */), omc_NFExpression_isLiteral(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_exp), 3))),((modelica_integer) 1)) /* DAE.ASUB */));
          }
          else
          {
            tmpMeta8 = _exp;
          }
          tmpMeta1 = tmpMeta8;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmpMeta1 = _exp;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _exp = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _exp;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_dummy(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter)
{
  modelica_metatype _iter = NULL;
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  // _names has no default value.
  // _ranges has no default value.
  // _maps has no default value.
  _names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges ,&_maps);

  {
    modelica_metatype __omcQ_24tmpVar97;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar96;
    modelica_integer tmp4;
    modelica_metatype _e_loopVar = 0;
    modelica_metatype _e;
    _e_loopVar = _ranges;
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar97 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar97;
    while(1) {
      tmp4 = 1;
      if (!listEmpty(_e_loopVar)) {
        _e = MMC_CAR(_e_loopVar);
        _e_loopVar = MMC_CDR(_e_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar96 = omc_NBEquation_Iterator_dummy_dummyRange(threadData, _e);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar96,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar97;
  }
  _ranges = tmpMeta1;

  _iter = omc_NBEquation_Iterator_fromFrames(threadData, omc_List_zip3(threadData, _names, _ranges, _maps));
  _return: OMC_LABEL_UNUSED
  return _iter;
}

DLLDirection
modelica_integer omc_NBEquation_Iterator_numDimensions(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_integer _num;
  modelica_integer tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _num has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 1);
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmp1 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          
          /* Pattern matching succeeded */
          tmp1 = ((modelica_integer) 0);
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _num = tmp1;
  _return: OMC_LABEL_UNUSED
  return _num;
}
modelica_metatype boxptr_NBEquation_Iterator_numDimensions(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_integer _num;
  modelica_metatype out_num;
  _num = omc_NBEquation_Iterator_numDimensions(threadData, _iter);
  out_num = mmc_mk_icon(_num);
  return out_num;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_dimensions(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_metatype _dims = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_metatype __omcQ_24tmpVar99;
    modelica_metatype* tmp2;
    modelica_metatype tmpMeta3;
    modelica_metatype __omcQ_24tmpVar98;
    modelica_integer tmp4;
    modelica_metatype _t_loopVar = 0;
    modelica_metatype _t;
    _t_loopVar = omc_NBEquation_Iterator_types(threadData, _iter);
    tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
    __omcQ_24tmpVar99 = tmpMeta3; /* defaultValue */
    tmp2 = &__omcQ_24tmpVar99;
    while(1) {
      tmp4 = 1;
      if (!listEmpty(_t_loopVar)) {
        _t = MMC_CAR(_t_loopVar);
        _t_loopVar = MMC_CDR(_t_loopVar);
        tmp4--;
      }
      if (tmp4 == 0) {
        __omcQ_24tmpVar98 = omc_NFType_arrayDims(threadData, _t);
        *tmp2 = mmc_mk_cons(__omcQ_24tmpVar98,0);
        tmp2 = &MMC_CDR(*tmp2);
      } else if (tmp4 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    *tmp2 = mmc_mk_nil();
    tmpMeta1 = __omcQ_24tmpVar99;
  }
  _dims = omc_List_flatten(threadData, tmpMeta1);
  _return: OMC_LABEL_UNUSED
  return _dims;
}

DLLDirection
modelica_integer omc_NBEquation_Iterator_size(threadData_t *threadData, modelica_metatype _iter, modelica_boolean _resize)
{
  modelica_integer _size;
  modelica_integer tmp1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  {
    modelica_integer __omcQ_24tmpVar101;
    modelica_integer __omcQ_24tmpVar100;
    modelica_integer tmp2;
    modelica_metatype _i_loopVar = 0;
    modelica_metatype tmpMeta3;
    modelica_metatype _i;
    tmpMeta3 = mmc_mk_cons(mmc_mk_integer(((modelica_integer) 1)), omc_NBEquation_Iterator_sizes(threadData, _iter, _resize));
    _i_loopVar = tmpMeta3;
    __omcQ_24tmpVar101 = ((modelica_integer) 1); /* defaultValue */
    while(1) {
      tmp2 = 1;
      if (!listEmpty(_i_loopVar)) {
        _i = MMC_CAR(_i_loopVar);
        _i_loopVar = MMC_CDR(_i_loopVar);
        tmp2--;
      }
      if (tmp2 == 0) {
        __omcQ_24tmpVar100 = mmc_unbox_integer(_i);
        __omcQ_24tmpVar101 = (__omcQ_24tmpVar101) * (__omcQ_24tmpVar100);
      } else if (tmp2 == 1) {
        break;
      } else {
        MMC_THROW_INTERNAL();
      }
    }
    tmp1 = __omcQ_24tmpVar101;
  }
  _size = tmp1;
  _return: OMC_LABEL_UNUSED
  return _size;
}
modelica_metatype boxptr_NBEquation_Iterator_size(threadData_t *threadData, modelica_metatype _iter, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_integer _size;
  modelica_integer tmp2;
  modelica_metatype out_size;
  tmp1 = mmc_unbox_integer(_resize);
  _size = omc_NBEquation_Iterator_size(threadData, _iter, tmp1);
  out_size = mmc_mk_icon(_size);
  return out_size;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_sizes(threadData_t *threadData, modelica_metatype _iter, modelica_boolean _resize)
{
  modelica_metatype _sizes = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _sizes has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_cons(mmc_mk_integer(omc_NFExpression_rangeSize(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), _resize)), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar103;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar102;
            modelica_integer tmp9;
            modelica_integer tmp10;
            modelica_integer tmp11;
            modelica_integer _i;
            tmp10 = 1 /* Range step-value */;
            tmp11 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3)))) /* Range stop-value */;
            _i = ((modelica_integer) 1) /* Range start-value */;
            _i = (((modelica_integer) 1) /* Range start-value */)-tmp10;
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar103 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar103;
            while(1) {
              tmp9 = 1;
              if (tmp10 > 0 ? _i+tmp10 <= tmp11 : _i+tmp10 >= tmp11) {
                _i += tmp10;
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar102 = mmc_mk_integer(omc_NFExpression_rangeSize(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */, _resize));
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar102,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar103;
          }
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta12;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          tmpMeta14 = stringAppend(_OMC_LIT273,omc_NBEquation_Iterator_toString(threadData, _iter));
          tmpMeta15 = stringAppend(tmpMeta14,_OMC_LIT22);
          tmpMeta13 = mmc_mk_cons(tmpMeta15, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta13);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _sizes = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _sizes;
}
modelica_metatype boxptr_NBEquation_Iterator_sizes(threadData_t *threadData, modelica_metatype _iter, modelica_metatype _resize)
{
  modelica_integer tmp1;
  modelica_metatype _sizes = NULL;
  tmp1 = mmc_unbox_integer(_resize);
  _sizes = omc_NBEquation_Iterator_sizes(threadData, _iter, tmp1);
  /* skip box _sizes; list<#Integer> */
  return _sizes;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_types(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_metatype _t = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _t has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_cons(omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3)))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta1 = tmpMeta5;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta6;
          
          /* Pattern matching succeeded */
          {
            modelica_metatype __omcQ_24tmpVar105;
            modelica_metatype* tmp7;
            modelica_metatype tmpMeta8;
            modelica_metatype __omcQ_24tmpVar104;
            modelica_integer tmp9;
            modelica_integer tmp10;
            modelica_integer tmp11;
            modelica_integer _i;
            tmp10 = 1 /* Range step-value */;
            tmp11 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3)))) /* Range stop-value */;
            _i = ((modelica_integer) 1) /* Range start-value */;
            _i = (((modelica_integer) 1) /* Range start-value */)-tmp10;
            tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
            __omcQ_24tmpVar105 = tmpMeta8; /* defaultValue */
            tmp7 = &__omcQ_24tmpVar105;
            while(1) {
              tmp9 = 1;
              if (tmp10 > 0 ? _i+tmp10 <= tmp11 : _i+tmp10 >= tmp11) {
                _i += tmp10;
                tmp9--;
              }
              if (tmp9 == 0) {
                __omcQ_24tmpVar104 = omc_NFExpression_typeOf(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))),_i) /* DAE.ASUB */);
                *tmp7 = mmc_mk_cons(__omcQ_24tmpVar104,0);
                tmp7 = &MMC_CDR(*tmp7);
              } else if (tmp9 == 1) {
                break;
              } else {
                goto goto_2;
              }
            }
            *tmp7 = mmc_mk_nil();
            tmpMeta6 = __omcQ_24tmpVar105;
          }
          tmpMeta1 = tmpMeta6;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta12;
          
          /* Pattern matching succeeded */
          tmpMeta12 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta1 = tmpMeta12;
          goto tmp3_done;
        }
        default:
        tmp3_default: OMC_LABEL_UNUSED; {
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          
          /* Pattern matching succeeded */
          tmpMeta14 = stringAppend(_OMC_LIT274,omc_NBEquation_Iterator_toString(threadData, _iter));
          tmpMeta15 = stringAppend(tmpMeta14,_OMC_LIT22);
          tmpMeta13 = mmc_mk_cons(tmpMeta15, MMC_REFSTRUCTLIT(mmc_nil));
          omc_Error_addMessage(threadData, _OMC_LIT4, tmpMeta13);
          goto goto_2;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _t = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _t;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_intersectRest(threadData_t *threadData, modelica_metatype _name, modelica_integer _start, modelica_integer _step, modelica_integer _stop, modelica_integer _start_max, modelica_integer _stop_min, modelica_metatype _map)
{
  modelica_metatype _rest = NULL;
  modelica_metatype _rest_left = NULL;
  modelica_metatype _rest_right = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  modelica_metatype tmpMeta7;
  modelica_metatype tmpMeta8;
  modelica_metatype tmpMeta9;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _rest has no default value.
  // _rest_left has no default value.
  // _rest_right has no default value.
  if((_start > _start_max))
  {
    _rest_left = _OMC_LIT82;
  }
  else
  {
    tmpMeta1 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start));
    tmpMeta2 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_step));
    tmpMeta3 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start_max));
    tmpMeta4 = mmc_mk_box4(3, &NBEquation_Iterator_SINGLE__desc, _name, omc_NFExpression_makeRange(threadData, tmpMeta1, mmc_mk_some(tmpMeta2), tmpMeta3), _map);
    _rest_left = tmpMeta4;
  }

  if((_stop_min > _stop))
  {
    _rest_right = _OMC_LIT82;
  }
  else
  {
    tmpMeta5 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_stop_min));
    tmpMeta6 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_step));
    tmpMeta7 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_stop));
    tmpMeta8 = mmc_mk_box4(3, &NBEquation_Iterator_SINGLE__desc, _name, omc_NFExpression_makeRange(threadData, tmpMeta5, mmc_mk_some(tmpMeta6), tmpMeta7), _map);
    _rest_right = tmpMeta8;
  }

  tmpMeta9 = mmc_mk_box2(0, _rest_left, _rest_right);
  _rest = tmpMeta9;
  _return: OMC_LABEL_UNUSED
  return _rest;
}
modelica_metatype boxptr_NBEquation_Iterator_intersectRest(threadData_t *threadData, modelica_metatype _name, modelica_metatype _start, modelica_metatype _step, modelica_metatype _stop, modelica_metatype _start_max, modelica_metatype _stop_min, modelica_metatype _map)
{
  modelica_integer tmp1;
  modelica_integer tmp2;
  modelica_integer tmp3;
  modelica_integer tmp4;
  modelica_integer tmp5;
  modelica_metatype _rest = NULL;
  tmp1 = mmc_unbox_integer(_start);
  tmp2 = mmc_unbox_integer(_step);
  tmp3 = mmc_unbox_integer(_stop);
  tmp4 = mmc_unbox_integer(_start_max);
  tmp5 = mmc_unbox_integer(_stop_min);
  _rest = omc_NBEquation_Iterator_intersectRest(threadData, _name, tmp1, tmp2, tmp3, tmp4, tmp5, _map);
  /* skip box _rest; tuple<NBEquation.Iterator, NBEquation.Iterator> */
  return _rest;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_intersect(threadData_t *threadData, modelica_metatype _iter1, modelica_metatype _iter2, modelica_metatype *out_rest1, modelica_metatype *out_rest2)
{
  modelica_metatype _intersection = NULL;
  modelica_metatype _rest1 = NULL;
  modelica_metatype _rest2 = NULL;
  modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _intersection has no default value.
  // _rest1 has no default value.
  // _rest2 has no default value.
  
  
  
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _iter1;
    tmp4_2 = _iter2;
    {
      modelica_integer _start1;
      modelica_integer _step1;
      modelica_integer _stop1;
      modelica_integer _start2;
      modelica_integer _step2;
      modelica_integer _stop2;
      modelica_integer _start_max;
      modelica_integer _stop_min;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _start1 has no default value.
      // _step1 has no default value.
      // _stop1 has no default value.
      // _start2 has no default value.
      // _step2 has no default value.
      // _stop2 has no default value.
      // _start_max has no default value.
      // _stop_min has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_integer tmp13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_integer tmp16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_integer tmp20;
          modelica_metatype tmpMeta21;
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_integer tmp24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_integer tmp27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_metatype tmpMeta30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,10,4) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta7,0,1) == 0) goto tmp3_end;
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta7), 2));
          tmp9 = mmc_unbox_integer(tmpMeta8);
          tmpMeta10 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 4));
          if (optionNone(tmpMeta10)) goto tmp3_end;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta10), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,0,1) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 2));
          tmp13 = mmc_unbox_integer(tmpMeta12);
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta14,0,1) == 0) goto tmp3_end;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta14), 2));
          tmp16 = mmc_unbox_integer(tmpMeta15);
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,3) == 0) goto tmp3_end;
          tmpMeta17 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta17,10,4) == 0) goto tmp3_end;
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta17), 3));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta18,0,1) == 0) goto tmp3_end;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta18), 2));
          tmp20 = mmc_unbox_integer(tmpMeta19);
          tmpMeta21 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta17), 4));
          if (optionNone(tmpMeta21)) goto tmp3_end;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta21), 1));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta22,0,1) == 0) goto tmp3_end;
          tmpMeta23 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta22), 2));
          tmp24 = mmc_unbox_integer(tmpMeta23);
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta17), 5));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta25,0,1) == 0) goto tmp3_end;
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta25), 2));
          tmp27 = mmc_unbox_integer(tmpMeta26);
          
          _start1 = tmp9  /* pattern as ty=Integer */;
          _step1 = tmp13  /* pattern as ty=Integer */;
          _stop1 = tmp16  /* pattern as ty=Integer */;
          _start2 = tmp20  /* pattern as ty=Integer */;
          _step2 = tmp24  /* pattern as ty=Integer */;
          _stop2 = tmp27  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!((_step1 == _step2) && (modelica_integer_mod(_start1, _step1) == modelica_integer_mod(_start2, _step2)))) goto tmp3_end;
          modelica_integer_min((modelica_integer)(_start1),(modelica_integer)(_start2));

          _start_max = modelica_integer_max((modelica_integer)(_start1),(modelica_integer)(_start2));

          _stop_min = modelica_integer_min((modelica_integer)(_stop1),(modelica_integer)(_stop2));

          modelica_integer_max((modelica_integer)(_stop1),(modelica_integer)(_stop2));

          if((_start_max >= _stop_min))
          {
            _intersection = _OMC_LIT82;
          }
          else
          {
            tmpMeta28 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_start_max));
            tmpMeta29 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_step1));
            tmpMeta30 = mmc_mk_box2(3, &NFExpression_INTEGER__desc, mmc_mk_integer(_stop_min));
            tmpMeta31 = mmc_mk_box5(13, &NFExpression_RANGE__desc, omc_NFExpression_typeOf(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 3)))), tmpMeta28, mmc_mk_some(tmpMeta29), tmpMeta30);
            tmpMeta32 = mmc_mk_box4(3, &NBEquation_Iterator_SINGLE__desc, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 2))), tmpMeta31, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4))));
            _intersection = tmpMeta32;
          }

          _rest1 = omc_NBEquation_Iterator_intersectRest(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 2))), _start1, _step1, _stop1, _start_max - _step1, _stop_min + _step1, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4))));

          _rest2 = omc_NBEquation_Iterator_intersectRest(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 2))), _start2, _step2, _stop2, _start_max - _step2, _stop_min + _step2, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 4))));
          tmpMeta[0+0] = _intersection;
          tmpMeta[0+1] = _rest1;
          tmpMeta[0+2] = _rest2;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          
          /* Pattern matching succeeded */
          tmpMeta33 = mmc_mk_box2(0, _iter1, _OMC_LIT82);
          tmpMeta34 = mmc_mk_box2(0, _OMC_LIT82, _iter2);
          tmpMeta[0+0] = _OMC_LIT82;
          tmpMeta[0+1] = tmpMeta33;
          tmpMeta[0+2] = tmpMeta34;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _intersection = tmpMeta[0+0];
  _rest1 = tmpMeta[0+1];
  _rest2 = tmpMeta[0+2];
  _return: OMC_LABEL_UNUSED
  if (out_rest1) { *out_rest1 = _rest1; }
  if (out_rest2) { *out_rest2 = _rest2; }
  return _intersection;
}

DLLDirection
modelica_boolean omc_NBEquation_Iterator_isEmpty(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _b has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Iterator_isEmpty(threadData_t *threadData, modelica_metatype _iter)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Iterator_isEmpty(threadData, _iter);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_boolean omc_NBEquation_Iterator_isEqual(threadData_t *threadData, modelica_metatype _iter1, modelica_metatype _iter2)
{
  modelica_boolean _b;
  modelica_boolean tmp1 = 0;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _b = 1 /* true */;
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _iter1;
    tmp4_2 = _iter2;
    {
      volatile mmc_switch_type tmp4;
      int tmp5;
      tmp4 = 0;
      for (; tmp4 < 4; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,2,0) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,2,0) == 0) goto tmp3_end;
          /* Pattern matching succeeded */
          tmp1 = 1 /* true */;
          goto tmp3_done;
        }
        case 1: {
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp1 = (omc_NFExpression_isEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 3))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 3)))) && omc_Util_optionEqual(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4))), (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 4))), boxvar_NBEquation_Iterator_isEqual));
          goto tmp3_done;
        }
        case 2: {
          modelica_integer tmp6;
          modelica_integer tmp7;
          modelica_integer tmp8;
          modelica_integer tmp9;
          modelica_integer tmp10;
          modelica_integer tmp11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_2,1,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          if(((arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 3)))) == arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 3))))) && (arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4)))) == arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 4)))))))
          {
            tmp6 = ((modelica_integer) 1); tmp7 = 1; tmp8 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 3))));
            if(!(((tmp7 > 0) && (tmp6 > tmp8)) || ((tmp7 < 0) && (tmp6 < tmp8))))
            {
              modelica_integer _i;
              for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp6, tmp8); _i += tmp7)
              {
                _b = omc_NFExpression_isEqual(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 3))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 3))),_i) /* DAE.ASUB */);

                if((!_b))
                {
                  break;
                }
              }
            }

            tmp9 = ((modelica_integer) 1); tmp10 = 1; tmp11 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4))));
            if(!(((tmp10 > 0) && (tmp9 > tmp11)) || ((tmp10 < 0) && (tmp9 < tmp11))))
            {
              modelica_integer _i;
              for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp9, tmp11); _i += tmp10)
              {
                _b = omc_Util_optionEqual(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter1), 4))),_i) /* DAE.ASUB */, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter2), 4))),_i) /* DAE.ASUB */, boxvar_NBEquation_Iterator_isEqual);

                if((!_b))
                {
                  break;
                }
              }
            }
          }
          else
          {
            _b = 0 /* false */;
          }
          tmp1 = _b;
          goto tmp3_done;
        }
        case 3: {
          
          /* Pattern matching succeeded */
          tmp1 = 0 /* false */;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _b = tmp1;
  _return: OMC_LABEL_UNUSED
  return _b;
}
modelica_metatype boxptr_NBEquation_Iterator_isEqual(threadData_t *threadData, modelica_metatype _iter1, modelica_metatype _iter2)
{
  modelica_boolean _b;
  modelica_metatype out_b;
  _b = omc_NBEquation_Iterator_isEqual(threadData, _iter1, _iter2);
  out_b = mmc_mk_icon(_b);
  return out_b;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_rename(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_string _newBaseName, modelica_metatype _replacements)
{
  modelica_metatype _iter = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      modelica_metatype _replacor = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _replacor has no default value.
      tmp4 = 0;
      for (; tmp4 < 2; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,0,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta6 = stringAppend(_newBaseName,_OMC_LIT275);
          _replacor = omc_NFComponentRef_rename(threadData, tmpMeta6, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));

          omc_UnorderedMap_add(threadData, (MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))), omc_NFExpression_fromCref(threadData, _replacor, 0 /* false */), _replacements);

          tmpMeta7 = MMC_TAGPTR(mmc_alloc_words(5));
          memcpy(MMC_UNTAGPTR(tmpMeta7), MMC_UNTAGPTR(_iter), 5*sizeof(modelica_metatype));
          ((modelica_metatype*)MMC_UNTAGPTR(tmpMeta7))[2] = _replacor;
          _iter = tmpMeta7;
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta8;
          modelica_integer tmp9;
          modelica_integer tmp10;
          modelica_integer tmp11;
          if (mmc__uniontype__metarecord__typedef__equal(tmp4_1,1,3) == 0) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmp9 = ((modelica_integer) 1); tmp10 = 1; tmp11 = arrayLength((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
          if(!(((tmp10 > 0) && (tmp9 > tmp11)) || ((tmp10 < 0) && (tmp9 < tmp11))))
          {
            modelica_integer _i;
            for(_i = ((modelica_integer) 1); in_range_integer(_i, tmp9, tmp11); _i += tmp10)
            {
              tmpMeta8 = stringAppend(_newBaseName,intString(_i));
              _replacor = omc_NFComponentRef_rename(threadData, tmpMeta8, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */);

              omc_UnorderedMap_add(threadData, arrayGet((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i) /* DAE.ASUB */, omc_NFExpression_fromCref(threadData, _replacor, 0 /* false */), _replacements);

              arrayUpdate((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))),_i,_replacor);
            }
          }
          tmpMeta1 = _iter;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _iter = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _iter;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_split(threadData_t *threadData, modelica_metatype _iterator)
{
  modelica_metatype _result = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _result = tmpMeta1;
  // _names has no default value.
  // _ranges has no default value.
  // _maps has no default value.
  _names = omc_NBEquation_Iterator_getFrames(threadData, _iterator ,&_ranges ,&_maps);

  {
    modelica_metatype _tpl;
    for (tmpMeta2 = omc_List_zip3(threadData, _names, _ranges, _maps); !listEmpty(tmpMeta2); tmpMeta2=MMC_CDR(tmpMeta2))
    {
      _tpl = MMC_CAR(tmpMeta2);
      tmpMeta4 = mmc_mk_cons(_tpl, MMC_REFSTRUCTLIT(mmc_nil));
      tmpMeta3 = mmc_mk_cons(omc_NBEquation_Iterator_fromFrames(threadData, tmpMeta4), _result);
      _result = tmpMeta3;
    }
  }
  _return: OMC_LABEL_UNUSED
  return _result;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_merge(threadData_t *threadData, modelica_metatype _iterators)
{
  modelica_metatype _result = NULL;
  modelica_metatype _tmp_names = NULL;
  modelica_metatype _names = NULL;
  modelica_metatype tmpMeta1;
  modelica_metatype _tmp_ranges = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype tmpMeta2;
  modelica_metatype _tmp_maps = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype tmpMeta3;
  modelica_metatype tmpMeta4;
  modelica_metatype tmpMeta5;
  modelica_metatype tmpMeta6;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _result has no default value.
  // _tmp_names has no default value.
  tmpMeta1 = MMC_REFSTRUCTLIT(mmc_nil);
  _names = tmpMeta1;
  // _tmp_ranges has no default value.
  tmpMeta2 = MMC_REFSTRUCTLIT(mmc_nil);
  _ranges = tmpMeta2;
  // _tmp_maps has no default value.
  tmpMeta3 = MMC_REFSTRUCTLIT(mmc_nil);
  _maps = tmpMeta3;
  if(omc_List_hasOneElement(threadData, _iterators))
  {
    _result = listHead(_iterators);
  }
  else
  {
    {
      modelica_metatype _iter;
      for (tmpMeta4 = listReverse(_iterators); !listEmpty(tmpMeta4); tmpMeta4=MMC_CDR(tmpMeta4))
      {
        _iter = MMC_CAR(tmpMeta4);
        _tmp_names = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_tmp_ranges ,&_tmp_maps);

        _names = listAppend(_tmp_names, _names);

        _ranges = listAppend(_tmp_ranges, _ranges);

        _maps = listAppend(_tmp_maps, _maps);
      }
    }

    tmpMeta6 = mmc_mk_box4(4, &NBEquation_Iterator_NESTED__desc, listArray(_names), listArray(_ranges), listArray(_maps));
    _result = tmpMeta6;
  }
  _return: OMC_LABEL_UNUSED
  return _result;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_getFrames(threadData_t *threadData, modelica_metatype _iter, modelica_metatype *out_ranges, modelica_metatype *out_maps)
{
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _names has no default value.
  // _ranges has no default value.
  // _maps has no default value.
  
  
  
  { /* match expression */
    modelica_metatype tmp4_1;
    tmp4_1 = _iter;
    {
      int tmp4;
      {
        switch (MMC_SWITCH_CAST(valueConstructor(tmp4_1))) {
        case 3: {
          modelica_metatype tmpMeta5;
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          
          /* Pattern matching succeeded */
          tmpMeta5 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta6 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta7 = mmc_mk_cons((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))), MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta[0+0] = tmpMeta5;
          tmpMeta[0+1] = tmpMeta6;
          tmpMeta[0+2] = tmpMeta7;
          goto tmp3_done;
        }
        case 4: {
          
          /* Pattern matching succeeded */
          tmpMeta[0+0] = arrayList((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 2))));
          tmpMeta[0+1] = arrayList((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 3))));
          tmpMeta[0+2] = arrayList((MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(_iter), 4))));
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          
          /* Pattern matching succeeded */
          tmpMeta8 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta9 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta10 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta[0+0] = tmpMeta8;
          tmpMeta[0+1] = tmpMeta9;
          tmpMeta[0+2] = tmpMeta10;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _names = tmpMeta[0+0];
  _ranges = tmpMeta[0+1];
  _maps = tmpMeta[0+2];
  _return: OMC_LABEL_UNUSED
  if (out_ranges) { *out_ranges = _ranges; }
  if (out_maps) { *out_maps = _maps; }
  return _names;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_addFrames(threadData_t *threadData, modelica_metatype __omcQ_24in_5Fiter, modelica_metatype _frames)
{
  modelica_metatype _iter = NULL;
  modelica_metatype _names1 = NULL;
  modelica_metatype _names2 = NULL;
  modelica_metatype _ranges1 = NULL;
  modelica_metatype _ranges2 = NULL;
  modelica_metatype _maps1 = NULL;
  modelica_metatype _maps2 = NULL;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  _iter = __omcQ_24in_5Fiter;
  // _names1 has no default value.
  // _names2 has no default value.
  // _ranges1 has no default value.
  // _ranges2 has no default value.
  // _maps1 has no default value.
  // _maps2 has no default value.
  if((!listEmpty(_frames)))
  {
    _names1 = omc_NBEquation_Iterator_getFrames(threadData, _iter ,&_ranges1 ,&_maps1);

    _names2 = omc_List_unzip3(threadData, _frames ,&_ranges2 ,&_maps2);

    _iter = omc_NBEquation_Iterator_fromFrames(threadData, omc_List_zip3(threadData, listAppend(_names1, _names2), listAppend(_ranges1, _ranges2), listAppend(_maps1, _maps2)));
  }
  _return: OMC_LABEL_UNUSED
  return _iter;
}

DLLDirection
modelica_metatype omc_NBEquation_Iterator_fromFrames(threadData_t *threadData, modelica_metatype _frames)
{
  modelica_metatype _iter = NULL;
  modelica_metatype _names = NULL;
  modelica_metatype _ranges = NULL;
  modelica_metatype _maps = NULL;
  modelica_metatype _name = NULL;
  modelica_metatype _range = NULL;
  modelica_metatype _map = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _iter has no default value.
  // _names has no default value.
  // _ranges has no default value.
  // _maps has no default value.
  // _name has no default value.
  // _range has no default value.
  // _map has no default value.
  if(listEmpty(_frames))
  {
    _iter = _OMC_LIT82;
  }
  else
  {
    _names = omc_List_unzip3(threadData, _frames ,&_ranges ,&_maps);

    { /* match expression */
      modelica_metatype tmp4_1;modelica_metatype tmp4_2;modelica_metatype tmp4_3;
      tmp4_1 = _names;
      tmp4_2 = _ranges;
      tmp4_3 = _maps;
      {
        volatile mmc_switch_type tmp4;
        int tmp5;
        tmp4 = 0;
        for (; tmp4 < 2; tmp4++) {
          switch (MMC_SWITCH_CAST(tmp4)) {
          case 0: {
            modelica_metatype tmpMeta6;
            modelica_metatype tmpMeta7;
            modelica_metatype tmpMeta8;
            modelica_metatype tmpMeta9;
            modelica_metatype tmpMeta10;
            modelica_metatype tmpMeta11;
            modelica_metatype tmpMeta12;
            if (listEmpty(tmp4_1)) goto tmp3_end;
            tmpMeta6 = MMC_CAR(tmp4_1);
            tmpMeta7 = MMC_CDR(tmp4_1);
            if (!listEmpty(tmpMeta7)) goto tmp3_end;
            if (listEmpty(tmp4_2)) goto tmp3_end;
            tmpMeta8 = MMC_CAR(tmp4_2);
            tmpMeta9 = MMC_CDR(tmp4_2);
            if (!listEmpty(tmpMeta9)) goto tmp3_end;
            if (listEmpty(tmp4_3)) goto tmp3_end;
            tmpMeta10 = MMC_CAR(tmp4_3);
            tmpMeta11 = MMC_CDR(tmp4_3);
            if (!listEmpty(tmpMeta11)) goto tmp3_end;
            _name = tmpMeta6;
            _range = tmpMeta8;
            _map = tmpMeta10;
            /* Pattern matching succeeded */
            tmpMeta12 = mmc_mk_box4(3, &NBEquation_Iterator_SINGLE__desc, _name, _range, _map);
            tmpMeta1 = tmpMeta12;
            goto tmp3_done;
          }
          case 1: {
            modelica_metatype tmpMeta13;
            
            /* Pattern matching succeeded */
            tmpMeta13 = mmc_mk_box4(4, &NBEquation_Iterator_NESTED__desc, listArray(_names), listArray(_ranges), listArray(_maps));
            tmpMeta1 = tmpMeta13;
            goto tmp3_done;
          }
          }
          goto tmp3_end;
          tmp3_end: ;
        }
        goto goto_2;
        goto_2:;
        MMC_THROW_INTERNAL();
        goto tmp3_done;
        tmp3_done:;
      }
    }
    _iter = tmpMeta1;
  }
  _return: OMC_LABEL_UNUSED
  return _iter;
}

