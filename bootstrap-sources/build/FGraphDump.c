#include "omc_simulation_settings.h"
#include "FGraphDump.h"
#define _OMC_LIT0_data "rdrpCE:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT0,7,_OMC_LIT0_data);
#define _OMC_LIT0 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT0)
#define _OMC_LIT1_data "rdrpC:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT1,6,_OMC_LIT1_data);
#define _OMC_LIT1 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT1)
#define _OMC_LIT2_data "FFFF00"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT2,6,_OMC_LIT2_data);
#define _OMC_LIT2 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT2)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT3,1,7) {&GraphML_ShapeType_HEXAGON__desc,}};
#define _OMC_LIT3 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT3)
#define _OMC_LIT4_data "rdCE:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT4,5,_OMC_LIT4_data);
#define _OMC_LIT4 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT4)
#define _OMC_LIT5_data "rdC:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT5,4,_OMC_LIT5_data);
#define _OMC_LIT5 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT5)
#define _OMC_LIT6_data "rpC:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT6,4,_OMC_LIT6_data);
#define _OMC_LIT6 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT6)
#define _OMC_LIT7_data "FF0000"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT7,6,_OMC_LIT7_data);
#define _OMC_LIT7 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT7)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT8,1,3) {&GraphML_ShapeType_RECTANGLE__desc,}};
#define _OMC_LIT8 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT8)
#define _OMC_LIT9_data "rdrpc:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT9,6,_OMC_LIT9_data);
#define _OMC_LIT9 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT9)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT10,1,5) {&GraphML_ShapeType_ELLIPSE__desc,}};
#define _OMC_LIT10 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT10)
#define _OMC_LIT11_data "rdc:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT11,4,_OMC_LIT11_data);
#define _OMC_LIT11 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT11)
#define _OMC_LIT12_data "rpc:"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT12,4,_OMC_LIT12_data);
#define _OMC_LIT12 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT12)
#define _OMC_LIT13_data ":"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT13,1,_OMC_LIT13_data);
#define _OMC_LIT13 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT13)
#define _OMC_LIT14_data "C0C0C0"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT14,6,_OMC_LIT14_data);
#define _OMC_LIT14 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT14)
#define _OMC_LIT15_data "FFFFFF"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT15,6,_OMC_LIT15_data);
#define _OMC_LIT15 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT15)
#define _OMC_LIT16_data "339966"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT16,6,_OMC_LIT16_data);
#define _OMC_LIT16 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT16)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT17,1,4) {&GraphML_ShapeType_ROUNDRECTANGLE__desc,}};
#define _OMC_LIT17 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT17)
#define _OMC_LIT18_data "993366"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT18,6,_OMC_LIT18_data);
#define _OMC_LIT18 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT18)
#define _OMC_LIT19_data "CF8CB7"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT19,6,_OMC_LIT19_data);
#define _OMC_LIT19 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT19)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT20,1,8) {&GraphML_ShapeType_TRIANGLE__desc,}};
#define _OMC_LIT20 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT20)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT21,1,9) {&GraphML_ShapeType_OCTAGON__desc,}};
#define _OMC_LIT21 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT21)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT22,1,6) {&GraphML_ShapeType_PARALLELOGRAM__desc,}};
#define _OMC_LIT22 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT22)
#define _OMC_LIT23_data "UNRESOLVED"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT23,10,_OMC_LIT23_data);
#define _OMC_LIT23 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT23)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT24,1,11) {&GraphML_ShapeType_TRAPEZOID__desc,}};
#define _OMC_LIT24 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT24)
#define _OMC_LIT25_data "0000FF"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT25,6,_OMC_LIT25_data);
#define _OMC_LIT25 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT25)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT26,1,3) {&GraphML_FontStyle_FONTPLAIN__desc,}};
#define _OMC_LIT26 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT26)
#define _OMC_LIT27_data "n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT27,1,_OMC_LIT27_data);
#define _OMC_LIT27 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT27)
#define _OMC_LIT28_data "r"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT28,1,_OMC_LIT28_data);
#define _OMC_LIT28 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT28)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT29,1,3) {&GraphML_LineType_LINE__desc,}};
#define _OMC_LIT29 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT29)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT30,1,4) {&GraphML_ArrowType_ARROWNONE__desc,}};
#define _OMC_LIT30 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT30)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT31,1,3) {&GraphML_ArrowType_ARROWSTANDART__desc,}};
#define _OMC_LIT31 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT31)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT32,2,0) {_OMC_LIT30,_OMC_LIT31}};
#define _OMC_LIT32 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT32)
#define _OMC_LIT33_data "e"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT33,1,_OMC_LIT33_data);
#define _OMC_LIT33 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT33)
#define _OMC_LIT34_data "000000"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT34,6,_OMC_LIT34_data);
#define _OMC_LIT34 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT34)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT35,2,0) {_OMC_LIT30,_OMC_LIT30}};
#define _OMC_LIT35 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT35)
#define _OMC_LIT36_data "graphInstGenGraph"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT36,17,_OMC_LIT36_data);
#define _OMC_LIT36 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT36)
#define _OMC_LIT37_data "Dumps a graph of the program. Use with -d=graphInst"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT37,51,_OMC_LIT37_data);
#define _OMC_LIT37 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT37)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT38,2,3) {&Gettext_TranslatableContent_gettext__desc,_OMC_LIT37}};
#define _OMC_LIT38 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT38)
static const MMC_DEFSTRUCTLIT(_OMC_LIT_STRUCT39,5,3) {&Flags_DebugFlag_DEBUG__FLAG__desc,MMC_IMMEDIATE(MMC_TAGFIXNUM(79)),_OMC_LIT36,MMC_IMMEDIATE(MMC_TAGFIXNUM(0 /* false */)),_OMC_LIT38}};
#define _OMC_LIT39 MMC_REFSTRUCTLIT(_OMC_LIT_STRUCT39)
#define _OMC_LIT40_data "G"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT40,1,_OMC_LIT40_data);
#define _OMC_LIT40 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT40)
#define _OMC_LIT41_data "Dumping graph file: "
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT41,20,_OMC_LIT41_data);
#define _OMC_LIT41 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT41)
#define _OMC_LIT42_data " ....\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT42,6,_OMC_LIT42_data);
#define _OMC_LIT42 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT42)
#define _OMC_LIT43_data "Dumped\n"
static const MMC_DEFSTRINGLIT(_OMC_LIT_STRUCT43,7,_OMC_LIT43_data);
#define _OMC_LIT43 MMC_REFSTRINGLIT(_OMC_LIT_STRUCT43)
#include "util/modelica.h"

#include "FGraphDump_includes.h"


/* default, do not make protected functions static */
#if !defined(PROTECTED_FUNCTION_STATIC)
#define PROTECTED_FUNCTION_STATIC
#endif
PROTECTED_FUNCTION_STATIC modelica_metatype omc_FGraphDump_addNode(threadData_t *threadData, modelica_metatype _gin, modelica_metatype _node);
static const MMC_DEFSTRUCTLIT(boxvar_lit_FGraphDump_addNode,2,0) {(void*) boxptr_FGraphDump_addNode,0}};
#define boxvar_FGraphDump_addNode MMC_REFSTRUCTLIT(boxvar_lit_FGraphDump_addNode)
PROTECTED_FUNCTION_STATIC modelica_metatype omc_FGraphDump_addNodes(threadData_t *threadData, modelica_metatype _gin, modelica_metatype _inRefs);
static const MMC_DEFSTRUCTLIT(boxvar_lit_FGraphDump_addNodes,2,0) {(void*) boxptr_FGraphDump_addNodes,0}};
#define boxvar_FGraphDump_addNodes MMC_REFSTRUCTLIT(boxvar_lit_FGraphDump_addNodes)

DLLDirection
modelica_string omc_FGraphDump_graphml(threadData_t *threadData, modelica_metatype _node, modelica_boolean _escape, modelica_metatype *out_shape, modelica_string *out_nname)
{
  modelica_string _color = NULL;
  modelica_metatype _shape = NULL;
  modelica_string _nname = NULL;
  modelica_string tmp1_c0 __attribute__((unused)) = 0;
  modelica_string tmp1_c2 __attribute__((unused)) = 0;
  modelica_metatype tmpMeta[3] __attribute__((unused)) = {0};
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _color has no default value.
  // _shape has no default value.
  // _nname has no default value.
  
  
  
  { /* matchcontinue expression */
    volatile modelica_metatype tmp4_1;
    tmp4_1 = _node;
    {
      modelica_metatype _nd = NULL;
      modelica_metatype _e = NULL;
      modelica_metatype _exp = NULL;
      modelica_metatype _r = NULL;
      modelica_string _s = NULL;
      modelica_metatype _dims = NULL;
      modelica_metatype _target = NULL;
      modelica_boolean _b;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _nd has no default value.
      // _e has no default value.
      // _exp has no default value.
      // _r has no default value.
      // _s has no default value.
      // _dims has no default value.
      // _target has no default value.
      // _b has no default value.
      tmp4 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp3_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp4 < 16; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_boolean tmp8;
          modelica_boolean tmp9;
          modelica_metatype tmpMeta10;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta6,3,5) == 0) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          
          _e = tmpMeta7;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp8 = omc_SCodeUtil_isElementRedeclare(threadData, _e);
          if (1 /* true */ != tmp8) goto goto_2;

          /* Pattern-matching assignment */
          tmp9 = omc_SCodeUtil_isElementReplaceable(threadData, _e);
          if (1 /* true */ != tmp9) goto goto_2;

          _b = omc_FNode_isClassExtends(threadData, _node);

          _s = (_b?_OMC_LIT0:_OMC_LIT1);

          tmpMeta10 = stringAppend(_s,omc_FNode_name(threadData, _node));
          _s = tmpMeta10;
          tmp1_c0 = _OMC_LIT2;
          tmpMeta[0+1] = _OMC_LIT3;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_boolean tmp13;
          modelica_metatype tmpMeta14;
          tmpMeta11 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta11,3,5) == 0) goto tmp3_end;
          tmpMeta12 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta11), 2));
          
          _e = tmpMeta12;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp13 = omc_SCodeUtil_isElementRedeclare(threadData, _e);
          if (1 /* true */ != tmp13) goto goto_2;

          _b = omc_FNode_isClassExtends(threadData, _node);

          _s = (_b?_OMC_LIT4:_OMC_LIT5);

          tmpMeta14 = stringAppend(_s,omc_FNode_name(threadData, _node));
          _s = tmpMeta14;
          tmp1_c0 = _OMC_LIT2;
          tmpMeta[0+1] = _OMC_LIT3;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_boolean tmp17;
          modelica_metatype tmpMeta18;
          tmpMeta15 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta15,3,5) == 0) goto tmp3_end;
          tmpMeta16 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta15), 2));
          
          _e = tmpMeta16;
          tmp4 += 3; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp17 = omc_SCodeUtil_isElementReplaceable(threadData, _e);
          if (1 /* true */ != tmp17) goto goto_2;

          tmpMeta18 = stringAppend(_OMC_LIT6,omc_FNode_name(threadData, _node));
          _s = tmpMeta18;
          tmp1_c0 = _OMC_LIT7;
          tmpMeta[0+1] = _OMC_LIT8;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta19;
          modelica_metatype tmpMeta20;
          modelica_boolean tmp21;
          modelica_boolean tmp22;
          modelica_metatype tmpMeta23;
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta19,4,4) == 0) goto tmp3_end;
          tmpMeta20 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta19), 2));
          
          _e = tmpMeta20;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp21 = omc_SCodeUtil_isElementRedeclare(threadData, _e);
          if (1 /* true */ != tmp21) goto goto_2;

          /* Pattern-matching assignment */
          tmp22 = omc_SCodeUtil_isElementReplaceable(threadData, _e);
          if (1 /* true */ != tmp22) goto goto_2;

          tmpMeta23 = stringAppend(_OMC_LIT9,omc_FNode_name(threadData, _node));
          _s = tmpMeta23;
          tmp1_c0 = _OMC_LIT2;
          tmpMeta[0+1] = _OMC_LIT10;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_boolean tmp26;
          modelica_metatype tmpMeta27;
          tmpMeta24 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta24,4,4) == 0) goto tmp3_end;
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta24), 2));
          
          _e = tmpMeta25;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp26 = omc_SCodeUtil_isElementRedeclare(threadData, _e);
          if (1 /* true */ != tmp26) goto goto_2;

          tmpMeta27 = stringAppend(_OMC_LIT11,omc_FNode_name(threadData, _node));
          _s = tmpMeta27;
          tmp1_c0 = _OMC_LIT2;
          tmpMeta[0+1] = _OMC_LIT10;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 5: {
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_boolean tmp30;
          modelica_metatype tmpMeta31;
          tmpMeta28 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta28,4,4) == 0) goto tmp3_end;
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta28), 2));
          
          _e = tmpMeta29;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          /* Pattern-matching assignment */
          tmp30 = omc_SCodeUtil_isElementReplaceable(threadData, _e);
          if (1 /* true */ != tmp30) goto goto_2;

          tmpMeta31 = stringAppend(_OMC_LIT12,omc_FNode_name(threadData, _node));
          _s = tmpMeta31;
          tmp1_c0 = _OMC_LIT7;
          tmpMeta[0+1] = _OMC_LIT10;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 6: {
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          tmpMeta32 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta32,3,5) == 0) goto tmp3_end;
          
          _nd = tmpMeta32;
          tmp4 += 8; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta33 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta34 = stringAppend(tmpMeta33,omc_FNode_name(threadData, _node));
          _s = tmpMeta34;
          tmp1_c0 = _OMC_LIT14;
          tmpMeta[0+1] = _OMC_LIT8;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 7: {
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          tmpMeta35 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta35,4,4) == 0) goto tmp3_end;
          
          _nd = tmpMeta35;
          tmp4 += 7; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta36 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta37 = stringAppend(tmpMeta36,omc_FNode_name(threadData, _node));
          _s = tmpMeta37;
          tmp1_c0 = _OMC_LIT15;
          tmpMeta[0+1] = _OMC_LIT10;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 8: {
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          tmpMeta38 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta38,5,2) == 0) goto tmp3_end;
          
          _nd = tmpMeta38;
          tmp4 += 6; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta39 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta40 = stringAppend(tmpMeta39,omc_FNode_name(threadData, _node));
          _s = tmpMeta40;
          tmp1_c0 = _OMC_LIT16;
          tmpMeta[0+1] = _OMC_LIT17;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 9: {
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          tmpMeta41 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta41,16,2) == 0) goto tmp3_end;
          tmpMeta42 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta41), 3));
          _nd = tmpMeta41;
          _exp = tmpMeta42;
          tmp4 += 5; /* Pattern matching succeeded; we may skip some cases if we fail */
          _s = omc_Dump_printExpStr(threadData, _exp);

          tmpMeta43 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta44 = stringAppend(tmpMeta43,(_escape?omc_Util_escapeModelicaStringToXmlString(threadData, _s):omc_Util_stringTrunc(threadData, _s, ((modelica_integer) 100))));
          _s = tmpMeta44;
          tmp1_c0 = _OMC_LIT18;
          tmpMeta[0+1] = _OMC_LIT3;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 10: {
          modelica_metatype tmpMeta45;
          modelica_metatype tmpMeta46;
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          tmpMeta45 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta45,18,2) == 0) goto tmp3_end;
          tmpMeta46 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta45), 3));
          _nd = tmpMeta45;
          _dims = tmpMeta46;
          tmp4 += 4; /* Pattern matching succeeded; we may skip some cases if we fail */
          _s = omc_Dump_printArraydimStr(threadData, _dims);

          tmpMeta47 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta48 = stringAppend(tmpMeta47,(_escape?omc_Util_escapeModelicaStringToXmlString(threadData, _s):omc_Util_stringTrunc(threadData, _s, ((modelica_integer) 100))));
          _s = tmpMeta48;
          tmp1_c0 = _OMC_LIT19;
          tmpMeta[0+1] = _OMC_LIT20;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 11: {
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          tmpMeta49 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta49,17,1) == 0) goto tmp3_end;
          tmpMeta50 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta49), 2));
          _nd = tmpMeta49;
          _r = tmpMeta50;
          tmp4 += 3; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta51 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta52 = stringAppend(tmpMeta51,omc_Dump_printComponentRefStr(threadData, _r));
          _s = tmpMeta52;
          tmp1_c0 = _OMC_LIT18;
          tmpMeta[0+1] = _OMC_LIT21;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 12: {
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          modelica_metatype tmpMeta55;
          modelica_metatype tmpMeta56;
          tmpMeta53 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta53,23,1) == 0) goto tmp3_end;
          tmpMeta54 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta53), 2));
          _nd = tmpMeta53;
          _s = tmpMeta54;
          tmp4 += 2; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta55 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta56 = stringAppend(tmpMeta55,omc_FNode_name(threadData, _node));
          _s = tmpMeta56;
          tmp1_c0 = _OMC_LIT7;
          tmpMeta[0+1] = _OMC_LIT22;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 13: {
          modelica_metatype tmpMeta57;
          modelica_metatype tmpMeta58;
          modelica_metatype tmpMeta59;
          modelica_metatype tmpMeta60;
          tmpMeta57 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta57,20,1) == 0) goto tmp3_end;
          tmpMeta58 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta57), 2));
          if (!listEmpty(tmpMeta58)) goto tmp3_end;
          _nd = tmpMeta57;
          tmp4 += 1; /* Pattern matching succeeded; we may skip some cases if we fail */
          tmpMeta59 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta60 = stringAppend(tmpMeta59,_OMC_LIT23);
          _s = tmpMeta60;
          tmp1_c0 = _OMC_LIT7;
          tmpMeta[0+1] = _OMC_LIT22;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 14: {
          modelica_metatype tmpMeta61;
          modelica_metatype tmpMeta62;
          modelica_metatype tmpMeta63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          tmpMeta61 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta61,20,1) == 0) goto tmp3_end;
          tmpMeta62 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta61), 2));
          if (listEmpty(tmpMeta62)) goto tmp3_end;
          tmpMeta63 = MMC_CAR(tmpMeta62);
          tmpMeta64 = MMC_CDR(tmpMeta62);
          _nd = tmpMeta61;
          _target = tmpMeta63;
          /* Pattern matching succeeded */
          tmpMeta65 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta66 = stringAppend(tmpMeta65,omc_FNode_toPathStr(threadData, omc_FNode_fromRef(threadData, _target)));
          _s = tmpMeta66;
          tmp1_c0 = _OMC_LIT16;
          tmpMeta[0+1] = _OMC_LIT24;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        case 15: {
          modelica_metatype tmpMeta67;
          modelica_metatype tmpMeta68;
          modelica_metatype tmpMeta69;
          tmpMeta67 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 6));
          _nd = tmpMeta67;
          /* Pattern matching succeeded */
          tmpMeta68 = stringAppend(omc_FNode_dataStr(threadData, _nd),_OMC_LIT13);
          tmpMeta69 = stringAppend(tmpMeta68,omc_FNode_name(threadData, _node));
          _s = tmpMeta69;
          tmp1_c0 = _OMC_LIT25;
          tmpMeta[0+1] = _OMC_LIT10;
          tmp1_c2 = _s;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      tmp3_done:
      (void)tmp4;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp3_done2;
      goto_2:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp4 < 16) {
        goto tmp3_top;
      }
      MMC_THROW_INTERNAL();
      tmp3_done2:;
    }
  }
  _color = tmp1_c0;
  _shape = tmpMeta[0+1];
  _nname = tmp1_c2;
  _return: OMC_LABEL_UNUSED
  if (out_shape) { *out_shape = _shape; }
  if (out_nname) { *out_nname = _nname; }
  return _color;
}
modelica_metatype boxptr_FGraphDump_graphml(threadData_t *threadData, modelica_metatype _node, modelica_metatype _escape, modelica_metatype *out_shape, modelica_metatype *out_nname)
{
  modelica_integer tmp1;
  modelica_string _color = NULL;
  tmp1 = mmc_unbox_integer(_escape);
  _color = omc_FGraphDump_graphml(threadData, _node, tmp1, out_shape, out_nname);
  /* skip box _color; String */
  /* skip box _shape; GraphML.ShapeType */
  /* skip box _nname; String */
  return _color;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_FGraphDump_addNode(threadData_t *threadData, modelica_metatype _gin, modelica_metatype _node)
{
  modelica_metatype _gout = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _gout has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _gin;
    tmp4_2 = _node;
    {
      modelica_metatype _gi = NULL;
      modelica_integer _i;
      modelica_metatype _kids = NULL;
      modelica_string _nds = NULL;
      modelica_string _color = NULL;
      modelica_string _labelText = NULL;
      modelica_metatype _shape = NULL;
      modelica_metatype _nr = NULL;
      modelica_metatype _nrefs = NULL;
      modelica_metatype _label = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _gi has no default value.
      // _i has no default value.
      // _kids has no default value.
      // _nds has no default value.
      // _color has no default value.
      // _labelText has no default value.
      // _shape has no default value.
      // _nr has no default value.
      // _nrefs has no default value.
      // _label has no default value.
      tmp4 = 0;
      for (; tmp4 < 5; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          modelica_integer tmp10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_metatype tmpMeta15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          modelica_metatype tmpMeta18;
          modelica_metatype tmpMeta19;
          modelica_integer tmp20;
          modelica_metatype tmpMeta21;
          tmpMeta6 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (!listEmpty(tmpMeta6)) goto tmp3_end;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmpMeta8 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta9 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp10 = mmc_unbox_integer(tmpMeta9);
          _kids = tmpMeta7;
          _gi = tmpMeta8;
          _i = tmp10  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _color = omc_FGraphDump_graphml(threadData, _node, 1 /* true */ ,&_shape ,&_nds);

          _labelText = _nds;

          tmpMeta11 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT26);
          _label = tmpMeta11;

          tmpMeta12 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta13 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta14 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addNode(threadData, tmpMeta12, _color, 1.0, tmpMeta13, _shape, mmc_mk_none(), tmpMeta14, _i, _gi, NULL);

          tmpMeta15 = MMC_REFSTRUCTLIT(mmc_nil);
          _nrefs = omc_FCore_RefTree_listValues(threadData, _kids, tmpMeta15);

          /* Pattern-matching assignment */
          tmpMeta16 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta17 = omc_FGraphDump_addNodes(threadData, tmpMeta16, _nrefs);
          tmpMeta18 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta17), 1));
          tmpMeta19 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta17), 2));
          tmp20 = mmc_unbox_integer(tmpMeta19);
          _gi = tmpMeta18;
          _i = tmp20  /* pattern as ty=Integer */;
          tmpMeta21 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta1 = tmpMeta21;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta22;
          modelica_metatype tmpMeta23;
          modelica_metatype tmpMeta24;
          modelica_metatype tmpMeta25;
          modelica_metatype tmpMeta26;
          modelica_metatype tmpMeta27;
          modelica_metatype tmpMeta28;
          modelica_metatype tmpMeta29;
          modelica_integer tmp30;
          modelica_metatype tmpMeta31;
          modelica_metatype tmpMeta32;
          modelica_metatype tmpMeta33;
          modelica_metatype tmpMeta34;
          modelica_metatype tmpMeta35;
          modelica_metatype tmpMeta36;
          modelica_metatype tmpMeta37;
          modelica_metatype tmpMeta38;
          modelica_metatype tmpMeta39;
          modelica_metatype tmpMeta40;
          modelica_metatype tmpMeta41;
          modelica_metatype tmpMeta42;
          modelica_metatype tmpMeta43;
          modelica_metatype tmpMeta44;
          modelica_integer tmp45;
          modelica_metatype tmpMeta46;
          tmpMeta22 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (listEmpty(tmpMeta22)) goto tmp3_end;
          tmpMeta23 = MMC_CAR(tmpMeta22);
          tmpMeta24 = MMC_CDR(tmpMeta22);
          tmpMeta25 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmpMeta26 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta26,20,1) == 0) goto tmp3_end;
          tmpMeta27 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta26), 2));
          if (!listEmpty(tmpMeta27)) goto tmp3_end;
          tmpMeta28 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta29 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp30 = mmc_unbox_integer(tmpMeta29);
          _nr = tmpMeta23;
          _kids = tmpMeta25;
          _gi = tmpMeta28;
          _i = tmp30  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _color = omc_FGraphDump_graphml(threadData, _node, 1 /* true */ ,&_shape ,&_nds);

          _labelText = _nds;

          tmpMeta31 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT26);
          _label = tmpMeta31;

          tmpMeta32 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta33 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta34 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addNode(threadData, tmpMeta32, _color, 1.0, tmpMeta33, _shape, mmc_mk_none(), tmpMeta34, _i, _gi, NULL);

          tmpMeta35 = stringAppend(_OMC_LIT28,intString(omc_FNode_id(threadData, _node)));
          tmpMeta36 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta37 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, omc_FNode_fromRef(threadData, _nr))));
          tmpMeta38 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta39 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addEdge(threadData, tmpMeta35, tmpMeta36, tmpMeta37, _OMC_LIT7, _OMC_LIT29, 2.0, 0 /* false */, tmpMeta38, _OMC_LIT32, tmpMeta39, _gi, NULL);

          tmpMeta40 = MMC_REFSTRUCTLIT(mmc_nil);
          _nrefs = omc_FCore_RefTree_listValues(threadData, _kids, tmpMeta40);

          /* Pattern-matching assignment */
          tmpMeta41 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta42 = omc_FGraphDump_addNodes(threadData, tmpMeta41, _nrefs);
          tmpMeta43 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta42), 1));
          tmpMeta44 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta42), 2));
          tmp45 = mmc_unbox_integer(tmpMeta44);
          _gi = tmpMeta43;
          _i = tmp45  /* pattern as ty=Integer */;
          tmpMeta46 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta1 = tmpMeta46;
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta47;
          modelica_metatype tmpMeta48;
          modelica_metatype tmpMeta49;
          modelica_metatype tmpMeta50;
          modelica_metatype tmpMeta51;
          modelica_metatype tmpMeta52;
          modelica_metatype tmpMeta53;
          modelica_metatype tmpMeta54;
          modelica_metatype tmpMeta55;
          modelica_metatype tmpMeta56;
          modelica_integer tmp57;
          modelica_metatype tmpMeta58;
          modelica_metatype tmpMeta59;
          modelica_metatype tmpMeta60;
          modelica_metatype tmpMeta61;
          modelica_metatype tmpMeta62;
          modelica_metatype tmpMeta63;
          modelica_metatype tmpMeta64;
          modelica_metatype tmpMeta65;
          modelica_metatype tmpMeta66;
          modelica_metatype tmpMeta67;
          modelica_metatype tmpMeta68;
          modelica_metatype tmpMeta69;
          modelica_metatype tmpMeta70;
          modelica_metatype tmpMeta71;
          modelica_integer tmp72;
          modelica_metatype tmpMeta73;
          tmpMeta47 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (listEmpty(tmpMeta47)) goto tmp3_end;
          tmpMeta48 = MMC_CAR(tmpMeta47);
          tmpMeta49 = MMC_CDR(tmpMeta47);
          tmpMeta50 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmpMeta51 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta51,20,1) == 0) goto tmp3_end;
          tmpMeta52 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta51), 2));
          if (listEmpty(tmpMeta52)) goto tmp3_end;
          tmpMeta53 = MMC_CAR(tmpMeta52);
          tmpMeta54 = MMC_CDR(tmpMeta52);
          tmpMeta55 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta56 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp57 = mmc_unbox_integer(tmpMeta56);
          _nr = tmpMeta48;
          _kids = tmpMeta50;
          _gi = tmpMeta55;
          _i = tmp57  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _color = omc_FGraphDump_graphml(threadData, _node, 1 /* true */ ,&_shape ,&_nds);

          _labelText = _nds;

          tmpMeta58 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT26);
          _label = tmpMeta58;

          tmpMeta59 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta60 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta61 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addNode(threadData, tmpMeta59, _color, 1.0, tmpMeta60, _shape, mmc_mk_none(), tmpMeta61, _i, _gi, NULL);

          tmpMeta62 = stringAppend(_OMC_LIT28,intString(omc_FNode_id(threadData, _node)));
          tmpMeta63 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta64 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, omc_FNode_fromRef(threadData, _nr))));
          tmpMeta65 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta66 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addEdge(threadData, tmpMeta62, tmpMeta63, tmpMeta64, _OMC_LIT16, _OMC_LIT29, 2.0, 0 /* false */, tmpMeta65, _OMC_LIT32, tmpMeta66, _gi, NULL);

          tmpMeta67 = MMC_REFSTRUCTLIT(mmc_nil);
          _nrefs = omc_FCore_RefTree_listValues(threadData, _kids, tmpMeta67);

          /* Pattern-matching assignment */
          tmpMeta68 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta69 = omc_FGraphDump_addNodes(threadData, tmpMeta68, _nrefs);
          tmpMeta70 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta69), 1));
          tmpMeta71 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta69), 2));
          tmp72 = mmc_unbox_integer(tmpMeta71);
          _gi = tmpMeta70;
          _i = tmp72  /* pattern as ty=Integer */;
          tmpMeta73 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta1 = tmpMeta73;
          goto tmp3_done;
        }
        case 3: {
          modelica_metatype tmpMeta74;
          modelica_metatype tmpMeta75;
          modelica_metatype tmpMeta76;
          modelica_metatype tmpMeta77;
          modelica_metatype tmpMeta78;
          modelica_metatype tmpMeta79;
          modelica_integer tmp80;
          modelica_metatype tmpMeta81;
          tmpMeta74 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (listEmpty(tmpMeta74)) goto tmp3_end;
          tmpMeta75 = MMC_CAR(tmpMeta74);
          tmpMeta76 = MMC_CDR(tmpMeta74);
          tmpMeta77 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 6));
          if (mmc__uniontype__metarecord__typedef__equal(tmpMeta77,22,4) == 0) goto tmp3_end;
          tmpMeta78 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta79 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp80 = mmc_unbox_integer(tmpMeta79);
          _gi = tmpMeta78;
          _i = tmp80  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          tmpMeta81 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta1 = tmpMeta81;
          goto tmp3_done;
        }
        case 4: {
          modelica_metatype tmpMeta82;
          modelica_metatype tmpMeta83;
          modelica_metatype tmpMeta84;
          modelica_metatype tmpMeta85;
          modelica_metatype tmpMeta86;
          modelica_metatype tmpMeta87;
          modelica_integer tmp88;
          modelica_metatype tmpMeta89;
          modelica_metatype tmpMeta90;
          modelica_metatype tmpMeta91;
          modelica_metatype tmpMeta92;
          modelica_metatype tmpMeta93;
          modelica_metatype tmpMeta94;
          modelica_metatype tmpMeta95;
          modelica_metatype tmpMeta96;
          modelica_metatype tmpMeta97;
          modelica_metatype tmpMeta98;
          modelica_metatype tmpMeta99;
          modelica_metatype tmpMeta100;
          modelica_metatype tmpMeta101;
          modelica_metatype tmpMeta102;
          modelica_integer tmp103;
          modelica_metatype tmpMeta104;
          tmpMeta82 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 4));
          if (listEmpty(tmpMeta82)) goto tmp3_end;
          tmpMeta83 = MMC_CAR(tmpMeta82);
          tmpMeta84 = MMC_CDR(tmpMeta82);
          tmpMeta85 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_2), 5));
          tmpMeta86 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 1));
          tmpMeta87 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmp4_1), 2));
          tmp88 = mmc_unbox_integer(tmpMeta87);
          _nr = tmpMeta83;
          _kids = tmpMeta85;
          _gi = tmpMeta86;
          _i = tmp88  /* pattern as ty=Integer */;
          /* Pattern matching succeeded */
          _color = omc_FGraphDump_graphml(threadData, _node, 1 /* true */ ,&_shape ,&_nds);

          _labelText = _nds;

          tmpMeta89 = mmc_mk_box4(3, &GraphML_NodeLabel_NODELABEL__INTERNAL__desc, _labelText, mmc_mk_none(), _OMC_LIT26);
          _label = tmpMeta89;

          tmpMeta90 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta91 = mmc_mk_cons(_label, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta92 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addNode(threadData, tmpMeta90, _color, 1.0, tmpMeta91, _shape, mmc_mk_none(), tmpMeta92, _i, _gi, NULL);

          tmpMeta93 = stringAppend(_OMC_LIT33,intString(omc_FNode_id(threadData, _node)));
          tmpMeta94 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, _node)));
          tmpMeta95 = stringAppend(_OMC_LIT27,intString(omc_FNode_id(threadData, omc_FNode_fromRef(threadData, _nr))));
          tmpMeta96 = MMC_REFSTRUCTLIT(mmc_nil);
          tmpMeta97 = MMC_REFSTRUCTLIT(mmc_nil);
          _gi = omc_GraphML_addEdge(threadData, tmpMeta93, tmpMeta94, tmpMeta95, _OMC_LIT34, _OMC_LIT29, 2.0, 0 /* false */, tmpMeta96, _OMC_LIT35, tmpMeta97, _gi, NULL);

          tmpMeta98 = MMC_REFSTRUCTLIT(mmc_nil);
          _nrefs = omc_FCore_RefTree_listValues(threadData, _kids, tmpMeta98);

          /* Pattern-matching assignment */
          tmpMeta99 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta100 = omc_FGraphDump_addNodes(threadData, tmpMeta99, _nrefs);
          tmpMeta101 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta100), 1));
          tmpMeta102 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta100), 2));
          tmp103 = mmc_unbox_integer(tmpMeta102);
          _gi = tmpMeta101;
          _i = tmp103  /* pattern as ty=Integer */;
          tmpMeta104 = mmc_mk_box2(0, _gi, mmc_mk_integer(_i));
          tmpMeta1 = tmpMeta104;
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _gout = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _gout;
}

PROTECTED_FUNCTION_STATIC modelica_metatype omc_FGraphDump_addNodes(threadData_t *threadData, modelica_metatype _gin, modelica_metatype _inRefs)
{
  modelica_metatype _gout = NULL;
  modelica_metatype tmpMeta1;
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  // _gout has no default value.
  { /* match expression */
    modelica_metatype tmp4_1;modelica_metatype tmp4_2;
    tmp4_1 = _gin;
    tmp4_2 = _inRefs;
    {
      modelica_metatype _g = NULL;
      modelica_metatype _rest = NULL;
      modelica_metatype _n = NULL;
      volatile mmc_switch_type tmp4;
      int tmp5;
      // _g has no default value.
      // _rest has no default value.
      // _n has no default value.
      tmp4 = 0;
      for (; tmp4 < 3; tmp4++) {
        switch (MMC_SWITCH_CAST(tmp4)) {
        case 0: {
          if (!listEmpty(tmp4_2)) goto tmp3_end;
          
          /* Pattern matching succeeded */
          tmpMeta1 = _gin;
          goto tmp3_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta6 = MMC_CAR(tmp4_2);
          tmpMeta7 = MMC_CDR(tmp4_2);
          
          _n = tmpMeta6;
          _rest = tmpMeta7;
          _g = tmp4_1;
          /* Pattern matching succeeded */
          /* Check guard condition after assignments */
          if (!((!omc_FNode_isRefTop(threadData, _n)) && (!omc_FNode_isRefUserDefined(threadData, _n)))) goto tmp3_end;
          /* Tail recursive call */
          _gin = _g;
          _inRefs = _rest;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        case 2: {
          modelica_metatype tmpMeta8;
          modelica_metatype tmpMeta9;
          if (listEmpty(tmp4_2)) goto tmp3_end;
          tmpMeta8 = MMC_CAR(tmp4_2);
          tmpMeta9 = MMC_CDR(tmp4_2);
          
          _n = tmpMeta8;
          _rest = tmpMeta9;
          _g = tmp4_1;
          /* Pattern matching succeeded */
          _g = omc_FGraphDump_addNode(threadData, _g, omc_FNode_fromRef(threadData, _n));
          /* Tail recursive call */
          _gin = _g;
          _inRefs = _rest;
          goto _tailrecursive;
          /* TODO: Make sure any eventual dead code below is never generated */
          goto tmp3_done;
        }
        }
        goto tmp3_end;
        tmp3_end: ;
      }
      goto goto_2;
      goto_2:;
      MMC_THROW_INTERNAL();
      goto tmp3_done;
      tmp3_done:;
    }
  }
  _gout = tmpMeta1;
  _return: OMC_LABEL_UNUSED
  return _gout;
}

DLLDirection
void omc_FGraphDump_dumpGraph(threadData_t *threadData, modelica_metatype _inGraph, modelica_string _fileName)
{
  MMC_SO();
  _tailrecursive: OMC_LABEL_UNUSED
  { /* matchcontinue expression */
    {
      modelica_integer _g;
      modelica_metatype _gi = NULL;
      modelica_metatype _nr = NULL;
      volatile mmc_switch_type tmp3;
      int tmp4;
      // _g has no default value.
      // _gi has no default value.
      // _nr has no default value.
      tmp3 = 0;
      MMC_TRY_INTERNAL(mmc_jumper)
      tmp2_top:
      threadData->mmc_jumper = &new_mmc_jumper;
      for (; tmp3 < 2; tmp3++) {
        switch (MMC_SWITCH_CAST(tmp3)) {
        case 0: {
          modelica_boolean tmp5;
          /* Pattern matching succeeded */
          /* Pattern-matching assignment */
          tmp5 = omc_Flags_isSet(threadData, _OMC_LIT39);
          if (0 /* false */ != tmp5) goto goto_1;
          goto tmp2_done;
        }
        case 1: {
          modelica_metatype tmpMeta6;
          modelica_metatype tmpMeta7;
          modelica_integer tmp8;
          modelica_metatype tmpMeta9;
          modelica_metatype tmpMeta10;
          modelica_metatype tmpMeta11;
          modelica_metatype tmpMeta12;
          modelica_metatype tmpMeta13;
          modelica_metatype tmpMeta14;
          modelica_integer tmp15;
          modelica_metatype tmpMeta16;
          modelica_metatype tmpMeta17;
          /* Pattern matching succeeded */
          _gi = omc_GraphML_createGraphInfo(threadData);

          /* Pattern-matching tuple assignment */
          tmpMeta9 = omc_GraphML_addGraph(threadData, _OMC_LIT40, 0 /* false */, _gi, &tmpMeta6);
          _gi = tmpMeta9;
          tmpMeta7 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta6), 2));
          tmp8 = mmc_unbox_integer(tmpMeta7);
          _g = tmp8  /* pattern as ty=Integer */;

          _nr = omc_FGraph_top(threadData, _inGraph);

          /* Pattern-matching assignment */
          tmpMeta10 = mmc_mk_box2(0, _gi, mmc_mk_integer(_g));
          tmpMeta11 = mmc_mk_cons(_nr, MMC_REFSTRUCTLIT(mmc_nil));
          tmpMeta12 = omc_FGraphDump_addNodes(threadData, tmpMeta10, tmpMeta11);
          tmpMeta13 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 1));
          tmpMeta14 = MMC_FETCH(MMC_OFFSET(MMC_UNTAGPTR(tmpMeta12), 2));
          tmp15 = mmc_unbox_integer(tmpMeta14);
          _gi = tmpMeta13;
          _g = tmp15  /* pattern as ty=Integer */;

          tmpMeta16 = stringAppend(_OMC_LIT41,_fileName);
          tmpMeta17 = stringAppend(tmpMeta16,_OMC_LIT42);
          fputs(MMC_STRINGDATA(tmpMeta17),stdout);

          omc_GraphML_dumpGraph(threadData, _gi, _fileName);

          fputs(MMC_STRINGDATA(_OMC_LIT43),stdout);
          goto tmp2_done;
        }
        }
        goto tmp2_end;
        tmp2_end: ;
      }
      goto goto_1;
      tmp2_done:
      (void)tmp3;
      MMC_RESTORE_INTERNAL(mmc_jumper);
      goto tmp2_done2;
      goto_1:;
      MMC_CATCH_INTERNAL(mmc_jumper);
      if (++tmp3 < 2) {
        goto tmp2_top;
      }
      MMC_THROW_INTERNAL();
      tmp2_done2:;
    }
  }
  ;
  _return: OMC_LABEL_UNUSED
  return;
}

